     H/TITLE Exc TRG PMAMREP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/13/19  Time  : 09:23:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUBECPL0  IF A E           K DISK
      * UPD : BI Order Header Extsn TRG Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUBE1        E DS                  EXTNAME(PUBECPL0)
      * UPD : BI Order Header Extsn TRG Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(BEAIC3)
     D  WAC4NB       E                     EXTFLD(BEC4NB)
     D  WAAYTS       E                     EXTFLD(BEAYTS)
     D  WAJJSC       E                     EXTFLD(BEJJSC)
     D  WAJKSC       E                     EXTFLD(BEJKSC)
     D  WAA9DX       E                     EXTFLD(BEA9DX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              1
     D  WL0004         S              2
     D  WL0005         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0001         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           894
      * RCD: Order Header Extension    Retrieval index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Load ID
     D  P1RMNB                 7     10P 0
      * I :  Stop/Drop Sequence Number
     D  P1RUNB                11     13P 0
      * I :  Shipping Line
     D  P1XACD                14     16
      * I :  Port Delv Terminal
     D  P1OANA                17     36
      * I :  OHE City
     D  P1HBAA                37     61
      * I :  OHE Vessel/Airline
     D  P1J0T1                62     91
      * I :  OHE Voyage/Flight
     D  P1GENY                92    106
      * I :  OHE Booking Number
     D  P1J1T1               107    121
      * I :  OHE Discharge Port/Airprt
     D  P1HCAA               122    141
      * I :  OHE Sail/Flight Date
     D  P1QWDT               142    145P 0
      * I :  OHE Port Cut Date
     D  P1QXDT               146    149P 0
      * I :  OHE Arrival Date
     D  P1QYDT               150    153P 0
      * I :  OHE Late Delivery Code
     D  P1HDAA               154    156
      * I :  OHE Ship Status
     D  P1CCTX               157    157
      * I :  OHE Container Number
     D  P1J2T1               158    169
      * I :  OHE Comment 1
     D  P1RLNA               170    204
      * I :  OHE Comment 2
     D  P1RMNA               205    279
      * I :  OHE Unused Number 1-11.0
     D  P1GINY               280    285P 0
      * I :  OHE Unused Number 2-11.0
     D  P1GFNY               286    291P 0
      * I :  OHE Unused Number 3-11.0
     D  P1GGNY               292    297P 0
      * I :  OHE Unused Number 4-11.0
     D  P1GHNY               298    303P 0
      * I :  OHE HPB RIN Equiv Value
     D  P1HEVL               304    309P 2
      * I :  OHE HPB RIN Price
     D  P1HFVL               310    315P 2
      * I :  Transload Terminal Fees
     D  P1HGVL               316    321P 2
      * I :  OHE Est Arrv at Dest Date
     D  P1QZDT               322    325P 0
      * I :  OHE Backhaul ETA RtrnDate
     D  P1Q0DT               326    329P 0
      * I :  OHE Port/Pier Paid Date
     D  P1Q1DT               330    333P 0
      * I :  OHE Actual Ship Date
     D  P1Q2DT               334    337P 0
      * I :  OHE Carrier SCAC Code
     D  P1C2TX               338    341
      * I :  OHE Spot Buy
     D  P1C3TX               342    345
      * I :  OHE PO ACK Flag
     D  P1C6TX               346    349
      * I :  OHE Override Type Code
     D  P1CHTX               350    351
      * I :  OHE Backhaul Status
     D  P1CITX               352    353
      * I :  OHE Backhaul ETA AM/PM
     D  P1CLTX               354    355
      * I :  OHE Load Haul Type
     D  P1B4TX               356    358
      * I :  OHE Backhaul Carrier Code
     D  P1CUTX               359    361
      * I :  OHE Bookings Confirmed
     D  P1CVTX               362    364
      * I :  OHE EDI Error Reasons
     D  P1B9TX               365    369
      * I :  OHE EDI Error Reasons 2
     D  P1JWSC               370    374
      * I :  HPB COA Batch Number
     D  P1ITNY               375    377P 0
      * I :  Delivery P.O. Number
     D  P1LMT1               378    415
      * I :  OHE Intended for ExportCC
     D  P1LWAA               416    421
      * I :  OHE EDI 943 Action
     D  P1FVST               422    427
      * I :  OHE EDI 944 Action
     D  P1F0ST               428    433
      * I :  OHE EDI 940 Action
     D  P1F2ST               434    439
      * I :  OHE EDI 945 Action
     D  P1F3ST               440    445
      * I :  OHE EDI 856 Action
     D  P1JUSC               446    446
      * I :  OHE EDI 824 Action
     D  P1JVSC               447    447
      * I :  OHE Transload Seal Nbr
     D  P1V3T1               448    457
      * I :  OHE Abs Rate Override Rsn
     D  P1V4T1               458    467
      * I :  OHE Appt Confirmation #
     D  P1V5T1               468    477
      * I :  OHE Backhaul Container#
     D  P1V6T1               478    492
      * I :  OHE Backhaul Chassis #
     D  P1V7T1               493    507
      * I :  OHE Transload Container#
     D  P1V8T1               508    522
      * I :  OHE Pier Pass Invoice
     D  P1V9T1               523    552
      * I :  OHE Carrier Nm
     D  P1WAT1               553    582
      * I :  OHE Appt Confirmation Nm
     D  P1WBT1               583    612
      * I :  OHE Backhaul Comment
     D  P1WCT1               613    662
      * I :  Letter of Credit Number
     D  P1WDT1               663    712
      * I :  OHE Backhaul Return to Co
     D  P1QJNY               713    714P 0
      * I :  LD Stop/Drop
     D  P1QKNY               715    716P 0
      * I :  OHE Unused Number 3.0
     D  P1QLNY               717    718P 0
      * I :  OHE Pier Pass Fee Amount
     D  P1P8NY               719    721P 2
      * I :  OHE Port Check Fee Amount
     D  P1P9NY               722    724P 2
      * I :  OHE Port Cut Time
     D  P1QANY               725    727P 0
      * I :  OHE Backhaul Truck Number
     D  P1QCNY               728    731P 0
      * I :  OHE Load Sched Seq Num
     D  P1QDNY               732    735P 0
      * I :  Original Appointment Date
     D  P1QENY               736    739P 0
      * I :  Original Appointment Time
     D  P1QFNY               740    743P 0
      * I :  OHE PowerPro Load#-Outbnd
     D  P1QGNY               744    748P 0
      * I :  OHE PowerPro Load#-Bckhl
     D  P1QHNY               749    753P 0
      * I :  OHE Unused Numeric 9,0 3
     D  P1QINY               754    758P 0
      * I :  OHE Orig ABS Freight Rate
     D  P1QMNY               759    763P 6
      * I :  OHE Genset Number
     D  P1MYU1               764    778
      * I :  OHE Unused Status 1
     D  P1JXSC               779    779
      * I :  OHE Unused Status 2
     D  P1JYSC               780    780
      * I :  OHE Unused Status 3
     D  P1JZSC               781    782
      * I :  OHE Unused Status 4
     D  P1J0SC               783    784
      * I :  OHE Unused Text 1
     D  P1MZU1               785    789
      * I :  OHE Unused Text 2
     D  P1M0U1               790    794
      * I :  OHE Unused Text 3
     D  P1M1U1               795    809
      * I :  OHE Unused Text 4
     D  P1M2U1               810    824
      * I :  OHE Unused Text 5
     D  P1M3U1               825    854
      * I :  OHE Unused Date 1
     D  P1W5DT               855    858P 0
      * I :  OHE Unused Date 2
     D  P1W6DT               859    862P 0
      * I :  EDI Status 1
     D  P1UVST               863    863
      * I :  EDI Status 2
     D  P1UWST               864    864
      * I :  EDI Status 3
     D  P1UXST               865    865
      * I :  Record Status
     D  P1VSST               866    866
      * I :  Job Time
     D  P1AATM               867    870P 0
      * I :  User Id
     D  P1AYNA               871    880
      * I :  Job Name
     D  P1A0NA               881    890
      * I :  Job Date
     D  P1AXDT               891    894P 0
     D P2PARM          DS           894
      * RCD: Order Header Extension    Retrieval index
      * I :  Company Number
     D  P2AIC3                 1      2P 0
      * I :  Order Number
     D  P2C4NB                 3      6P 0
      * I :  Load ID
     D  P2RMNB                 7     10P 0
      * I :  Stop/Drop Sequence Number
     D  P2RUNB                11     13P 0
      * I :  Shipping Line
     D  P2XACD                14     16
      * I :  Port Delv Terminal
     D  P2OANA                17     36
      * I :  OHE City
     D  P2HBAA                37     61
      * I :  OHE Vessel/Airline
     D  P2J0T1                62     91
      * I :  OHE Voyage/Flight
     D  P2GENY                92    106
      * I :  OHE Booking Number
     D  P2J1T1               107    121
      * I :  OHE Discharge Port/Airprt
     D  P2HCAA               122    141
      * I :  OHE Sail/Flight Date
     D  P2QWDT               142    145P 0
      * I :  OHE Port Cut Date
     D  P2QXDT               146    149P 0
      * I :  OHE Arrival Date
     D  P2QYDT               150    153P 0
      * I :  OHE Late Delivery Code
     D  P2HDAA               154    156
      * I :  OHE Ship Status
     D  P2CCTX               157    157
      * I :  OHE Container Number
     D  P2J2T1               158    169
      * I :  OHE Comment 1
     D  P2RLNA               170    204
      * I :  OHE Comment 2
     D  P2RMNA               205    279
      * I :  OHE Unused Number 1-11.0
     D  P2GINY               280    285P 0
      * I :  OHE Unused Number 2-11.0
     D  P2GFNY               286    291P 0
      * I :  OHE Unused Number 3-11.0
     D  P2GGNY               292    297P 0
      * I :  OHE Unused Number 4-11.0
     D  P2GHNY               298    303P 0
      * I :  OHE HPB RIN Equiv Value
     D  P2HEVL               304    309P 2
      * I :  OHE HPB RIN Price
     D  P2HFVL               310    315P 2
      * I :  Transload Terminal Fees
     D  P2HGVL               316    321P 2
      * I :  OHE Est Arrv at Dest Date
     D  P2QZDT               322    325P 0
      * I :  OHE Backhaul ETA RtrnDate
     D  P2Q0DT               326    329P 0
      * I :  OHE Port/Pier Paid Date
     D  P2Q1DT               330    333P 0
      * I :  OHE Actual Ship Date
     D  P2Q2DT               334    337P 0
      * I :  OHE Carrier SCAC Code
     D  P2C2TX               338    341
      * I :  OHE Spot Buy
     D  P2C3TX               342    345
      * I :  OHE PO ACK Flag
     D  P2C6TX               346    349
      * I :  OHE Override Type Code
     D  P2CHTX               350    351
      * I :  OHE Backhaul Status
     D  P2CITX               352    353
      * I :  OHE Backhaul ETA AM/PM
     D  P2CLTX               354    355
      * I :  OHE Load Haul Type
     D  P2B4TX               356    358
      * I :  OHE Backhaul Carrier Code
     D  P2CUTX               359    361
      * I :  OHE Bookings Confirmed
     D  P2CVTX               362    364
      * I :  OHE EDI Error Reasons
     D  P2B9TX               365    369
      * I :  OHE EDI Error Reasons 2
     D  P2JWSC               370    374
      * I :  HPB COA Batch Number
     D  P2ITNY               375    377P 0
      * I :  Delivery P.O. Number
     D  P2LMT1               378    415
      * I :  OHE Intended for ExportCC
     D  P2LWAA               416    421
      * I :  OHE EDI 943 Action
     D  P2FVST               422    427
      * I :  OHE EDI 944 Action
     D  P2F0ST               428    433
      * I :  OHE EDI 940 Action
     D  P2F2ST               434    439
      * I :  OHE EDI 945 Action
     D  P2F3ST               440    445
      * I :  OHE EDI 856 Action
     D  P2JUSC               446    446
      * I :  OHE EDI 824 Action
     D  P2JVSC               447    447
      * I :  OHE Transload Seal Nbr
     D  P2V3T1               448    457
      * I :  OHE Abs Rate Override Rsn
     D  P2V4T1               458    467
      * I :  OHE Appt Confirmation #
     D  P2V5T1               468    477
      * I :  OHE Backhaul Container#
     D  P2V6T1               478    492
      * I :  OHE Backhaul Chassis #
     D  P2V7T1               493    507
      * I :  OHE Transload Container#
     D  P2V8T1               508    522
      * I :  OHE Pier Pass Invoice
     D  P2V9T1               523    552
      * I :  OHE Carrier Nm
     D  P2WAT1               553    582
      * I :  OHE Appt Confirmation Nm
     D  P2WBT1               583    612
      * I :  OHE Backhaul Comment
     D  P2WCT1               613    662
      * I :  Letter of Credit Number
     D  P2WDT1               663    712
      * I :  OHE Backhaul Return to Co
     D  P2QJNY               713    714P 0
      * I :  LD Stop/Drop
     D  P2QKNY               715    716P 0
      * I :  OHE Unused Number 3.0
     D  P2QLNY               717    718P 0
      * I :  OHE Pier Pass Fee Amount
     D  P2P8NY               719    721P 2
      * I :  OHE Port Check Fee Amount
     D  P2P9NY               722    724P 2
      * I :  OHE Port Cut Time
     D  P2QANY               725    727P 0
      * I :  OHE Backhaul Truck Number
     D  P2QCNY               728    731P 0
      * I :  OHE Load Sched Seq Num
     D  P2QDNY               732    735P 0
      * I :  Original Appointment Date
     D  P2QENY               736    739P 0
      * I :  Original Appointment Time
     D  P2QFNY               740    743P 0
      * I :  OHE PowerPro Load#-Outbnd
     D  P2QGNY               744    748P 0
      * I :  OHE PowerPro Load#-Bckhl
     D  P2QHNY               749    753P 0
      * I :  OHE Unused Numeric 9,0 3
     D  P2QINY               754    758P 0
      * I :  OHE Orig ABS Freight Rate
     D  P2QMNY               759    763P 6
      * I :  OHE Genset Number
     D  P2MYU1               764    778
      * I :  OHE Unused Status 1
     D  P2JXSC               779    779
      * I :  OHE Unused Status 2
     D  P2JYSC               780    780
      * I :  OHE Unused Status 3
     D  P2JZSC               781    782
      * I :  OHE Unused Status 4
     D  P2J0SC               783    784
      * I :  OHE Unused Text 1
     D  P2MZU1               785    789
      * I :  OHE Unused Text 2
     D  P2M0U1               790    794
      * I :  OHE Unused Text 3
     D  P2M1U1               795    809
      * I :  OHE Unused Text 4
     D  P2M2U1               810    824
      * I :  OHE Unused Text 5
     D  P2M3U1               825    854
      * I :  OHE Unused Date 1
     D  P2W5DT               855    858P 0
      * I :  OHE Unused Date 2
     D  P2W6DT               859    862P 0
      * I :  EDI Status 1
     D  P2UVST               863    863
      * I :  EDI Status 2
     D  P2UWST               864    864
      * I :  EDI Status 3
     D  P2UXST               865    865
      * I :  Record Status
     D  P2VSST               866    866
      * I :  Job Time
     D  P2AATM               867    870P 0
      * I :  User Id
     D  P2AYNA               871    880
      * I :  Job Name
     D  P2A0NA               881    890
      * I :  Job Date
     D  P2AXDT               891    894P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@BECPEX
      * BI Order Header Extsn TRG Update index
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEAYTS                      WAAYTS
     I              BEJJSC                      WAJJSC
     I              BEJKSC                      WAJKSC
     I              BEA9DX                      WAA9DX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Order Head
     C                   PARM                    P2PARM                         RCD: Order Head
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG PMAMREP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Crt BI Ord Hdr Ext TRG CR - BI Order Header Extsn TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P3D8SC        WL0003                         BIOHE TRG Datab
     C                   MOVEL(P)  '0'           WL0004                         BIOHE Process S
     C                   Z-ADD     0             WL0005                         BIOHE Process D
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
     C                   IF        P3D8SC = '3'
     C                   MOVEL     'N'           YL0001                         Update Record U
      * Set Update Flag If Any 1st 50 Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45ORc46ORc47ORc48ORc49ORc50
      *   |- c1    : PR1.Load ID NE PR2.Load ID
      *   |- c2    : PR1.Stop/Drop Sequence Number NE PR2.Stop/Drop Seque
      *   |- c3    : PR1.Shipping Line NE PR2.Shipping Line
      *   |- c4    : PR1.Port Delv Terminal NE PR2.Port Delv Terminal
      *   |- c5    : PR1.OHE City NE PR2.OHE City
      *   |- c6    : PR1.OHE Vessel/Airline NE PR2.OHE Vessel/Airline
      *   |- c7    : PR1.OHE Voyage/Flight NE PR2.OHE Voyage/Flight
      *   |- c8    : PR1.OHE Booking Number NE PR2.OHE Booking Number
      *   |- c9    : PR1.OHE Discharge Port/Airprt NE PR2.OHE Discharge P
      *   |- c10   : PR1.OHE Sail/Flight Date NE PR2.OHE Sail/Flight Date
      *   |- c11   : PR1.OHE Port Cut Date NE PR2.OHE Port Cut Date
      *   |- c12   : PR1.OHE Arrival Date NE PR2.OHE Arrival Date
      *   |- c13   : PR1.OHE Late Delivery Code NE PR2.OHE Late Delivery
      *   |- c14   : PR1.OHE Ship Status NE PR2.OHE Ship Status
      *   |- c15   : PR1.OHE Container Number NE PR2.OHE Container Number
      *   |- c16   : PR1.OHE Comment 1 NE PR2.OHE Comment 1
      *   |- c17   : PR1.OHE Comment 2 NE PR2.OHE Comment 2
      *   |- c18   : PR1.OHE Unused Number 1-11.0 NE PR2.OHE Unused Numbe
      *   |- c19   : PR1.OHE Unused Number 2-11.0 NE PR2.OHE Unused Numbe
      *   |- c20   : PR1.OHE Unused Number 3-11.0 NE PR2.OHE Unused Numbe
      *   |- c21   : PR1.OHE Unused Number 4-11.0 NE PR2.OHE Unused Numbe
      *   |- c22   : PR1.OHE HPB RIN Equiv Value NE PR2.OHE HPB RIN Equiv
      *   |- c23   : PR1.OHE HPB RIN Price NE PR2.OHE HPB RIN Price
      *   |- c24   : PR1.Transload Terminal Fees NE PR2.Transload Termina
      *   |- c25   : PR1.OHE Est Arrv at Dest Date NE PR2.OHE Est Arrv at
      *   |- c26   : PR1.OHE Backhaul ETA RtrnDate NE PR2.OHE Backhaul ET
      *   |- c27   : PR1.OHE Port/Pier Paid Date NE PR2.OHE Port/Pier Pai
      *   |- c28   : PR1.OHE Actual Ship Date NE PR2.OHE Actual Ship Date
      *   |- c29   : PR1.OHE Carrier SCAC Code NE PR2.OHE Carrier SCAC Co
      *   |- c30   : PR1.OHE Spot Buy NE PR2.OHE Spot Buy
      *   |- c31   : PR1.OHE PO ACK Flag NE PR2.OHE PO ACK Flag
      *   |- c32   : PR1.OHE Override Type Code NE PR2.OHE Override Type
      *   |- c33   : PR1.OHE Backhaul Status NE PR2.OHE Backhaul Status
      *   |- c34   : PR1.OHE Backhaul ETA AM/PM NE PR2.OHE Backhaul ETA A
      *   |- c35   : PR1.OHE Load Haul Type NE PR2.OHE Load Haul Type
      *   |- c36   : PR1.OHE Backhaul Carrier Code NE PR2.OHE Backhaul Ca
      *   |- c37   : PR1.OHE Bookings Confirmed NE PR2.OHE Bookings Confi
      *   |- c38   : PR1.OHE EDI Error Reasons NE PR2.OHE EDI Error Reaso
      *   |- c39   : PR1.HPB COA Batch Number NE PR2.HPB COA Batch Number
      *   |- c40   : PR1.Delivery P.O. Number NE PR2.Delivery P.O. Number
      *   |- c41   : PR1.OHE Intended for ExportCC NE PR2.OHE Intended fo
      *   |- c42   : PR1.OHE EDI 943 Action NE PR2.OHE EDI 943 Action
      *   |- c43   : PR1.OHE EDI 944 Action NE PR2.OHE EDI 944 Action
      *   |- c44   : PR1.OHE EDI 940 Action NE PR2.OHE EDI 940 Action
      *   |- c45   : PR1.OHE EDI 945 Action NE PR2.OHE EDI 945 Action
      *   |- c46   : PR1.OHE Transload Seal Nbr NE PR2.OHE Transload Seal
      *   |- c47   : PR1.OHE Abs Rate Override Rsn NE PR2.OHE Abs Rate Ov
      *   |- c48   : PR1.OHE Appt Confirmation # NE PR2.OHE Appt Confirma
      *   |- c49   : PR1.OHE Backhaul Container# NE PR2.OHE Backhaul Cont
      *   |- c50   : PR1.OHE Backhaul Chassis # NE PR2.OHE Backhaul Chass
      *   '-
     C                   IF        P1RMNB <> P2RMNB OR
     C                             P1RUNB <> P2RUNB OR
     C                             P1XACD <> P2XACD OR
     C                             P1OANA <> P2OANA OR
     C                             P1HBAA <> P2HBAA OR
     C                             P1J0T1 <> P2J0T1 OR
     C                             P1GENY <> P2GENY OR
     C                             P1J1T1 <> P2J1T1 OR
     C                             P1HCAA <> P2HCAA OR
     C                             P1QWDT <> P2QWDT OR
     C                             P1QXDT <> P2QXDT OR
     C                             P1QYDT <> P2QYDT OR
     C                             P1HDAA <> P2HDAA OR
     C                             P1CCTX <> P2CCTX OR
     C                             P1J2T1 <> P2J2T1 OR
     C                             P1RLNA <> P2RLNA OR
     C                             P1RMNA <> P2RMNA OR
     C                             P1GINY <> P2GINY OR
     C                             P1GFNY <> P2GFNY OR
     C                             P1GGNY <> P2GGNY OR
     C                             P1GHNY <> P2GHNY OR
     C                             P1HEVL <> P2HEVL OR
     C                             P1HFVL <> P2HFVL OR
     C                             P1HGVL <> P2HGVL OR
     C                             P1QZDT <> P2QZDT OR
     C                             P1Q0DT <> P2Q0DT OR
     C                             P1Q1DT <> P2Q1DT OR
     C                             P1Q2DT <> P2Q2DT OR
     C                             P1C2TX <> P2C2TX OR
     C                             P1C3TX <> P2C3TX OR
     C                             P1C6TX <> P2C6TX OR
     C                             P1CHTX <> P2CHTX OR
     C                             P1CITX <> P2CITX OR
     C                             P1CLTX <> P2CLTX OR
     C                             P1B4TX <> P2B4TX OR
     C                             P1CUTX <> P2CUTX OR
     C                             P1CVTX <> P2CVTX OR
     C                             P1B9TX <> P2B9TX OR
     C                             P1ITNY <> P2ITNY OR
     C                             P1LMT1 <> P2LMT1 OR
     C                             P1LWAA <> P2LWAA OR
     C                             P1FVST <> P2FVST OR
     C                             P1F0ST <> P2F0ST OR
     C                             P1F2ST <> P2F2ST OR
     C                             P1F3ST <> P2F3ST OR
     C                             P1V3T1 <> P2V3T1 OR
     C                             P1V4T1 <> P2V4T1 OR
     C                             P1V5T1 <> P2V5T1 OR
     C                             P1V6T1 <> P2V6T1 OR
     C                             P1V7T1 <> P2V7T1
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Set Update Flag If Any Remaining Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39
      *   |- c1    : PR1.OHE Transload Container# NE PR2.OHE Transload Co
      *   |- c2    : PR1.OHE Pier Pass Invoice NE PR2.OHE Pier Pass Invoi
      *   |- c3    : PR1.OHE Carrier Nm NE PR2.OHE Carrier Nm
      *   |- c4    : PR1.OHE Appt Confirmation Nm NE PR2.OHE Appt Confirm
      *   |- c5    : PR1.OHE Backhaul Comment NE PR2.OHE Backhaul Comment
      *   |- c6    : PR1.Letter of Credit Number NE PR2.Letter of Credit
      *   |- c7    : PR1.OHE Backhaul Return to Co NE PR2.OHE Backhaul Re
      *   |- c8    : PR1.LD Stop/Drop NE PR2.LD Stop/Drop
      *   |- c9    : PR1.OHE Unused Number 3.0 NE PR2.OHE Unused Number 3
      *   |- c10   : PR1.OHE Pier Pass Fee Amount NE PR2.OHE Pier Pass Fe
      *   |- c11   : PR1.OHE Port Check Fee Amount NE PR2.OHE Port Check
      *   |- c12   : PR1.OHE Port Cut Time NE PR2.OHE Port Cut Time
      *   |- c13   : PR1.OHE Backhaul Truck Number NE PR2.OHE Backhaul Tr
      *   |- c14   : PR1.OHE Load Sched Seq Num NE PR2.OHE Load Sched Seq
      *   |- c15   : PR1.Original Appointment Date NE PR2.Original Appoin
      *   |- c16   : PR1.Original Appointment Time NE PR2.Original Appoin
      *   |- c17   : PR1.OHE PowerPro Load#-Outbnd NE PR2.OHE PowerPro Lo
      *   |- c18   : PR1.OHE PowerPro Load#-Bckhl NE PR2.OHE PowerPro Loa
      *   |- c19   : PR1.OHE Unused Numeric 9,0 3 NE PR2.OHE Unused Numer
      *   |- c20   : PR1.OHE Orig ABS Freight Rate NE PR2.OHE Orig ABS Fr
      *   |- c21   : PR1.EDI Status 1 NE PR2.EDI Status 1
      *   |- c22   : PR1.EDI Status 2 NE PR2.EDI Status 2
      *   |- c23   : PR1.EDI Status 3 NE PR2.EDI Status 3
      *   |- c24   : PR1.Record Status NE PR2.Record Status
      *   |- c25   : PR1.OHE EDI Error Reasons 2 NE PR2.OHE EDI Error Rea
      *   |- c26   : PR1.OHE EDI 856 Action NE PR2.OHE EDI 856 Action
      *   |- c27   : PR1.OHE EDI 824 Action NE PR2.OHE EDI 824 Action
      *   |- c28   : PR1.OHE Genset Number NE PR2.OHE Genset Number
      *   |- c29   : PR1.OHE Unused Status 1 NE PR2.OHE Unused Status 1
      *   |- c30   : PR1.OHE Unused Status 2 NE PR2.OHE Unused Status 2
      *   |- c31   : PR1.OHE Unused Status 3 NE PR2.OHE Unused Status 3
      *   |- c32   : PR1.OHE Unused Status 4 NE PR2.OHE Unused Status 4
      *   |- c33   : PR1.OHE Unused Text 1 NE PR2.OHE Unused Text 1
      *   |- c34   : PR1.OHE Unused Text 2 NE PR2.OHE Unused Text 2
      *   |- c35   : PR1.OHE Unused Text 3 NE PR2.OHE Unused Text 3
      *   |- c36   : PR1.OHE Unused Text 4 NE PR2.OHE Unused Text 4
      *   |- c37   : PR1.OHE Unused Text 5 NE PR2.OHE Unused Text 5
      *   |- c38   : PR1.OHE Unused Date 1 NE PR2.OHE Unused Date 1
      *   |- c39   : PR1.OHE Unused Date 2 NE PR2.OHE Unused Date 2
      *   '-
     C                   IF        P1V8T1 <> P2V8T1 OR
     C                             P1V9T1 <> P2V9T1 OR
     C                             P1WAT1 <> P2WAT1 OR
     C                             P1WBT1 <> P2WBT1 OR
     C                             P1WCT1 <> P2WCT1 OR
     C                             P1WDT1 <> P2WDT1 OR
     C                             P1QJNY <> P2QJNY OR
     C                             P1QKNY <> P2QKNY OR
     C                             P1QLNY <> P2QLNY OR
     C                             P1P8NY <> P2P8NY OR
     C                             P1P9NY <> P2P9NY OR
     C                             P1QANY <> P2QANY OR
     C                             P1QCNY <> P2QCNY OR
     C                             P1QDNY <> P2QDNY OR
     C                             P1QENY <> P2QENY OR
     C                             P1QFNY <> P2QFNY OR
     C                             P1QGNY <> P2QGNY OR
     C                             P1QHNY <> P2QHNY OR
     C                             P1QINY <> P2QINY OR
     C                             P1QMNY <> P2QMNY OR
     C                             P1UVST <> P2UVST OR
     C                             P1UWST <> P2UWST OR
     C                             P1UXST <> P2UXST OR
     C                             P1VSST <> P2VSST OR
     C                             P1JWSC <> P2JWSC OR
     C                             P1JUSC <> P2JUSC OR
     C                             P1JVSC <> P2JVSC OR
     C                             P1MYU1 <> P2MYU1 OR
     C                             P1JXSC <> P2JXSC OR
     C                             P1JYSC <> P2JYSC OR
     C                             P1JZSC <> P2JZSC OR
     C                             P1J0SC <> P2J0SC OR
     C                             P1MZU1 <> P2MZU1 OR
     C                             P1M0U1 <> P2M0U1 OR
     C                             P1M1U1 <> P2M1U1 OR
     C                             P1M2U1 <> P2M2U1 OR
     C                             P1M3U1 <> P2M3U1 OR
     C                             P1W5DT <> P2W5DT OR
     C                             P1W6DT <> P2W6DT
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Update Record?
      * CASE: LCL.Update Record USR is Yes
      * Crt BI Ord Hdr Ext TRG CR - BI Order Header Extsn TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0001 = 'Y'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P3D8SC        WL0003                         BIOHE TRG Datab
     C                   MOVEL(P)  '0'           WL0004                         BIOHE Process S
     C                   Z-ADD     0             WL0005                         BIOHE Process D
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Crt BI Ord Hdr Ext TRG CR - BI Order Header Extsn TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1AIC3        WL0001                         Company Number
     C                   Z-ADD     P1C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P3D8SC        WL0003                         BIOHE TRG Datab
     C                   MOVEL(P)  '0'           WL0004                         BIOHE Process S
     C                   Z-ADD     0             WL0005                         BIOHE Process D
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt BI Ord Hdr Ext TRG CR - BI Order Header Extsn TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         BIOHE Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @BECPEX
     C                   Z-ADD     WL0001        WAAIC3                         Company Number
     C                   Z-ADD     WL0002        WAC4NB                         Order Number
     C                   MOVEL     WL0003        WAJJSC                         BIOHE TRG Datab
     C                   MOVEL     WL0004        WAJKSC                         BIOHE Process S
     C                   Z-ADD     WL0005        WAA9DX                         BIOHE Process D
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WAAYTS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WAAYTS                         BIOHE Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @BECPEX                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5120'     W0RTN
      * Send message 'BI Order Header Extsn  EX'
     C                   MOVEL     'USR5120'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @BECPEX                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAAYTS                         BIOHE Timestamp
     C                   Z-ADD     *ZERO         WAA9DX                         BIOHE Process D
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   Z-ADD     *ZERO         WL0005
      * Define local work field Update Record USR
     C                   EVAL      YL0001 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
