     H/TITLE Bld Cutout - GENETIC  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 10/08/09  Time  : 14:52:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDIZREL1IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Retrieval index
      *
     FPDIZREL5IF  E           K        DISK
      * RTV : PS Cutout Dist Lean %     Pop Head > Zero
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDIZREL0UF  E           K        DISK
      * UPD : PS Cutout Dist Lean %     Update index
      *
     E                    #L3         3  1
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@IZRETC
      * PS Cutout Dist Lean %     Retrieval index
      * Renamed input format fields
     I              IZAIC3                          WBAIC3
     I              IZRXCD                          WBRXCD
     I              IZGHDT                          WBGHDT
     I              IZUPNB                          WBUPNB
     I              IZUQNB                          WBUQNB
     I              IZULNB                          WBULNB
     I              IZUNNB                          WBUNNB
     I              IZUONB                          WBUONB
     I              IZDIPC                          WBDIPC
     I              IZZ0NB                          WBZ0NB
     I              IZAVLE                          WBAVLE
     I              IZQPNX                          WBQPNX
     I              IZUVST                          WBUVST
     I              IZUWST                          WBUWST
     I              IZUXST                          WBUXST
     I              IZVSST                          WBVSST
     I              IZAATM                          WBAATM
     I              IZAYNA                          WBAYNA
     I              IZA0NA                          WBA0NA
     I              IZAXDT                          WBAXDT
      *
     I@IZRETB
      * PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     I@IZRENU
      * PS Cutout Dist Lean %     Pop Head > Zero
      * Renamed input format fields
     I              IZAIC3                          WDAIC3
     I              IZRXCD                          WDRXCD
     I              IZGHDT                          WDGHDT
     I              IZUPNB                          WDUPNB
     I              IZUQNB                          WDUQNB
     I              IZULNB                          WDULNB
     I              IZUNNB                          WDUNNB
     I              IZUONB                          WDUONB
     I              IZDIPC                          WDDIPC
     I              IZZ0NB                          WDZ0NB
     I              IZAVLE                          WDAVLE
     I              IZQPNX                          WDQPNX
     I              IZUVST                          WDUVST
     I              IZUWST                          WDUWST
     I              IZUXST                          WDUXST
     I              IZVSST                          WDVSST
     I              IZAATM                          WDAATM
     I              IZAYNA                          WDAYNA
     I              IZA0NA                          WDA0NA
     I              IZAXDT                          WDAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WEAIC3
     I              KMV8CD                          WEV8CD
     I              KMAUNA                          WEAUNA
     I              KMI5ST                          WEI5ST
     I              KMBXTX                          WEBXTX
     I              KMM8NB                          WEM8NB
     I              KMUVST                          WEUVST
     I              KMUWST                          WEUWST
     I              KMUXST                          WEUXST
     I              KMVSST                          WEVSST
     I              KMAATM                          WEAATM
     I              KMAYNA                          WEAYNA
     I              KMA0NA                          WEA0NA
     I              KMAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDIZ1    E DSPDIZREL0
      * UPD : PS Cutout Dist Lean %     Update index
      * Renamed input format fields
     I              IZAIC3                          WCAIC3
     I              IZRXCD                          WCRXCD
     I              IZGHDT                          WCGHDT
     I              IZUPNB                          WCUPNB
     I              IZUQNB                          WCUQNB
     I              IZULNB                          WCULNB
     I              IZUNNB                          WCUNNB
     I              IZUONB                          WCUONB
     I              IZDIPC                          WCDIPC
     I              IZZ0NB                          WCZ0NB
     I              IZAVLE                          WCAVLE
     I              IZQPNX                          WCQPNX
     I              IZUVST                          WCUVST
     I              IZUWST                          WCUWST
     I              IZUXST                          WCUXST
     I              IZVSST                          WCVSST
     I              IZAATM                          WCAATM
     I              IZAYNA                          WCAYNA
     I              IZA0NA                          WCA0NA
     I              IZAXDT                          WCAXDT
      *
     IYARDCS      DS                             70
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             70
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Kill Date
     I                                    P   1   40P1GGDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'SND Primal Yield by GEN'
      * Company Number
     I                                        1   3 ZA0001
      * Date (Char-8) USR
     I                                        4  11 ZA0002
      * Email Address
     I                                       12  61 ZA0003
      * text usr 75
     I                                       62 136 ZA0004
      * Message data for 'ADDLIBLE'
      * Library
     I                                        1  10 ZA0005
      * Message data for 'SND Primal Yield by GEN'
      * Company Number
     I                                        1   3 ZA0006
      * Date (Char-8) USR
     I                                        4  11 ZA0007
      * Email Address
     I                                       12  61 ZA0008
      * text usr 75
     I                                       62 136 ZA0009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1GGDT    PARM           WP0001  70       Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Cutout - GENETIC  XF
      * DOC
     C                     EXSR UASUBR                     DOC
      * 360 Kill Date
      * CASE: PAR.Kill Date is EQ 0
     C           P1GGDT    IFEQ *ZERO                      *IF
      * Rtv Prev Kill Date    RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     Z-ADD##JDT     WL0002           Post to G/L Dat
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Kill Date PRV U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GGDT    YL0001           Kill Date
     C                     END                             *FI
      * COMPANY: 360/C5
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0004           Company Number
     C                     MOVEL'PPSC5'   WL0005    P      Cutout Matrix C
     C                     Z-ADD0307      WL0006           Effective Month
     C                     EXSR SBRVGN
      * Upd Pop Head     2HPE PF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKY2PFR'              90  Upd Pop Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0001  30       Company Number
     C                     PARM YL0001    WQ0002  70       Kill Date
     C                     PARM 'PPSC5'   WQ0003  6        Cutout Matrix C
     C                     PARM 0307      WQ0004  40       Effective Month
     C           YL0002    PARM *ZERO     WQ0005  50       Head Killed  US
     C                     PARM 'F'       WQ0006  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0007           Company Number
     C                     MOVEL'PPSC5'   WL0008    P      Cutout Matrix C
     C                     Z-ADD0307      WL0009           Effective Month
     C                     Z-ADDYL0002    WL0010           Head Killed  US
     C                     EXSR SDRVGN
      * U1LP Upd 1st Lvl Plan PF - PS Cutout Item  * 
     C                     CALL 'PDJZPFR'              90  U1LP Upd 1st Lv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0007  30       Company Number
     C                     PARM 'PPSC5'   WQ0008  6        Cutout Matrix C
     C                     PARM 0307      WQ0009  40       Effective Month
     C                     PARM YL0001    WQ0010  70       Kill Date
     C                     PARM YL0001    WQ0011  70       Production Date
     C                     PARM YL0002    WQ0012  50       Hog Volume
     C                     PARM 'C'       WQ0013  1        Production Type
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * COMPANY: 360/G5
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0004           Company Number
     C                     MOVEL'PPSG5'   WL0005    P      Cutout Matrix C
     C                     Z-ADD0307      WL0006           Effective Month
     C                     EXSR SBRVGN
      * Upd Pop Head     2HPE PF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKY2PFR'              90  Upd Pop Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0014  30       Company Number
     C                     PARM YL0001    WQ0015  70       Kill Date
     C                     PARM 'PPSG5'   WQ0016  6        Cutout Matrix C
     C                     PARM 0307      WQ0017  40       Effective Month
     C           YL0002    PARM *ZERO     WQ0018  50       Head Killed  US
     C                     PARM 'F'       WQ0019  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0007           Company Number
     C                     MOVEL'PPSG5'   WL0008    P      Cutout Matrix C
     C                     Z-ADD0307      WL0009           Effective Month
     C                     Z-ADDYL0002    WL0010           Head Killed  US
     C                     EXSR SDRVGN
      * U1LP Upd 1st Lvl Plan PF - PS Cutout Item  * 
     C                     CALL 'PDJZPFR'              90  U1LP Upd 1st Lv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0020  30       Company Number
     C                     PARM 'PPSG5'   WQ0021  6        Cutout Matrix C
     C                     PARM 0307      WQ0022  40       Effective Month
     C                     PARM YL0001    WQ0023  70       Kill Date
     C                     PARM YL0001    WQ0024  70       Production Date
     C                     PARM YL0002    WQ0025  50       Hog Volume
     C                     PARM 'G'       WQ0026  1        Production Type
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------*
      * 360: Send XLS to Distribution List
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0011           Company Number
     C                     MOVEL'PYBYGEN' WL0012    P      Company Value C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0004    P      System Value Al
      *
     C                     Z-ADD*ZERO     WN0026  40       Year Code
     C                     Z-ADD*ZERO     WN0027  20       Month
     C                     Z-ADD*ZERO     WN0028  20       Day of Month US
     C                     MOVEL*BLANK    WN0029  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0030  2        Month (Char) US
     C                     MOVEL*BLANK    WN0031  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0032  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0033  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0034  7        Date (Alpha) US
      *
      * CVT *CYMD to MM/DD/YY IF
     C                     MOVEL*BLANK    WN0034           Date (Alpha) US
     C                     MOVELYL0001    WN0034           Date (Alpha) US
      * ** YEAR **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0034:ZQ WN0033    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** MONTH **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0034:ZQ WN0030    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** DAY **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0034:ZQ WN0031    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0030    CAT  '/':ZQ    YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  WN0031:ZQ YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  '/':ZQ    YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  WN0033:ZQ YL0005    P      Date (Char-8) U
     C                     Z-ADD1         ZQ      50
     C           @CN,01    CAT  '360':ZQ  YL0006    P      text usr 75
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      text usr 75
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           360       IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL360       WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0001           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0005    ZA0002           Date (Char-8) U
     C                     MOVELYL0004    ZA0003           Email Address
     C                     MOVELYL0006    ZA0004           text usr 75
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4192' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * *-------------------------------------------------------*
      * Setup message data for message
     C                     MOVEL'PRKFTFP' ZA0005           Library
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3110' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * 960 Kill Date
      * CASE: PAR.Kill Date is EQ 0
     C           P1GGDT    IFEQ *ZERO                      *IF
      * Rtv Prev Kill Date    RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0001           Company Number
     C                     Z-ADD##JDT     WL0002           Post to G/L Dat
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0001           Kill Date PRV U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GGDT    YL0001           Kill Date
     C                     END                             *FI
      * COMPANY: 960/G5
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0004           Company Number
     C                     MOVEL'PPSG5'   WL0005    P      Cutout Matrix C
     C                     Z-ADD0307      WL0006           Effective Month
     C                     EXSR SBRVGN
      * Upd Pop Head     2HPE PF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKY2PFR'              90  Upd Pop Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0027  30       Company Number
     C                     PARM YL0001    WQ0028  70       Kill Date
     C                     PARM 'PPSG5'   WQ0029  6        Cutout Matrix C
     C                     PARM 0307      WQ0030  40       Effective Month
     C           YL0002    PARM *ZERO     WQ0031  50       Head Killed  US
     C                     PARM 'B'       WQ0032  1        Cutout Matrix T
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0007           Company Number
     C                     MOVEL'PPSG5'   WL0008    P      Cutout Matrix C
     C                     Z-ADD0307      WL0009           Effective Month
     C                     Z-ADDYL0002    WL0010           Head Killed  US
     C                     EXSR SDRVGN
      * U1LP Upd 1st Lvl Plan PF - PS Cutout Item  * 
     C                     CALL 'PDJZPFR'              90  U1LP Upd 1st Lv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0033  30       Company Number
     C                     PARM 'PPSG5'   WQ0034  6        Cutout Matrix C
     C                     PARM 0307      WQ0035  40       Effective Month
     C                     PARM YL0001    WQ0036  70       Kill Date
     C                     PARM YL0001    WQ0037  70       Production Date
     C                     PARM YL0002    WQ0038  50       Hog Volume
     C                     PARM 'G'       WQ0039  1        Production Type
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *-------------------------------------------------------*
      * 960: Send XLS to Distribution List
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0011           Company Number
     C                     MOVEL'PYBYGEN' WL0012    P      Company Value C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0004    P      System Value Al
      *
     C                     Z-ADD*ZERO     WN0035  40       Year Code
     C                     Z-ADD*ZERO     WN0036  20       Month
     C                     Z-ADD*ZERO     WN0037  20       Day of Month US
     C                     MOVEL*BLANK    WN0038  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0039  2        Month (Char) US
     C                     MOVEL*BLANK    WN0040  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0041  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0042  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0043  7        Date (Alpha) US
      *
      * CVT *CYMD to MM/DD/YY IF
     C                     MOVEL*BLANK    WN0043           Date (Alpha) US
     C                     MOVELYL0001    WN0043           Date (Alpha) US
      * ** YEAR **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0043:ZQ WN0042    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** MONTH **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0043:ZQ WN0039    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * ** DAY **
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0043:ZQ WN0040    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0039    CAT  '/':ZQ    YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  WN0040:ZQ YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  '/':ZQ    YL0005    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0005    CAT  WN0042:ZQ YL0005    P      Date (Char-8) U
     C                     Z-ADD1         ZQ      50
     C           @CN,01    CAT  '960':ZQ  YL0006    P      text usr 75
     C                     Z-ADD1         ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      text usr 75
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           960       IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL960       WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0006           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVELYL0005    ZA0007           Date (Char-8) U
     C                     MOVELYL0004    ZA0008           Email Address
     C                     MOVELYL0006    ZA0009           text usr 75
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4192' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0021' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Prev Kill Date    RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREPU                    *
     C           KRSSA     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Kill Date PRV U
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Post to G/L Date EQ PAR.Post to G/L Date
     C           WABCDT    IFEQ WL0002                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Kill Day Status is yes
     C           WAV9ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWABCDT    WL0003           Kill Date PRV U
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Init Pop Head     RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBRXCD    WQSB02           Cutout Matrix C
     C           *LIKE     DEFN WBGHDT    WQSB03           Effective Month
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Cutout Matrix C
     C                     KFLD           WQSB03           Effective Month
      * Setup key
     C                     Z-ADDWL0004    WQSB01           Company Number
     C                     MOVELWL0005    WQSB02           Cutout Matrix C
     C                     Z-ADDWL0006    WQSB03           Effective Month
      * Establish starting position
     C           KRSSB     SETLL@IZRETC                    *
     C           KRSSB     READE@IZRETC                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Pop Head & %     CH - PS Cutout Dist Lean %  * 
     C                     EXSR SCCHRC
     C           KRSSB     READE@IZRETC                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Pop Head & %     CH - PS Cutout Dist Lean %  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Average Cold Wg
     C                     Z-ADD*ZERO     WN0002  52       Average Lean Pe
     C                     Z-ADD*ZERO     WN0003  52       Average Backfat
     C                     Z-ADD*ZERO     WN0004  52       Average Loin-Ey
     C                     MOVEL*BLANK    WN0005  1        EDI Status 1
     C                     MOVEL*BLANK    WN0006  1        EDI Status 2
     C                     MOVEL*BLANK    WN0007  1        EDI Status 3
     C                     MOVEL*BLANK    WN0008  1        Record Status
     C                     Z-ADD*ZERO     WN0009  60       Job Time
     C                     MOVEL*BLANK    WN0010 10        User Id
     C                     MOVEL*BLANK    WN0011 10        Job Name
     C                     Z-ADD*ZERO     WN0012  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @IZRETB
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     MOVELWBRXCD    WCRXCD    P      Cutout Matrix C
     C                     Z-ADDWBGHDT    WCGHDT           Effective Month
     C                     Z-ADDWBUPNB    WCUPNB           Min Carcass Wei
     C                     Z-ADDWBUQNB    WCUQNB           Max Carcass Wei
     C                     Z-ADDWBULNB    WCULNB           Lean Percent
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRXCD           Cutout Matrix C
     C                     KFLD           WCGHDT           Effective Month
     C                     KFLD           WCUPNB           Min Carcass Wei
     C                     KFLD           WCUQNB           Max Carcass Wei
     C                     KFLD           WCULNB           Lean Percent
     C           KLCHSC    CHAIN@IZRETB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIZREL0'MDACP
     C                     MOVEL'@IZRETB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIZ1    YARDCS
      * Move non-key fields to @IZRETB
     C                     Z-ADD*ZERO     WCUONB           Population Perc
     C                     Z-ADD*ZERO     WCQPNX           Population Head
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIZ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@IZRETB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDIZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Clc Population %      RT - PS Cutout Dist Lean %  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDRXCD    WQSD02           Cutout Matrix C
     C           *LIKE     DEFN WDGHDT    WQSD03           Effective Month
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Cutout Matrix C
     C                     KFLD           WQSD03           Effective Month
      * Setup key
     C                     Z-ADDWL0007    WQSD01           Company Number
     C                     MOVELWL0008    WQSD02           Cutout Matrix C
     C                     Z-ADDWL0009    WQSD03           Effective Month
      * Establish starting position
     C           KRSSD     SETLL@IZRENU                    *
     C           KRSSD     READE@IZRENU                  90*
      * Data record not found
     C   90                MOVEL'USR1720' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * LCL.Population Percent =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.Population Head
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.Head Killed  USR
      * *     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WDQPNX    DIV  WL0010    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0003           Population Perc
      * Chg Population %      CH - PS Cutout Dist Lean %  * 
     C                     EXSR SECHRC
     C           KRSSD     READE@IZRENU                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Population %      CH - PS Cutout Dist Lean %  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  30       Average Cold Wg
     C                     Z-ADD*ZERO     WN0014  52       Average Lean Pe
     C                     Z-ADD*ZERO     WN0015  52       Average Backfat
     C                     Z-ADD*ZERO     WN0016  52       Average Loin-Ey
     C                     Z-ADD*ZERO     WN0017  50       Population Head
     C                     MOVEL*BLANK    WN0018  1        EDI Status 1
     C                     MOVEL*BLANK    WN0019  1        EDI Status 2
     C                     MOVEL*BLANK    WN0020  1        EDI Status 3
     C                     MOVEL*BLANK    WN0021  1        Record Status
     C                     Z-ADD*ZERO     WN0022  60       Job Time
     C                     MOVEL*BLANK    WN0023 10        User Id
     C                     MOVEL*BLANK    WN0024 10        Job Name
     C                     Z-ADD*ZERO     WN0025  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @IZRETB
     C                     Z-ADDWDAIC3    WCAIC3           Company Number
     C                     MOVELWDRXCD    WCRXCD    P      Cutout Matrix C
     C                     Z-ADDWDGHDT    WCGHDT           Effective Month
     C                     Z-ADDWDUPNB    WCUPNB           Min Carcass Wei
     C                     Z-ADDWDUQNB    WCUQNB           Max Carcass Wei
     C                     Z-ADDWDULNB    WCULNB           Lean Percent
      *
     C           KLCHSE    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRXCD           Cutout Matrix C
     C                     KFLD           WCGHDT           Effective Month
     C                     KFLD           WCUPNB           Min Carcass Wei
     C                     KFLD           WCUQNB           Max Carcass Wei
     C                     KFLD           WCULNB           Lean Percent
     C           KLCHSE    CHAIN@IZRETB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIZREL0'MDACP
     C                     MOVEL'@IZRETB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIZ1    YBRDCS
      * Move non-key fields to @IZRETB
     C                     Z-ADDYL0003    WCUONB           Population Perc
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIZ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@IZRETB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDIZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0011    WEAIC3           Company Number
     C                     MOVELWL0012    WEV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBXTX    WL0013           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC
      *================================================================
      * 09/30/09 PKD This program is used for calculating the First
      *              Level Production for the two types of genetics:
      *              C5 and G5.
      *              For 360, when processing the Hot Scale transactions
      *              determine the Sire Line for the Tattoo. If the
      *              Sire Line is C5, then use the C5 Matrix; otherwise
      *              use G5 matrix.
      *              For 960, use the G5 Matrix for all hogs.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBGHDT           Effective Month
     C                     Z-ADD*ZERO     WBUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WBUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WBULNB           Lean Percent
     C                     Z-ADD*ZERO     WBUNNB           Average Cold Wg
     C                     Z-ADD*ZERO     WBUONB           Population Perc
     C                     Z-ADD*ZERO     WBDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WBZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WBAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WBQPNX           Population Head
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEM8NB           System Value Nu
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  6
     C                     Z-ADD*ZERO     WL0006  40
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     MOVEL*BLANK    WL0008  6
     C                     Z-ADD*ZERO     WL0009  40
     C                     Z-ADD*ZERO     WL0010  50
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     MOVEL*BLANK    WL0012 10
     C                     MOVEL*BLANK    WL0013 40
      * Define local work field Kill Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Head Killed  USR
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field Population Percent
     C                     Z-ADD*ZERO     YL0003  95
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0004 50
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0005  8
      * Define local work field text usr 75
     C                     MOVEL*BLANK    YL0006 75
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Primal Yield by Genetic
