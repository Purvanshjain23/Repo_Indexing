// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWG8XFR
// ?Date: 14.08.2025 Time: 02:56:26
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?NOTE: Any changes to this program you should consider changing
//?      PWFHXFR program as well. PWG8XFR was a cloned from PWFHXFR.
EXECUTE FUNCTION(Eml Prod Loc Dist XLS RT) TYPE(RTVOBJ) FILE(PWAMCPP)           AB1346369;
PARAMETER(PAR.Company_Number_Alpha_Usr);
{
 //?USER: Process Data record

 //?Build the Delivery Schedule Report for the Producer/Producer Loc.
 // Call program Prt3Delivery Schedule XF.
 CALL PROGRAM(Prt3Delivery Schedule XF) ('PWFGXFR');
 PARAMETER(DB1.PDW_Company_Number);
 PARAMETER(DB1.PDW_Producer_Code);
 PARAMETER(DB1.PDW_Email);
 PARAMETER(DB1.PDW_BOL_Kill_Date);
 PARAMETER(DB1.PDW_Date_To);
 PARAMETER(DB1.PDW_Producer_Loc_Code);

 //?Send Email to the Producer with .xls
 //?03/04/2019 JJH E14585 - Modify Email Subject Line
 //?Build Subject of Email.
 CASE;

 // IF PAR.Company Number Alpha Usr is SEB TF-Sioux City, IA
 IF PAR.Company_Number_Alpha_Usr = '440';

 // LCL.Email Subject-50 USR = CONCAT(CON.STF Delivery Schedule-,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'STF Delivery Schedule-' + DB1.PDW_Producer_Code (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,CON./,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + '/' (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,DB1.PDW Producer Loc Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + DB1.PDW_Producer_Loc_Code (*ZERO);

 //?Build Subject of Email.
 // IF PAR.Company Number Alpha Usr is SEB Foods-Guymon, OK
 IF PAR.Company_Number_Alpha_Usr = '360';

 // LCL.Email Subject-50 USR = CONCAT(CON.Guymon Delivery Schedule-,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'Guymon Delivery Schedule-' + DB1.PDW_Producer_Code (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,CON./,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + '/' (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,DB1.PDW Producer Loc Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + DB1.PDW_Producer_Loc_Code (*ZERO);

 //?Build Subject of Email.
 // IF PAR.Company Number Alpha Usr is Triumph Foods-StJoseph,MO
 IF PAR.Company_Number_Alpha_Usr = '960';

 // LCL.Email Subject-50 USR = CONCAT(CON.Triumph Delivery Schedule,CON.-,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'Triumph Delivery Schedule' + '-' (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + DB1.PDW_Producer_Code (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,CON./,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + '/' (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,DB1.PDW Producer Loc Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + DB1.PDW_Producer_Loc_Code (*ZERO);

 ENDIF;

 //?Retrieve the From user for Email
 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(DB1.PDW_Company_Number);
 PARAMETER('DLVSCHFROM');
 PARAMETER(LCL.Override_User_Option_USR);

 //?Build Producer Distribution Wrk file for Sequel Viewpoint
 // Call program Prt3Delivery Schedule CL.
 CALL PROGRAM(Prt3Delivery Schedule CL) ('PWFFUPC');
 PARAMETER(DB1.PDW_Email);
 PARAMETER(LCL.Email_Subject_50_USR);
 PARAMETER(LCL.Text_200);

}


