     H/TITLE Prg Tattoo Scale Files XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:46:51
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB3CPL6IF  E           K        DISK
      * RSQ : Tattoo Scale Ticket       KDte(d)/Co
      *
     FPKDUCPL2IF  E           K        DISK
      * RSQ : Tattoo Scale Ticket Msg   KDte(d)/Co
      *
     FPKDVCPL4IF  E           K        DISK
      * RSQ : Tattoo Scale Purge        Kill Date (desc)
      *
     FPKDWCPL3IF  E           K        DISK
      * RSQ : Tattoo Scale Purge Msg    Kill Date (desc)
      *
     FPKB3CPL9IF  E           K        DISK                      A
      * UPD : Tattoo Scale Ticket       Update index for Purge
      *
     FPKB3CPL0UF  E           K        DISK
      * UPD : Tattoo Scale Ticket       Update index
      *
     FPKDUCPL3IF  E           K        DISK                      A
      * UPD : Tattoo Scale Ticket Msg   Update index for Purge
      *
     FPKDUCPL0UF  E           K        DISK
      * UPD : Tattoo Scale Ticket Msg   Update index
      *
     FPKDVCPL5IF  E           K        DISK                      A
      * UPD : Tattoo Scale Purge        Update index for Purge
      *
     FPKDVCPL0UF  E           K        DISK
      * UPD : Tattoo Scale Purge        Update index
      *
     FPKDWCPL2IF  E           K        DISK                      A
      * UPD : Tattoo Scale Purge Msg    Update index for Purge
      *
     FPKDWCPL0UF  E           K        DISK
      * UPD : Tattoo Scale Purge Msg    Update index
      *
     I@B3CPFR
      * Tattoo Scale Ticket       KDte(d)/Co
      * Renamed input format fields
     I              B3HMNB                          WAHMNB
     I              B3BNNB                          WABNNB
     I              B3BONB                          WABONB
     I              B3CVNB                          WACVNB
     I              B3B0DT                          WAB0DT
     I              B3FKNB                          WAFKNB
     I              B3FMNB                          WAFMNB
     I              B3FLNB                          WAFLNB
     I              B3B6DT                          WAB6DT
     I              B3ANTM                          WAANTM
     I              B3JDA1                          WAJDA1
     I              B3CFDT                          WACFDT
     I              B3APTM                          WAAPTM
     I              B3I3ST                          WAI3ST
     I              B3HVNB                          WAHVNB
     I              B3CMCD                          WACMCD
     I              B3AAVN                          WAAAVN
     I              B3AADT                          WAAADT
     I              B3AMTM                          WAAMTM
     I              B3AJST                          WAAJST
     I              B3AHVN                          WAAHVN
     I              B3AGVN                          WAAGVN
     I              B3ABVN                          WAABVN
     I              B3ABDT                          WAABDT
     I              B3ABTM                          WAABTM
      *
     I@B3CPM9
      * Tattoo Scale Ticket       Update index for Purge
      * Renamed input format fields
     I              B3HMNB                          WBHMNB
     I              B3BNNB                          WBBNNB
     I              B3BONB                          WBBONB
     I              B3CVNB                          WBCVNB
     I              B3B0DT                          WBB0DT
     I              B3FKNB                          WBFKNB
     I              B3FMNB                          WBFMNB
     I              B3FLNB                          WBFLNB
     I              B3B6DT                          WBB6DT
     I              B3ANTM                          WBANTM
     I              B3JDA1                          WBJDA1
     I              B3CFDT                          WBCFDT
     I              B3APTM                          WBAPTM
     I              B3I3ST                          WBI3ST
     I              B3HVNB                          WBHVNB
     I              B3CMCD                          WBCMCD
     I              B3AAVN                          WBAAVN
     I              B3AADT                          WBAADT
     I              B3AMTM                          WBAMTM
     I              B3AJST                          WBAJST
     I              B3AHVN                          WBAHVN
     I              B3AGVN                          WBAGVN
     I              B3ABVN                          WBABVN
     I              B3ABDT                          WBABDT
     I              B3ABTM                          WBABTM
      *
     I@B3CPHK
      * Tattoo Scale Ticket       Update index
      * Renamed input format fields
     I              B3HMNB                          WCHMNB
     I              B3BNNB                          WCBNNB
     I              B3BONB                          WCBONB
     I              B3CVNB                          WCCVNB
     I              B3B0DT                          WCB0DT
     I              B3FKNB                          WCFKNB
     I              B3FMNB                          WCFMNB
     I              B3FLNB                          WCFLNB
     I              B3B6DT                          WCB6DT
     I              B3ANTM                          WCANTM
     I              B3JDA1                          WCJDA1
     I              B3CFDT                          WCCFDT
     I              B3APTM                          WCAPTM
     I              B3I3ST                          WCI3ST
     I              B3HVNB                          WCHVNB
     I              B3CMCD                          WCCMCD
     I              B3AAVN                          WCAAVN
     I              B3AADT                          WCAADT
     I              B3AMTM                          WCAMTM
     I              B3AJST                          WCAJST
     I              B3AHVN                          WCAHVN
     I              B3AGVN                          WCAGVN
     I              B3ABVN                          WCABVN
     I              B3ABDT                          WCABDT
     I              B3ABTM                          WCABTM
      *
     I@DUCPFS
      * Tattoo Scale Ticket Msg   KDte(d)/Co
      * Renamed input format fields
     I              DUHMNB                          WDHMNB
     I              DUBNNB                          WDBNNB
     I              DUBONB                          WDBONB
     I              DUCVNB                          WDCVNB
     I              DUB0DT                          WDB0DT
     I              DUFKNB                          WDFKNB
     I              DULYTX                          WDLYTX
     I              DUIHNB                          WDIHNB
     I              DUAAVN                          WDAAVN
     I              DUAADT                          WDAADT
     I              DUAMTM                          WDAMTM
     I              DUAJST                          WDAJST
     I              DUAHVN                          WDAHVN
     I              DUAGVN                          WDAGVN
     I              DUABVN                          WDABVN
     I              DUABDT                          WDABDT
     I              DUABTM                          WDABTM
      *
     I@DUCPNA
      * Tattoo Scale Ticket Msg   Update index for Purge
      * Renamed input format fields
     I              DUHMNB                          WEHMNB
     I              DUBNNB                          WEBNNB
     I              DUBONB                          WEBONB
     I              DUCVNB                          WECVNB
     I              DUB0DT                          WEB0DT
     I              DUFKNB                          WEFKNB
     I              DULYTX                          WELYTX
     I              DUIHNB                          WEIHNB
     I              DUAAVN                          WEAAVN
     I              DUAADT                          WEAADT
     I              DUAMTM                          WEAMTM
     I              DUAJST                          WEAJST
     I              DUAHVN                          WEAHVN
     I              DUAGVN                          WEAGVN
     I              DUABVN                          WEABVN
     I              DUABDT                          WEABDT
     I              DUABTM                          WEABTM
      *
     I@DUCPXF
      * Tattoo Scale Ticket Msg   Update index
      * Renamed input format fields
     I              DUHMNB                          WFHMNB
     I              DUBNNB                          WFBNNB
     I              DUBONB                          WFBONB
     I              DUCVNB                          WFCVNB
     I              DUB0DT                          WFB0DT
     I              DUFKNB                          WFFKNB
     I              DULYTX                          WFLYTX
     I              DUIHNB                          WFIHNB
     I              DUAAVN                          WFAAVN
     I              DUAADT                          WFAADT
     I              DUAMTM                          WFAMTM
     I              DUAJST                          WFAJST
     I              DUAHVN                          WFAHVN
     I              DUAGVN                          WFAGVN
     I              DUABVN                          WFABVN
     I              DUABDT                          WFABDT
     I              DUABTM                          WFABTM
      *
     I@DVCPML
      * Tattoo Scale Purge        Kill Date (desc)
      * Renamed input format fields
     I              DVCONO                          WGCONO
     I              DVBONO                          WGBONO
     I              DVIVNB                          WGIVNB
     I              DVIWNB                          WGIWNB
     I              DVDADT                          WGDADT
     I              DVIXNB                          WGIXNB
     I              DVDBDT                          WGDBDT
     I              DVASTM                          WGASTM
     I              DVDCDT                          WGDCDT
     I              DVATTM                          WGATTM
     I              DVIYNB                          WGIYNB
     I              DVHVNB                          WGHVNB
     I              DVCMCD                          WGCMCD
     I              DVAAVN                          WGAAVN
     I              DVAADT                          WGAADT
     I              DVAMTM                          WGAMTM
     I              DVAJST                          WGAJST
     I              DVAHVN                          WGAHVN
     I              DVAGVN                          WGAGVN
     I              DVABVN                          WGABVN
     I              DVABDT                          WGABDT
     I              DVABTM                          WGABTM
      *
     I@DVCPMS
      * Tattoo Scale Purge        Update index for Purge
      * Renamed input format fields
     I              DVCONO                          WHCONO
     I              DVBONO                          WHBONO
     I              DVIVNB                          WHIVNB
     I              DVIWNB                          WHIWNB
     I              DVDADT                          WHDADT
     I              DVIXNB                          WHIXNB
     I              DVDBDT                          WHDBDT
     I              DVASTM                          WHASTM
     I              DVDCDT                          WHDCDT
     I              DVATTM                          WHATTM
     I              DVIYNB                          WHIYNB
     I              DVHVNB                          WHHVNB
     I              DVCMCD                          WHCMCD
     I              DVAAVN                          WHAAVN
     I              DVAADT                          WHAADT
     I              DVAMTM                          WHAMTM
     I              DVAJST                          WHAJST
     I              DVAHVN                          WHAHVN
     I              DVAGVN                          WHAGVN
     I              DVABVN                          WHABVN
     I              DVABDT                          WHABDT
     I              DVABTM                          WHABTM
      *
     I@DVCPXI
      * Tattoo Scale Purge        Update index
      * Renamed input format fields
     I              DVCONO                          WICONO
     I              DVBONO                          WIBONO
     I              DVIVNB                          WIIVNB
     I              DVIWNB                          WIIWNB
     I              DVDADT                          WIDADT
     I              DVIXNB                          WIIXNB
     I              DVDBDT                          WIDBDT
     I              DVASTM                          WIASTM
     I              DVDCDT                          WIDCDT
     I              DVATTM                          WIATTM
     I              DVIYNB                          WIIYNB
     I              DVHVNB                          WIHVNB
     I              DVCMCD                          WICMCD
     I              DVAAVN                          WIAAVN
     I              DVAADT                          WIAADT
     I              DVAMTM                          WIAMTM
     I              DVAJST                          WIAJST
     I              DVAHVN                          WIAHVN
     I              DVAGVN                          WIAGVN
     I              DVABVN                          WIABVN
     I              DVABDT                          WIABDT
     I              DVABTM                          WIABTM
      *
     I@DWCPMR
      * Tattoo Scale Purge Msg    Kill Date (desc)
      * Renamed input format fields
     I              DWCONO                          WJCONO
     I              DWBONO                          WJBONO
     I              DWIVNB                          WJIVNB
     I              DWIWNB                          WJIWNB
     I              DWDADT                          WJDADT
     I              DWIXNB                          WJIXNB
     I              DWIZNB                          WJIZNB
     I              DWL0TX                          WJL0TX
     I              DWAAVN                          WJAAVN
     I              DWAADT                          WJAADT
     I              DWAMTM                          WJAMTM
     I              DWAJST                          WJAJST
     I              DWAHVN                          WJAHVN
     I              DWAGVN                          WJAGVN
     I              DWABVN                          WJABVN
     I              DWABDT                          WJABDT
     I              DWABTM                          WJABTM
      *
     I@DWCPMQ
      * Tattoo Scale Purge Msg    Update index for Purge
      * Renamed input format fields
     I              DWCONO                          WKCONO
     I              DWBONO                          WKBONO
     I              DWIVNB                          WKIVNB
     I              DWIWNB                          WKIWNB
     I              DWDADT                          WKDADT
     I              DWIXNB                          WKIXNB
     I              DWIZNB                          WKIZNB
     I              DWL0TX                          WKL0TX
     I              DWAAVN                          WKAAVN
     I              DWAADT                          WKAADT
     I              DWAMTM                          WKAMTM
     I              DWAJST                          WKAJST
     I              DWAHVN                          WKAHVN
     I              DWAGVN                          WKAGVN
     I              DWABVN                          WKABVN
     I              DWABDT                          WKABDT
     I              DWABTM                          WKABTM
      *
     I@DWCPXL
      * Tattoo Scale Purge Msg    Update index
      * Renamed input format fields
     I              DWCONO                          WLCONO
     I              DWBONO                          WLBONO
     I              DWIVNB                          WLIVNB
     I              DWIWNB                          WLIWNB
     I              DWDADT                          WLDADT
     I              DWIXNB                          WLIXNB
     I              DWIZNB                          WLIZNB
     I              DWL0TX                          WLL0TX
     I              DWAAVN                          WLAAVN
     I              DWAADT                          WLAADT
     I              DWAMTM                          WLAMTM
     I              DWAJST                          WLAJST
     I              DWAHVN                          WLAHVN
     I              DWAGVN                          WLAGVN
     I              DWABVN                          WLABVN
     I              DWABDT                          WLABDT
     I              DWABTM                          WLABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB31    E DSPKB3CPL9
      * UPD : Tattoo Scale Ticket       Update index for Purge
      * Renamed input format fields
     I              B3HMNB                          WBHMNB
     I              B3BNNB                          WBBNNB
     I              B3BONB                          WBBONB
     I              B3CVNB                          WBCVNB
     I              B3B0DT                          WBB0DT
     I              B3FKNB                          WBFKNB
     I              B3FMNB                          WBFMNB
     I              B3FLNB                          WBFLNB
     I              B3B6DT                          WBB6DT
     I              B3ANTM                          WBANTM
     I              B3JDA1                          WBJDA1
     I              B3CFDT                          WBCFDT
     I              B3APTM                          WBAPTM
     I              B3I3ST                          WBI3ST
     I              B3HVNB                          WBHVNB
     I              B3CMCD                          WBCMCD
     I              B3AAVN                          WBAAVN
     I              B3AADT                          WBAADT
     I              B3AMTM                          WBAMTM
     I              B3AJST                          WBAJST
     I              B3AHVN                          WBAHVN
     I              B3AGVN                          WBAGVN
     I              B3ABVN                          WBABVN
     I              B3ABDT                          WBABDT
     I              B3ABTM                          WBABTM
      *
     IQPKB32    E DSPKB3CPL0
      * UPD : Tattoo Scale Ticket       Update index
      * Renamed input format fields
     I              B3HMNB                          WCHMNB
     I              B3BNNB                          WCBNNB
     I              B3BONB                          WCBONB
     I              B3CVNB                          WCCVNB
     I              B3B0DT                          WCB0DT
     I              B3FKNB                          WCFKNB
     I              B3FMNB                          WCFMNB
     I              B3FLNB                          WCFLNB
     I              B3B6DT                          WCB6DT
     I              B3ANTM                          WCANTM
     I              B3JDA1                          WCJDA1
     I              B3CFDT                          WCCFDT
     I              B3APTM                          WCAPTM
     I              B3I3ST                          WCI3ST
     I              B3HVNB                          WCHVNB
     I              B3CMCD                          WCCMCD
     I              B3AAVN                          WCAAVN
     I              B3AADT                          WCAADT
     I              B3AMTM                          WCAMTM
     I              B3AJST                          WCAJST
     I              B3AHVN                          WCAHVN
     I              B3AGVN                          WCAGVN
     I              B3ABVN                          WCABVN
     I              B3ABDT                          WCABDT
     I              B3ABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKDU1    E DSPKDUCPL3
      * UPD : Tattoo Scale Ticket Msg   Update index for Purge
      * Renamed input format fields
     I              DUHMNB                          WEHMNB
     I              DUBNNB                          WEBNNB
     I              DUBONB                          WEBONB
     I              DUCVNB                          WECVNB
     I              DUB0DT                          WEB0DT
     I              DUFKNB                          WEFKNB
     I              DULYTX                          WELYTX
     I              DUIHNB                          WEIHNB
     I              DUAAVN                          WEAAVN
     I              DUAADT                          WEAADT
     I              DUAMTM                          WEAMTM
     I              DUAJST                          WEAJST
     I              DUAHVN                          WEAHVN
     I              DUAGVN                          WEAGVN
     I              DUABVN                          WEABVN
     I              DUABDT                          WEABDT
     I              DUABTM                          WEABTM
      *
     IQPKDU2    E DSPKDUCPL0
      * UPD : Tattoo Scale Ticket Msg   Update index
      * Renamed input format fields
     I              DUHMNB                          WFHMNB
     I              DUBNNB                          WFBNNB
     I              DUBONB                          WFBONB
     I              DUCVNB                          WFCVNB
     I              DUB0DT                          WFB0DT
     I              DUFKNB                          WFFKNB
     I              DULYTX                          WFLYTX
     I              DUIHNB                          WFIHNB
     I              DUAAVN                          WFAAVN
     I              DUAADT                          WFAADT
     I              DUAMTM                          WFAMTM
     I              DUAJST                          WFAJST
     I              DUAHVN                          WFAHVN
     I              DUAGVN                          WFAGVN
     I              DUABVN                          WFABVN
     I              DUABDT                          WFABDT
     I              DUABTM                          WFABTM
      *
     IQPKDV1    E DSPKDVCPL5
      * UPD : Tattoo Scale Purge        Update index for Purge
      * Renamed input format fields
     I              DVCONO                          WHCONO
     I              DVBONO                          WHBONO
     I              DVIVNB                          WHIVNB
     I              DVIWNB                          WHIWNB
     I              DVDADT                          WHDADT
     I              DVIXNB                          WHIXNB
     I              DVDBDT                          WHDBDT
     I              DVASTM                          WHASTM
     I              DVDCDT                          WHDCDT
     I              DVATTM                          WHATTM
     I              DVIYNB                          WHIYNB
     I              DVHVNB                          WHHVNB
     I              DVCMCD                          WHCMCD
     I              DVAAVN                          WHAAVN
     I              DVAADT                          WHAADT
     I              DVAMTM                          WHAMTM
     I              DVAJST                          WHAJST
     I              DVAHVN                          WHAHVN
     I              DVAGVN                          WHAGVN
     I              DVABVN                          WHABVN
     I              DVABDT                          WHABDT
     I              DVABTM                          WHABTM
      *
     IQPKDV2    E DSPKDVCPL0
      * UPD : Tattoo Scale Purge        Update index
      * Renamed input format fields
     I              DVCONO                          WICONO
     I              DVBONO                          WIBONO
     I              DVIVNB                          WIIVNB
     I              DVIWNB                          WIIWNB
     I              DVDADT                          WIDADT
     I              DVIXNB                          WIIXNB
     I              DVDBDT                          WIDBDT
     I              DVASTM                          WIASTM
     I              DVDCDT                          WIDCDT
     I              DVATTM                          WIATTM
     I              DVIYNB                          WIIYNB
     I              DVHVNB                          WIHVNB
     I              DVCMCD                          WICMCD
     I              DVAAVN                          WIAAVN
     I              DVAADT                          WIAADT
     I              DVAMTM                          WIAMTM
     I              DVAJST                          WIAJST
     I              DVAHVN                          WIAHVN
     I              DVAGVN                          WIAGVN
     I              DVABVN                          WIABVN
     I              DVABDT                          WIABDT
     I              DVABTM                          WIABTM
      *
     IQPKDW1    E DSPKDWCPL2
      * UPD : Tattoo Scale Purge Msg    Update index for Purge
      * Renamed input format fields
     I              DWCONO                          WKCONO
     I              DWBONO                          WKBONO
     I              DWIVNB                          WKIVNB
     I              DWIWNB                          WKIWNB
     I              DWDADT                          WKDADT
     I              DWIXNB                          WKIXNB
     I              DWIZNB                          WKIZNB
     I              DWL0TX                          WKL0TX
     I              DWAAVN                          WKAAVN
     I              DWAADT                          WKAADT
     I              DWAMTM                          WKAMTM
     I              DWAJST                          WKAJST
     I              DWAHVN                          WKAHVN
     I              DWAGVN                          WKAGVN
     I              DWABVN                          WKABVN
     I              DWABDT                          WKABDT
     I              DWABTM                          WKABTM
      *
     IQPKDW2    E DSPKDWCPL0
      * UPD : Tattoo Scale Purge Msg    Update index
      * Renamed input format fields
     I              DWCONO                          WLCONO
     I              DWBONO                          WLBONO
     I              DWIVNB                          WLIVNB
     I              DWIWNB                          WLIWNB
     I              DWDADT                          WLDADT
     I              DWIXNB                          WLIXNB
     I              DWIZNB                          WLIZNB
     I              DWL0TX                          WLL0TX
     I              DWAAVN                          WLAAVN
     I              DWAADT                          WLAADT
     I              DWAMTM                          WLAMTM
     I              DWAJST                          WLAJST
     I              DWAHVN                          WLAHVN
     I              DWAGVN                          WLAGVN
     I              DWABVN                          WLABVN
     I              DWABDT                          WLABDT
     I              DWABTM                          WLABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1EPDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1EPDT    PARM           WP0001  70       Purge Date USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg Tattoo Scale Files XF
      * MODIFICATIONS
      * 11/04/2020 ISE H16853 - Recompiled due to change in Buy Order Num
      * Prg Tattoo Scale Tkt  RT - Tattoo Scale Ticket  * 
     C                     EXSR SARVGN
      * Prg Tto Scl Tkt Msg   RT - Tattoo Scale Ticket Msg  * 
     C                     EXSR SDRVGN
      * Prg Tattoo Scl Purge  RT - Tattoo Scale Purge  * 
     C                     EXSR SGRVGN
      * Prg Tto Scl Prg Msg   RT - Tattoo Scale Purge Msg  * 
     C                     EXSR SJRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prg Tattoo Scale Tkt  RT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1EPDT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@B3CPFR                    *
     C                     READ @B3CPFR                  90*
      * Data record not found
     C   90                MOVEL'PRK0144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Tattoo Scl Tkt Purge - Tattoo Scale Ticket  * 
     C                     EXSR SBCRRC
      * Delete Tattoo Scale Ticke - Tattoo Scale Ticket  * 
     C                     EXSR SCDLRC
     C                     READ @B3CPFR                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * CRT Tattoo Scl Tkt Purge - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B3CPM9
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWAFKNB    WBFKNB           TST Sequence Nu
     C                     Z-ADDWAFMNB    WBFMNB           TST Head
     C                     Z-ADDWAFLNB    WBFLNB           TST Wgt
     C                     Z-ADDWAB6DT    WBB6DT           TST Wgt Date
     C                     Z-ADDWAANTM    WBANTM           TST Wgt Time
     C                     Z-ADDWAJDA1    WBJDA1           TST Wgt Hour
     C                     Z-ADDWACFDT    WBCFDT           TST Last Zero D
     C                     Z-ADDWAAPTM    WBAPTM           TST Last Zero T
     C                     MOVELWAI3ST    WBI3ST           TST Record Crea
     C                     Z-ADDWAHVNB    WBHVNB           Pen Company Num
     C                     MOVELWACMCD    WBCMCD           Pen Number
     C                     MOVELWAAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWAAADT    WBAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WBAMTM           RS Time Changed
     C                     MOVELWAAJST    WBAJST           RS Record Statu
     C                     MOVELWAAHVN    WBAHVN           RS Job
     C                     MOVELWAAGVN    WBAGVN           RS Program
     C                     MOVELWAABVN    WBABVN           RS User Added
     C                     Z-ADDWAABDT    WBABDT           RS Date Added
     C                     Z-ADDWAABTM    WBABTM           RS Time Added
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBFKNB           TST Sequence Nu
      * Check for duplicate primary key
     C           KLCRSB    SETLL@B3CPM9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0145' W0RTN   7
      * Send message 'Tattoo Scale Ticket    EX'
     C                     MOVEL'PRK0145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@B3CPM9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Delete Tattoo Scale Ticke - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B3CPHK
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWAFKNB    WCFKNB           TST Sequence Nu
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCFKNB           TST Sequence Nu
     C           KLDLSC    CHAIN@B3CPHK              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB3CPL0'MDACP
     C                     MOVEL'@B3CPHK' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B3CPHK                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Prg Tto Scl Tkt Msg   RT - Tattoo Scale Ticket Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change log and comments
     C                     EXSR UBSUBR                     ***** Change lo
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WDB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1EPDT    WDB0DT           TH Kill Date
      * Establish starting position
     C           KPSSD     SETLL@DUCPFS                    *
     C                     READ @DUCPFS                  90*
      * Data record not found
     C   90                MOVEL'PRK0703' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ttt Scl Tck Msg Purge - Tattoo Scale Ticket Msg  * 
     C                     EXSR SECRRC
      * Dlt Tattoo Scl Tck Msg DO - Tattoo Scale Ticket Msg  * 
     C                     EXSR SFDLRC
     C                     READ @DUCPFS                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Ttt Scl Tck Msg Purge - Tattoo Scale Ticket Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DUCPNA
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWDFKNB    WEFKNB           TST Sequence Nu
     C                     Z-ADDWDLYTX    WELYTX           TSTM Message Se
     C                     MOVELWDIHNB    WEIHNB           TSTM Message
     C                     MOVELWDAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST           RS Record Statu
     C                     MOVELWDAHVN    WEAHVN           RS Job
     C                     MOVELWDAGVN    WEAGVN           RS Program
     C                     MOVELWDABVN    WEABVN           RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEFKNB           TST Sequence Nu
     C                     KFLD           WELYTX           TSTM Message Se
      * Check for duplicate primary key
     C           KLCRSE    SETLL@DUCPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0704' W0RTN   7
      * Send message 'Tattoo Scale Ticket Ms EX'
     C                     MOVEL'PRK0704' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@DUCPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Scl Tck Msg DO - Tattoo Scale Ticket Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DUCPXF
     C                     Z-ADDWDHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WFBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWDFKNB    WFFKNB           TST Sequence Nu
     C                     Z-ADDWDLYTX    WFLYTX           TSTM Message Se
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFFKNB           TST Sequence Nu
     C                     KFLD           WFLYTX           TSTM Message Se
     C           KLDLSF    CHAIN@DUCPXF              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDUCPL0'MDACP
     C                     MOVEL'@DUCPXF' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DUCPXF                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Prg Tattoo Scl Purge  RT - Tattoo Scale Purge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WGDADT           TSP Kill Date
      * Setup key
     C                     Z-ADDP1EPDT    WGDADT           TSP Kill Date
      * Establish starting position
     C           KPSSG     SETLL@DVCPML                    *
     C                     READ @DVCPML                  90*
      * Data record not found
     C   90                MOVEL'PRK0705' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      *  6/06/2019 JBB 15035 - now called from Tattoo Purge PKVOXFR
      * CRT Ttt Scale Purge   PRG - Tattoo Scale Purge  * 
     C                     EXSR SHCRRC
      * Dlt Tattoo Scale Purge DO - Tattoo Scale Purge  * 
     C                     EXSR SIDLRC
     C                     READ @DVCPML                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Ttt Scale Purge   PRG - Tattoo Scale Purge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DVCPMS
     C                     Z-ADDWGCONO    WHCONO           TSP Company Num
     C                     Z-ADDWGBONO    WHBONO           TSP Buy Order N
     C                     Z-ADDWGIVNB    WHIVNB           TSP Load Number
     C                     Z-ADDWGIWNB    WHIWNB           TSP Tattoo Numb
     C                     Z-ADDWGDADT    WHDADT           TSP Kill Date
     C                     Z-ADDWGIXNB    WHIXNB           TSP Sequence Nu
     C                     Z-ADDWGDBDT    WHDBDT           TSP Wgt Date
     C                     Z-ADDWGASTM    WHASTM           TSP Wgt Time
     C                     Z-ADDWGDCDT    WHDCDT           TSP Last Zero D
     C                     Z-ADDWGATTM    WHATTM           TSP Last Zero T
     C                     Z-ADDWGIYNB    WHIYNB           TSP Head
     C                     Z-ADDWGHVNB    WHHVNB           Pen Company Num
     C                     MOVELWGCMCD    WHCMCD           Pen Number
     C                     MOVELWGAAVN    WHAAVN           RS User Changed
     C                     Z-ADDWGAADT    WHAADT           RS Date Changed
     C                     Z-ADDWGAMTM    WHAMTM           RS Time Changed
     C                     MOVELWGAJST    WHAJST           RS Record Statu
     C                     MOVELWGAHVN    WHAHVN           RS Job
     C                     MOVELWGAGVN    WHAGVN           RS Program
     C                     MOVELWGABVN    WHABVN           RS User Added
     C                     Z-ADDWGABDT    WHABDT           RS Date Added
     C                     Z-ADDWGABTM    WHABTM           RS Time Added
      *
     C           KLCRSH    KLIST
     C                     KFLD           WHCONO           TSP Company Num
     C                     KFLD           WHBONO           TSP Buy Order N
     C                     KFLD           WHIVNB           TSP Load Number
     C                     KFLD           WHIWNB           TSP Tattoo Numb
     C                     KFLD           WHDADT           TSP Kill Date
     C                     KFLD           WHIXNB           TSP Sequence Nu
      * Check for duplicate primary key
     C           KLCRSH    SETLL@DVCPMS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0706' W0RTN   7
      * Send message 'Tattoo Scale Purge     EX'
     C                     MOVEL'PRK0706' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@DVCPMS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Scale Purge DO - Tattoo Scale Purge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DVCPXI
     C                     Z-ADDWGCONO    WICONO           TSP Company Num
     C                     Z-ADDWGBONO    WIBONO           TSP Buy Order N
     C                     Z-ADDWGIVNB    WIIVNB           TSP Load Number
     C                     Z-ADDWGIWNB    WIIWNB           TSP Tattoo Numb
     C                     Z-ADDWGDADT    WIDADT           TSP Kill Date
     C                     Z-ADDWGIXNB    WIIXNB           TSP Sequence Nu
      *
     C           KLDLSI    KLIST
     C                     KFLD           WICONO           TSP Company Num
     C                     KFLD           WIBONO           TSP Buy Order N
     C                     KFLD           WIIVNB           TSP Load Number
     C                     KFLD           WIIWNB           TSP Tattoo Numb
     C                     KFLD           WIDADT           TSP Kill Date
     C                     KFLD           WIIXNB           TSP Sequence Nu
     C           KLDLSI    CHAIN@DVCPXI              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDVCPL0'MDACP
     C                     MOVEL'@DVCPXI' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DVCPXI                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Prg Tto Scl Prg Msg   RT - Tattoo Scale Purge Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WJDADT           TSP Kill Date
      * Setup key
     C                     Z-ADDP1EPDT    WJDADT           TSP Kill Date
      * Establish starting position
     C           KPSSJ     SETLL@DWCPMR                    *
     C                     READ @DWCPMR                  90*
      * Data record not found
     C   90                MOVEL'PRK0707' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Tattoo Scl Purge Prg - Tattoo Scale Purge Msg  * 
     C                     EXSR SKCRRC
      * Dlt Tattoo Scl Purge   DO - Tattoo Scale Purge Msg  * 
     C                     EXSR SLDLRC
     C                     READ @DWCPMR                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT Tattoo Scl Purge Prg - Tattoo Scale Purge Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DWCPMQ
     C                     Z-ADDWJCONO    WKCONO           TSP Company Num
     C                     Z-ADDWJBONO    WKBONO           TSP Buy Order N
     C                     Z-ADDWJIVNB    WKIVNB           TSP Load Number
     C                     Z-ADDWJIWNB    WKIWNB           TSP Tattoo Numb
     C                     Z-ADDWJDADT    WKDADT           TSP Kill Date
     C                     Z-ADDWJIXNB    WKIXNB           TSP Sequence Nu
     C                     Z-ADDWJIZNB    WKIZNB           TSPM Message Se
     C                     MOVELWJL0TX    WKL0TX           TSPM Message
     C                     MOVELWJAAVN    WKAAVN           RS User Changed
     C                     Z-ADDWJAADT    WKAADT           RS Date Changed
     C                     Z-ADDWJAMTM    WKAMTM           RS Time Changed
     C                     MOVELWJAJST    WKAJST           RS Record Statu
     C                     MOVELWJAHVN    WKAHVN           RS Job
     C                     MOVELWJAGVN    WKAGVN           RS Program
     C                     MOVELWJABVN    WKABVN           RS User Added
     C                     Z-ADDWJABDT    WKABDT           RS Date Added
     C                     Z-ADDWJABTM    WKABTM           RS Time Added
      *
     C           KLCRSK    KLIST
     C                     KFLD           WKCONO           TSP Company Num
     C                     KFLD           WKBONO           TSP Buy Order N
     C                     KFLD           WKIVNB           TSP Load Number
     C                     KFLD           WKIWNB           TSP Tattoo Numb
     C                     KFLD           WKDADT           TSP Kill Date
     C                     KFLD           WKIXNB           TSP Sequence Nu
     C                     KFLD           WKIZNB           TSPM Message Se
      * Check for duplicate primary key
     C           KLCRSK    SETLL@DWCPMQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0708' W0RTN   7
      * Send message 'Tattoo Scale Purge Msg EX'
     C                     MOVEL'PRK0708' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@DWCPMQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Scl Purge   DO - Tattoo Scale Purge Msg  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DWCPXL
     C                     Z-ADDWJCONO    WLCONO           TSP Company Num
     C                     Z-ADDWJBONO    WLBONO           TSP Buy Order N
     C                     Z-ADDWJIVNB    WLIVNB           TSP Load Number
     C                     Z-ADDWJIWNB    WLIWNB           TSP Tattoo Numb
     C                     Z-ADDWJDADT    WLDADT           TSP Kill Date
     C                     Z-ADDWJIXNB    WLIXNB           TSP Sequence Nu
     C                     Z-ADDWJIZNB    WLIZNB           TSPM Message Se
      *
     C           KLDLSL    KLIST
     C                     KFLD           WLCONO           TSP Company Num
     C                     KFLD           WLBONO           TSP Buy Order N
     C                     KFLD           WLIVNB           TSP Load Number
     C                     KFLD           WLIWNB           TSP Tattoo Numb
     C                     KFLD           WLDADT           TSP Kill Date
     C                     KFLD           WLIXNB           TSP Sequence Nu
     C                     KFLD           WLIZNB           TSPM Message Se
     C           KLDLSL    CHAIN@DWCPXL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDWCPL0'MDACP
     C                     MOVEL'@DWCPXL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DWCPXL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 08/16/2007 LJB FP1009
      * ** Changed RSQ lgl to put Kill Date first, removed company number
      * ** from input parms, Add CRT to write the records to QTEMP file
      * ** before deleting from production
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 08/16/2007 LJB FP1009
      * ** Changed RSQ lgl to put Kill Date first, removed company number
      * ** from input parms, Add CRT to write the records to QTEMP file
      * ** before deleting from production
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 06/06/2019 JBB 15035
      * ** Reinstated in Tattoo Purge.  Used to be in HPEMSC
      * ** 03/13/2009 LJB FP1009
      * ** Commented out - this file is not being used enough to purge
      * ** 08/15/2007 LJB FP1009
      * ** Pass the purge date into this function
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 06/06/2019 JBB 15035 - Add this purge as part of Tattoo purge.
      * ** Commented out in Tattoo Scale Purge, added to Tattoo purge.
      * ** 02/02/2009 LJB FP1009
      * ** Put back into production, add crt to save 1 year of records
      * ** 08/15/2007 LJB FP1009
      * ** Delete from production
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAFKNB           TST Sequence Nu
     C                     Z-ADD*ZERO     WAFMNB           TST Head
     C                     Z-ADD*ZERO     WAFLNB           TST Wgt
     C                     Z-ADD*ZERO     WAB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WAANTM           TST Wgt Time
     C                     Z-ADD*ZERO     WAJDA1           TST Wgt Hour
     C                     Z-ADD*ZERO     WACFDT           TST Last Zero D
     C                     Z-ADD*ZERO     WAAPTM           TST Last Zero T
     C                     Z-ADD*ZERO     WAHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDFKNB           TST Sequence Nu
     C                     Z-ADD*ZERO     WDLYTX           TSTM Message Se
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGCONO           TSP Company Num
     C                     Z-ADD*ZERO     WGBONO           TSP Buy Order N
     C                     Z-ADD*ZERO     WGIVNB           TSP Load Number
     C                     Z-ADD*ZERO     WGIWNB           TSP Tattoo Numb
     C                     Z-ADD*ZERO     WGDADT           TSP Kill Date
     C                     Z-ADD*ZERO     WGIXNB           TSP Sequence Nu
     C                     Z-ADD*ZERO     WGDBDT           TSP Wgt Date
     C                     Z-ADD*ZERO     WGASTM           TSP Wgt Time
     C                     Z-ADD*ZERO     WGDCDT           TSP Last Zero D
     C                     Z-ADD*ZERO     WGATTM           TSP Last Zero T
     C                     Z-ADD*ZERO     WGIYNB           TSP Head
     C                     Z-ADD*ZERO     WGHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJCONO           TSP Company Num
     C                     Z-ADD*ZERO     WJBONO           TSP Buy Order N
     C                     Z-ADD*ZERO     WJIVNB           TSP Load Number
     C                     Z-ADD*ZERO     WJIWNB           TSP Tattoo Numb
     C                     Z-ADD*ZERO     WJDADT           TSP Kill Date
     C                     Z-ADD*ZERO     WJIXNB           TSP Sequence Nu
     C                     Z-ADD*ZERO     WJIZNB           TSPM Message Se
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
