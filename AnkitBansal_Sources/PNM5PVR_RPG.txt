     H/TITLE Pmt Crt BUY RIN Trans PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/28/13  Time  : 15:07:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPNM5PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Crt BUY RIN Trans PV  Prompt & validate record
      *
     FPMCCCPL1IF  E           K        DISK
      * RTV : COA Batch Header          Retrieval index
      *
     FPMCBREL1IF  E           K        DISK
      * RTV : COA Property Define Dtl   Retrieval index
      *
     FPMCDCPL1IF  E           K        DISK
      * RTV : COA Batch Detail          Retrieval index
      *
     FPMDACPLEIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/ULSD CMP/BATCH/S/Sc(D
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPNGGREL1IF  E           K        DISK
      * RTV : RFS Transaction Reason    Retrieval index
      *
     FPNGCREL1IF  E           K        DISK
      * RTV : RFS Fuel Code - D Code    Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMCCCPL0IF  E           K        DISK                      A
      * UPD : COA Batch Header          Update index
      *
     FPMCDCPL0IF  E           K        DISK                      A
      * UPD : COA Batch Detail          Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FPMDACPL0IF  E           K        DISK                      A
      * UPD : COA Batch Header RIN      Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 031  5 0A
     E                    W0END   7 031  5 0A
     E                    W0NAM   7 031 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@CCCPOH
      * COA Batch Header          Retrieval index
      * Renamed input format fields
     I              CCAIC3                          WAAIC3
     I              CCL6T1                          WAL6T1
     I              CCI3NY                          WAI3NY
     I              CCIKAA                          WAIKAA
     I              CCIDAA                          WAIDAA
     I              CCRFDT                          WARFDT
     I              CCC2TM                          WAC2TM
     I              CCMHT1                          WAMHT1
     I              CCRGDT                          WARGDT
     I              CCC3TM                          WAC3TM
     I              CCMKT1                          WAMKT1
     I              CCJHNY                          WAJHNY
     I              CCR1NA                          WAR1NA
     I              CCRHDT                          WARHDT
     I              CCC4TM                          WAC4TM
     I              CCMIT1                          WAMIT1
     I              CCMJT1                          WAMJT1
     I              CCHXTX                          WAHXTX
     I              CCHJTX                          WAHJTX
     I              CCHYTX                          WAHYTX
     I              CCJENY                          WAJENY
     I              CCJVNY                          WAJVNY
     I              CCJWNY                          WAJWNY
     I              CCIMTX                          WAIMTX
     I              CCFEDS                          WAFEDS
     I              CCMTT1                          WAMTT1
     I              CCJXNY                          WAJXNY
     I              CCJ1NY                          WAJ1NY
     I              CCJCNY                          WAJCNY
     I              CCJDNY                          WAJDNY
     I              CCJ3NY                          WAJ3NY
     I              CCRLDT                          WARLDT
     I              CCMSAA                          WAMSAA
     I              CCMTAA                          WAMTAA
     I              CCMUAA                          WAMUAA
     I              CCL8T1                          WAL8T1
     I              CCR0NY                          WAR0NY
     I              CCL7T1                          WAL7T1
     I              CCJQST                          WAJQST
     I              CCWUT1                          WAWUT1
     I              CCWVT1                          WAWVT1
     I              CCJZST                          WAJZST
     I              CCJ0ST                          WAJ0ST
     I              CCTTDT                          WATTDT
     I              CCDRTM                          WADRTM
     I              CCWYT1                          WAWYT1
     I              CCJUST                          WAJUST
     I              CCR4NY                          WAR4NY
     I              CCMZAA                          WAMZAA
     I              CCTUDT                          WATUDT
     I              CCDSTM                          WADSTM
     I              CCWZT1                          WAWZT1
     I              CCM0AA                          WAM0AA
     I              CCSANY                          WASANY
     I              CCKJST                          WAKJST
     I              CCKKST                          WAKKST
     I              CCGZPC                          WAGZPC
     I              CCW2T1                          WAW2T1
     I              CCM1AA                          WAM1AA
     I              CCSBNY                          WASBNY
     I              CCKLST                          WAKLST
     I              CCKPST                          WAKPST
     I              CCG0PC                          WAG0PC
     I              CCW3T1                          WAW3T1
     I              CCM2AA                          WAM2AA
     I              CCSCNY                          WASCNY
     I              CCKQST                          WAKQST
     I              CCKRST                          WAKRST
     I              CCG1PC                          WAG1PC
     I              CCW4T1                          WAW4T1
     I              CCVSST                          WAVSST
     I              CCMJDT                          WAMJDT
     I              CCBETM                          WABETM
     I              CCCCVN                          WACCVN
     I              CCCDVN                          WACDVN
     I              CCMKDT                          WAMKDT
     I              CCBFTM                          WABFTM
     I              CCCEVN                          WACEVN
     I              CCCFVN                          WACFVN
      *
     I@CCCPOG
      * COA Batch Header          Update index
      * Renamed input format fields
     I              CCAIC3                          WBAIC3
     I              CCL6T1                          WBL6T1
     I              CCI3NY                          WBI3NY
     I              CCIKAA                          WBIKAA
     I              CCIDAA                          WBIDAA
     I              CCRFDT                          WBRFDT
     I              CCC2TM                          WBC2TM
     I              CCMHT1                          WBMHT1
     I              CCRGDT                          WBRGDT
     I              CCC3TM                          WBC3TM
     I              CCMKT1                          WBMKT1
     I              CCJHNY                          WBJHNY
     I              CCR1NA                          WBR1NA
     I              CCRHDT                          WBRHDT
     I              CCC4TM                          WBC4TM
     I              CCMIT1                          WBMIT1
     I              CCMJT1                          WBMJT1
     I              CCHXTX                          WBHXTX
     I              CCHJTX                          WBHJTX
     I              CCHYTX                          WBHYTX
     I              CCJENY                          WBJENY
     I              CCJVNY                          WBJVNY
     I              CCJWNY                          WBJWNY
     I              CCIMTX                          WBIMTX
     I              CCFEDS                          WBFEDS
     I              CCMTT1                          WBMTT1
     I              CCJXNY                          WBJXNY
     I              CCJ1NY                          WBJ1NY
     I              CCJCNY                          WBJCNY
     I              CCJDNY                          WBJDNY
     I              CCJ3NY                          WBJ3NY
     I              CCRLDT                          WBRLDT
     I              CCMSAA                          WBMSAA
     I              CCMTAA                          WBMTAA
     I              CCMUAA                          WBMUAA
     I              CCL8T1                          WBL8T1
     I              CCR0NY                          WBR0NY
     I              CCL7T1                          WBL7T1
     I              CCJQST                          WBJQST
     I              CCWUT1                          WBWUT1
     I              CCWVT1                          WBWVT1
     I              CCJZST                          WBJZST
     I              CCJ0ST                          WBJ0ST
     I              CCTTDT                          WBTTDT
     I              CCDRTM                          WBDRTM
     I              CCWYT1                          WBWYT1
     I              CCJUST                          WBJUST
     I              CCR4NY                          WBR4NY
     I              CCMZAA                          WBMZAA
     I              CCTUDT                          WBTUDT
     I              CCDSTM                          WBDSTM
     I              CCWZT1                          WBWZT1
     I              CCM0AA                          WBM0AA
     I              CCSANY                          WBSANY
     I              CCKJST                          WBKJST
     I              CCKKST                          WBKKST
     I              CCGZPC                          WBGZPC
     I              CCW2T1                          WBW2T1
     I              CCM1AA                          WBM1AA
     I              CCSBNY                          WBSBNY
     I              CCKLST                          WBKLST
     I              CCKPST                          WBKPST
     I              CCG0PC                          WBG0PC
     I              CCW3T1                          WBW3T1
     I              CCM2AA                          WBM2AA
     I              CCSCNY                          WBSCNY
     I              CCKQST                          WBKQST
     I              CCKRST                          WBKRST
     I              CCG1PC                          WBG1PC
     I              CCW4T1                          WBW4T1
     I              CCVSST                          WBVSST
     I              CCMJDT                          WBMJDT
     I              CCBETM                          WBBETM
     I              CCCCVN                          WBCCVN
     I              CCCDVN                          WBCDVN
     I              CCMKDT                          WBMKDT
     I              CCBFTM                          WBBFTM
     I              CCCEVN                          WBCEVN
     I              CCCFVN                          WBCFVN
      *
     I@CBREOE
      * COA Property Define Dtl   Retrieval index
      * Renamed input format fields
     I              CBAIC3                          WCAIC3
     I              CBIDAA                          WCIDAA
     I              CBMDT1                          WCMDT1
     I              CBMET1                          WCMET1
     I              CBMFT1                          WCMFT1
     I              CBMGT1                          WCMGT1
     I              CBI2NY                          WCI2NY
     I              CBIBAA                          WCIBAA
     I              CBI1NY                          WCI1NY
     I              CBHCTU                          WCHCTU
     I              CBMCT1                          WCMCT1
     I              CBVSST                          WCVSST
     I              CBMJDT                          WCMJDT
     I              CBBETM                          WCBETM
     I              CBCCVN                          WCCCVN
     I              CBCDVN                          WCCDVN
     I              CBMKDT                          WCMKDT
     I              CBBFTM                          WCBFTM
     I              CBCEVN                          WCCEVN
     I              CBCFVN                          WCCFVN
      *
     I@CDCPOK
      * COA Batch Detail          Retrieval index
      * Renamed input format fields
     I              CDAIC3                          WDAIC3
     I              CDL6T1                          WDL6T1
     I              CDI3NY                          WDI3NY
     I              CDMDT1                          WDMDT1
     I              CDMET1                          WDMET1
     I              CDMFT1                          WDMFT1
     I              CDMGT1                          WDMGT1
     I              CDI2NY                          WDI2NY
     I              CDH5VL                          WDH5VL
     I              CDIBAA                          WDIBAA
     I              CDI1NY                          WDI1NY
     I              CDHCTU                          WDHCTU
     I              CDMCT1                          WDMCT1
     I              CDVSST                          WDVSST
     I              CDMJDT                          WDMJDT
     I              CDBETM                          WDBETM
     I              CDCCVN                          WDCCVN
     I              CDCDVN                          WDCDVN
     I              CDMKDT                          WDMKDT
     I              CDBFTM                          WDBFTM
     I              CDCEVN                          WDCEVN
     I              CDCFVN                          WDCFVN
      *
     I@CDCPOJ
      * COA Batch Detail          Update index
      * Renamed input format fields
     I              CDAIC3                          WEAIC3
     I              CDL6T1                          WEL6T1
     I              CDI3NY                          WEI3NY
     I              CDMDT1                          WEMDT1
     I              CDMET1                          WEMET1
     I              CDMFT1                          WEMFT1
     I              CDMGT1                          WEMGT1
     I              CDI2NY                          WEI2NY
     I              CDH5VL                          WEH5VL
     I              CDIBAA                          WEIBAA
     I              CDI1NY                          WEI1NY
     I              CDHCTU                          WEHCTU
     I              CDMCT1                          WEMCT1
     I              CDVSST                          WEVSST
     I              CDMJDT                          WEMJDT
     I              CDBETM                          WEBETM
     I              CDCCVN                          WECCVN
     I              CDCDVN                          WECDVN
     I              CDMKDT                          WEMKDT
     I              CDBFTM                          WEBFTM
     I              CDCEVN                          WECEVN
     I              CDCFVN                          WECFVN
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WFAIC3
     I              ASAXNB                          WFAXNB
     I              ASNGNB                          WFNGNB
     I              ASBZNB                          WFBZNB
     I              ASC5NB                          WFC5NB
     I              ASC3NB                          WFC3NB
     I              ASCYNB                          WFCYNB
     I              ASIONB                          WFIONB
     I              ASI6NB                          WFI6NB
     I              ASDCNB                          WFDCNB
     I              ASC7NB                          WFC7NB
     I              ASC2NB                          WFC2NB
     I              ASC1NB                          WFC1NB
     I              ASL8NB                          WFL8NB
     I              ASBANB                          WFBANB
     I              ASCHST                          WFCHST
     I              ASCKST                          WFCKST
     I              ASCIST                          WFCIST
     I              ASCGST                          WFCGST
     I              ASAIPC                          WFAIPC
     I              ASASPC                          WFASPC
     I              ASA2VA                          WFA2VA
     I              ASC2ST                          WFC2ST
     I              ASD8ST                          WFD8ST
     I              ASD7ST                          WFD7ST
     I              ASA8NA                          WFA8NA
     I              ASA9NA                          WFA9NA
     I              ASBANA                          WFBANA
     I              ASBBNA                          WFBBNA
     I              ASEUST                          WFEUST
     I              ASAADY                          WFAADY
     I              ASABDY                          WFABDY
     I              ASACDY                          WFACDY
     I              ASADDY                          WFADDY
     I              ASAEDY                          WFAEDY
     I              ASAFDY                          WFAFDY
     I              ASAGDY                          WFAGDY
     I              ASAHDY                          WFAHDY
     I              ASAENB                          WFAENB
     I              ASALNB                          WFALNB
     I              ASEVNB                          WFEVNB
     I              ASRPOP                          WFRPOP
     I              ASDWNB                          WFDWNB
     I              ASR3NB                          WFR3NB
     I              ASPNST                          WFPNST
     I              ASR4NB                          WFR4NB
     I              ASPOST                          WFPOST
     I              ASSCNB                          WFSCNB
     I              ASVIST                          WFVIST
     I              ASVJST                          WFVJST
     I              ASBVVN                          WFBVVN
     I              ASUVST                          WFUVST
     I              ASUWST                          WFUWST
     I              ASUXST                          WFUXST
     I              ASVSST                          WFVSST
     I              ASAATM                          WFAATM
     I              ASAYNA                          WFAYNA
     I              ASA0NA                          WFA0NA
     I              ASAXDT                          WFAXDT
      *
     I@DACPP5
      * COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WGAIC3
     I              DAL6T1                          WGL6T1
     I              DAI3NY                          WGI3NY
     I              DAJYNY                          WGJYNY
     I              DAQ1NY                          WGQ1NY
     I              DAMUT1                          WGMUT1
     I              DAJZNY                          WGJZNY
     I              DAJ0NY                          WGJ0NY
     I              DAJ2NY                          WGJ2NY
     I              DARIDT                          WGRIDT
     I              DAC5TM                          WGC5TM
     I              DAMVT1                          WGMVT1
     I              DAMWT1                          WGMWT1
     I              DARINT                          WGRINT
     I              DARJDT                          WGRJDT
     I              DAC6TM                          WGC6TM
     I              DAC4NB                          WGC4NB
     I              DADPNB                          WGDPNB
     I              DAUENB                          WGUENB
     I              DARZNB                          WGRZNB
     I              DANGT1                          WGNGT1
     I              DARMNB                          WGRMNB
     I              DARKDT                          WGRKDT
     I              DAC7TM                          WGC7TM
     I              DARINS                          WGRINS
     I              DAMXT1                          WGMXT1
     I              DAG3ST                          WGG3ST
     I              DAQWNY                          WGQWNY
     I              DAL0AA                          WGL0AA
     I              DAMAT1                          WGMAT1
     I              DATDNA                          WGTDNA
     I              DACWC3                          WGCWC3
     I              DAQXNY                          WGQXNY
     I              DAQZNY                          WGQZNY
     I              DAQ0NY                          WGQ0NY
     I              DALVTX                          WGLVTX
     I              DANYT1                          WGNYT1
     I              DAG5ST                          WGG5ST
     I              DAG7ST                          WGG7ST
     I              DATFDT                          WGTFDT
     I              DATGDT                          WGTGDT
     I              DAWIT1                          WGWIT1
     I              DAQYNY                          WGQYNY
     I              DAL7T1                          WGL7T1
     I              DAR8NY                          WGR8NY
     I              DAR0NY                          WGR0NY
     I              DAI7AA                          WGI7AA
     I              DAMXAA                          WGMXAA
     I              DAMSAA                          WGMSAA
     I              DAR7NY                          WGR7NY
     I              DAHEPR                          WGHEPR
     I              DAHFPR                          WGHFPR
     I              DAWVT1                          WGWVT1
     I              DAW0T1                          WGW0T1
     I              DAR5NY                          WGR5NY
     I              DAW1T1                          WGW1T1
     I              DAR6NY                          WGR6NY
     I              DAJ1ST                          WGJ1ST
     I              DAKHST                          WGKHST
     I              DATWDT                          WGTWDT
     I              DADUTM                          WGDUTM
     I              DAKGST                          WGKGST
     I              DATVDT                          WGTVDT
     I              DADTTM                          WGDTTM
     I              DAR9NY                          WGR9NY
     I              DASQNY                          WGSQNY
     I              DABHR3                          WGBHR3
     I              DASRNY                          WGSRNY
     I              DAW7T1                          WGW7T1
     I              DAW8T1                          WGW8T1
     I              DAT2DT                          WGT2DT
     I              DASXNY                          WGSXNY
     I              DASYNY                          WGSYNY
     I              DASZNY                          WGSZNY
     I              DAVSST                          WGVSST
     I              DAMJDT                          WGMJDT
     I              DABETM                          WGBETM
     I              DACCVN                          WGCCVN
     I              DACDVN                          WGCDVN
     I              DAMKDT                          WGMKDT
     I              DABFTM                          WGBFTM
     I              DACEVN                          WGCEVN
     I              DACFVN                          WGCFVN
      *
     I@DACPED
      * COA Batch Header RIN      Co/ULSD CMP/BATCH/S/Sc(D
      * Renamed input format fields
     I              DAAIC3                          WHAIC3
     I              DAL6T1                          WHL6T1
     I              DAI3NY                          WHI3NY
     I              DAJYNY                          WHJYNY
     I              DAQ1NY                          WHQ1NY
     I              DAMUT1                          WHMUT1
     I              DAJZNY                          WHJZNY
     I              DAJ0NY                          WHJ0NY
     I              DAJ2NY                          WHJ2NY
     I              DARIDT                          WHRIDT
     I              DAC5TM                          WHC5TM
     I              DAMVT1                          WHMVT1
     I              DAMWT1                          WHMWT1
     I              DARINT                          WHRINT
     I              DARJDT                          WHRJDT
     I              DAC6TM                          WHC6TM
     I              DAC4NB                          WHC4NB
     I              DADPNB                          WHDPNB
     I              DAUENB                          WHUENB
     I              DARZNB                          WHRZNB
     I              DANGT1                          WHNGT1
     I              DARMNB                          WHRMNB
     I              DARKDT                          WHRKDT
     I              DAC7TM                          WHC7TM
     I              DARINS                          WHRINS
     I              DAMXT1                          WHMXT1
     I              DAG3ST                          WHG3ST
     I              DAQWNY                          WHQWNY
     I              DAL0AA                          WHL0AA
     I              DAMAT1                          WHMAT1
     I              DATDNA                          WHTDNA
     I              DACWC3                          WHCWC3
     I              DAQXNY                          WHQXNY
     I              DAQZNY                          WHQZNY
     I              DAQ0NY                          WHQ0NY
     I              DALVTX                          WHLVTX
     I              DANYT1                          WHNYT1
     I              DAG5ST                          WHG5ST
     I              DAG7ST                          WHG7ST
     I              DATFDT                          WHTFDT
     I              DATGDT                          WHTGDT
     I              DAWIT1                          WHWIT1
     I              DAQYNY                          WHQYNY
     I              DAL7T1                          WHL7T1
     I              DAR8NY                          WHR8NY
     I              DAR0NY                          WHR0NY
     I              DAI7AA                          WHI7AA
     I              DAMXAA                          WHMXAA
     I              DAMSAA                          WHMSAA
     I              DAR7NY                          WHR7NY
     I              DAHEPR                          WHHEPR
     I              DAHFPR                          WHHFPR
     I              DAWVT1                          WHWVT1
     I              DAW0T1                          WHW0T1
     I              DAR5NY                          WHR5NY
     I              DAW1T1                          WHW1T1
     I              DAR6NY                          WHR6NY
     I              DAJ1ST                          WHJ1ST
     I              DAKHST                          WHKHST
     I              DATWDT                          WHTWDT
     I              DADUTM                          WHDUTM
     I              DAKGST                          WHKGST
     I              DATVDT                          WHTVDT
     I              DADTTM                          WHDTTM
     I              DAR9NY                          WHR9NY
     I              DASQNY                          WHSQNY
     I              DABHR3                          WHBHR3
     I              DASRNY                          WHSRNY
     I              DAW7T1                          WHW7T1
     I              DAW8T1                          WHW8T1
     I              DAT2DT                          WHT2DT
     I              DASXNY                          WHSXNY
     I              DASYNY                          WHSYNY
     I              DASZNY                          WHSZNY
     I              DAVSST                          WHVSST
     I              DAMJDT                          WHMJDT
     I              DABETM                          WHBETM
     I              DACCVN                          WHCCVN
     I              DACDVN                          WHCDVN
     I              DAMKDT                          WHMKDT
     I              DABFTM                          WHBFTM
     I              DACEVN                          WHCEVN
     I              DACFVN                          WHCFVN
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@GGREG2
      * RFS Transaction Reason    Retrieval index
      * Renamed input format fields
     I              GGI7AA                          WJI7AA
     I              GGMXAA                          WJMXAA
     I              GGWTT1                          WJWTT1
     I              GGJPST                          WJJPST
     I              GGVSST                          WJVSST
     I              GGMJDT                          WJMJDT
     I              GGBETM                          WJBETM
     I              GGCCVN                          WJCCVN
     I              GGCDVN                          WJCDVN
     I              GGMKDT                          WJMKDT
     I              GGBFTM                          WJBFTM
     I              GGCEVN                          WJCEVN
     I              GGCFVN                          WJCFVN
      *
     I@GCREGQ
      * RFS Fuel Code - D Code    Retrieval index
      * Renamed input format fields
     I              GCMSAA                          WKMSAA
     I              GCWOT1                          WKWOT1
     I              GCJGST                          WKJGST
     I              GCVSST                          WKVSST
     I              GCMJDT                          WKMJDT
     I              GCBETM                          WKBETM
     I              GCCCVN                          WKCCVN
     I              GCCDVN                          WKCDVN
     I              GCMKDT                          WKMKDT
     I              GCBFTM                          WKBFTM
     I              GCCEVN                          WKCEVN
     I              GCCFVN                          WKCFVN
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WLAJVN
     I              DRAUNA                          WLAUNA
     I              DRB8NA                          WLB8NA
     I              DRAHVN                          WLAHVN
     I              DRI6ST                          WLI6ST
     I              DRI7ST                          WLI7ST
     I              DRXMST                          WLXMST
     I              DRXNST                          WLXNST
     I              DRI8ST                          WLI8ST
     I              DRNLNB                          WLNLNB
     I              DRMPNA                          WLMPNA
     I              DRBCCD                          WLBCCD
     I              DRAIC3                          WLAIC3
     I              DRDQCD                          WLDQCD
     I              DRDRCD                          WLDRCD
     I              DRAJCD                          WLAJCD
     I              DRBUVN                          WLBUVN
     I              DRUVST                          WLUVST
     I              DRUWST                          WLUWST
     I              DRUXST                          WLUXST
     I              DRAATM                          WLAATM
     I              DRAYNA                          WLAYNA
     I              DRA0NA                          WLA0NA
     I              DRAXDT                          WLAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WMAJVN
     I              DTDNCD                          WMDNCD
     I              DTAIC3                          WMAIC3
     I              DTDQCD                          WMDQCD
     I              DTDRCD                          WMDRCD
     I              DTAJCD                          WMAJCD
     I              DTJFST                          WMJFST
     I              DTUVST                          WMUVST
     I              DTUWST                          WMUWST
     I              DTUXST                          WMUXST
     I              DTAATM                          WMAATM
     I              DTAYNA                          WMAYNA
     I              DTA0NA                          WMA0NA
     I              DTAXDT                          WMAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WODNCD
     I              DNAUNA                          WOAUNA
     I              DNVKST                          WOVKST
     I              DNRSCD                          WORSCD
     I              DNUVST                          WOUVST
     I              DNUWST                          WOUWST
     I              DNUXST                          WOUXST
     I              DNAATM                          WOAATM
     I              DNAYNA                          WOAYNA
     I              DNA0NA                          WOA0NA
     I              DNAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPMCC1    E DSPMCCCPL0
      * UPD : COA Batch Header          Update index
      * Renamed input format fields
     I              CCAIC3                          WBAIC3
     I              CCL6T1                          WBL6T1
     I              CCI3NY                          WBI3NY
     I              CCIKAA                          WBIKAA
     I              CCIDAA                          WBIDAA
     I              CCRFDT                          WBRFDT
     I              CCC2TM                          WBC2TM
     I              CCMHT1                          WBMHT1
     I              CCRGDT                          WBRGDT
     I              CCC3TM                          WBC3TM
     I              CCMKT1                          WBMKT1
     I              CCJHNY                          WBJHNY
     I              CCR1NA                          WBR1NA
     I              CCRHDT                          WBRHDT
     I              CCC4TM                          WBC4TM
     I              CCMIT1                          WBMIT1
     I              CCMJT1                          WBMJT1
     I              CCHXTX                          WBHXTX
     I              CCHJTX                          WBHJTX
     I              CCHYTX                          WBHYTX
     I              CCJENY                          WBJENY
     I              CCJVNY                          WBJVNY
     I              CCJWNY                          WBJWNY
     I              CCIMTX                          WBIMTX
     I              CCFEDS                          WBFEDS
     I              CCMTT1                          WBMTT1
     I              CCJXNY                          WBJXNY
     I              CCJ1NY                          WBJ1NY
     I              CCJCNY                          WBJCNY
     I              CCJDNY                          WBJDNY
     I              CCJ3NY                          WBJ3NY
     I              CCRLDT                          WBRLDT
     I              CCMSAA                          WBMSAA
     I              CCMTAA                          WBMTAA
     I              CCMUAA                          WBMUAA
     I              CCL8T1                          WBL8T1
     I              CCR0NY                          WBR0NY
     I              CCL7T1                          WBL7T1
     I              CCJQST                          WBJQST
     I              CCWUT1                          WBWUT1
     I              CCWVT1                          WBWVT1
     I              CCJZST                          WBJZST
     I              CCJ0ST                          WBJ0ST
     I              CCTTDT                          WBTTDT
     I              CCDRTM                          WBDRTM
     I              CCWYT1                          WBWYT1
     I              CCJUST                          WBJUST
     I              CCR4NY                          WBR4NY
     I              CCMZAA                          WBMZAA
     I              CCTUDT                          WBTUDT
     I              CCDSTM                          WBDSTM
     I              CCWZT1                          WBWZT1
     I              CCM0AA                          WBM0AA
     I              CCSANY                          WBSANY
     I              CCKJST                          WBKJST
     I              CCKKST                          WBKKST
     I              CCGZPC                          WBGZPC
     I              CCW2T1                          WBW2T1
     I              CCM1AA                          WBM1AA
     I              CCSBNY                          WBSBNY
     I              CCKLST                          WBKLST
     I              CCKPST                          WBKPST
     I              CCG0PC                          WBG0PC
     I              CCW3T1                          WBW3T1
     I              CCM2AA                          WBM2AA
     I              CCSCNY                          WBSCNY
     I              CCKQST                          WBKQST
     I              CCKRST                          WBKRST
     I              CCG1PC                          WBG1PC
     I              CCW4T1                          WBW4T1
     I              CCVSST                          WBVSST
     I              CCMJDT                          WBMJDT
     I              CCBETM                          WBBETM
     I              CCCCVN                          WBCCVN
     I              CCCDVN                          WBCDVN
     I              CCMKDT                          WBMKDT
     I              CCBFTM                          WBBFTM
     I              CCCEVN                          WBCEVN
     I              CCCFVN                          WBCFVN
      *
     IQPMCD1    E DSPMCDCPL0
      * UPD : COA Batch Detail          Update index
      * Renamed input format fields
     I              CDAIC3                          WEAIC3
     I              CDL6T1                          WEL6T1
     I              CDI3NY                          WEI3NY
     I              CDMDT1                          WEMDT1
     I              CDMET1                          WEMET1
     I              CDMFT1                          WEMFT1
     I              CDMGT1                          WEMGT1
     I              CDI2NY                          WEI2NY
     I              CDH5VL                          WEH5VL
     I              CDIBAA                          WEIBAA
     I              CDI1NY                          WEI1NY
     I              CDHCTU                          WEHCTU
     I              CDMCT1                          WEMCT1
     I              CDVSST                          WEVSST
     I              CDMJDT                          WEMJDT
     I              CDBETM                          WEBETM
     I              CDCCVN                          WECCVN
     I              CDCDVN                          WECDVN
     I              CDMKDT                          WEMKDT
     I              CDBFTM                          WEBFTM
     I              CDCEVN                          WECEVN
     I              CDCFVN                          WECFVN
      *
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WFAIC3
     I              ASAXNB                          WFAXNB
     I              ASNGNB                          WFNGNB
     I              ASBZNB                          WFBZNB
     I              ASC5NB                          WFC5NB
     I              ASC3NB                          WFC3NB
     I              ASCYNB                          WFCYNB
     I              ASIONB                          WFIONB
     I              ASI6NB                          WFI6NB
     I              ASDCNB                          WFDCNB
     I              ASC7NB                          WFC7NB
     I              ASC2NB                          WFC2NB
     I              ASC1NB                          WFC1NB
     I              ASL8NB                          WFL8NB
     I              ASBANB                          WFBANB
     I              ASCHST                          WFCHST
     I              ASCKST                          WFCKST
     I              ASCIST                          WFCIST
     I              ASCGST                          WFCGST
     I              ASAIPC                          WFAIPC
     I              ASASPC                          WFASPC
     I              ASA2VA                          WFA2VA
     I              ASC2ST                          WFC2ST
     I              ASD8ST                          WFD8ST
     I              ASD7ST                          WFD7ST
     I              ASA8NA                          WFA8NA
     I              ASA9NA                          WFA9NA
     I              ASBANA                          WFBANA
     I              ASBBNA                          WFBBNA
     I              ASEUST                          WFEUST
     I              ASAADY                          WFAADY
     I              ASABDY                          WFABDY
     I              ASACDY                          WFACDY
     I              ASADDY                          WFADDY
     I              ASAEDY                          WFAEDY
     I              ASAFDY                          WFAFDY
     I              ASAGDY                          WFAGDY
     I              ASAHDY                          WFAHDY
     I              ASAENB                          WFAENB
     I              ASALNB                          WFALNB
     I              ASEVNB                          WFEVNB
     I              ASRPOP                          WFRPOP
     I              ASDWNB                          WFDWNB
     I              ASR3NB                          WFR3NB
     I              ASPNST                          WFPNST
     I              ASR4NB                          WFR4NB
     I              ASPOST                          WFPOST
     I              ASSCNB                          WFSCNB
     I              ASVIST                          WFVIST
     I              ASVJST                          WFVJST
     I              ASBVVN                          WFBVVN
     I              ASUVST                          WFUVST
     I              ASUWST                          WFUWST
     I              ASUXST                          WFUXST
     I              ASVSST                          WFVSST
     I              ASAATM                          WFAATM
     I              ASAYNA                          WFAYNA
     I              ASA0NA                          WFA0NA
     I              ASAXDT                          WFAXDT
      *
     IYARDCS      DS                            278
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMDA1    E DSPMDACPL0
      * UPD : COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WGAIC3
     I              DAL6T1                          WGL6T1
     I              DAI3NY                          WGI3NY
     I              DAJYNY                          WGJYNY
     I              DAQ1NY                          WGQ1NY
     I              DAMUT1                          WGMUT1
     I              DAJZNY                          WGJZNY
     I              DAJ0NY                          WGJ0NY
     I              DAJ2NY                          WGJ2NY
     I              DARIDT                          WGRIDT
     I              DAC5TM                          WGC5TM
     I              DAMVT1                          WGMVT1
     I              DAMWT1                          WGMWT1
     I              DARINT                          WGRINT
     I              DARJDT                          WGRJDT
     I              DAC6TM                          WGC6TM
     I              DAC4NB                          WGC4NB
     I              DADPNB                          WGDPNB
     I              DAUENB                          WGUENB
     I              DARZNB                          WGRZNB
     I              DANGT1                          WGNGT1
     I              DARMNB                          WGRMNB
     I              DARKDT                          WGRKDT
     I              DAC7TM                          WGC7TM
     I              DARINS                          WGRINS
     I              DAMXT1                          WGMXT1
     I              DAG3ST                          WGG3ST
     I              DAQWNY                          WGQWNY
     I              DAL0AA                          WGL0AA
     I              DAMAT1                          WGMAT1
     I              DATDNA                          WGTDNA
     I              DACWC3                          WGCWC3
     I              DAQXNY                          WGQXNY
     I              DAQZNY                          WGQZNY
     I              DAQ0NY                          WGQ0NY
     I              DALVTX                          WGLVTX
     I              DANYT1                          WGNYT1
     I              DAG5ST                          WGG5ST
     I              DAG7ST                          WGG7ST
     I              DATFDT                          WGTFDT
     I              DATGDT                          WGTGDT
     I              DAWIT1                          WGWIT1
     I              DAQYNY                          WGQYNY
     I              DAL7T1                          WGL7T1
     I              DAR8NY                          WGR8NY
     I              DAR0NY                          WGR0NY
     I              DAI7AA                          WGI7AA
     I              DAMXAA                          WGMXAA
     I              DAMSAA                          WGMSAA
     I              DAR7NY                          WGR7NY
     I              DAHEPR                          WGHEPR
     I              DAHFPR                          WGHFPR
     I              DAWVT1                          WGWVT1
     I              DAW0T1                          WGW0T1
     I              DAR5NY                          WGR5NY
     I              DAW1T1                          WGW1T1
     I              DAR6NY                          WGR6NY
     I              DAJ1ST                          WGJ1ST
     I              DAKHST                          WGKHST
     I              DATWDT                          WGTWDT
     I              DADUTM                          WGDUTM
     I              DAKGST                          WGKGST
     I              DATVDT                          WGTVDT
     I              DADTTM                          WGDTTM
     I              DAR9NY                          WGR9NY
     I              DASQNY                          WGSQNY
     I              DABHR3                          WGBHR3
     I              DASRNY                          WGSRNY
     I              DAW7T1                          WGW7T1
     I              DAW8T1                          WGW8T1
     I              DAT2DT                          WGT2DT
     I              DASXNY                          WGSXNY
     I              DASYNY                          WGSYNY
     I              DASZNY                          WGSZNY
     I              DAVSST                          WGVSST
     I              DAMJDT                          WGMJDT
     I              DABETM                          WGBETM
     I              DACCVN                          WGCCVN
     I              DACDVN                          WGCDVN
     I              DAMKDT                          WGMKDT
     I              DABFTM                          WGBFTM
     I              DACEVN                          WGCEVN
     I              DACFVN                          WGCFVN
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Application Code
     I                                        4   9 P1DNCD
      * N :  Salesperson Code
     I                                       10  12 P1BCCD
      * N :  Allow Multi-Company
     I                                       13  13 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       14  14 P1I8ST
      * N :  Default Printer
     I                                       15  24 P1MPNA
      * N :  Access Denied (Y/N)
     I                                       25  25 P1WVST
     IP2PARM      DS
      * FLD: COA Batch Header RIN
      * I :  Company Number
     I                                    P   1   20P2AIC3
      * O :  COA ULSD Company #
     I                                        3   6 P2L6T1
      * O :  COA Batch Number
     I                                    P   7   90P2I3NY
      * O :  COA Batch Header RIN Seq
     I                                    P  10  120P2JYNY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Fuel Code'
      * COA Bio-diesel Fuel Code
     I                                        1   6 ZA0001
      * Message data for 'RIN or Gallon Prc req'
      * COA BHR RIN Price
     I                                    P   1   42ZA0002
      * COA BHR Gallon Price
     I                                    P   5   82ZA0003
      * Message data for 'Batch doesnt exist-enter'
      * COA ULSD Company #
     I                                        1   4 ZA0004
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0005
      * Application Code
     I                                       11  16 ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P2L6T1    PARM P2L6T1    WP0002  4        COA ULSD Compan
     C           P2I3NY    PARM P2I3NY    WP0003  50       COA Batch Numbe
     C           P2JYNY    PARM P2JYNY    WP0004  50       COA Batch Heade
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.COA Ship To Warehouse
     C           W0CFL     IFEQ '#1L0AA'                   *IF
      * SEL AcctCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1L0AA    PARM #1L0AA    WQ0001  3        Warehouse Code
     C                     PARM #1AIC3    WQ0002  30       Accounting Comp
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * RTV Check for Batch #  RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     MOVEL#1L6T1    WL0002    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0003           COA Batch Numbe
     C                     EXSR SARVGN
      * CASE: PGM.*Return code is COA Batch Header       NF
     C           W0RTN     IFEQ @CN,001                    *IF
      * Crt Batch from Outside CR - COA Batch Header  * 
     C                     EXSR SBCRRC
     C                     END                             *FI
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
     C                     EXSR SGCRRC
     C                     MOVEL#1L6T1    P2L6T1           COA ULSD Compan
     C                     Z-ADD#1I3NY    P2I3NY           COA Batch Numbe
     C                     Z-ADD#1JYNY    P2JYNY           COA Batch Heade
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate RFS Transaction Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1I7AA'  IFEQ YPMTFD
      * RFS Transaction Type
     C                     MOVEL#1I7AA    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHI7AA
     C                     SELEC
     C           W0INVL    WHEQ 'BUY'                      BUY
     C                     Z-ADD1         ZHI7AA
     C           W0INVL    WHEQ 'TRB'                      TRB
     C                     Z-ADD2         ZHI7AA
     C                     ENDSL
     C                     EXFMTZGI7AA
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHI7AA    WHEQ 1
     C                     MOVEL'BUY'     W0INVL           BUY
     C           ZHI7AA    WHEQ 2
     C                     MOVEL'TRB'     W0INVL           TRB
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1I7AA
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate COA RIN Type Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1MAT1'  IFEQ YPMTFD
      * COA RIN Type Flag
     C                     MOVEL#1MAT1    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHMAT1
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHMAT1
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHMAT1
     C                     ENDSL
     C                     EXFMTZGMAT1
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHMAT1    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHMAT1    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1MAT1
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate COA RIN SoldFull/Splt Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1G3ST'  IFEQ YPMTFD
      * COA RIN SoldFull/Splt Sts
     C                     MOVEL#1G3ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHG3ST
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZHG3ST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHG3ST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHG3ST
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD4         ZHG3ST
     C           W0INVL    WHEQ '*'                        *
     C                     Z-ADD5         ZHG3ST
     C                     ENDSL
     C                     EXFMTZGG3ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHG3ST    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZHG3ST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C           ZHG3ST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHG3ST    WHEQ 4
     C                     MOVEL'U'       W0INVL           U
     C           ZHG3ST    WHEQ 5
     C                     MOVEL'*'       W0INVL           *
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1G3ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate COA RIN Transaction Date
      * External date
     C                     Z-ADDV1RIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     Z-ADDXDINDT    #1RIDT
      * Validate COA RIN Transaction Time
     C                     Z-ADD#1C5TM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * CASE: DTL.*CMD key is CF04
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.COA RIN Trans Partner Id
     C           W0CFL     IFEQ '#1MWT1'                   *IF
      * Sel HPB Trans Partner SL - Company Customer EXT  * 
     C                     CALL 'PNM1SRR'              90  Sel HPB Trans P
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0003  30       Company Number
     C           YL0013    PARM YL0013    WQ0004  70       Ship To Custome
     C           #1MWT1    PARM #1MWT1    WQ0005  4        HPB ULSD Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNM1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : DTL.COA Bio-diesel Fuel Code is B100
      *   |- c2    : DTL.COA Bio-diesel Fuel Code is B99.9
      *   '-
     C           #DIDAA    IFEQ 'B100'                     *IF
     C           #DIDAA    OREQ 'B99.9'                    *OR
      * DTL.Condition Desc. 4  USR = Condition name of DTL.COA Bio-diesel
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 0000000   Y2LSNO  70       List number
     C                     PARM #DIDAA    W0INVL 25        COA Bio-diesel
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DIDAA    ZA0001           COA Bio-diesel
      * Send message 'Invalid Fuel Code'
     C                     MOVEL'USR4234' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      * Val warehouse per Rin Type
      * CASE: DTL.COA RIN Type Flag is Assigned
     C           #1MAT1    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1L0AA           COA Ship To War
     C                     END                             *FI
      * DTL.Condition Desc. 1  USR = Condition name of DTL.COA RIN Type F
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1852628   Y2LSNO  70       List number
     C                     PARM #1MAT1    W0INVL 25        COA RIN Type Fl
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.COA BHR Gallon Price is not entered
      *   |- c2    : DTL.COA BHR RIN Price is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HFPR    IFEQ *ZERO                      *IF
     C           #1HEPR    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HEPR    ZA0002           COA BHR RIN Pri
     C                     Z-ADD#1HFPR    ZA0003           COA BHR Gallon
      * Send message 'RIN or Gallon Prc req'
     C                     MOVEL'USR4328' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993839*
      *
     C                     END                             *FI
      * RTV Check for Batch #  RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     MOVEL#1L6T1    WL0002    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0003           COA Batch Numbe
     C                     EXSR SARVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     MOVEL#1L6T1    ZA0004           COA ULSD Compan
      * Send message 'Batch doesnt exist-enter'
     C                     MOVEL'USR4232' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     Z-ADD#1R0NY    #1J2NY           COA RIN Volume
      * Rtv Last Sec f/Btch/SecRT - COA Batch Header RIN  * 
     C                     EXSR SHRVGN
     C                     ADD  1         #1Q1NY           COA Batch Hdr R
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to COA Batch Header
     C                     EXSR VBCKRL
      * Check reference to Load Header
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to RFS Transaction Reason
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993133*
     C                     END
      * Check reference to RFS Fuel Code - D Code
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9934  *
     C                     END
      * RFS Transaction Type required
     C           #1I7AA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Type Flag required
     C           #1MAT1    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * RFS Trans Reason Code required
     C           #1MXAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * RFS Fuel Code required
     C           #1MSAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA BHR RIN Gen Year required
     C           #1R7NY    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA Batch Header RIN Seq required
     C           #1JYNY    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA Bio-diesel Fuel Code required
     C           #DIDAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9940  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Equivalence Valu# required
     C           #DJ3NY    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9942  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN SoldFull/Splt Sts required
     C           #1G3ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9944  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Transaction Date required
     C           #1RIDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9945  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Transaction Time required
     C           #1C5TM    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9946  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Trans Partner Id required
     C           #1MWT1    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9947  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Trans Partner Nm required
     C           #1MVT1    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9948  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Supporting Text 1 required
     C           #1W0T1    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9950  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN Supporting Nbr 1 required
     C           #1R5NY    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9951  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA EMTS Batch Nbr required
     C           #1SQNY    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9952  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * COA RIN EMTS Sts required
     C           #1KGST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9954  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVEL*BLANK    #1WVT1           COA Transaction
     C                     MOVEL*BLANK    #1W1T1           COA RIN Support
     C                     Z-ADD*ZERO     #1R6NY           COA RIN Support
     C                     MOVEL*BLANK    #1J1ST           COA BHR RFS Ver
     C                     MOVEL*BLANK    #1KHST           COA GEN EMTS St
     C                     Z-ADD*ZERO     #1TWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     #1DUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     #1TVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     #1DTTM           COA RIN EMTS Ti
     C                     MOVEL*BLANK    #1BHR3           COA BHR Unused
     C                     Z-ADD*ZERO     #1SRNY           COA BHR Unused
     C                     MOVEL*BLANK    #1W7T1           COA EMTS Trans
     C                     MOVEL*BLANK    #1W8T1           COA EMTS Return
     C                     Z-ADD*ZERO     #1T2DT           COA BHR Unused
     C                     Z-ADD*ZERO     #1SXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     #1SYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     #1SZNY           COA Unassgnd Tx
     C                     MOVEL*BLANK    #1MUT1           COA Batch Heade
     C                     Z-ADD*ZERO     #1JZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     #1J0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     #1J2NY           COA RIN Volume
     C                     MOVEL*BLANK    #1RINT           COA Retired RIN
     C                     Z-ADD*ZERO     #1RJDT           COA Retired RIN
     C                     Z-ADD*ZERO     #1C6TM           COA Retired RIN
     C                     Z-ADD*ZERO     #1C4NB           Order Number
     C                     Z-ADD*ZERO     #1DPNB           Order Sequence
     C                     Z-ADD*ZERO     #1UENB           Order Secondary
     C                     Z-ADD*ZERO     #1RZNB           Case Sequence N
     C                     MOVEL*BLANK    #1NGT1           COA Rail Car
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1RKDT           COA Date of 1st
     C                     Z-ADD*ZERO     #1C7TM           COA RIN Unused
     C                     MOVEL*BLANK    #1RINS           COA RIN Modifie
     C                     MOVEL*BLANK    #1MXT1           COA RIN Unused
     C                     Z-ADD*ZERO     #1QWNY           COA RIN Gallons
     C                     MOVEL*BLANK    #1L0AA           COA Ship To War
     C                     Z-ADD*ZERO     #1CWC3           COA Shipping Co
     C                     Z-ADD*ZERO     #1QXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     #1QZNY           COA Reference B
     C                     Z-ADD*ZERO     #1Q0NY           COA Reference B
     C                     MOVEL*BLANK    #1LVTX           RFS Compliance
     C                     MOVEL*BLANK    #1NYT1           RFS Report Year
     C                     MOVEL*BLANK    #1G5ST           COA RIN Int/Ext
     C                     MOVEL*BLANK    #1G7ST           COA BHR Unused
     C                     Z-ADD*ZERO     #1TFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     #1TGDT           COA BHR Unused
     C                     MOVEL*BLANK    #1WIT1           COA BHR Unused
     C                     Z-ADD*ZERO     #1QYNY           COA BHR Loadout
     C                     MOVEL*BLANK    #1L7T1           COA ULSD Facili
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1MJDT           Create Date
     C                     Z-ADD*ZERO     #1BETM           Create Time
     C                     MOVEL*BLANK    #1CCVN           Create User
     C                     MOVEL*BLANK    #1CDVN           Create Program
     C                     Z-ADD*ZERO     #1MKDT           Change Date
     C                     Z-ADD*ZERO     #1BFTM           Change Time
     C                     MOVEL*BLANK    #1CEVN           Change User
     C                     MOVEL*BLANK    #1CFVN           Change Program
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #1L6T1           COA ULSD Compan
     C                     MOVEL*BLANK    #1I7AA           RFS Transaction
     C                     MOVEL*BLANK    #1MAT1           COA RIN Type Fl
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL*BLANK    #1MXAA           RFS Trans Reaso
     C                     MOVEL*BLANK    #DWTT1           RFS Trans Reaso
     C                     MOVEL*BLANK    #1MSAA           RFS Fuel Code
     C                     MOVEL*BLANK    #DWOT1           RFS Fuel Code D
     C                     Z-ADD*ZERO     #1R7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     #1I3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     #1JYNY           COA Batch Heade
     C                     Z-ADD*ZERO     #1Q1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     #1HEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     #1HFPR           COA BHR Gallon
     C                     MOVEL*BLANK    #DIDAA           COA Bio-diesel
     C                     MOVEL*BLANK    #DHOTX           Condition Desc.
     C                     Z-ADD*ZERO     #1R8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     #DJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     #1R0NY           COA RIN Quantit
     C                     MOVEL*BLANK    #1G3ST           COA RIN SoldFul
     C                     Z-ADD*ZERO     #1RIDT           COA RIN Transac
      * Clear external version also
     C                     Z-ADD*ZERO     V1RIDT
     C                     Z-ADD*ZERO     #1C5TM           COA RIN Transac
     C                     MOVEL*BLANK    #1MWT1           COA RIN Trans P
     C                     MOVEL*BLANK    #1MVT1           COA RIN Trans P
     C                     MOVEL*BLANK    #1TDNA           COA RIN Custome
     C                     MOVEL*BLANK    #1W0T1           COA RIN Support
     C                     Z-ADD*ZERO     #1R5NY           COA RIN Support
     C                     Z-ADD*ZERO     #1SQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     #1R9NY           COA EMTS PTD Nb
     C                     MOVEL*BLANK    #1KGST           COA RIN EMTS St
      * USER: Load screen
     C                     Z-ADDP2AIC3    #1AIC3           Company Number
     C                     MOVEL'BUY'     #1I7AA           RFS Transaction
     C                     MOVEL*BLANK    #DIDAA           COA Bio-diesel
     C                     MOVEL'B100'    #DIDAA           COA Bio-diesel
     C                     MOVEL'2'       #1MAT1           COA RIN Type Fl
      * DTL.Condition Desc. 1  USR = Condition name of DTL.COA RIN Type F
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1852628   Y2LSNO  70       List number
     C                     PARM #1MAT1    W0INVL 25        COA RIN Type Fl
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     Z-ADD##JDT     #1RIDT           COA RIN Transac
     C                     Z-ADD##JTM     #1C5TM           COA RIN Transac
     C                     MOVEL'0'       #1KGST           COA RIN EMTS St
     C                     MOVEL'F'       #1G3ST           COA RIN SoldFul
     C                     MOVEL'2'       #1J1ST           COA BHR RFS Ver
      * RTV Fuel Code Dft,dsc RT - RFS Fuel Code - D Code  * 
     C                     EXSR SIRVGN
      * Rtv Trans Rsn Dft,Dsc RT - RFS Transaction Reason  * 
     C                     EXSR SJRVGN
     C                     MOVEL'4846'    #1L6T1           COA ULSD Compan
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert COA RIN Transaction Date to display format
      * Convert date
     C           1000000   ADD  #1RIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1RIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Check for Batch #  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAL6T1           COA ULSD Compan
     C                     KFLD           WAI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     MOVELWL0002    WAL6T1           COA ULSD Compan
     C                     Z-ADDWL0003    WAI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSA     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Batch from Outside CR - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CCCPOG
     C                     Z-ADD#1AIC3    WBAIC3           Company Number
     C                     MOVEL#1L6T1    WBL6T1           COA ULSD Compan
     C                     Z-ADD#1I3NY    WBI3NY           COA Batch Numbe
     C                     MOVEL#1L0AA    WBIKAA           COA Active Whse
     C                     MOVEL#DIDAA    WBIDAA           COA Bio-diesel
     C                     Z-ADD##JDT     WBRFDT           COA Date Open f
     C                     Z-ADD##JTM     WBC2TM           COA Time Open f
     C                     MOVEL*BLANK    WBMHT1           COA Open for Sh
     C                     Z-ADD*ZERO     WBRGDT           COA Date Close
     C                     Z-ADD*ZERO     WBC3TM           COA Time Close
     C                     MOVEL*BLANK    WBMKT1           COA Close from
     C                     Z-ADD*ZERO     WBJHNY           COA Gallons Use
     C                     MOVEL@CN,002   WBR1NA           COA Comment
     C                     Z-ADD*ZERO     WBRHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WBC4TM           COA Batch Unuse
     C                     MOVEL*BLANK    WBMIT1           COA Batch Unuse
     C                     MOVEL*BLANK    WBMJT1           COA Batch Unuse
     C                     MOVEL'O'       WBHXTX           COA Batch Heade
     C                     MOVEL'Y'       WBHJTX           COA Batch Prope
     C                     MOVEL'N'       WBHYTX           COA Batch Int/E
     C                     Z-ADD*ZERO     WBJENY           COA Temperature
     C                     Z-ADD*ZERO     WBJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WBJWNY           COA Batch Denat
     C                     MOVEL'BDS'     WBIMTX           COA RFS Renew F
     C                     MOVEL'004'     WBFEDS           COA RFS Rnwbl F
     C                     MOVEL#1MUT1    WBMTT1           COA Batch RIN
     C                     Z-ADD*ZERO     WBJXNY           COA Batch Expor
     C                     Z-ADD#1J0NY    WBJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WBJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WBJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WBJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WBRLDT           COA Batch Unuse
     C                     MOVEL#1MSAA    WBMSAA           RFS Fuel Code
     C                     MOVEL*BLANK    WBMTAA           RFS Process Cod
     C                     MOVEL*BLANK    WBMUAA           RFS Fuel Catego
     C                     MOVELYL0001    WBL8T1           COA RIN Equival
     C                     Z-ADD#1R0NY    WBR0NY           COA RIN Quantit
     C                     MOVEL#1L7T1    WBL7T1           COA ULSD Facili
     C                     MOVELYL0002    WBJQST           COA Co-Product
     C                     MOVEL*BLANK    WBWUT1           COA Co-Product
     C                     MOVEL#1WVT1    WBWVT1           COA Transaction
     C                     MOVELYL0003    WBJZST           COA BH RFS Vers
     C                     MOVELYL0004    WBJ0ST           COA BH EMTS Sts
     C                     Z-ADD*ZERO     WBTTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WBDRTM           COA BH EMTS Tim
     C                     MOVEL*BLANK    WBWYT1           COA BH Unused I
     C                     MOVELYL0005    WBJUST           COA BH Equiv Va
     C                     Z-ADD*ZERO     WBR4NY           COA BH Unused N
     C                     MOVEL*BLANK    WBMZAA           COA BH Unused C
     C                     Z-ADD*ZERO     WBTUDT           COA BH Unused D
     C                     Z-ADD*ZERO     WBDSTM           COA BH Unused T
     C                     MOVEL*BLANK    WBWZT1           COA BH Unused C
     C                     MOVELYL0006    WBM0AA           RFS Feedstock C
     C                     Z-ADD*ZERO     WBSANY           COA BH Feedstck
     C                     MOVELYL0007    WBKJST           COA BH Feedstck
     C                     MOVELYL0008    WBKKST           COA BH Feedstck
     C                     Z-ADD*ZERO     WBGZPC           COA BH Feedstck
     C                     MOVEL*BLANK    WBW2T1           COA BH Feedstck
     C                     MOVEL*BLANK    WBM1AA           RFS Feedstock C
     C                     Z-ADD*ZERO     WBSBNY           COA BH Feedstck
     C                     MOVELYL0009    WBKLST           COA BH Feedstck
     C                     MOVELYL0010    WBKPST           COA BH Feedstck
     C                     Z-ADD*ZERO     WBG0PC           COA BH Feedstck
     C                     MOVEL*BLANK    WBW3T1           COA BH Feedstck
     C                     MOVEL*BLANK    WBM2AA           RFS Feedstock C
     C                     Z-ADD*ZERO     WBSCNY           COA BH Feedstck
     C                     MOVELYL0011    WBKQST           COA BH Feedstck
     C                     MOVELYL0012    WBKRST           COA BH Feedstck
     C                     Z-ADD*ZERO     WBG1PC           cOA BH Feedstck
     C                     MOVEL*BLANK    WBW4T1           COA BH Feedstck
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD#1MJDT    WBMJDT           Create Date
     C                     Z-ADD#1BETM    WBBETM           Create Time
     C                     MOVEL#1CCVN    WBCCVN           Create User
     C                     MOVEL#1CDVN    WBCDVN           Create Program
     C                     Z-ADD#1MKDT    WBMKDT           Change Date
     C                     Z-ADD#1BFTM    WBBFTM           Change Time
     C                     MOVEL#1CEVN    WBCEVN           Change User
     C                     MOVEL#1CFVN    WBCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WBVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WBMJDT           Create Date
     C                     Z-ADD##JTM     WBBETM           Create Time
     C                     MOVEL##USR     WBCCVN           Create User
     C                     MOVEL##PGM     WBCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
     C                     MOVEL*BLANK    WBCEVN           Change User
     C                     MOVEL*BLANK    WBCFVN           Change Program
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBL6T1           COA ULSD Compan
     C                     KFLD           WBI3NY           COA Batch Numbe
      * Check for duplicate primary key
     C           KLCRSB    SETLL@CCCPOG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3804' W0RTN   7
      * Send message 'COA Batch Header       EX'
     C                     MOVEL'USR3804' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@CCCPOG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * RTV Build Batch Detail RT - COA Property Define Dtl  * 
     C                     EXSR SCRVGN
      * CHG Increment Batch #  CH - Company Control  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Build Batch Detail RT - COA Property Define Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCIDAA    WQSC02           COA Bio-diesel
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           COA Bio-diesel
      * Setup key
     C                     Z-ADDWBAIC3    WQSC01           Company Number
     C                     MOVELWBIDAA    WQSC02           COA Bio-diesel
      * Establish starting position
     C           KRSSC     SETLL@CBREOE                    *
     C           KRSSC     READE@CBREOE                  90*
      * Data record not found
     C   90                MOVEL'USR3801' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WCVSST    IFEQ 'A'                        *IF
      * RTV for Create Record  RT - COA Batch Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSC     READE@CBREOE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for Create Record  RT - COA Batch Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDL6T1           COA ULSD Compan
     C                     KFLD           WDI3NY           COA Batch Numbe
     C                     KFLD           WDMDT1           COA Property
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     MOVELWBL6T1    WDL6T1           COA ULSD Compan
     C                     Z-ADDWBI3NY    WDI3NY           COA Batch Numbe
     C                     MOVELWCMDT1    WDMDT1           COA Property
      * Establish starting position
     C           KRSSD     CHAIN@CDCPOK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3805' W0RTN   7
      * USER: Processing if Data record not found
      * Crt COA Batch Detail  CR - COA Batch Detail  * 
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt COA Batch Detail  CR - COA Batch Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPOJ
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     MOVELWBL6T1    WEL6T1           COA ULSD Compan
     C                     Z-ADDWBI3NY    WEI3NY           COA Batch Numbe
     C                     MOVELWCMDT1    WEMDT1           COA Property
     C                     MOVELWCMET1    WEMET1           COA Test Method
     C                     MOVELWCMFT1    WEMFT1           COA Unit of Mea
     C                     MOVELWCMGT1    WEMGT1           COA Limit
     C                     Z-ADDWCI2NY    WEI2NY           COA Print Seque
     C                     Z-ADD*ZERO     WEH5VL           COA Property Va
     C                     MOVELWCIBAA    WEIBAA           COA OMS Item Co
     C                     Z-ADDWCI1NY    WEI1NY           Sold To Custome
     C                     MOVELWCHCTU    WEHCTU           COA Footnote In
     C                     MOVELWCMCT1    WEMCT1           COA Fuel Cd Des
     C                     MOVELWCVSST    WEVSST           Record Status
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     MOVEL*BLANK    WECCVN           Create User
     C                     MOVEL*BLANK    WECDVN           Create Program
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
     C                     MOVEL*BLANK    WECEVN           Change User
     C                     MOVEL*BLANK    WECFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WEVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WEMJDT           Create Date
     C                     Z-ADD##JTM     WEBETM           Create Time
     C                     MOVEL##USR     WECCVN           Create User
     C                     MOVEL##PGM     WECDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
     C                     MOVEL*BLANK    WECEVN           Change User
     C                     MOVEL*BLANK    WECFVN           Change Program
     C           KLCRSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEL6T1           COA ULSD Compan
     C                     KFLD           WEI3NY           COA Batch Numbe
     C                     KFLD           WEMDT1           COA Property
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CDCPOJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3806' W0RTN   7
      * Send message 'COA Batch Detail       EX'
     C                     MOVEL'USR3806' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPOJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Increment Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  40       Current Account
     C                     Z-ADD*ZERO     WN0002  20       Current Account
     C                     Z-ADD*ZERO     WN0003  30       OM Week
     C                     Z-ADD*ZERO     WN0004  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0005  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0006  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0007  70       Next Late Charg
     C                     Z-ADD*ZERO     WN0008  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0009  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0010  70       Next Customer #
     C                     Z-ADD*ZERO     WN0011  70       Next Inventory
     C                     Z-ADD*ZERO     WN0012  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0013  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0014  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0015  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0016  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0017  1        Auto Customers
     C                     MOVEL*BLANK    WN0018  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0019  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0020  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0021 112       Late Charge Min
     C                     MOVEL*BLANK    WN0022  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0023  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0024  1        Allocate Credit
     C                     MOVEL*BLANK    WN0025 30        Message Line 1
     C                     MOVEL*BLANK    WN0026 30        Message Line 2
     C                     MOVEL*BLANK    WN0027 30        Message Line 3
     C                     MOVEL*BLANK    WN0028 30        Message Line 4
     C                     MOVEL*BLANK    WN0029  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0030  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0031  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0032  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0033  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0034  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0035  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0036  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0037  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0038  30       Retention Perio
     C                     Z-ADD*ZERO     WN0039  30       Retention Perio
     C                     Z-ADD*ZERO     WN0040  30       Retention Perio
     C                     Z-ADD*ZERO     WN0041  30       Retention Perio
     C                     Z-ADD*ZERO     WN0042  30       Retention Perio
     C                     Z-ADD*ZERO     WN0043  70       Next Load ID
     C                     MOVEL*BLANK    WN0044  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0045  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0046  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0047  30       Production Numb
     C                     MOVEL*BLANK    WN0048  1        Freight by Poun
     C                     MOVEL*BLANK    WN0049  1        Price Audit Act
     C                     MOVEL*BLANK    WN0050 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0051  1        EDI Status 1
     C                     MOVEL*BLANK    WN0052  1        EDI Status 2
     C                     MOVEL*BLANK    WN0053  1        EDI Status 3
     C                     MOVEL*BLANK    WN0054  1        Record Status
     C                     Z-ADD*ZERO     WN0055  60       Job Time
     C                     MOVEL*BLANK    WN0056 10        User Id
     C                     MOVEL*BLANK    WN0057 10        Job Name
     C                     Z-ADD*ZERO     WN0058  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADDWBAIC3    WFAIC3           Company Number
      *
     C           KLCHSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C           KLCHSF    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C           WBI3NY    ADD  1         WFBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DACPP5
     C                     Z-ADD#1AIC3    WGAIC3           Company Number
     C                     MOVEL#1L6T1    WGL6T1           COA ULSD Compan
     C                     Z-ADD#1I3NY    WGI3NY           COA Batch Numbe
     C                     Z-ADD#1JYNY    WGJYNY           COA Batch Heade
     C                     Z-ADD#1Q1NY    WGQ1NY           COA Batch Hdr R
     C                     MOVEL#1MUT1    WGMUT1           COA Batch Heade
     C                     Z-ADD#1JZNY    WGJZNY           COA RIN SSSSSSS
     C                     Z-ADD#1J0NY    WGJ0NY           COA RIN EEEEEEE
     C                     Z-ADD#1J2NY    WGJ2NY           COA RIN Volume
     C                     Z-ADD#1RIDT    WGRIDT           COA RIN Transac
     C                     Z-ADD#1C5TM    WGC5TM           COA RIN Transac
     C                     MOVEL#1MVT1    WGMVT1           COA RIN Trans P
     C                     MOVEL#1MWT1    WGMWT1           COA RIN Trans P
     C                     MOVEL#1RINT    WGRINT           COA Retired RIN
     C                     Z-ADD#1RJDT    WGRJDT           COA Retired RIN
     C                     Z-ADD#1C6TM    WGC6TM           COA Retired RIN
     C                     Z-ADD#1C4NB    WGC4NB           Order Number
     C                     Z-ADD#1DPNB    WGDPNB           Order Sequence
     C                     Z-ADD#1UENB    WGUENB           Order Secondary
     C                     Z-ADD#1RZNB    WGRZNB           Case Sequence N
     C                     MOVEL#1NGT1    WGNGT1           COA Rail Car
     C                     Z-ADD#1RMNB    WGRMNB           Load ID
     C                     Z-ADD#1RKDT    WGRKDT           COA Date of 1st
     C                     Z-ADD#1C7TM    WGC7TM           COA RIN Unused
     C                     MOVEL#1RINS    WGRINS           COA RIN Modifie
     C                     MOVEL#1MXT1    WGMXT1           COA RIN Unused
     C                     MOVEL#1G3ST    WGG3ST           COA RIN SoldFul
     C                     Z-ADD#1QWNY    WGQWNY           COA RIN Gallons
     C                     MOVEL#1L0AA    WGL0AA           COA Ship To War
     C                     MOVEL#1MAT1    WGMAT1           COA RIN Type Fl
     C                     MOVEL#1TDNA    WGTDNA           COA RIN Custome
     C                     Z-ADD#1CWC3    WGCWC3           COA Shipping Co
     C                     Z-ADD#1QXNY    WGQXNY           COA Ref Load Id
     C                     Z-ADD#1QZNY    WGQZNY           COA Reference B
     C                     Z-ADD#1Q0NY    WGQ0NY           COA Reference B
     C                     MOVEL#1LVTX    WGLVTX           RFS Compliance
     C                     MOVEL#1NYT1    WGNYT1           RFS Report Year
     C                     MOVEL#1G5ST    WGG5ST           COA RIN Int/Ext
     C                     MOVEL#1G7ST    WGG7ST           COA BHR Unused
     C                     Z-ADD#1TFDT    WGTFDT           COA BHR Net Gal
     C                     Z-ADD#1TGDT    WGTGDT           COA BHR Unused
     C                     MOVEL#1WIT1    WGWIT1           COA BHR Unused
     C                     Z-ADD#1QYNY    WGQYNY           COA BHR Loadout
     C                     MOVEL#1L7T1    WGL7T1           COA ULSD Facili
     C                     Z-ADD#1R8NY    WGR8NY           COA Batch RIN V
     C                     Z-ADD#1R0NY    WGR0NY           COA RIN Quantit
     C                     MOVEL#1I7AA    WGI7AA           RFS Transaction
     C                     MOVEL#1MXAA    WGMXAA           RFS Trans Reaso
     C                     MOVEL#1MSAA    WGMSAA           RFS Fuel Code
     C                     Z-ADD#1R7NY    WGR7NY           COA BHR RIN Gen
     C                     Z-ADD#1HEPR    WGHEPR           COA BHR RIN Pri
     C                     Z-ADD#1HFPR    WGHFPR           COA BHR Gallon
     C                     MOVEL#1WVT1    WGWVT1           COA Transaction
     C                     MOVEL#1W0T1    WGW0T1           COA RIN Support
     C                     Z-ADD#1R5NY    WGR5NY           COA RIN Support
     C                     MOVEL#1W1T1    WGW1T1           COA RIN Support
     C                     Z-ADD#1R6NY    WGR6NY           COA RIN Support
     C                     MOVEL#1J1ST    WGJ1ST           COA BHR RFS Ver
     C                     MOVEL#1KHST    WGKHST           COA GEN EMTS St
     C                     Z-ADD#1TWDT    WGTWDT           COA GEN EMTS Da
     C                     Z-ADD#1DUTM    WGDUTM           COA GEN EMTS Ti
     C                     MOVEL#1KGST    WGKGST           COA RIN EMTS St
     C                     Z-ADD#1TVDT    WGTVDT           COA RIN EMTS Da
     C                     Z-ADD#1DTTM    WGDTTM           COA RIN EMTS Ti
     C                     Z-ADD#1R9NY    WGR9NY           COA EMTS PTD Nb
     C                     Z-ADD#1SQNY    WGSQNY           COA EMTS Batch
     C                     MOVEL#1BHR3    WGBHR3           COA BHR Unused
     C                     Z-ADD#1SRNY    WGSRNY           COA BHR Unused
     C                     MOVEL#1W7T1    WGW7T1           COA EMTS Trans
     C                     MOVEL#1W8T1    WGW8T1           COA EMTS Return
     C                     Z-ADD#1T2DT    WGT2DT           COA BHR Unused
     C                     Z-ADD#1SXNY    WGSXNY           COA BHR Equiv V
     C                     Z-ADD#1SYNY    WGSYNY           COA BHR RINs to
     C                     Z-ADD#1SZNY    WGSZNY           COA Unassgnd Tx
     C                     MOVEL#1VSST    WGVSST           Record Status
     C                     Z-ADD#1MJDT    WGMJDT           Create Date
     C                     Z-ADD#1BETM    WGBETM           Create Time
     C                     MOVEL#1CCVN    WGCCVN           Create User
     C                     MOVEL#1CDVN    WGCDVN           Create Program
     C                     Z-ADD#1MKDT    WGMKDT           Change Date
     C                     Z-ADD#1BFTM    WGBFTM           Change Time
     C                     MOVEL#1CEVN    WGCEVN           Change User
     C                     MOVEL#1CFVN    WGCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WGVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WGMJDT           Create Date
     C                     Z-ADD##JTM     WGBETM           Create Time
     C                     MOVEL##USR     WGCCVN           Create User
     C                     MOVEL##PGM     WGCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
     C                     MOVEL*BLANK    WGCEVN           Change User
     C                     MOVEL*BLANK    WGCFVN           Change Program
     C           KLCRSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGL6T1           COA ULSD Compan
     C                     KFLD           WGI3NY           COA Batch Numbe
     C                     KFLD           WGJYNY           COA Batch Heade
     C                     KFLD           WGQ1NY           COA Batch Hdr R
      * Check for duplicate primary key
     C           KLCRSG    SETLL@DACPP5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3856' W0RTN   7
      * Send message 'COA Batch Header RIN   EX'
     C                     MOVEL'USR3856' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@DACPP5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Last Sec f/Btch/SecRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHL6T1    WQSH02           COA ULSD Compan
     C           *LIKE     DEFN WHI3NY    WQSH03           COA Batch Numbe
     C           *LIKE     DEFN WHJYNY    WQSH04           COA Batch Heade
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           COA ULSD Compan
     C                     KFLD           WQSH03           COA Batch Numbe
     C                     KFLD           WQSH04           COA Batch Heade
      * Setup key
     C                     Z-ADD#1AIC3    WQSH01           Company Number
     C                     MOVEL#1L6T1    WQSH02           COA ULSD Compan
     C                     Z-ADD#1I3NY    WQSH03           COA Batch Numbe
     C                     Z-ADD#1JYNY    WQSH04           COA Batch Heade
      * Establish starting position
     C           KRSSH     SETLL@DACPED                    *
     C           KRSSH     READE@DACPED                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3855' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     #1Q1NY           COA Batch Hdr R
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHQ1NY    #1Q1NY           COA Batch Hdr R
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@DACPED                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Fuel Code Dft,dsc RT - RFS Fuel Code - D Code  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@GCREGQ                    *
     C                     READ @GCREGQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4316' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1MSAA           RFS Fuel Code
     C                     MOVEL*BLANK    #DWOT1           RFS Fuel Code D
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Fuel Code Default EQ PAR.RFS Fuel Code Default
     C           WKJGST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     MOVELWKMSAA    #1MSAA           RFS Fuel Code
     C                     MOVELWKWOT1    #DWOT1           RFS Fuel Code D
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @GCREGQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Trans Rsn Dft,Dsc RT - RFS Transaction Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJI7AA    WQSJ01           RFS Transaction
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           RFS Transaction
      * Setup key
     C                     MOVEL#1I7AA    WQSJ01           RFS Transaction
      * Establish starting position
     C           KRSSJ     SETLL@GGREG2                    *
     C           KRSSJ     READE@GGREG2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4324' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1MXAA           RFS Trans Reaso
     C                     MOVEL*BLANK    #DWTT1           RFS Trans Reaso
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Trans Reason Dft EQ PAR.RFS Trans Reason Dft
     C           WJJPST    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     MOVELWJMXAA    #1MXAA           RFS Trans Reaso
     C                     MOVELWJWTT1    #DWTT1           RFS Trans Reaso
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@GGREG2                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WLAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0059    WLAJVN           User Profile Na
      * Establish starting position
     C           KRSSK     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,003   W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELWLMPNA    P1MPNA           Default Printer
     C                     MOVELWLBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDWLAIC3    YL0015           Company Number
     C                     MOVELWLBUVN    WN0060           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WMAJVN           User Profile Na
     C                     KFLD           WMDNCD           Application Cod
      * Setup key
     C                     MOVELWL0004    WMAJVN           User Profile Na
     C                     MOVELWL0005    WMDNCD           Application Cod
      * Establish starting position
     C           KRSSL     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMAIC3    WL0006           Company Number
     C                     MOVELWMAJCD    WL0007           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WODNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSM01           Application Cod
     C                     MOVEL'OMS'     WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WORSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWOAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WODNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELWORSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,003   W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * E1860  RMC 01/28/13 Allow volume to be -0-
      * E1860  RMC 12/20/11 Allow rin type & batch seq entry
      * FP1322 RMC 11/10/09 New function: BUY Separated RIN only is allow
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1L6T1    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        COA ULSD Compan
     C           YPMTFD    OREQ '#1L6T1'
     C           YPMTFD    OREQ '#1I3NY'
     C           YPMTFD    OREQ '#1JYNY'
     C           YPMTFD    OREQ '#1Q1NY'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1I3NY' defaulted for 'COA Batch Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1MUT1' defaulted for 'COA Batch Header RIN'.
      * Field '(DTL) #1JZNY' defaulted for 'COA RIN SSSSSSSS'.
      * Field '(DTL) #1J0NY' defaulted for 'COA RIN EEEEEEEE'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
      * Field '(DTL) #1DPNB' defaulted for 'Order Sequence Number'.
      * Field '(DTL) #1UENB' defaulted for 'Order Secondary Line Seq'.
      * Field '(DTL) #1RZNB' defaulted for 'Case Sequence Number'.
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     C                     CALL 'PMGOSRR'              90  Sel Rin from SS
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0006  30       Company Number
     C           #1I3NY    PARM #1I3NY    WQ0007  50       COA Batch Numbe
     C           #1MUT1    PARM *BLANK    WQ0008 38        COA Batch Heade
     C                     PARM #1JZNY    WQ0009  80       COA RIN SSSSSSS
     C                     PARM #1J0NY    WQ0010  80       COA RIN EEEEEEE
     C           #1C4NB    PARM #1C4NB    WQ0011  70       Order Number
     C           #1DPNB    PARM #1DPNB    WQ0012  30       Order Sequence
     C           #1UENB    PARM #1UENB    WQ0013  30       Order Secondary
     C           #1RZNB    PARM #1RZNB    WQ0014  50       Case Sequence N
     C           #1RMNB    PARM #1RMNB    WQ0015  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMGOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9936  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1L6T1    IFNE *BLANK                     COA ULSD Compan
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1I3NY    IFNE *ZERO                      COA Batch Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1JYNY    IFNE *ZERO                      COA Batch Heade
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1Q1NY    IFNE *ZERO                      COA Batch Hdr R
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to COA Batch Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1L6T1    ANDEQ*BLANK                     COA ULSD Compan
     C           #1I3NY    ANDEQ*ZERO                      COA Batch Numbe
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAL6T1           COA ULSD Compan
     C                     KFLD           WAI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C                     MOVEL#1L6T1    WAL6T1
     C                     Z-ADD#1I3NY    WAI3NY
     C           KLVBWA    CHAIN@CCCPOH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Load Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0016  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0017  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWI    KLIST
     C                     KFLD           WIRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WIRMNB
     C           KLVCWI    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to RFS Transaction Reason
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1I7AA    WK1X01  1
     C                     MOVEL#1MXAA    WK1X02  1
     C           WK1X01    IFEQ '?'                        RFS Transaction
     C           YPMTFD    OREQ '#1I7AA'
     C           WK1X02    OREQ '?'                        RFS Trans Reaso
     C           YPMTFD    OREQ '#1MXAA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1I7AA' defaulted for 'RFS Transaction Type'.
      * Field '(DTL) #1MXAA' defaulted for 'RFS Trans Reason Code'.
     C                     CALL 'PNR3SRR'              90  Sel RFS Trnsctn
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1I7AA    WQ0018  3        RFS Transaction
     C           #1MXAA    PARM #1MXAA    WQ0019  3        RFS Trans Reaso
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNR3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993133*
     C                     END
      *
     C           #1I7AA    IFNE *BLANK                     RFS Transaction
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1MXAA    IFNE *BLANK                     RFS Trans Reaso
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1I7AA    IFEQ *BLANK                     RFS Transaction
     C           #1MXAA    ANDEQ*BLANK                     RFS Trans Reaso
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWJ    KLIST
     C                     KFLD           WJI7AA           RFS Transaction
     C                     KFLD           WJMXAA           RFS Trans Reaso
      * Setup key
     C                     MOVEL#1I7AA    WJI7AA
     C                     MOVEL#1MXAA    WJMXAA
     C           KLVDWJ    CHAIN@GGREG2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'RFS Transaction Reason NF'
     C                     MOVEL'USR4324' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR4324' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to RFS Fuel Code - D Code
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1MSAA    WK1X01  1
     C           WK1X01    IFEQ '?'                        RFS Fuel Code
     C           YPMTFD    OREQ '#1MSAA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1MSAA' defaulted for 'RFS Fuel Code'.
     C                     CALL 'PNRUSRR'              90  Sel RFS Fuel Co
     C                     PARM *BLANK    W0RTN   7
     C           #1MSAA    PARM #1MSAA    WQ0020  1        RFS Fuel Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNRUSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9934  *
     C                     END
      *
     C           #1MSAA    IFNE *BLANK                     RFS Fuel Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1MSAA    IFEQ *BLANK                     RFS Fuel Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWK    KLIST
     C                     KFLD           WKMSAA           RFS Fuel Code
      * Setup key
     C                     MOVEL#1MSAA    WKMSAA
     C           KLVEWK    CHAIN@GCREGQ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'RFS Fuel Code - D Code NF'
     C                     MOVEL'USR4316' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR4316' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1I7AA'  YPMTFD           RFS Transaction
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1MAT1'  YPMTFD           COA RIN Type Fl
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1MXAA'  YPMTFD           RFS Trans Reaso
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1MSAA'  YPMTFD           RFS Fuel Code
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE049
     C           ZHCSCL    ANDLE053
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1I3NY'  YPMTFD           COA Batch Numbe
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE062
     C           ZHCSCL    ANDLE066
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1JYNY'  YPMTFD           COA Batch Heade
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1G3ST'  YPMTFD           COA RIN SoldFul
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1WVST           Access Denied (
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WARFDT           COA Date Open f
     C                     Z-ADD*ZERO     WAC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WARGDT           COA Date Close
     C                     Z-ADD*ZERO     WAC3TM           COA Time Close
     C                     Z-ADD*ZERO     WAJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WARHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WAC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WAJENY           COA Temperature
     C                     Z-ADD*ZERO     WAJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WAJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WAJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WAJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WAJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WAJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WAJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WARLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WATTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WADRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WAR4NY           COA BH Unused N
     C                     Z-ADD*ZERO     WATUDT           COA BH Unused D
     C                     Z-ADD*ZERO     WADSTM           COA BH Unused T
     C                     Z-ADD*ZERO     WASANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WASBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WASCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WAG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCI2NY           COA Print Seque
     C                     Z-ADD*ZERO     WCI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WDI2NY           COA Print Seque
     C                     Z-ADD*ZERO     WDH5VL           COA Property Va
     C                     Z-ADD*ZERO     WDI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAXNB           Current Account
     C                     Z-ADD*ZERO     WFNGNB           Current Account
     C                     Z-ADD*ZERO     WFBZNB           OM Week
     C                     Z-ADD*ZERO     WFC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WFC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WFCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WFIONB           Next Late Charg
     C                     Z-ADD*ZERO     WFI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WFDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WFC7NB           Next Customer #
     C                     Z-ADD*ZERO     WFC2NB           Next Inventory
     C                     Z-ADD*ZERO     WFC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WFL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WFBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WFAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WFASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WFA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WFAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WFABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WFACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WFADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WFAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WFAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WFAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WFAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WFAENB           Retention Perio
     C                     Z-ADD*ZERO     WFALNB           Retention Perio
     C                     Z-ADD*ZERO     WFEVNB           Retention Perio
     C                     Z-ADD*ZERO     WFRPOP           Retention Perio
     C                     Z-ADD*ZERO     WFDWNB           Retention Perio
     C                     Z-ADD*ZERO     WFR3NB           Next Load ID
     C                     Z-ADD*ZERO     WFR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WFSCNB           Production Numb
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WGJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WGQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WGJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WGJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WGJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WGRIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WGC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WGRJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WGC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WGC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WGQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WGCWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WGQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WGQZNY           COA Reference B
     C                     Z-ADD*ZERO     WGQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WGTFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WGTGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WGQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WGR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WGR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WGR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WGHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WGHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WGR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WGR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WGTWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WGDUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WGTVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WGDTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WGR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WGSQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WGSRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WGT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WGSXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WGSYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WGSZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WIFLAM           Flat Amount
     C                     Z-ADD*ZERO     WIRRNB           Total Stops
     C                     Z-ADD*ZERO     WISBNB           BOL Time
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WISDNB           Number Pallets
     C                     Z-ADD*ZERO     WIPAOU           Number Pallets
     C                     Z-ADD*ZERO     WIDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIHADT           Actual Arrival
     C                     Z-ADD*ZERO     WIAART           Actual Arrival
     C                     Z-ADD*ZERO     WIDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WIDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WIAQDT           Actual Departur
     C                     Z-ADD*ZERO     WIS6NB           Departure Time
     C                     Z-ADD*ZERO     WIT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WIPRTM           Product Tempera
     C                     Z-ADD*ZERO     WINPSV           Number Pallets
     C                     Z-ADD*ZERO     WITLMI           Total Load Mile
     C                     Z-ADD*ZERO     WIGRWE           Gross Weight
     C                     Z-ADD*ZERO     WIF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WIJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WITRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WIJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WISPTM           Spotted Time
     C                     Z-ADD*ZERO     WIJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WILFTM           Load Finished T
     C                     Z-ADD*ZERO     WIJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WIBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WIJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WIBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WIKIDT           Truck Departure
     C                     Z-ADD*ZERO     WIASTM           Truck Departure
     C                     Z-ADD*ZERO     WIKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WIAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WIVOAG           Voyage
     C                     Z-ADD*ZERO     WIKBDT           Sail Date
     C                     Z-ADD*ZERO     WIEFDT           Arrival Date
     C                     Z-ADD*ZERO     WIKCDT           Date In
     C                     Z-ADD*ZERO     WITMIN           Time In
     C                     Z-ADD*ZERO     WIKDDT           Date Out
     C                     Z-ADD*ZERO     WIVMNB           Time Out
     C                     Z-ADD*ZERO     WIOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WILLDT           Express Mail Da
     C                     Z-ADD*ZERO     WIK0DT           Product Complet
     C                     Z-ADD*ZERO     WIAYTM           Product Complet
     C                     Z-ADD*ZERO     WIKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WIICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WIIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WIK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WIAZTM           Load Door 1
     C                     Z-ADD*ZERO     WIK2DT           Override Total
     C                     Z-ADD*ZERO     WIA0TM           Load Door 2
     C                     Z-ADD*ZERO     WIZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WIPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WICKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WIPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WICLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WIP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WICMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WIP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WICNTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WICOTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WICQTM           LH Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLNLNB           Entity Number
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  4
     C                     Z-ADD*ZERO     WL0003  50
      * Define local variables for subroutine SLRVGN.
     C                     MOVEL*BLANK    WL0004 10
     C                     MOVEL*BLANK    WL0005  6
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007  3
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field COA Co-Product Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field COA BH RFS Version Nbr
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field COA BH EMTS Sts
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field COA BH Equiv Value f/SEP
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field RFS Feedstock Code 1
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field COA BH Feedstck Measure 1
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field COA BH Feedstck Biomass 1
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field COA BH Feedstck Measure 2
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field COA BH Feedstck Biomass 2
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field COA BH Feedstck Measure 3
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field COA BH Feedstck Biomass 3
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0016  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0059 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0059           User Profile Na
      *
     C                     MOVEL*BLANK    WN0060 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SKRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0059    ZA0005           User Profile Na
     C                     MOVEL'OMS'     ZA0006           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,004   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0060    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0059    WL0004    P      User Profile Na
     C                     MOVEL'OMS'     WL0005    P      Application Cod
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0014           Company Number
     C                     MOVELWL0007    YL0016    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0060    WL0004    P      User Profile Na
     C                     MOVEL'OMS'     WL0005    P      Application Cod
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0014           Company Number
     C                     MOVELWL0007    YL0016    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0016    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0059    ZA0007           User Profile Na
     C                     MOVEL'OMS'     ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL@CN,004   P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0015    IFNE *ZERO                      *IF
     C                     Z-ADDYL0015    YL0014           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0016    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0021  3        Warehouse Code
     C                     PARM YL0015    WQ0022  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * ***** Change Log and comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01052013080156401820018260233202339
02588025950284402865028780288903100
03134033560336703612036380365703868
04380044150463604652048920514805192
054040543105660
** W0END
01054013110156601820018500233402368
02588026240284702869028820289303107
03141033610339103619036460366303868
04387044220463904681049060517205198
054110543705660
** W0NAM
V1AIC3    #1L6T1    #1I7AA    #1MAT1    #DHLTX    #1MXAA    #DWTT1
#1MSAA    #DWOT1    #1R7NY    #1I3NY    #1JYNY    #1Q1NY    #1HEPR
#1HFPR    #DIDAA    #DHOTX    #1R8NY    #DJ3NY    #1R0NY    #1G3ST
V1RIDT    #1C5TM    #1MWT1    #1MVT1    #1TDNA    #1W0T1    #1R5NY
#1SQNY    #1R9NY    #1KGST
** @CN
00001 USR3803
00002 Created from outside BUY
00003 Y2U0005
00004 Y2U9999
