/***************************************************************** */
/*                                                                 */
/*  System:          JDE - Convert World to Enterprise 1           */
/*  Program Number:  E1LSUCL                                       */
/*  Program Name:    Email Batch Number to users                   */
/*  Programmer:      Brad Baden                                    */
/*  Create Date:     07/22/2020                                    */
/*  Project:         SDN465                                        */
/*                                                                 */
/*  Function:        This CL is called from programs that are part */
/*                   of the move from JDE World to Enterprise 1.   */
/*                   A process name is passed in along with a      */
/*                   batch number.  ESEND will be used to          */
/*                   send the message to a DL.                     */
/*                                                                 */
/*******************************************************************/
/*                                                                 */
/* MODIFIED:  xx/xx/xxxx  xxxxxxxxxxxxxxxxxxx Exxxx                */
/*            xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx     */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&BATCHES &SOURCE &BCHDSC &RECIP &SUBJECT)

             DCL        VAR(&BATCHES) TYPE(*CHAR) LEN(500)
             DCL        VAR(&MESSAGE)  TYPE(*CHAR) LEN(500)
             DCL        VAR(&SOURCE) TYPE(*CHAR) LEN(25)
             DCL        VAR(&BCHDSC) TYPE(*CHAR) LEN(25)
             DCL        VAR(&RECIP)   TYPE(*CHAR) LEN(30)
             DCL        VAR(&SUBJECT) TYPE(*CHAR) LEN(40)
             DCL        VAR(&USER)    TYPE(*CHAR) LEN(10)
             DCL        VAR(&GRPPRF)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&ERECIP) TYPE(*CHAR) LEN(40) VALUE('e1 +
                          batch error')
             DCL        VAR(&ESUBJECT) TYPE(*CHAR) LEN(60)

/*  Send message to user that the batch is ready in JDE              */
/*                                                                   */
             RTVJOBA    USER(&USER)
             RTVUSRPRF  GRPPRF(&GRPPRF)

             CHGVAR     VAR(&MESSAGE) VALUE(' ')
             CHGVAR     VAR(&MESSAGE) VALUE(&SOURCE |> 'has created ' +
                          |> &BCHDSC |> 'batches: ' |> &BATCHES |> 'in +
                           JDE.  Batches are ready for your review.')

             ESNDMAIL   RECIPIENT(&RECIP) SUBJECT(&SUBJECT) +
                          MSG(&MESSAGE)

             /* If ESEND error, send message to I/T people */
ERROR:       MONMSG     MSGID(CPF0000) EXEC(DO)
             CHGVAR     VAR(&ESUBJECT) VALUE('Error - ')
             CHGVAR     VAR(&ESUBJECT) VALUE(&ESUBJECT |> &SUBJECT +
                          |> 'for recipient: ' |> &RECIP)
             ESNDMAIL   RECIPIENT(&ERECIP) SUBJECT(&ESUBJECT) +
                          MSG(&MESSAGE)
             ENDDO

             ENDPGM
