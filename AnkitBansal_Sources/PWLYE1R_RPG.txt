     H/TITLE Edt Producer/JDE E1   ER  Edit record(1 screen)
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
     H* Object type   : *PGM
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 02/21/22  Time  : 09:27:57
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0  IF   E           K DISK
      * Values list details file
      *
     FPWLYE1R#  CF   E             WORKSTN
     F                                     INFDS(INFDS#)
      * DSP: Edt Producer/JDE E1   ER  Edit record(1 screen)
      *
     FPKACREL1  IF   E           K DISK
     F                                     INFDS(INFDS1)
      * RTV : Producer                  Retrieval index
      *
     FPKEAREL1  IF   E           K DISK
      * RTV : Fax Detail                Retrieval index
      *
     FPLB4REL1  IF   E           K DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPLB2REL1  IF   E           K DISK
      * RTV : M3 Supplier               Retrieval index
      *
     FPKACREL9  IF   E           K DISK
      * RSQ : Producer                  By EDI Trading Partners
      *
     FPKAAREL0  IF   E           K DISK
      * RTV : Source                    Retrieval index
      *
     FPKADREL0  IF   E           K DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKE3CPL1  IF   E           K DISK
      * RTV : MPR Producer Purch Type   Retrieval index
      *
     FPKE2REL1  IF   E           K DISK
      * RTV : MPR Purchase Type         Retrieval index
      *
     FPLAOREL1  IF   E           K DISK
      * RTV : Producer EXT              Retrieval index
      *
     FPKACREL0  UF A E           K DISK
      * UPD : Producer                  Update index
      *
     FPLB4REL0  UF A E           K DISK
      * UPD : Producer EXT2             Update index
      *
     FPWAGREL0  UF A E           K DISK
      * UPD : Producer Address          Update index
      *
     FPKEAREL0  UF A E           K DISK
      * UPD : Fax Detail                Update index
      *
     FPKE3CPL0  UF A E           K DISK
      * UPD : MPR Producer Purch Type   Update index
      *
      * KEY Screen: Field position and name array
     D W0BEG           S              5  0 DIM(001)CTDATA PERRCD(1)ASCEND
     D W0END           S              5  0 DIM(001)CTDATA PERRCD(1)ASCEND
     D W0NAM           S             10    DIM(001)CTDATA PERRCD(1)
      * DETAIL Screen: Field position and name array
     D W1BEG           S              5  0 DIM(053)CTDATA PERRCD(7)ASCEND
     D W1END           S              5  0 DIM(053)CTDATA PERRCD(7)ASCEND
     D W1NAM           S             10    DIM(053)CTDATA PERRCD(7)
      * Long constants
     D @CN#            S              6    DIM(05)CTDATA PERRCD(1)
     D @CN             S             25    DIM(05) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
     D INFDS1        E DS                  EXTNAME(Y2I1DSP)
      * File information data structure
      *
     D @1DBRC        E DS                  EXTNAME(PKACREL0)
      * UPD : Producer                  Update index
      * Current/previous master file format fields for change control
      *
     D #1DBRC          DS           153
      * Stored master file format fields
     D  #1DB1                  1      1
      *
     D QPLB41        E DS                  EXTNAME(PLB4REL0)
      * UPD : Producer EXT2             Update index
      * Renamed input format fields
     D  WBABCD       E                     EXTFLD(B4ABCD)
     D  WBQHCD       E                     EXTFLD(B4QHCD)
     D  WBAAVN       E                     EXTFLD(B4AAVN)
     D  WBAADT       E                     EXTFLD(B4AADT)
     D  WBAMTM       E                     EXTFLD(B4AMTM)
     D  WBAJST       E                     EXTFLD(B4AJST)
     D  WBAHVN       E                     EXTFLD(B4AHVN)
     D  WBAGVN       E                     EXTFLD(B4AGVN)
     D  WBABVN       E                     EXTFLD(B4ABVN)
     D  WBABDT       E                     EXTFLD(B4ABDT)
     D  WBABTM       E                     EXTFLD(B4ABTM)
      *
     D QPWAG1        E DS                  EXTNAME(PWAGREL0)
      * UPD : Producer Address          Update index
      *
     D QPKEA1        E DS                  EXTNAME(PKEAREL0)
      * UPD : Fax Detail                Update index
      * Renamed input format fields
     D  WCHHCD       E                     EXTFLD(EAHHCD)
     D  WCNYTX       E                     EXTFLD(EANYTX)
     D  WCFDFN       E                     EXTFLD(EAFDFN)
     D  WCNXTX       E                     EXTFLD(EANXTX)
     D  WCAAVN       E                     EXTFLD(EAAAVN)
     D  WCAADT       E                     EXTFLD(EAAADT)
     D  WCAMTM       E                     EXTFLD(EAAMTM)
     D  WCAJST       E                     EXTFLD(EAAJST)
     D  WCAHVN       E                     EXTFLD(EAAHVN)
     D  WCAGVN       E                     EXTFLD(EAAGVN)
     D  WCABVN       E                     EXTFLD(EAABVN)
     D  WCABDT       E                     EXTFLD(EAABDT)
     D  WCABTM       E                     EXTFLD(EAABTM)
      *
     D YARDCS          DS           129
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D YBRDCS          DS           129
     D QPKE31        E DS                  EXTNAME(PKE3CPL0)
      * UPD : MPR Producer Purch Type   Update index
      * Renamed input format fields
     D  WDABCD       E                     EXTFLD(E3ABCD)
     D  WDC0A1       E                     EXTFLD(E3C0A1)
     D  WDAAVN       E                     EXTFLD(E3AAVN)
     D  WDAADT       E                     EXTFLD(E3AADT)
     D  WDAMTM       E                     EXTFLD(E3AMTM)
     D  WDAJST       E                     EXTFLD(E3AJST)
     D  WDAHVN       E                     EXTFLD(E3AHVN)
     D  WDAGVN       E                     EXTFLD(E3AGVN)
     D  WDABVN       E                     EXTFLD(E3ABVN)
     D  WDABDT       E                     EXTFLD(E3ABDT)
     D  WDABTM       E                     EXTFLD(E3ABTM)
      *
     D YCRDCS          DS           153
     D YDRDCS          DS           464
     D YERDCS          DS            73
     D YFRDCS          DS           129
     D YGRDCS          DS           129
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              6
     D  WP0002         S             40
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0BYP          S              1
     D  W0TRN          S              1
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  BBIN89         S              1
     D  W0GRP          S              1
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0PMD          S              3
     D  Y2LSNO         S              7  0
     D  W0INVL         S             25
     D  W0VLMP         S              1
     D  W0CNNM         S             25
     D  YN0001         S              8  0
     D  YN0002         S             40
     D  YN0003         S             40
     D  YN0004         S             40
     D  YN0005         S              1
     D  YN0006         S             16
     D  WQ0001         S              6
     D  WQ0002         S              8  0
     D  WQ0003         S             40
     D  WQ0004         S             40
     D  WQ0005         S             40
     D  WQ0006         S             40
     D  WQ0007         S             40
     D  WQ0008         S              3
     D  WQ0009         S             12
     D  WQ0010         S              6
     D  WQ0011         S             20
     D  WQ0012         S              6
     D  WQ0013         S             20
     D  WQ0014         S             40
     D  WQ0015         S              6
     D  WQ0016         S             20
     D  WQ0017         S             40
     D  WQ0018         S              1
     D  WQ0019         S             16
     D  WQ0020         S              3
     D  W0CLPG         S             10
     D  YN0007         S             15
     D  YN0008         S             36
     D  YN0009         S             36
     D  YN0010         S             36
     D  YN0011         S             36
     D  YN0012         S             20
     D  YN0013         S              2
     D  YN0014         S             10
     D  YN0015         S             16
     D  YN0016         S             16
     D  YN0017         S             16
     D  YN0018         S              3
     D  WUGUST         S              7
     D  YN0019         S              1
     D  WXPGM          S             10
     D  WQ0021         S              7
     D  WQ0022         S              8  0
     D  WQ0023         S             40
     D  WQ0024         S             40
     D  WQ0025         S             40
     D  WQ0026         S             40
     D  WQ0027         S             40
     D  WQ0028         S              3
     D  WQ0029         S             12
     D  WQ0030         S              6
     D  WQ0031         S             20
     D  WQ0032         S              6
     D  WQ0033         S             20
     D  WQ0034         S              6
     D  WQ0035         S             20
     D  WQ0036         S              1
     D  WQ0037         S             16
     D  WQ0038         S              3
     D  WQ0039         S              1
     D  WQ0040         S              6
     D  WQ0041         S              6
     D  WQ0042         S              8  0
     D  WQ0043         S             10
     D  WQSG01         S                   LIKE(WAGJNB)
     D  WQSK01         S                   LIKE(E3ABCD)
     D  WK1X01         S              1
     D  WQ0044         S              6
     D  W0DCF          S              1
     D  CBIN89         S              1
     D  YL0001         S              3
     D  YL0002         S             36
     D  YL0003         S             16
     D  YL0004         S             16
     D  YL0005         S             16
     D  WQ0045         S             10
     D  WQ0046         S             36
     D  WQ0047         S             36
     D  WQ0048         S             36
     D  WQ0049         S             36
     D  WQ0050         S             36
     D  WQ0051         S             20
     D  WQ0052         S              2
     D  WQ0053         S             10
     D  WQ0054         S             16
     D  WQ0055         S             16
     D  WQ0056         S             16
     D  WQ0057         S             15
     D  WQ0058         S              3
     D  WQ0059         S              3
     D  WQ0060         S              3
     D  ZQ             S              5  0
     D  YL0006         S             40
     D  YL0007         S             40
     D  YL0008         S             40
     D  YL0009         S             40
     D  YL0010         S             40
     D  YL0011         S              3
     D  YL0012         S             12
     D  YL0013         S             16
     D  YL0014         S              3
     D  WQ0061         S             10
     D  WQ0062         S             36
     D  WQ0063         S             36
     D  WQ0064         S             36
     D  WQ0065         S             36
     D  WQ0066         S             36
     D  WQ0067         S             20
     D  WQ0068         S              2
     D  WQ0069         S             10
     D  WQ0070         S             16
     D  WQ0071         S             16
     D  WQ0072         S             16
     D  WQ0073         S             15
     D  WQ0074         S              3
     D  WQ0075         S              3
     D  WQ0076         S              3
     D  YL0015         S              2  0
     D  WQ0077         S              2  0
     D  Y0CX01         S              1
     D  YL0016         S              3
     D  YL0017         S             12
     D  WQ0078         S              8  0
     D  WQ0079         S             40
     D  WQ0080         S             40
     D  WQ0081         S             40
     D  WQ0082         S             40
     D  WQ0083         S             40
     D  WQ0084         S              3
     D  WQ0085         S             12
     D  WQ0086         S              6
     D  WQ0087         S             20
     D  WQ0088         S              6
     D  WQ0089         S             20
     D  WQ0090         S              6
     D  WQ0091         S             20
     D  WQ0092         S              1
     D  WQ0093         S             16
     D  WQ0094         S              3
     D  WQ0095         S              3
     D  WQ0096         S             12
     D  WQ0097         S              6
     D  WQ0098         S              6
     D  WQ0099         S              8  0
     D  WQ0100         S             10
     D  WUE9NB         S              1  0
     D  ZADFMF         S             10
     D  YL0018         S              1
     D  WQSR01         S                   LIKE(WAGJNB)
     D  WQ0101         S              3
     D  WQ0102         S              3
     D  WQ0103         S              6
     D  WN30           S             30
     D  W0NSRQ         S              1
     D  W0EXVL         S             25
     D  WN0001         S             10
     D  WN0002         S              7  0
     D  WN0003         S              6  0
     D  WN0004         S              1
     D  WN0005         S             10
     D  WN0006         S             10
     D  WN0007         S             10
     D  WN0008         S              7  0
     D  WN0009         S              6  0
     D  WN0010         S             10
     D  WN0011         S              7  0
     D  WN0012         S              6  0
     D  WN0013         S              1
     D  WN0014         S             10
     D  WN0015         S             10
     D  WN0016         S             10
     D  WN0017         S              7  0
     D  WN0018         S              6  0
     D  WN0019         S             10
     D  WN0020         S              7  0
     D  WN0021         S              6  0
     D  WN0022         S              1
     D  WN0023         S             10
     D  WN0024         S             10
     D  WN0025         S             10
     D  WN0026         S              7  0
     D  WN0027         S              6  0
     D  WQ0104         S              7  0
     D  WQ0105         S              6  0
     D  WN0028         S             10
     D  WN0029         S              7  0
     D  WN0030         S              6  0
     D  WN0031         S              1
     D  WN0032         S             10
     D  WN0033         S             10
     D  WN0034         S             10
     D  WN0035         S              7  0
     D  WN0036         S              6  0
     D  WN0037         S             10
     D  WN0038         S              7  0
     D  WN0039         S              6  0
     D  WN0040         S              1
     D  WN0041         S             10
     D  WN0042         S             10
     D  WN0043         S             10
     D  WN0044         S              7  0
     D  WN0045         S              6  0
     D  YARDC          S              1
     D  WN0046         S             10
     D  WN0047         S              7  0
     D  WN0048         S              6  0
     D  WN0049         S              1
     D  WN0050         S             10
     D  WN0051         S             10
     D  WN0052         S             10
     D  WN0053         S              7  0
     D  WN0054         S              6  0
     D  WN0055         S             10
     D  WN0056         S              7  0
     D  WN0057         S              6  0
     D  WN0058         S              1
     D  WN0059         S             10
     D  WN0060         S             10
     D  WN0061         S             10
     D  WN0062         S              7  0
     D  WN0063         S              6  0
     D  YBRDC          S              1
     D  WQTB01         S                   LIKE(E3ABCD)
     D  WN0064         S             10
     D  WN0065         S              7  0
     D  WN0066         S              6  0
     D  WN0067         S             10
     D  WN0068         S             10
     D  WN0069         S             10
     D  WN0070         S              7  0
     D  WN0071         S              6  0
     D  YCRDC          S              1
     D  WN0072         S             10
     D  WN0073         S              7  0
     D  WN0074         S              6  0
     D  WN0075         S             10
     D  WN0076         S             10
     D  WN0077         S             10
     D  WN0078         S              7  0
     D  WN0079         S              6  0
     D  YDRDC          S              1
     D  WN0080         S             10
     D  WN0081         S              7  0
     D  WN0082         S              6  0
     D  WN0083         S              1
     D  WN0084         S             10
     D  WN0085         S             10
     D  WN0086         S             10
     D  WN0087         S              7  0
     D  WN0088         S              6  0
     D  YERDC          S              1
     D  WN0089         S             10
     D  WN0090         S              7  0
     D  WN0091         S              6  0
     D  WN0092         S              1
     D  WN0093         S             10
     D  WN0094         S             10
     D  WN0095         S             10
     D  WN0096         S              7  0
     D  WN0097         S              6  0
     D  WN0098         S             10
     D  WN0099         S              7  0
     D  WN0100         S              6  0
     D  WN0101         S              1
     D  WN0102         S             10
     D  WN0103         S             10
     D  WN0104         S             10
     D  WN0105         S              7  0
     D  WN0106         S              6  0
     D  WN0107         S             10
     D  WN0108         S              7  0
     D  WN0109         S              6  0
     D  WN0110         S              1
     D  WN0111         S             10
     D  WN0112         S             10
     D  WN0113         S             10
     D  WN0114         S              7  0
     D  WN0115         S              6  0
     D  YFRDC          S              1
     D  WN0116         S             10
     D  WN0117         S              7  0
     D  WN0118         S              6  0
     D  WN0119         S              1
     D  WN0120         S             10
     D  WN0121         S             10
     D  WN0122         S             10
     D  WN0123         S              7  0
     D  WN0124         S              6  0
     D  WN0125         S             10
     D  WN0126         S              7  0
     D  WN0127         S              6  0
     D  WN0128         S              1
     D  WN0129         S             10
     D  WN0130         S             10
     D  WN0131         S             10
     D  WN0132         S              7  0
     D  WN0133         S              6  0
     D  YGRDC          S              1
     D  WQTP01         S                   LIKE(E3ABCD)
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  YL0019         S              3
     D  YL0020         S              3  0
     D  YL0021         S              3
     D  YL0022         S              1
     D  YL0023         S             10
     D  YL0024         S             30
     D  YL0025         S             40
     D  YL0026         S              1
     D  WQ0106         S              3
     D  WQ0107         S              3  0
     D  WQ0108         S              6
     D  WQ0109         S              3
     D  WQ0110         S              1
     D  WQ0111         S             10
     D  WQ0112         S             30
     D  WQ0113         S             40
     D  WQ0114         S              1
     D  YL0027         S             10
     D  WQ0115         S              3  0
     D  WQ0116         S             10
     D  WQ0117         S             40
     D  YL0028         S             15  5
     D  WQ0118         S              3  0
     D  WQ0119         S             10
     D  WQ0120         S             15  5
     D  WQ0121         S              3  0
     D  WQ0122         S             10
     D  WQ0123         S             40
     D  WQ0124         S              3  0
     D  WQ0125         S             10
     D  WQ0126         S             40
     D  WQ0127         S              3  0
     D  WQ0128         S             10
     D  WQ0129         S             40
     D  WQ0130         S              3  0
     D  WQ0131         S             10
     D  WQ0132         S             40
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  F              S              3  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Producer
      * I : MAP PD Producer Code
     D  P1ABCD                 1      6
      * N :  PD VND Address Number
     D  P1GCNB                 7     14  0
      * N :  PD EDI Trading Partner #
     D  P1GJNB                15     22  0
     D P2PARM          DS
      * I :  Oms System Value Alpha
     D  P2EVTX                 1     40
     D P3PARM          DS
      * N :  Live with M3   USR
     D  P3G4SS                 1      1
     D P4PARM          DS
      * N :  M3 Supplier Division
     D  P4R8CD                 1      3
     D P5PARM          DS
      * N :  M3 Supplier Group
     D  P5SACD                 1      3
     D P6PARM          DS
      * FLD: STR VND Common Routines
      * N :  Pass Name
     D  P6DVTX                 1     40
      * N :  Address 1
     D  P6DNTX                41     80
      * N :  Address 2
     D  P6DOTX                81    120
      * N :  Address 3
     D  P6DPTX               121    160
      * N :  City
     D  P6DQTX               161    200
      * N :  State
     D  P6DRTX               201    203
      * N :  Zip
     D  P6DSTX               204    215
      * N :  Area Code
     D  P6DTTX               216    221
      * N :  Telephone
     D  P6DUTX               222    241
      * N :  Fax Area Code #
     D  P6LSTX               242    247
      * N :  Fax Telephone
     D  P6LRTX               248    267
      * N :  Fax Area Code # 2
     D  P6NGTX               268    273
      * N :  Fax Telephone 2
     D  P6NHTX               274    293
      * N :  Vendor 1099
     D  P6GNST               294    294
      * N :  Vendor Tax Id.
     D  P6DXTX               295    310
      * N :  Country Code
     D  P6E0CD               311    313
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'MPR Purchase Type      NF'
      * Message data for 'EDI# does not exists'
      * PD EDI Trading Partner #
     D  ZA0001                 1      5P 0
     I@ACRELJ
      * Producer                  By EDI Trading Partners
      * Renamed input format fields
     I              ACABCD                      WAABCD
     I              ACAGTX                      WAAGTX
     I              ACALNB                      WAALNB
     I              ACAATH                      WAAATH
     I              ACAMNB                      WAAMNB
     I              ACIWST                      WAIWST
     I              ACAPST                      WAAPST
     I              ACGCNB                      WAGCNB
     I              ACGJNB                      WAGJNB
     I              ACC2TX                      WAC2TX
     I              ACAACD                      WAAACD
     I              ACACCD                      WAACCD
     I              ACADCD                      WAADCD
     I              ACAAVN                      WAAAVN
     I              ACAADT                      WAAADT
     I              ACAMTM                      WAAMTM
     I              ACAJST                      WAAJST
     I              ACAHVN                      WAAHVN
     I              ACAGVN                      WAAGVN
     I              ACABVN                      WAABVN
     I              ACABDT                      WAABDT
     I              ACABTM                      WAABTM
      *
     I@B4RET3
      * Producer EXT2             Update index
      * Renamed input format fields
     I              B4ABCD                      WBABCD
     I              B4QHCD                      WBQHCD
     I              B4AAVN                      WBAAVN
     I              B4AADT                      WBAADT
     I              B4AMTM                      WBAMTM
     I              B4AJST                      WBAJST
     I              B4AHVN                      WBAHVN
     I              B4AGVN                      WBAGVN
     I              B4ABVN                      WBABVN
     I              B4ABDT                      WBABDT
     I              B4ABTM                      WBABTM
      *
     I@EAREZ8
      * Fax Detail                Update index
      * Renamed input format fields
     I              EAHHCD                      WCHHCD
     I              EANYTX                      WCNYTX
     I              EAFDFN                      WCFDFN
     I              EANXTX                      WCNXTX
     I              EAAAVN                      WCAAVN
     I              EAAADT                      WCAADT
     I              EAAMTM                      WCAMTM
     I              EAAJST                      WCAJST
     I              EAAHVN                      WCAHVN
     I              EAAGVN                      WCAGVN
     I              EAABVN                      WCABVN
     I              EAABDT                      WCABDT
     I              EAABTM                      WCABTM
      *
     I@E3CPF3
      * MPR Producer Purch Type   Update index
      * Renamed input format fields
     I              E3ABCD                      WDABCD
     I              E3C0A1                      WDC0A1
     I              E3AAVN                      WDAAVN
     I              E3AADT                      WDAADT
     I              E3AMTM                      WDAMTM
     I              E3AJST                      WDAJST
     I              E3AHVN                      WDAHVN
     I              E3AGVN                      WDAGVN
     I              E3ABVN                      WDABVN
     I              E3ABDT                      WDABDT
     I              E3ABTM                      WDABTM
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1ABCD        PARM                    WP0001                         PD Producer Cod
     C     P2EVTX        PARM                    WP0002                         Oms System Valu
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Repeat forever
     C                   DO        *HIVAL
      * Display and process key screen
     C                   EXSR      BADSKY
     C                   END
      *****************************************************************
      /EJECT
     CSR   BADSKY        BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                   IF        W0BYP = ' '
     C                   MOVEL     'Y'           W0BYP
     C                   END
      * Initialize key screen
     C                   EXSR      MDIZ#K
      * Signal start of transaction
     C                   MOVEL     'Y'           W0TRN
      * Ensure transaction continues (if reset)
     C                   DOW       W0TRN = 'Y' OR
     C                             W0TRN = 'K'
     C                   MOVEL     'Y'           W0TRN
      * Conduct screen conversation
      * Is bypass key screen still viable?
     C                   DOW       W0TRN = 'Y'
     C                   IF        W0BYP = 'Y'
      * One or more key fields is blank
      * HOME: Reset screen fields
     C                   IF        #1ABCD = ' ' OR
     C                             *IN30
     C                   MOVEL     'N'           W0BYP
     C                   END
     C                   END
      * Bypass key screen
      * Display key screen
     C                   IF        W0BYP = 'N'
     C                   EXSR      BBEXFM
     C                   END
      * Cancel key screen bypass
     C                   MOVEL     'N'           W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09              CAS                     BCCHMD
      * HOME: Reset screen fields
     C   30              CAS                     BDHMKY
      * Process key screen input
     C                   CAS                     BEPRKY
     C                   END
     C                   DOW       W0TRN = 'R'
     C                   MOVEL     'Y'           W0TRN
     C                   EXSR      BEPRKY
     C                   END
      *
     C                   END
     C                   END
      *================================================================
     CSR   BAEXIT        ENDSR
      /EJECT
     CSR   BBEXFM        BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                   EXSR      GADSAK
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * PUTOVR unless conditioned fields change
     C                   SETON                                            86    *
     C                   IF        *IN89 <> BBIN89
     C                   SETOFF                                           86    *
     C                   END
     C                   MOVE      *IN89         BBIN89
     C                   MOVEL     'K'           W0GRP
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #RCDKEY
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS
      * Reset global error indicator
     C                   SETOFF                                           99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   BBEXIT        ENDSR
      /EJECT
     CSR   BCCHMD        BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C                   IF        W0PMD = 'ADD'
     C                   MOVEL     'CHG'         W0PMD
     C                   ELSE
     C                   MOVEL     'ADD'         W0PMD
     C                   END
      *================================================================
     CSR   BCEXIT        ENDSR
      /EJECT
     CSR   BDHMKY        BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                   MOVEL     'N'           W0TRN
      *================================================================
     CSR   BDEXIT        ENDSR
      /EJECT
     CSR   BEPRKY        BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                   EXSR      MAIZ#1
      * Validate key fields
     C                   EXSR      BFVLKY
     C     *IN99         CABEQ     '1'           BEEXIT
     C     YPMTFD        CABNE     *BLANKS       BEEXIT
      * Check for existing record
     C     KRTV          KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ABCD        ACABCD
     C     KRTV          CHAIN     @ACREAI                            9091      *
      * Record locked
     C                   IF        *IN91
     C                   SETON                                        9931      *
     C                   GOTO      BEEXIT
     C                   END                                                    FI 91
      *
      * If record does not exist, flip to add mode
     C                   IF        *IN90
     C                   MOVEL     'ADD'         W0PMD
      * USER: Initialize detail screen (new record)
     C                   MOVEL     'P'           #1IWST                         PD Freight Exp
     C                   MOVEL     'A'           #1AJST                         RS Record Statu
     C                   MOVEL     'N'           #DGNST                         Vendor 1099
      * DTL.Frt Exp Pay By Desc Usr = Condition name of DTL.PD Freight Ex
     C                   CALL      'PKRVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1191734       Y2LSNO                         List number
     C                   PARM      #1IWST        W0INVL                         PD Freight Exp
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     #DLVTX        PARM                    W0CNNM                         Frt Exp Pay By
      *
     C                   Z-ADD     P1GJNB        #1GJNB                         PD EDI Trading
     C                   ELSE
      * If record does exist, flip to change mode
     C                   MOVEL     'CHG'         W0PMD
      * Load screen fields from DBF
     C                   EXSR      MBFL#1
      * CALC: Detail screen function fields
      * R10690 JJH 06/07/17 - No longer required, Adderss is now Input
      * USER: Initialize detail screen (existing record)
      * E3580 CGL 11/11/14 - M3 Vendor interfaces changes
      * R10690 JJH 06/06/17 - Hide Code that is no longer valid
      * R10690 JJH 06/06/17 - Display Producer Address
      * Rtv Producer Address  XF - Producer Address  * 
     C                   CALL      'PWCZXFR'                            90      Rtv Producer Ad
     C                   PARM      *BLANK        W0RTN
     C                   PARM      ACABCD        WQ0001                         PD Producer Cod
     C                   PARM      *ZERO         WQ0002                         Address Number
     C                   PARM      *BLANK        WQ0003                         Pass Name
     C     #DAITX        PARM      *BLANK        WQ0004                         Address 1
     C     #DAJTX        PARM      *BLANK        WQ0005                         Address 2
     C     #DDCTX        PARM      *BLANK        WQ0006                         Address 3
     C     #DAKTX        PARM      *BLANK        WQ0007                         City
     C     #DANST        PARM      *BLANK        WQ0008                         State
     C     #DCJTX        PARM      *BLANK        WQ0009                         Zip
     C     #DC9TX        PARM      *BLANK        WQ0010                         Area Code
     C     #DDATX        PARM      *BLANK        WQ0011                         Telephone
     C     #DPFAC        PARM      *BLANK        WQ0012                         Fax Area Code #
     C     #DLQTX        PARM      *BLANK        WQ0013                         Fax Telephone
     C                   PARM      *BLANK        WQ0014                         Fax Attn 1
     C     #DLSTX        PARM      *BLANK        WQ0015                         Fax Area Code #
     C     #DLRTX        PARM      *BLANK        WQ0016                         Fax Telephone 2
     C                   PARM      *BLANK        WQ0017                         Fax Attn 2
     C                   PARM      *BLANK        WQ0018                         Vendor 1099
     C                   PARM      *BLANK        WQ0019                         Vendor Tax Id.
     C     #DEZCD        PARM      *BLANK        WQ0020                         Country Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PWCZXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Fax Attn 1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Producer Fax Area Cd  USR is Not Blank
      *   |- c2    : DTL.Producer Fax Phone #  USR is Not Blank
      *   '-
      * Rtv Fax Detail        RT - Fax Detail  * 
     C                   IF        #DPFAC <> ' ' OR
     C                             #DLQTX <> ' '
     C                   EXSR      SARVGN
     C                   END                                                    *FI
      * Fax Attn 2
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Fax Area Code # is Not Blank
      *   |- c2    : DTL.Fax Telephone is Not Blank
      *   '-
      * Rtv Fax Detail        RT - Fax Detail  * 
     C                   IF        #DLSTX <> ' ' OR
     C                             #DLRTX <> ' '
     C                   EXSR      SBRVGN
     C                   END                                                    *FI
      * R10690 JJH 06/06/17 - Display M3 Suppier Address
      * R17061 DN 08/11/21-Commented out 'Rtv Get M3 Supplier   IF' & mov
      * R17061 DN 08/11/21-Get M3 Supplier Info.
      * CASE: PAR.Live with M3   USR is Yes
      * Rtv Get M3 Supplier   IF
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                   IF        P3G4SS = 'Y'
     C                   EXSR      SCRVGN
      * Rtv M# Supplier       RT - M3 Supplier  * 
     C                   EXSR      SDRVGN
     C                   ELSE
      * CASE: *OTHERWISE
      * Rtv Get M3 Supplier   IF
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                   EXSR      SERVGN
      * Rtv M# Supplier       RT - M3 Supplier  * 
     C                   EXSR      SFRVGN
     C                   END                                                    *FI
      * R17061 DN 04/23/21-Get JDE E1 Info.
      * CASE: *OTHERWISE
      * Rtv Vendor Addr/FaxE1 UP - STR VND Common Routines  * 
     C                   MOVEL     'VNDFAXRE'    WXPGM
     C                   MOVE      '1 '          WXPGM
     C                   CALL      WXPGM                                90      Rtv Vendor Addr
     C     WUGUST        PARM      *BLANK        WQ0021                         *Return code
     C                   PARM      ACGCNB        WQ0022                         Address Number
     C     #DDVTX        PARM      *BLANK        WQ0023                         Pass Name
     C     #DDNTX        PARM      *BLANK        WQ0024                         Address 1
     C     #DDOTX        PARM      *BLANK        WQ0025                         Address 2
     C     #DDPTX        PARM      *BLANK        WQ0026                         Address 3
     C     #DDQTX        PARM      *BLANK        WQ0027                         City
     C     #DDRTX        PARM      *BLANK        WQ0028                         State
     C     #DDSTX        PARM      *BLANK        WQ0029                         Zip
     C     #DDTTX        PARM      *BLANK        WQ0030                         Area Code
     C     #DDUTX        PARM      *BLANK        WQ0031                         Telephone
     C     #DHGT1        PARM      *BLANK        WQ0032                         Fax Area Code #
     C     #DHIT1        PARM      *BLANK        WQ0033                         Fax Telephone
     C     #DNGTX        PARM      *BLANK        WQ0034                         Fax Area Code #
     C     #DNHTX        PARM      *BLANK        WQ0035                         Fax Telephone 2
     C     #DGNST        PARM      *BLANK        WQ0036                         Vendor 1099
     C     #DDXTX        PARM      *BLANK        WQ0037                         Vendor Tax Id.
     C     #DE0CD        PARM      *BLANK        WQ0038                         Country Code
     C                   PARM      *BLANK        WQ0039                         Producer/Trucke
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   MOVEL     'VNDFAXRE'    W0CLPG
     C                   MOVE      '1 '          W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
      * CASE: WRK.Vendor Return Code Usr is Vendor Error
     C                   IF        WUGUST = 'ERR'
     C                   EVAL      #DDNTX = ' '                                 Address 1
     C                   MOVEL     @CN(001)      #DDNTX                         Address 1
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   END                                                    *FI
      * R10690 JJH 06/06/17 - Initialization for Existing Producer fields
     C                   MOVEL     'CHG'         W0PMD                          *Program mode
      * DTL.Record Status Desc Usr = Condition name of DB1.RS Record Stat
     C                   CALL      'PKRVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1100087       Y2LSNO                         List number
     C                   PARM      ACAJST        W0INVL                         RS Record Statu
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     #DD6TX        PARM                    W0CNNM                         Record Status D
      *
      * Rtv Alt Prd Py Nm&Vn# XF - Producer EXT  * 
     C                   CALL      'PLO7XFR'                            90      Rtv Alt Prd Py
     C                   PARM      *BLANK        W0RTN
     C                   PARM      #1ABCD        WQ0040                         PD Producer Cod
     C     #DPBCD        PARM      #DPBCD        WQ0041                         Alt Producer Pa
     C     #DSVA1        PARM      #DSVA1        WQ0042                         Alt Prod Payee
     C     #DR6CD        PARM      #DR6CD        WQ0043                         M3 Supplier ID
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PLO7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Validate PD EDI Trading Partner #
      * CASE: DB1.PD EDI Trading Partner # is Not zero
      * RTV Val Edi#          RT - Producer  * 
     C                   IF        ACGJNB <> 0
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
      * Rtv Source Desc       RT - Source  * 
     C                   EXSR      SHRVGN
      * Rtv Hog Buyer Name    RT - Hog Buyer  * 
     C                   EXSR      SIRVGN
      * Rtv Producer Name     RT - Producer  * Commission Producer
     C                   EXSR      SJRVGN
      * DTL.Frt Exp Pay By Desc Usr = Condition name of DTL.PD Freight Ex
     C                   CALL      'PKRVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1191734       Y2LSNO                         List number
     C                   PARM      #1IWST        W0INVL                         PD Freight Exp
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     #DLVTX        PARM                    W0CNNM                         Frt Exp Pay By
      *
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                   EXSR      SKRVGN
     C                   MOVEL     'N'           #DGNST                         Vendor 1099
      * Rtv MPR Purch Desc    RT - MPR Purchase Type  * 
     C                   EXSR      SLRVGN
      * 12/03/2018 JBB E14180 - Retrieve HPS Automation flag
      * Rtv HPS Automation    RT - Producer EXT  * 
     C                   EXSR      SMRVGN
      * Populate HPS Automation description
      * CASE: DTL.HPS Automation Y/N Usr is N
     C                   IF        #DJTSS = 'N'
     C                   EVAL      #DGBT1 = ' '                                 Yes/No Text USR
     C                   MOVEL     'No'          #DGBT1                         Yes/No Text USR
     C                   ELSE
      * CASE: DTL.HPS Automation Y/N Usr is Y
     C                   IF        #DJTSS = 'Y'
     C                   MOVEL     'Yes'         #DGBT1                         Yes/No Text USR
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      #DGBT1 = ' '                                 Yes/No Text USR
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END
      *..................................................
     C   99              GOTO      BEEXIT
      *
      * No error: Display and process details
     C                   IF        YPMTFD = ' '
     C                   EXSR      CADSDA
     C                   END
      *
      *================================================================
     CSR   BEEXIT        ENDSR
      /EJECT
     CSR   BFVLKY        BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Select existing record
     C                   IF        W0PMD <> 'ADD' OR
     C                             YPMTFD <> ' '
     C                   EXSR      VACKRL
     C                   END
      * PD Producer Code required
     C                   IF        #1ABCD = ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        9931      *
      * Send message '*Value required'
     C                   MOVEL     'Y2U0001'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI
      *================================================================
     CSR   BFEXIT        ENDSR
      /EJECT
     CSR   CADSDA        BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
      * Display detail screen
     C                   DOW       W0TRN = 'Y'
     C                   EXSR      CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * Redisplay previous screen
     C   12              CAS                     CCDSPV
      * HOME: Reset screen fields
     C   30              CAS                     CCDSPV
      * Process detail screen input
     C                   CAS                     CFPRSC
     C                   END
     C                   IF        W0TRN = 'R'
     C                   IF        W0PMD = 'ADD'
     C                   EXSR      MAIZ#1
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   CBEXFM        BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                   EXSR      GBDSAD
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * PUTOVR unless conditioned fields change
     C                   SETON                                            86    *
     C                   IF        *IN89 <> CBIN89
     C                   SETOFF                                           86    *
     C                   END
     C                   MOVE      *IN89         CBIN89
     C                   MOVEL     '1'           W0GRP
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y1SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT2
     C                   EXFMT     #RCDDTL1
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS
      * Reset global error indicator
     C                   SETOFF                                           99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CBEXIT        ENDSR
      /EJECT
     CSR   CCDSPV        BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30              MOVEL     'R'           W0TRN
     C   12              MOVEL     'K'           W0TRN
      *================================================================
     CSR   CCEXIT        ENDSR
      /EJECT
     CSR   CFPRSC        BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * Validate details
     C                   EXSR      DCVLDL
      * QUIT if error:
     C   99              GOTO      CFEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           CFEXIT
      * Prompt for confirmation
     C                   EXSR      EAPMCF
      * Quit if not confirmed
     C                   IF        *IN99
     C                   SETOFF                                       99
     C                   GOTO      CFEXIT
     C                   END
      * No error: update record
     C                   EXSR      EBPR##
      *================================================================
     CSR   CFEXIT        ENDSR
      /EJECT
     CSR   DCVLDL        BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                   EXSR      GBDSAD
      * USER: Validate detail screen fields
      * R10690 JJH 06/07/17 - Options no longer required
      * F15=M3 Supplier Nbr Search
      * CASE: DTL.*CMD key is CF15
     C                   IF        YPMTFD = ' '
      * CASE: PAR.Live with M3   USR is Live or Parallel
     C                   IF        *IN15
      * T8163 DN  01/16/17 - Set M3 Supplier Group as Producer.
     C                   IF        P3G4SS = 'P' OR
     C                             P3G4SS = 'Y'
     C                   MOVEL     'ZHP'         YL0001                         M3 Supplier Gro
      * Live or Parallel
      * CASE: PAR.Live with M3   USR is Yes
      * Sel M3 Suplr Same Div/Grp - M3 Supplier  * 
     C                   IF        P3G4SS = 'Y'
     C                   CALL      'PLX1SRR'                            90      Sel M3 Suplr Sa
     C                   PARM      *BLANK        W0RTN
     C     #DQHCD        PARM      #DQHCD        WQ0045                         M3 Supplier ID
     C     #1AGTX        PARM      #1AGTX        WQ0046                         M3 Supplier Nam
     C     #DAITX        PARM      #DAITX        WQ0047                         M3 Address Line
     C     #DAJTX        PARM      #DAJTX        WQ0048                         M3 Address Line
     C     #DDCTX        PARM      #DDCTX        WQ0049                         M3 Address Line
     C     YL0002        PARM      YL0002        WQ0050                         M3 Address Line
     C     #DAKTX        PARM      #DAKTX        WQ0051                         M3 City
     C     #DANST        PARM      #DANST        WQ0052                         M3 State
     C     #DCJTX        PARM      #DCJTX        WQ0053                         M3 Postal Code
     C     YL0003        PARM      YL0003        WQ0054                         M3 Telephone No
     C     YL0004        PARM      YL0004        WQ0055                         M3 Telephone No
     C     YL0005        PARM      YL0005        WQ0056                         M3 Fax Telephon
     C     #DDXTX        PARM      #DDXTX        WQ0057                         M3 Supplier Tax
     C     #DEZCD        PARM      #DEZCD        WQ0058                         M3 Country Code
     C     YL0001        PARM      YL0001        WQ0059                         M3 Supplier Gro
     C     P4R8CD        PARM      P4R8CD        WQ0060                         M3 Supplier Div
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PLX1SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     3             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00016 OR
     C                             ZQ > 00016
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0003:ZQ     #DC9TX                 90      Producer Area C
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     8             YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00016 OR
     C                             ZQ > 00016
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0003:ZQ     #DDATX                 90      Producer Phone
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     3             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00016 OR
     C                             ZQ > 00016
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0005:ZQ     #DPFAC                 90      Producer Fax Ar
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   Z-ADD     8             YRSW00
     C                   Z-ADD     5             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00016 OR
     C                             ZQ > 00016
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0005:ZQ     #DLQTX                 90      Producer Fax Ph
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   MOVEL     'N'           #DGNST                         Vendor 1099
     C                   ELSE
      * CASE: *OTHERWISE
      * Sel M3 Suplr Same Div/Grp - M3 Supplier  * 
     C                   CALL      'PLX1SRR'                            90      Sel M3 Suplr Sa
     C                   PARM      *BLANK        W0RTN
     C     #DQHCD        PARM      #DQHCD        WQ0061                         M3 Supplier ID
     C     YL0006        PARM      YL0006        WQ0062                         M3 Supplier Nam
     C     YL0007        PARM      YL0007        WQ0063                         M3 Address Line
     C     YL0008        PARM      YL0008        WQ0064                         M3 Address Line
     C     YL0009        PARM      YL0009        WQ0065                         M3 Address Line
     C     YL0002        PARM      YL0002        WQ0066                         M3 Address Line
     C     YL0010        PARM      YL0010        WQ0067                         M3 City
     C     YL0011        PARM      YL0011        WQ0068                         M3 State
     C     YL0012        PARM      YL0012        WQ0069                         M3 Postal Code
     C     YL0003        PARM      YL0003        WQ0070                         M3 Telephone No
     C     YL0004        PARM      YL0004        WQ0071                         M3 Telephone No
     C     YL0005        PARM      YL0005        WQ0072                         M3 Fax Telephon
     C     YL0013        PARM      YL0013        WQ0073                         M3 Supplier Tax
     C     YL0014        PARM      YL0014        WQ0074                         M3 Country Code
     C     YL0001        PARM      YL0001        WQ0075                         M3 Supplier Gro
     C     P4R8CD        PARM      P4R8CD        WQ0076                         M3 Supplier Div
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PLX1SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * F4=Prompt   MPR Purchase Type Code
      * CASE: DTL.*CMD key is *Prompt
      * CASE: PGM.*Cursor field <IS> DTL.MPR Purchase Type Code
     C                   IF        *IN04
     C                   IF        W0CFL = '#DC0A1'
     C                   Z-ADD     *ZERO         YL0015                         MPR Purchase Ty
      * Sel MPR Purchase Type SR - MPR Purchase Type  * 
     C                   CALL      'PKV8SRR'                            90      Sel MPR Purchas
     C                   PARM      *BLANK        W0RTN
     C     YL0015        PARM      YL0015        WQ0077                         MPR Purchase Ty
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKV8SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.MPR Purchase Type Code NE DTL.MPR Purchase Type
      *   |- c2    : LCL.MPR Purchase Type Code is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0015 <> #DC0A1
     C                   IF        YL0015 > 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     YL0015        #DC0A1                         MPR Purchase Ty
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * R10690 JJH 06/07/17 - Add option
      * R17061 DN 04/26/21-Replaced M3 Supplier Prompt with JDE E1 Vendor
      * F13=Select Vendor.                            R17061 DN 07/28/21
      * CASE: DTL.*CMD key is CF13
      * Save Before Screen Values.
      * CASE: *OTHERWISE
     C                   IF        *IN13
     C                   Z-ADD     #1GCNB        P1GCNB                         PD VND Address
     C                   MOVEL     #DDVTX        P6DVTX                         Pass Name
     C                   MOVEL     #DDNTX        P6DNTX                         Address 1
     C                   MOVEL     #DDOTX        P6DOTX                         Address 2
     C                   MOVEL     #DDPTX        P6DPTX                         Address 3
     C                   MOVEL     #DDQTX        P6DQTX                         City
     C                   MOVEL     #DDRTX        P6DRTX                         State
     C                   MOVEL     #DDSTX        P6DSTX                         Zip
     C                   MOVEL     #DDTTX        P6DTTX                         Area Code
     C                   MOVEL     #DDUTX        P6DUTX                         Telephone
     C                   MOVEL     #DHGT1        P6LSTX                         Fax Area Code #
     C                   MOVEL     #DHIT1        P6LRTX                         Fax Telephone
     C                   MOVEL     #DNGTX        P6NGTX                         Fax Area Code #
     C                   MOVEL     #DNHTX        P6NHTX                         Fax Telephone 2
     C                   MOVEL     #DGNST        P6GNST                         Vendor 1099
     C                   MOVEL     #DDXTX        P6DXTX                         Vendor Tax Id.
     C                   MOVEL     #DE0CD        P6E0CD                         Country Code
      * TOOK OFF STS, ADDED SEARCH TYPE TO USE IN VNDFAXSE1
      * R17061 DN 08/02/21-Replaced VNDFAXSE1 with E1MUSRR Select Record.
      * Sel Vendor w/Name  E1 XF - STR VND Common Routines  * 
     C                   CALL      'E1MVXFR'                            90      Sel Vendor w/Na
     C                   PARM      *BLANK        W0RTN
     C     #1GCNB        PARM      *ZERO         WQ0078                         Address Number
     C     #DDVTX        PARM      *BLANK        WQ0079                         Pass Name
     C     #DDNTX        PARM      *BLANK        WQ0080                         Address 1
     C     #DDOTX        PARM      *BLANK        WQ0081                         Address 2
     C     #DDPTX        PARM      *BLANK        WQ0082                         Address 3
     C     #DDQTX        PARM      *BLANK        WQ0083                         City
     C     #DDRTX        PARM      *BLANK        WQ0084                         State
     C     #DDSTX        PARM      *BLANK        WQ0085                         Zip
     C     #DDTTX        PARM      *BLANK        WQ0086                         Area Code
     C     #DDUTX        PARM      *BLANK        WQ0087                         Telephone
     C     #DHGT1        PARM      *BLANK        WQ0088                         Fax Area Code #
     C     #DHIT1        PARM      *BLANK        WQ0089                         Fax Telephone
     C     #DNGTX        PARM      *BLANK        WQ0090                         Fax Area Code #
     C     #DNHTX        PARM      *BLANK        WQ0091                         Fax Telephone 2
     C     #DGNST        PARM      *BLANK        WQ0092                         Vendor 1099
     C     #DDXTX        PARM      *BLANK        WQ0093                         Vendor Tax Id.
     C     #DE0CD        PARM      *BLANK        WQ0094                         Country Code
     C                   PARM      YL0016        WQ0095                         Search Type 3A
     C                   PARM      YL0017        WQ0096                         Business Unit/C
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1MVXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Vendor Selected?
      * CASE: DTL.PD VND Address Number is Zero
      * No Vendor Selected. Revert Before Screen Values.
      * CASE: *OTHERWISE
     C                   IF        #1GCNB = 0
     C                   Z-ADD     P1GCNB        #1GCNB                         PD VND Address
     C                   MOVEL     P6DVTX        #DDVTX                         Pass Name
     C                   MOVEL     P6DNTX        #DDNTX                         Address 1
     C                   MOVEL     P6DOTX        #DDOTX                         Address 2
     C                   MOVEL     P6DPTX        #DDPTX                         Address 3
     C                   MOVEL     P6DQTX        #DDQTX                         City
     C                   MOVEL     P6DRTX        #DDRTX                         State
     C                   MOVEL     P6DSTX        #DDSTX                         Zip
     C                   MOVEL     P6DTTX        #DDTTX                         Area Code
     C                   MOVEL     P6DUTX        #DDUTX                         Telephone
     C                   MOVEL     P6LSTX        #DHGT1                         Fax Area Code #
     C                   MOVEL     P6LRTX        #DHIT1                         Fax Telephone 1
     C                   MOVEL     P6NGTX        #DNGTX                         Fax Area Code #
     C                   MOVEL     P6NHTX        #DNHTX                         Fax Telephone 2
     C                   MOVEL     P6GNST        #DGNST                         Vendor 1099
     C                   MOVEL     P6DXTX        #DDXTX                         Vendor Tax Id.
     C                   MOVEL     P6E0CD        #DE0CD                         Country Code
     C                   MOVEL     'Y'           W0DCF                          *Defer confirm
     C                   ELSE
      * CASE: *OTHERWISE
      * Vendor Changed, Proceed to Confirm.
      * CASE: DTL.PD VND Address Number NE PAR.PD VND Address Number
     C                   IF        #1GCNB <> P1GCNB
     C                   MOVEL     'N'           W0DCF                          *Defer confirm
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * DTL.Record Status Desc Usr = Condition name of DTL.RS Record Stat
     C                   CALL      'PKRVC2R'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1100087       Y2LSNO                         List number
     C                   PARM      #1AJST        W0INVL                         RS Record Statu
     C                   PARM      ' '           W0VLMP                         Value mapped
     C     #DD6TX        PARM                    W0CNNM                         Record Status D
      *
      * Rtv Source Desc       RT - Source  * 
     C                   EXSR      SNRVGN
      * Rtv Hog Buyer Name    RT - Hog Buyer  * 
     C                   EXSR      SORVGN
      * Rtv Producer Name     RT - Producer  * 
     C                   EXSR      SPRVGN
      * Rtv Alt Prd Py Nm&Vn# XF - Producer EXT  * 
     C                   CALL      'PLO7XFR'                            90      Rtv Alt Prd Py
     C                   PARM      *BLANK        W0RTN
     C                   PARM      #1ABCD        WQ0097                         PD Producer Cod
     C     #DPBCD        PARM      #DPBCD        WQ0098                         Alt Producer Pa
     C     #DSVA1        PARM      #DSVA1        WQ0099                         Alt Prod Payee
     C     #DR6CD        PARM      #DR6CD        WQ0100                         M3 Supplier ID
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PLO7XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * R10690 JJH 06/07/17 - Validation of JDE Vendor no longer required
      * Validate MPR Purchase Type Code
      * CASE: DTL.MPR Purchase Type Code NE WRK.Zero USR
     C                   IF        #DC0A1 <> WUE9NB
     C                   EVAL      W0RTN = ' '                                  *Return code
      * Val MPR Purchase Type RT - MPR Purchase Type  * 
     C                   EXSR      SQRVGN
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'MPR Purchase Type      NF'
     C                   MOVEL     'PRK0965'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Validate PD EDI Trading Partner #
      * CASE: LCL.EDI Allow Changes is Yes
     C                   IF        YL0018 = 'Y'
     C                   EVAL      W0RTN = ' '                                  *Return code
      * CASE: DTL.PD EDI Trading Partner # is Not zero
      * RTV Val Edi#          RT - Producer  * 
     C                   IF        #1GJNB <> 0
     C                   EXSR      SRRVGN
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * This number must exists on at least one producer for a user to ch
      * or enter this number.
      * Setup message data for message
     C                   Z-ADD     #1GJNB        ZA0001                         PD EDI Trading
      * Send message 'EDI# does not exists'
     C                   MOVEL     'PRK1164'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * R17061 DN 07/28/21-Do NOT Allow JDE Vendor for Input. Use F13.
      *        Commented Out Validation Logic.
     C                   END
      * Check relations
      * Check reference to Source
     C                   EXSR      VBCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Hog Buyer
     C                   EXSR      VCCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Producer
     C                   EXSR      VDCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * CALC: Detail screen function fields
      * R10690 JJH 06/07/17 - No longer required, Adderss is now Input
     C                   IF        YPMTFD = ' '
     C                   END
      * USER: Validate detail screen relations
      * E11442 JJH 08/21 - Validation for M3 Supplier Division/Group
      * R17061 DN 04/27/21-Commented Out. No Longer Used.
     C                   IF        YPMTFD = ' '
     C                   END
      *================================================================
     CSR   DCEXIT        ENDSR
      /EJECT
     CSR   EAPMCF        BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Set screen conditioning indicators
     C                   EXSR      GBDSAD
      * Force PUTOVR
     C                   SETON                                            86    *
      * Update screen time
     C                   TIME                    ##TME
      * Refresh screen
     C                   EVAL      ##CFCD = ' '
     C                   MOVEL     'N'           ##CFCD
      * Save CMD keys
     C                   MOVEA     *IN           WN30
     C                   SETOFF                                       29        *
      * Generate internal/external key list
     C     KINEX         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2INVL
      * Convert *CONFIRM to external value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2INVL = ' '
     C                   MOVEL     ##CFCD        Y2INVL                         *CONFIRM
     C     KINEX         CHAIN     @Y2INEX                            90        *
     C  N90              MOVEL     Y2EXVL        V#CFCD                         *CONFIRM
      *
     C                   DOU       W0HLP = 'N' AND
     C                             NOT *IN29
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT2
     C                   WRITE     #RCDDTL1
     C                   EXFMT     #CONFIRM
     C                   IF        *IN29
     C                   SETON                                        99
     C                   GOTO      EAEXIT
     C                   END
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
      * Validate *CONFIRM
     C                   EVAL      W0RTN = ' '
     C                   MOVEL     V#CFCD        W0NSRQ                         *CONFIRM
      * Name search required?
     C                   IF        W0NSRQ = '?' OR
     C                             'V#CFCD' = YPMTFD
     C                   CALL      'PKVLLSR'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1001713       Y2LSNO
     C     V#CFCD        PARM      V#CFCD        W0EXVL                         *CONFIRM
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   IF        W0NSRQ <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
     C                   END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C     KEXIN         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2EXVL
      * Convert *CONFIRM to internal value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2EXVL = ' '
     C                   MOVEL     V#CFCD        Y2EXVL                         *CONFIRM
     C     KEXIN         CHAIN     @Y2EXIN                            90        *
     C                   IF        *IN90
     C                   EVAL      ##CFCD = ' '
     C                   IF        YPMTFD = ' '
     C                   SETON                                        96        *
     C                   WRITE     #CONFIRM
     C                   SETOFF                                       96        *
     C                   END
     C                   ELSE
     C                   MOVEL     Y2INVL        ##CFCD                         *CONFIRM
     C                   END
      *
     C   90              SETON                                        29        *
     C  N90              SETOFF                                       29        *
     C                   END
      * Restore CMD keys
     C                   MOVEA     WN30          *IN
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   IF        ##CFCD = 'Y'
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   END
     C     ##CFCD        COMP      'Y'                                9999      *
      * Not confirmed
      *================================================================
     CSR   EAEXIT        ENDSR
      /EJECT
     CSR   EBPR##        BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C     W0PMD         CASEQ     'ADD'         ECADRQ
      * Process update request
     C     W0PMD         CASNE     'ADD'         EECHRQ
     C                   END
      * USER: Process command keys
      * CASE: PGM.*Program mode is *CHANGE
     C                   IF        W0RTN = ' '
     C                   IF        W0PMD = 'CHG'
     C                   MOVEL     W0RTN         P0RTN                          *Return code
     C                   EXSR      ZYEXPG
     C                   END                                                    *FI
      * Restart program for next record
     C                   MOVEL     'N'           W0TRN
     C                   END
      *================================================================
     CSR   EBEXIT        ENDSR
      /EJECT
     CSR   ECADRQ        BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      *
     C                   EVAL      WN0001 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0002                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0003                         RS Time Changed
     C                   EVAL      WN0004 = ' '                                 RS Record Statu
     C                   EVAL      WN0005 = ' '                                 RS Job
     C                   EVAL      WN0006 = ' '                                 RS Program
     C                   EVAL      WN0007 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0008                         RS Date Added
     C                   Z-ADD     *ZERO         WN0009                         RS Time Added
      *
      * Crt Producer/Prd Addr IF
      * Crt Producer          CT - Producer  * 
     C                   EXSR      SSCRRC
      * Crt Producer EXT2     CT - Producer EXT2  * 
     C                   EXSR      STCRRC
      * Crt Producer Address  CR - Producer Address  * 
     C                   EXSR      SUCRRC
      * Fax Attn 1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Fax Area Code # is Not Blank
      *   |- c2    : PAR.Fax Telephone is Not Blank
      *   '-
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
     C                   IF        #DPFAC <> ' ' OR
     C                             #DLQTX <> ' '
     C                   EXSR      SVRVGN
     C                   END                                                    *FI
      * Fax Attn 2
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Fax Area Code # 2 is Not Blank
      *   |- c2    : PAR.Fax Telephone 2 is Not Blank
      *   '-
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
     C                   IF        #DLSTX <> ' ' OR
     C                             #DLRTX <> ' '
     C                   EXSR      SYRVGN
     C                   END                                                    *FI
      * MPR Producer Purchase Type
      * CASE: PAR.MPR Purchase Type Code is Entered
      * Rtv/Crt/Chg MPR PrPur RT - MPR Producer Purch Type  * 
     C                   IF        #DC0A1 > 0
     C                   EXSR      TBRVGN
     C                   END                                                    *FI
      * Send message '*Record added'
     C                   IF        W0RTN = ' '
     C                   MOVEL     'Y2U0011'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
      *================================================================
     CSR   ECEXIT        ENDSR
      /EJECT
     CSR   EECHRQ        BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      *
     C                   EVAL      WN0064 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0065                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0066                         RS Time Changed
     C                   EVAL      WN0067 = ' '                                 RS Job
     C                   EVAL      WN0068 = ' '                                 RS Program
     C                   EVAL      WN0069 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0070                         RS Date Added
     C                   Z-ADD     *ZERO         WN0071                         RS Time Added
      *
      * Chg Producer/Prd Addr IF
      * Chg Producer          CH - Producer  * 
     C                   EXSR      TFCHRC
      * Chg Producer Address  CH - Producer Address  * 
     C                   EXSR      TGCHRC
      * Chg Producer EXT2     CH - Producer EXT2  * 
     C                   EXSR      THCHRC
      * Fax Attn 1
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Fax Area Code # is Not Blank
      *   |- c2    : PAR.Fax Telephone is Not Blank
      *   '-
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
     C                   IF        #DPFAC <> ' ' OR
     C                             #DLQTX <> ' '
     C                   EXSR      TJRVGN
     C                   END                                                    *FI
      * Fax Attn 2
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Fax Area Code # 2 is Not Blank
      *   |- c2    : PAR.Fax Telephone 2 is Not Blank
      *   '-
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 2
     C                   IF        #DLSTX <> ' ' OR
     C                             #DLRTX <> ' '
     C                   EXSR      TMRVGN
     C                   END                                                    *FI
      * MPR Producer Purchase Type
      * CASE: PAR.MPR Purchase Type Code is Entered
      * Rtv/Crt/Chg MPR PrPur RT - MPR Producer Purch Type  * 
     C                   IF        #DC0A1 > 0
     C                   EXSR      TPRVGN
     C                   END                                                    *FI
      * Data update error
      * Reset screen fields if changed record
     C                   IF        W0RTN <> ' '
     C     W0RTN         CASEQ     'Y2U0007'     MBFL#1
     C                   END
     C                   ELSE
      * Send message '*Record changed'
     C                   IF        YGRDC = 'Y'
     C                   MOVEL     'Y2U0012'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *================================================================
     CSR   EEEXIT        ENDSR
      /EJECT
     CSR   GADSAK        BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C     W0PMD         COMP      'ADD'                                  89    *
      *================================================================
     CSR   GAEXIT        ENDSR
      /EJECT
     CSR   GBDSAD        BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C     W0PMD         COMP      'ADD'                                  89    *
      * Protect key fields on detail screen
     C                   SETON                                        88        *
     C                   MOVEL     '0'           *IN79
     C                   IF        P3G4SS = 'N'
     C                   MOVEL     '1'           *IN79
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN78
     C                   IF        W0PMD = 'ADD'
     C                   MOVEL     '1'           *IN78
     C                   END                                                    *FI
     C                   MOVEL     '0'           *IN77
     C                   IF        #DPBCD <> ' '
     C                   MOVEL     '1'           *IN77
     C                   END                                                    *FI
      * Enable key screen
     C                   SETON                                        87        *
      *================================================================
     CSR   GBEXIT        ENDSR
      /EJECT
     CSR   MAIZ#1        BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                   EVAL      #DDXTX = ' '                                 Vendor Tax Id.
     C                   EVAL      #DGNST = ' '                                 Vendor 1099
     C                   EVAL      #DZNTX = ' '                                 M3 Supplier Nam
     C                   EVAL      #DZOTX = ' '                                 M3 Address Line
     C                   EVAL      #DZPTX = ' '                                 M3 Address Line
     C                   EVAL      #DZQTX = ' '                                 M3 Address Line
     C                   EVAL      #DZ5TX = ' '                                 M3 Address Line
     C                   EVAL      #DZSTX = ' '                                 M3 State
     C                   EVAL      #DZTTX = ' '                                 M3 Postal Code
     C                   EVAL      #DZ1TX = ' '                                 M3 Country Code
     C                   EVAL      #DZRTX = ' '                                 M3 City
     C                   EVAL      #DZVTX = ' '                                 M3 Telephone No
     C                   EVAL      #DZXTX = ' '                                 M3 Telephone No
     C                   EVAL      #DZZTX = ' '                                 M3 Fax Telephon
     C                   EVAL      #DZ0TX = ' '                                 M3 Supplier Tax
     C                   EVAL      #1APST = ' '                                 PD Fax Status
     C                   EVAL      #DR6CD = ' '                                 M3 Supplier ID
     C                   EVAL      #1C2TX = ' '                                 PD VND Category
     C                   EVAL      #1AAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         #1AADT                         RS Date Changed
     C                   Z-ADD     *ZERO         #1AMTM                         RS Time Changed
     C                   EVAL      #1AHVN = ' '                                 RS Job
     C                   EVAL      #1AGVN = ' '                                 RS Program
     C                   EVAL      #1ABVN = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         #1ABDT                         RS Date Added
     C                   Z-ADD     *ZERO         #1ABTM                         RS Time Added
     C                   Z-ADD     *ZERO         #1GCNB                         PD VND Address
     C                   EVAL      #DQHCD = ' '                                 M3 Supplier ID
     C                   EVAL      #1AGTX = ' '                                 PD Name
     C                   EVAL      #DDVTX = ' '                                 Pass Name
     C                   EVAL      #DAITX = ' '                                 Producer Addres
     C                   EVAL      #DDNTX = ' '                                 Address 1
     C                   EVAL      #DAJTX = ' '                                 Producer Addres
     C                   EVAL      #DDOTX = ' '                                 Address 2
     C                   EVAL      #DDCTX = ' '                                 Producer Addres
     C                   EVAL      #DDPTX = ' '                                 Address 3
     C                   EVAL      #DAKTX = ' '                                 Producer City
     C                   EVAL      #DDQTX = ' '                                 City
     C                   EVAL      #DANST = ' '                                 Producer State
     C                   EVAL      #DCJTX = ' '                                 Producer Zip 10
     C                   EVAL      #DEZCD = ' '                                 Country Code Us
     C                   EVAL      #DDRTX = ' '                                 State
     C                   EVAL      #DDSTX = ' '                                 Zip
     C                   EVAL      #DE0CD = ' '                                 Country Code
     C                   EVAL      #DC9TX = ' '                                 Producer Area C
     C                   EVAL      #DDATX = ' '                                 Producer Phone
     C                   EVAL      #DPFAC = ' '                                 Producer Fax Ar
     C                   EVAL      #DLQTX = ' '                                 Producer Fax Ph
     C                   EVAL      #DDTTX = ' '                                 Area Code
     C                   EVAL      #DDUTX = ' '                                 Telephone
     C                   EVAL      #DNVTX = ' '                                 Fax Attn 1
     C                   EVAL      #DHGT1 = ' '                                 Fax Area Code #
     C                   EVAL      #DHIT1 = ' '                                 Fax Telephone 1
     C                   EVAL      #DLSTX = ' '                                 Fax Area Code #
     C                   EVAL      #DLRTX = ' '                                 Fax Telephone
     C                   EVAL      #DNGTX = ' '                                 Fax Area Code #
     C                   EVAL      #DNHTX = ' '                                 Fax Telephone 2
     C                   EVAL      #DNWTX = ' '                                 Fax Attn 2
     C                   EVAL      #DJTSS = ' '                                 HPS Automation
     C                   EVAL      #DGBT1 = ' '                                 Yes/No Text USR
     C                   EVAL      #1AJST = ' '                                 RS Record Statu
     C                   EVAL      #DD6TX = ' '                                 Record Status D
     C                   EVAL      #DPBCD = ' '                                 Alt Producer Pa
     C                   EVAL      #1AACD = ' '                                 SR Source Code
     C                   EVAL      #DAFTX = ' '                                 SR Description
     C                   Z-ADD     *ZERO         #DSVA1                         Alt Prod Payee
     C                   EVAL      #1ACCD = ' '                                 HB Buyer Code
     C                   EVAL      #DBSTX = ' '                                 Name USR
     C                   EVAL      #1ADCD = ' '                                 Commission Prod
     C                   EVAL      #DCNTX = ' '                                 Name Producer U
     C                   Z-ADD     *ZERO         #1GJNB                         PD EDI Trading
     C                   Z-ADD     *ZERO         #1ALNB                         PD Production C
     C                   Z-ADD     *ZERO         #1AATH                         PD Std Delv Tim
     C                   Z-ADD     *ZERO         #1AMNB                         PD Std Truck Si
     C                   EVAL      #1IWST = ' '                                 PD Freight Exp
     C                   EVAL      #DLVTX = ' '                                 Frt Exp Pay By
     C                   Z-ADD     *ZERO         #DC0A1                         MPR Purchase Ty
     C                   EVAL      #DP5TX = ' '                                 MPR Purchase Ty
      *================================================================
     CSR   MAEXIT        ENDSR
      /EJECT
     CSR   MBFL#1        BEGSR
      *================================================================
      * Move @ACREAI fields to screen
      *================================================================
     C                   MOVEL     ACAPST        #1APST                         PD Fax Status
     C                   MOVEL     ACC2TX        #1C2TX                         PD VND Category
     C                   MOVEL     ACAAVN        #1AAVN                         RS User Changed
     C                   Z-ADD     ACAADT        #1AADT                         RS Date Changed
     C                   Z-ADD     ACAMTM        #1AMTM                         RS Time Changed
     C                   MOVEL     ACAHVN        #1AHVN                         RS Job
     C                   MOVEL     ACAGVN        #1AGVN                         RS Program
     C                   MOVEL     ACABVN        #1ABVN                         RS User Added
     C                   Z-ADD     ACABDT        #1ABDT                         RS Date Added
     C                   Z-ADD     ACABTM        #1ABTM                         RS Time Added
     C                   MOVEL     ACABCD        #1ABCD                         PD Producer Cod
     C                   Z-ADD     ACGCNB        #1GCNB                         PD VND Address
     C                   MOVEL     ACAGTX        #1AGTX                         PD Name
     C                   MOVEL     ACAJST        #1AJST                         RS Record Statu
     C                   MOVEL     ACAACD        #1AACD                         SR Source Code
     C                   MOVEL     ACACCD        #1ACCD                         HB Buyer Code
     C                   MOVEL     ACADCD        #1ADCD                         Commission Prod
     C                   Z-ADD     ACGJNB        #1GJNB                         PD EDI Trading
     C                   Z-ADD     ACALNB        #1ALNB                         PD Production C
     C                   Z-ADD     ACAATH        #1AATH                         PD Std Delv Tim
     C                   Z-ADD     ACAMNB        #1AMNB                         PD Std Truck Si
     C                   MOVEL     ACIWST        #1IWST                         PD Freight Exp
      * Hold existing record image
     C                   MOVEL     @1DBRC        #1DBRC
      *================================================================
     CSR   MBEXIT        ENDSR
      /EJECT
     CSR   MDIZ#K        BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                   MOVEL     P1ABCD        #1ABCD                         PD Producer Cod
      * USER: Initialize key screen
     C                   MOVEL     'ADD'         W0PMD                          *Program mode
      *================================================================
     CSR   MDEXIT        ENDSR
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Rtv Fax Detail        RT - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DPFAC        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLQTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSSA         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DNVTX = ' '                                 FD Fax Attentio
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     EANXTX        #DNVTX                         FD Fax Attentio
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Fax Detail        RT - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DLSTX        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLRTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSSB         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DNWTX = ' '                                 FD Fax Attentio
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     EANXTX        #DNWTX                         FD Fax Attentio
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    B4ABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     ACABCD        B4ABCD                         PD Producer Cod
      * Establish starting position
     C     KRSSC         CHAIN     @B4RET4                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK1329'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DQHCD = ' '                                 M3 Supplier ID
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     B4QHCD        #DQHCD                         M3 Supplier ID
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv M# Supplier       RT - M3 Supplier  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      #DZNTX = ' '                                 M3 Supplier Nam
     C                   EVAL      #DZOTX = ' '                                 M3 Address Line
     C                   EVAL      #DZPTX = ' '                                 M3 Address Line
     C                   EVAL      #DZQTX = ' '                                 M3 Address Line
     C                   EVAL      #DZRTX = ' '                                 M3 City
     C                   EVAL      #DZSTX = ' '                                 M3 State
     C                   EVAL      #DZTTX = ' '                                 M3 Postal Code
     C                   EVAL      #DZVTX = ' '                                 M3 Telephone No
     C                   EVAL      #DZXTX = ' '                                 M3 Telephone No
     C                   EVAL      #DZZTX = ' '                                 M3 Fax Telephon
     C                   EVAL      #DZ1TX = ' '                                 M3 Country Code
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    B2QHCD                         M3 Supplier ID
      * Setup key
     C                   MOVEL     #DQHCD        B2QHCD                         M3 Supplier ID
      * Establish starting position
     C     KRSSD         CHAIN     @B2RETY                            90        *
      * Data record not found
     C   90              MOVEL     'PRK1325'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     B2ZNTX        #DZNTX                         M3 Supplier Nam
     C                   MOVEL     B2ZOTX        #DZOTX                         M3 Address Line
     C                   MOVEL     B2ZPTX        #DZPTX                         M3 Address Line
     C                   MOVEL     B2ZQTX        #DZQTX                         M3 Address Line
     C                   MOVEL     B2ZRTX        #DZRTX                         M3 City
     C                   MOVEL     B2ZSTX        #DZSTX                         M3 State
     C                   MOVEL     B2ZTTX        #DZTTX                         M3 Postal Code
     C                   MOVEL     B2ZVTX        #DZVTX                         M3 Telephone No
     C                   MOVEL     B2ZXTX        #DZXTX                         M3 Telephone No
     C                   MOVEL     B2ZZTX        #DZZTX                         M3 Fax Telephon
     C                   MOVEL     B2Z1TX        #DZ1TX                         M3 Country Code
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    B4ABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     ACABCD        B4ABCD                         PD Producer Cod
      * Establish starting position
     C     KRSSE         CHAIN     @B4RET4                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK1329'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DQHCD = ' '                                 M3 Supplier ID
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     B4QHCD        #DQHCD                         M3 Supplier ID
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * Rtv M# Supplier       RT - M3 Supplier  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    B2QHCD                         M3 Supplier ID
      * Setup key
     C                   MOVEL     #DQHCD        B2QHCD                         M3 Supplier ID
      * Establish starting position
     C     KRSSF         CHAIN     @B2RETY                            90        *
      * Data record not found
     C   90              MOVEL     'PRK1325'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * RTV Val Edi#          RT - Producer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WQSG01                         PD EDI Trading
      * Setup key
     C                   Z-ADD     ACGJNB        WQSG01                         PD EDI Trading
      * Establish starting position
     C     KRSSG         SETLL     @ACRELJ                                      *
     C     KRSSG         READE     @ACRELJ                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0009'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SGEXIT                                       *QUIT
     C     KRSSG         READE     @ACRELJ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHRVGN        BEGSR
      *================================================================
      * Rtv Source Desc       RT - Source  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSH         KLIST
     C                   KFLD                    AAAACD                         SR Source Code
      * Setup key
     C                   MOVEL     ACAACD        AAAACD                         SR Source Code
      * Establish starting position
     C     KRSSH         CHAIN     @AAREAC                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0005'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     AAAFTX        #DAFTX                         SR Description
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Rtv Hog Buyer Name    RT - Hog Buyer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSI         KLIST
     C                   KFLD                    ADACCD                         HB Buyer Code
      * Setup key
     C                   MOVEL     ACACCD        ADACCD                         HB Buyer Code
      * Establish starting position
     C     KRSSI         CHAIN     @ADREAF                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0011'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ADALTX        #DBSTX                         HB Name
     C                   ENDIF
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * Commission Producer
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     ACADCD        ACABCD                         PD Producer Cod
      * Establish starting position
     C     KRSSJ         CHAIN     @ACREAI                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0009'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ACAGTX        #DCNTX                         PD Name
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WQSK01                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ABCD        WQSK01                         PD Producer Cod
      * Establish starting position
     C     KRSSK         SETLL     @E3CPF4                                      *
     C     KRSSK         READE     @E3CPF4                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0967'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         #DC0A1                         MPR Purchase Ty
     C                   GOTO      SKEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   Z-ADD     E3C0A1        #DC0A1                         MPR Purchase Ty
     C                   GOTO      SKEXIT                                       *QUIT
     C     KRSSK         READE     @E3CPF4                                90    *
     C                   ENDDO
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLRVGN        BEGSR
      *================================================================
      * Rtv MPR Purch Desc    RT - MPR Purchase Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSL         KLIST
     C                   KFLD                    E2C0A1                         MPR Purchase Ty
      * Setup key
     C                   Z-ADD     #DC0A1        E2C0A1                         MPR Purchase Ty
      * Establish starting position
     C     KRSSL         CHAIN     @E2REF1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0965'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DP5TX = ' '                                 MPR Purchase Ty
     C                   GOTO      SLEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     E2P5TX        #DP5TX                         MPR Purchase Ty
     C                   GOTO      SLEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * Rtv HPS Automation    RT - Producer EXT  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    AOABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ABCD        AOABCD                         PD Producer Cod
      * Establish starting position
     C     KRSSM         CHAIN     @AOREKK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK1097'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      #DJTSS = ' '                                 HPS Automation
     C                   GOTO      SMEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     AOMLCD        #DJTSS                         HPS Automation
     C                   ENDIF
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNRVGN        BEGSR
      *================================================================
      * Rtv Source Desc       RT - Source  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSN         KLIST
     C                   KFLD                    AAAACD                         SR Source Code
      * Setup key
     C                   MOVEL     #1AACD        AAAACD                         SR Source Code
      * Establish starting position
     C     KRSSN         CHAIN     @AAREAC                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0005'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     AAAFTX        #DAFTX                         SR Description
     C                   ENDIF
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SORVGN        BEGSR
      *================================================================
      * Rtv Hog Buyer Name    RT - Hog Buyer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSO         KLIST
     C                   KFLD                    ADACCD                         HB Buyer Code
      * Setup key
     C                   MOVEL     #1ACCD        ADACCD                         HB Buyer Code
      * Establish starting position
     C     KRSSO         CHAIN     @ADREAF                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0011'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ADALTX        #DBSTX                         HB Name
     C                   ENDIF
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ADCD        ACABCD                         PD Producer Cod
      * Establish starting position
     C     KRSSP         CHAIN     @ACREAI                            90        *
      * Data record not found
     C   90              MOVEL     'PRK0009'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     ACAGTX        #DCNTX                         PD Name
     C                   ENDIF
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQRVGN        BEGSR
      *================================================================
      * Val MPR Purchase Type RT - MPR Purchase Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSQ         KLIST
     C                   KFLD                    E2C0A1                         MPR Purchase Ty
      * Setup key
     C                   Z-ADD     #DC0A1        E2C0A1                         MPR Purchase Ty
      * Establish starting position
     C     KRSSQ         CHAIN     @E2REF1                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0965'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SQEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   IF        NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SQEXIT                                       *QUIT
     C                   ENDIF
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRRVGN        BEGSR
      *================================================================
      * RTV Val Edi#          RT - Producer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSR         KLIST
     C                   KFLD                    WQSR01                         PD EDI Trading
      * Setup key
     C                   Z-ADD     #1GJNB        WQSR01                         PD EDI Trading
      * Establish starting position
     C     KRSSR         SETLL     @ACRELJ                                      *
     C     KRSSR         READE     @ACRELJ                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0009'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   EVAL      W0RTN = ' '                                  *Return code
     C                   GOTO      SREXIT                                       *QUIT
     C     KRSSR         READE     @ACRELJ                                90    *
     C                   ENDDO
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSCRRC        BEGSR
      *================================================================
      * Crt Producer          CT - Producer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @ACREAB
     C                   MOVEL     #1ABCD        ACABCD                         PD Producer Cod
     C                   MOVEL     #1AGTX        ACAGTX                         PD Name
     C                   Z-ADD     #1ALNB        ACALNB                         PD Production C
     C                   Z-ADD     #1AATH        ACAATH                         PD Std Delv Tim
     C                   Z-ADD     #1AMNB        ACAMNB                         PD Std Truck Si
     C                   MOVEL     #1IWST        ACIWST                         PD Freight Exp
     C                   MOVEL     #1APST        ACAPST                         PD Fax Status
     C                   Z-ADD     *ZERO         ACGCNB                         PD VND Address
     C                   Z-ADD     #1GJNB        ACGJNB                         PD EDI Trading
     C                   MOVEL     #1C2TX        ACC2TX                         PD VND Category
     C                   MOVEL     #1AACD        ACAACD                         SR Source Code
     C                   MOVEL     #1ACCD        ACACCD                         HB Buyer Code
     C                   MOVEL     #1ADCD        ACADCD                         Commission Prod
     C                   EVAL      ACAAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         ACAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         ACAMTM                         RS Time Changed
     C                   MOVEL     'A'           ACAJST                         RS Record Statu
     C                   EVAL      ACAHVN = ' '                                 RS Job
     C                   EVAL      ACAGVN = ' '                                 RS Program
     C                   EVAL      ACABVN = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         ACABDT                         RS Date Added
     C                   Z-ADD     *ZERO         ACABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           ACAJST                         RS Record Statu
     C                   MOVEL     ##USR         ACABVN                         RS User Added
     C                   Z-ADD     ##JDT         ACABDT                         RS Date Added
     C                   Z-ADD     ##JTM         ACABTM                         RS Time Added
     C                   MOVEL     ##PGM         ACAGVN                         RS Program
     C                   MOVEL     ##JOB         ACAHVN                         RS Job
     C     KLCRSS        KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
      * Check for duplicate primary key
     C     KLCRSS        SETLL     @ACREAB                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0010'     W0RTN
      * Send message 'Producer               EX'
     C                   MOVEL     'PRK0010'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SSEXIT
     C                   ENDIF
      *
     C                   WRITE     @ACREAB                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STCRRC        BEGSR
      *================================================================
      * Crt Producer EXT2     CT - Producer EXT2  * 
      *================================================================
      *
     C                   EVAL      WN0010 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0011                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0012                         RS Time Changed
     C                   EVAL      WN0013 = ' '                                 RS Record Statu
     C                   EVAL      WN0014 = ' '                                 RS Job
     C                   EVAL      WN0015 = ' '                                 RS Program
     C                   EVAL      WN0016 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0017                         RS Date Added
     C                   Z-ADD     *ZERO         WN0018                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B4RET3
     C                   MOVEL     #1ABCD        WBABCD                         PD Producer Cod
     C                   MOVEL     #DQHCD        WBQHCD                         M3 Supplier ID
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WBAJST                         RS Record Statu
     C                   MOVEL     ##USR         WBABVN                         RS User Added
     C                   Z-ADD     ##JDT         WBABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WBABTM                         RS Time Added
     C                   MOVEL     ##PGM         WBAGVN                         RS Program
     C                   MOVEL     ##JOB         WBAHVN                         RS Job
     C     KLCRST        KLIST
     C                   KFLD                    WBABCD                         PD Producer Cod
      * Check for duplicate primary key
     C     KLCRST        SETLL     @B4RET3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK1330'     W0RTN
      * Send message 'Producer EXT2          EX'
     C                   MOVEL     'PRK1330'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      STEXIT
     C                   ENDIF
      *
     C                   WRITE     @B4RET3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   SUCRRC        BEGSR
      *================================================================
      * Crt Producer Address  CR - Producer Address  * 
      *================================================================
      *
     C                   EVAL      WN0019 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0020                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0021                         RS Time Changed
     C                   EVAL      WN0022 = ' '                                 RS Record Statu
     C                   EVAL      WN0023 = ' '                                 RS Job
     C                   EVAL      WN0024 = ' '                                 RS Program
     C                   EVAL      WN0025 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0026                         RS Date Added
     C                   Z-ADD     *ZERO         WN0027                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @AGREXP
     C                   MOVEL     #1ABCD        AGABCD                         PD Producer Cod
     C                   Z-ADD     *ZERO         AGIKNB                         Address Number
     C                   MOVEL     #1AGTX        AGDVTX                         Pass Name
     C                   MOVEL     #DAITX        AGDNTX                         Address 1
     C                   MOVEL     #DAJTX        AGDOTX                         Address 2
     C                   MOVEL     #DDCTX        AGDPTX                         Address 3
     C                   MOVEL     #DAKTX        AGDQTX                         City
     C                   MOVEL     #DANST        AGDRTX                         State
     C                   MOVEL     #DCJTX        AGDSTX                         Zip
     C                   MOVEL     #DC9TX        AGDTTX                         Area Code
     C                   MOVEL     #DDATX        AGDUTX                         Telephone
     C                   MOVEL     #DPFAC        AGLSTX                         Fax Area Code #
     C                   MOVEL     #DLQTX        AGLRTX                         Fax Telephone
     C                   MOVEL     #DNVTX        AGNVTX                         Fax Attn 1
     C                   MOVEL     #DLSTX        AGNGTX                         Fax Area Code #
     C                   MOVEL     #DLRTX        AGNHTX                         Fax Telephone 2
     C                   MOVEL     #DNWTX        AGNWTX                         Fax Attn 2
     C                   MOVEL     #DGNST        AGGNST                         Vendor 1099
     C                   EVAL      AGDXTX = ' '                                 Vendor Tax Id.
     C                   MOVEL     #DEZCD        AGE0CD                         Country Code
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                   MOVEL     'A'           AGAJST                         RS Record Statu
     C                   MOVEL     ##USR         AGABVN                         RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                   CALL      'PKWDUPC'                            90      Rtv System Date
     C     AGABDT        PARM      *ZERO         WQ0104                         *DATE
     C     AGABTM        PARM      *ZERO         WQ0105                         *TIME
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKWDUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     ##PGM         AGAGVN                         RS Program
     C                   MOVEL     ##JOB         AGAHVN                         RS Job
     C     KLCRSU        KLIST
     C                   KFLD                    AGABCD                         PD Producer Cod
      * Check for duplicate primary key
     C     KLCRSU        SETLL     @AGREXP                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK1441'     W0RTN
      * Send message 'Producer Address       EX'
     C                   MOVEL     'PRK1441'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
     C                   WRITE     @AGREXP                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SUEXIT        ENDSR
      /EJECT
     CSR   SVRVGN        BEGSR
      *================================================================
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
      *================================================================
      *
     C                   EVAL      WN0028 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0029                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0030                         RS Time Changed
     C                   EVAL      WN0031 = ' '                                 RS Record Statu
     C                   EVAL      WN0032 = ' '                                 RS Job
     C                   EVAL      WN0033 = ' '                                 RS Program
     C                   EVAL      WN0034 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0035                         RS Date Added
     C                   Z-ADD     *ZERO         WN0036                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSV         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DPFAC        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLQTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSSV         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * Create Fax Detail - Fax Detail  * 
     C                   EXSR      SWCRRC
     C                   GOTO      SVEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Change Fax Detail - Fax Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      SXCHRC
     C                   ENDIF
      *================================================================
     CSR   SVEXIT        ENDSR
      /EJECT
     CSR   SWCRRC        BEGSR
      *================================================================
      * Create Fax Detail - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @EAREZ8
     C                   EVALR     WCHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         WCHHCD                         FD Application
     C                   MOVEL     #DPFAC        WCNYTX                         FD Fax Area Cod
     C                   MOVEL     #DLQTX        WCFDFN                         FD Fax Number
     C                   MOVEL     #DNVTX        WCNXTX                         FD Fax Attentio
     C                   MOVEL     WN0028        WCAAVN                         RS User Changed
     C                   Z-ADD     WN0029        WCAADT                         RS Date Changed
     C                   Z-ADD     WN0030        WCAMTM                         RS Time Changed
     C                   MOVEL     WN0031        WCAJST                         RS Record Statu
     C                   MOVEL     WN0032        WCAHVN                         RS Job
     C                   MOVEL     WN0033        WCAGVN                         RS Program
     C                   MOVEL     WN0034        WCABVN                         RS User Added
     C                   Z-ADD     WN0035        WCABDT                         RS Date Added
     C                   Z-ADD     WN0036        WCABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WCAJST                         RS Record Statu
     C                   MOVEL     ##USR         WCABVN                         RS User Added
     C                   Z-ADD     ##JDT         WCABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WCABTM                         RS Time Added
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C     KLCRSW        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
      * Check for duplicate primary key
     C     KLCRSW        SETLL     @EAREZ8                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0809'     W0RTN
      * Send message 'Fax Detail             EX'
     C                   MOVEL     'PRK0809'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SWEXIT
     C                   ENDIF
      *
     C                   WRITE     @EAREZ8                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SWEXIT        ENDSR
      /EJECT
     CSR   SXCHRC        BEGSR
      *================================================================
      * Change Fax Detail - Fax Detail  * 
      *================================================================
      *
     C                   EVAL      WN0037 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0038                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0039                         RS Time Changed
     C                   EVAL      WN0040 = ' '                                 RS Record Statu
     C                   EVAL      WN0041 = ' '                                 RS Job
     C                   EVAL      WN0042 = ' '                                 RS Program
     C                   EVAL      WN0043 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0044                         RS Date Added
     C                   Z-ADD     *ZERO         WN0045                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @EAREZ8
     C                   MOVEL(P)  EAHHCD        WCHHCD                         FD Application
     C                   MOVEL(P)  EANYTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL(P)  EAFDFN        WCFDFN                         FD Fax Number
      *
     C     KLCHSX        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
     C     KLCHSX        CHAIN     @EAREZ8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKEAREL0'    MDACP
     C                   MOVEL     '@EAREZ8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SXEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SXEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPKEA1        YARDCS
      * Move non-key fields to @EAREZ8
     C                   MOVEL(P)  #DNVTX        WCNXTX                         FD Fax Attentio
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         WCAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         WCAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         WCAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @EAREZ8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PKEAREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SXEXIT        ENDSR
      /EJECT
     CSR   SYRVGN        BEGSR
      *================================================================
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
      *================================================================
      *
     C                   EVAL      WN0046 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0047                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0048                         RS Time Changed
     C                   EVAL      WN0049 = ' '                                 RS Record Statu
     C                   EVAL      WN0050 = ' '                                 RS Job
     C                   EVAL      WN0051 = ' '                                 RS Program
     C                   EVAL      WN0052 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0053                         RS Date Added
     C                   Z-ADD     *ZERO         WN0054                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSY         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DLSTX        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLRTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSSY         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * Create Fax Detail - Fax Detail  * 
     C                   EXSR      SZCRRC
     C                   GOTO      SYEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Change Fax Detail - Fax Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      TACHRC
     C                   ENDIF
      *================================================================
     CSR   SYEXIT        ENDSR
      /EJECT
     CSR   SZCRRC        BEGSR
      *================================================================
      * Create Fax Detail - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @EAREZ8
     C                   EVALR     WCHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         WCHHCD                         FD Application
     C                   MOVEL     #DLSTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL     #DLRTX        WCFDFN                         FD Fax Number
     C                   MOVEL     #DNWTX        WCNXTX                         FD Fax Attentio
     C                   MOVEL     WN0046        WCAAVN                         RS User Changed
     C                   Z-ADD     WN0047        WCAADT                         RS Date Changed
     C                   Z-ADD     WN0048        WCAMTM                         RS Time Changed
     C                   MOVEL     WN0049        WCAJST                         RS Record Statu
     C                   MOVEL     WN0050        WCAHVN                         RS Job
     C                   MOVEL     WN0051        WCAGVN                         RS Program
     C                   MOVEL     WN0052        WCABVN                         RS User Added
     C                   Z-ADD     WN0053        WCABDT                         RS Date Added
     C                   Z-ADD     WN0054        WCABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WCAJST                         RS Record Statu
     C                   MOVEL     ##USR         WCABVN                         RS User Added
     C                   Z-ADD     ##JDT         WCABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WCABTM                         RS Time Added
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C     KLCRSZ        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
      * Check for duplicate primary key
     C     KLCRSZ        SETLL     @EAREZ8                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0809'     W0RTN
      * Send message 'Fax Detail             EX'
     C                   MOVEL     'PRK0809'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SZEXIT
     C                   ENDIF
      *
     C                   WRITE     @EAREZ8                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SZEXIT        ENDSR
      /EJECT
     CSR   TACHRC        BEGSR
      *================================================================
      * Change Fax Detail - Fax Detail  * 
      *================================================================
      *
     C                   EVAL      WN0055 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0056                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0057                         RS Time Changed
     C                   EVAL      WN0058 = ' '                                 RS Record Statu
     C                   EVAL      WN0059 = ' '                                 RS Job
     C                   EVAL      WN0060 = ' '                                 RS Program
     C                   EVAL      WN0061 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0062                         RS Date Added
     C                   Z-ADD     *ZERO         WN0063                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @EAREZ8
     C                   MOVEL(P)  EAHHCD        WCHHCD                         FD Application
     C                   MOVEL(P)  EANYTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL(P)  EAFDFN        WCFDFN                         FD Fax Number
      *
     C     KLCHTA        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
     C     KLCHTA        CHAIN     @EAREZ8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKEAREL0'    MDACP
     C                   MOVEL     '@EAREZ8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TAEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TAEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPKEA1        YBRDCS
      * Move non-key fields to @EAREZ8
     C                   MOVEL(P)  #DNWTX        WCNXTX                         FD Fax Attentio
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         WCAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         WCAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         WCAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @EAREZ8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PKEAREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TAEXIT        ENDSR
      /EJECT
     CSR   TBRVGN        BEGSR
      *================================================================
      * Rtv/Crt/Chg MPR PrPur RT - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTB         KLIST
     C                   KFLD                    WQTB01                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ABCD        WQTB01                         PD Producer Cod
      * Establish starting position
     C     KRSTB         SETLL     @E3CPF4                                      *
     C     KRSTB         READE     @E3CPF4                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0967'     W0RTN
      * USER: Processing if Data record not found
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
     C                   EXSR      TCCRRC
     C                   GOTO      TBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: PAR.MPR Purchase Type Code NE DB1.MPR Purchase Type Code
     C                   DOW       NOT *IN90
      * Del MPR Prdcr Purch   DL - MPR Producer Purch Type  * 
     C                   IF        #DC0A1 <> E3C0A1
     C                   EXSR      TDDLRC
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
     C                   EXSR      TECRRC
     C                   END                                                    *FI
     C     KRSTB         READE     @E3CPF4                                90    *
     C                   ENDDO
      *================================================================
     CSR   TBEXIT        ENDSR
      /EJECT
     CSR   TCCRRC        BEGSR
      *================================================================
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @E3CPF3
     C                   MOVEL     #1ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     #DC0A1        WDC0A1                         MPR Purchase Ty
     C                   EVAL      WDAAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WDAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WDAMTM                         RS Time Changed
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     WN0005        WDAHVN                         RS Job
     C                   MOVEL     WN0006        WDAGVN                         RS Program
     C                   MOVEL     WN0007        WDABVN                         RS User Added
     C                   Z-ADD     WN0008        WDABDT                         RS Date Added
     C                   Z-ADD     WN0009        WDABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     ##USR         WDABVN                         RS User Added
     C                   Z-ADD     ##JDT         WDABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WDABTM                         RS Time Added
     C                   MOVEL     ##PGM         WDAGVN                         RS Program
     C                   MOVEL     ##JOB         WDAHVN                         RS Job
     C     KLCRTC        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
      * Check for duplicate primary key
     C     KLCRTC        SETLL     @E3CPF3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0968'     W0RTN
      * Send message 'MPR Producer Purch Typ EX'
     C                   MOVEL     'PRK0968'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TCEXIT
     C                   ENDIF
      *
     C                   WRITE     @E3CPF3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TCEXIT        ENDSR
      /EJECT
     CSR   TDDLRC        BEGSR
      *================================================================
      * Del MPR Prdcr Purch   DL - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @E3CPF3
     C                   MOVEL     E3ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     E3C0A1        WDC0A1                         MPR Purchase Ty
      *
     C     KLDLTD        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
     C     KLDLTD        CHAIN     @E3CPF3                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKE3CPL0'    MDACP
     C                   MOVEL     '@E3CPF3'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TDEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @E3CPF3                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   TDEXIT        ENDSR
      /EJECT
     CSR   TECRRC        BEGSR
      *================================================================
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @E3CPF3
     C                   MOVEL     #1ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     #DC0A1        WDC0A1                         MPR Purchase Ty
     C                   MOVEL     WN0001        WDAAVN                         RS User Changed
     C                   Z-ADD     WN0002        WDAADT                         RS Date Changed
     C                   Z-ADD     WN0003        WDAMTM                         RS Time Changed
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     WN0005        WDAHVN                         RS Job
     C                   MOVEL     E3AGVN        WDAGVN                         RS Program
     C                   MOVEL     E3ABVN        WDABVN                         RS User Added
     C                   Z-ADD     E3ABDT        WDABDT                         RS Date Added
     C                   Z-ADD     E3ABTM        WDABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     ##USR         WDABVN                         RS User Added
     C                   Z-ADD     ##JDT         WDABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WDABTM                         RS Time Added
     C                   MOVEL     ##PGM         WDAGVN                         RS Program
     C                   MOVEL     ##JOB         WDAHVN                         RS Job
     C     KLCRTE        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
      * Check for duplicate primary key
     C     KLCRTE        SETLL     @E3CPF3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0968'     W0RTN
      * Send message 'MPR Producer Purch Typ EX'
     C                   MOVEL     'PRK0968'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TEEXIT
     C                   ENDIF
      *
     C                   WRITE     @E3CPF3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TEEXIT        ENDSR
      /EJECT
     CSR   TFCHRC        BEGSR
      *================================================================
      * Chg Producer          CH - Producer  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @ACREAB
     C                   MOVEL(P)  #1ABCD        ACABCD                         PD Producer Cod
      *
     C     KLCHTF        KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
     C     KLCHTF        CHAIN     @ACREAB                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKACREL0'    MDACP
     C                   MOVEL     '@ACREAB'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL004.
     C                   MOVEL     'LBL004'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TFEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TFEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      @1DBRC        YCRDCS
      * Move non-key fields to @ACREAB
     C                   MOVEL(P)  #1AGTX        ACAGTX                         PD Name
     C                   Z-ADD     #1ALNB        ACALNB                         PD Production C
     C                   Z-ADD     #1AATH        ACAATH                         PD Std Delv Tim
     C                   Z-ADD     #1AMNB        ACAMNB                         PD Std Truck Si
     C                   MOVEL(P)  #1IWST        ACIWST                         PD Freight Exp
     C                   MOVEL(P)  #1APST        ACAPST                         PD Fax Status
     C                   Z-ADD     #1GCNB        ACGCNB                         PD VND Address
     C                   Z-ADD     #1GJNB        ACGJNB                         PD EDI Trading
     C                   MOVEL(P)  #1C2TX        ACC2TX                         PD VND Category
     C                   MOVEL(P)  #1AACD        ACAACD                         SR Source Code
     C                   MOVEL(P)  #1ACCD        ACACCD                         HB Buyer Code
     C                   MOVEL(P)  #1ADCD        ACADCD                         Commission Prod
     C                   EVAL      ACAAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         ACAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         ACAMTM                         RS Time Changed
     C                   MOVEL(P)  #1AJST        ACAJST                         RS Record Statu
     C                   EVAL      ACAHVN = ' '                                 RS Job
     C                   EVAL      ACAGVN = ' '                                 RS Program
     C                   EVAL      ACABVN = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         ACABDT                         RS Date Added
     C                   Z-ADD     *ZERO         ACABTM                         RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        @1DBRC <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         ACAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         ACAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         ACAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         ACAHVN                         RS Job
     C                   MOVEL     ##PGM         ACAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        @1DBRC <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @ACREAB                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PKACREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TFEXIT        ENDSR
      /EJECT
     CSR   TGCHRC        BEGSR
      *================================================================
      * Chg Producer Address  CH - Producer Address  * 
      *================================================================
      *
     C                   EVAL      WN0072 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0073                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0074                         RS Time Changed
     C                   EVAL      WN0075 = ' '                                 RS Job
     C                   EVAL      WN0076 = ' '                                 RS Program
     C                   EVAL      WN0077 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0078                         RS Date Added
     C                   Z-ADD     *ZERO         WN0079                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YDRDC = ' '
      *
      * Move key fields to @AGREXP
     C                   MOVEL(P)  #1ABCD        AGABCD                         PD Producer Cod
      *
     C     KLCHTG        KLIST
     C                   KFLD                    AGABCD                         PD Producer Cod
     C     KLCHTG        CHAIN     @AGREXP                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PWAGREL0'    MDACP
     C                   MOVEL     '@AGREXP'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL005.
     C                   MOVEL     'LBL005'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TGEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TGEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPWAG1        YDRDCS
      * Move non-key fields to @AGREXP
     C                   Z-ADD     #1GCNB        AGIKNB                         Address Number
     C                   MOVEL(P)  #1AGTX        AGDVTX                         Pass Name
     C                   MOVEL(P)  #DAITX        AGDNTX                         Address 1
     C                   MOVEL(P)  #DAJTX        AGDOTX                         Address 2
     C                   MOVEL(P)  #DDCTX        AGDPTX                         Address 3
     C                   MOVEL(P)  #DAKTX        AGDQTX                         City
     C                   MOVEL(P)  #DANST        AGDRTX                         State
     C                   MOVEL(P)  #DCJTX        AGDSTX                         Zip
     C                   MOVEL(P)  #DC9TX        AGDTTX                         Area Code
     C                   MOVEL(P)  #DDATX        AGDUTX                         Telephone
     C                   MOVEL(P)  #DPFAC        AGLSTX                         Fax Area Code #
     C                   MOVEL(P)  #DLQTX        AGLRTX                         Fax Telephone
     C                   MOVEL(P)  #DNVTX        AGNVTX                         Fax Attn 1
     C                   MOVEL(P)  #DLSTX        AGNGTX                         Fax Area Code #
     C                   MOVEL(P)  #DLRTX        AGNHTX                         Fax Telephone 2
     C                   MOVEL(P)  #DNWTX        AGNWTX                         Fax Attn 2
     C                   MOVEL(P)  #DGNST        AGGNST                         Vendor 1099
     C                   MOVEL(P)  #DDXTX        AGDXTX                         Vendor Tax Id.
     C                   MOVEL(P)  #DEZCD        AGE0CD                         Country Code
     C                   MOVEL(P)  #1AJST        AGAJST                         RS Record Statu
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPWAG1 <> YDRDCS AND
     C                             YDRDC <> 'N'
     C                   MOVE      'Y'           YDRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         AGAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         AGAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         AGAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         AGAHVN                         RS Job
     C                   MOVEL     ##PGM         AGAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPWAG1 <> YDRDCS AND
     C                             YDRDC <> 'N'
     C                   MOVE      'Y'           YDRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YDRDC = 'Y'
     C                   UPDATE    @AGREXP                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PWAGREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TGEXIT        ENDSR
      /EJECT
     CSR   THCHRC        BEGSR
      *================================================================
      * Chg Producer EXT2     CH - Producer EXT2  * 
      *================================================================
      *
     C                   EVAL      WN0080 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0081                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0082                         RS Time Changed
     C                   EVAL      WN0083 = ' '                                 RS Record Statu
     C                   EVAL      WN0084 = ' '                                 RS Job
     C                   EVAL      WN0085 = ' '                                 RS Program
     C                   EVAL      WN0086 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0087                         RS Date Added
     C                   Z-ADD     *ZERO         WN0088                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YERDC = ' '
      *
      * Move key fields to @B4RET3
     C                   MOVEL(P)  #1ABCD        WBABCD                         PD Producer Cod
      *
     C     KLCHTH        KLIST
     C                   KFLD                    WBABCD                         PD Producer Cod
     C     KLCHTH        CHAIN     @B4RET3                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
      * USER: Processing if Data record not found
      * Crt Producer EXT2     CT - Producer EXT2  * 
     C                   EXSR      TICRRC
     C                   IF        W0RTN <> ' '
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PLB4REL0'    MDACP
     C                   MOVEL     '@B4RET3'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL006.
     C                   MOVEL     'LBL006'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   ENDIF
     C                   GOTO      THEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      THEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPLB41        YERDCS
      * Move non-key fields to @B4RET3
     C                   MOVEL(P)  #DQHCD        WBQHCD                         M3 Supplier ID
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPLB41 <> YERDCS AND
     C                             YERDC <> 'N'
     C                   MOVE      'Y'           YERDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         WBAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         WBAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         WBAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         WBAHVN                         RS Job
     C                   MOVEL     ##PGM         WBAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPLB41 <> YERDCS AND
     C                             YERDC <> 'N'
     C                   MOVE      'Y'           YERDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YERDC = 'Y'
     C                   UPDATE    @B4RET3                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PLB4REL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   THEXIT        ENDSR
      /EJECT
     CSR   TICRRC        BEGSR
      *================================================================
      * Crt Producer EXT2     CT - Producer EXT2  * 
      *================================================================
      *
     C                   EVAL      WN0089 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0090                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0091                         RS Time Changed
     C                   EVAL      WN0092 = ' '                                 RS Record Statu
     C                   EVAL      WN0093 = ' '                                 RS Job
     C                   EVAL      WN0094 = ' '                                 RS Program
     C                   EVAL      WN0095 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0096                         RS Date Added
     C                   Z-ADD     *ZERO         WN0097                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B4RET3
     C                   MOVEL     #1ABCD        WBABCD                         PD Producer Cod
     C                   MOVEL     #DQHCD        WBQHCD                         M3 Supplier ID
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WBAJST                         RS Record Statu
     C                   MOVEL     ##USR         WBABVN                         RS User Added
     C                   Z-ADD     ##JDT         WBABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WBABTM                         RS Time Added
     C                   MOVEL     ##PGM         WBAGVN                         RS Program
     C                   MOVEL     ##JOB         WBAHVN                         RS Job
     C     KLCRTI        KLIST
     C                   KFLD                    WBABCD                         PD Producer Cod
      * Check for duplicate primary key
     C     KLCRTI        SETLL     @B4RET3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK1330'     W0RTN
      * Send message 'Producer EXT2          EX'
     C                   MOVEL     'PRK1330'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TIEXIT
     C                   ENDIF
      *
     C                   WRITE     @B4RET3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TIEXIT        ENDSR
      /EJECT
     CSR   TJRVGN        BEGSR
      *================================================================
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 1
      *================================================================
      *
     C                   EVAL      WN0098 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0099                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0100                         RS Time Changed
     C                   EVAL      WN0101 = ' '                                 RS Record Statu
     C                   EVAL      WN0102 = ' '                                 RS Job
     C                   EVAL      WN0103 = ' '                                 RS Program
     C                   EVAL      WN0104 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0105                         RS Date Added
     C                   Z-ADD     *ZERO         WN0106                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTJ         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DPFAC        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLQTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSTJ         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * Create Fax Detail - Fax Detail  * 
     C                   EXSR      TKCRRC
     C                   GOTO      TJEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Change Fax Detail - Fax Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      TLCHRC
     C                   ENDIF
      *================================================================
     CSR   TJEXIT        ENDSR
      /EJECT
     CSR   TKCRRC        BEGSR
      *================================================================
      * Create Fax Detail - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @EAREZ8
     C                   EVALR     WCHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         WCHHCD                         FD Application
     C                   MOVEL     #DPFAC        WCNYTX                         FD Fax Area Cod
     C                   MOVEL     #DLQTX        WCFDFN                         FD Fax Number
     C                   MOVEL     #DNVTX        WCNXTX                         FD Fax Attentio
     C                   MOVEL     WN0098        WCAAVN                         RS User Changed
     C                   Z-ADD     WN0099        WCAADT                         RS Date Changed
     C                   Z-ADD     WN0100        WCAMTM                         RS Time Changed
     C                   MOVEL     WN0101        WCAJST                         RS Record Statu
     C                   MOVEL     WN0102        WCAHVN                         RS Job
     C                   MOVEL     WN0103        WCAGVN                         RS Program
     C                   MOVEL     WN0104        WCABVN                         RS User Added
     C                   Z-ADD     WN0105        WCABDT                         RS Date Added
     C                   Z-ADD     WN0106        WCABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WCAJST                         RS Record Statu
     C                   MOVEL     ##USR         WCABVN                         RS User Added
     C                   Z-ADD     ##JDT         WCABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WCABTM                         RS Time Added
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C     KLCRTK        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
      * Check for duplicate primary key
     C     KLCRTK        SETLL     @EAREZ8                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0809'     W0RTN
      * Send message 'Fax Detail             EX'
     C                   MOVEL     'PRK0809'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TKEXIT
     C                   ENDIF
      *
     C                   WRITE     @EAREZ8                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TKEXIT        ENDSR
      /EJECT
     CSR   TLCHRC        BEGSR
      *================================================================
      * Change Fax Detail - Fax Detail  * 
      *================================================================
      *
     C                   EVAL      WN0107 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0108                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0109                         RS Time Changed
     C                   EVAL      WN0110 = ' '                                 RS Record Statu
     C                   EVAL      WN0111 = ' '                                 RS Job
     C                   EVAL      WN0112 = ' '                                 RS Program
     C                   EVAL      WN0113 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0114                         RS Date Added
     C                   Z-ADD     *ZERO         WN0115                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YFRDC = ' '
      *
      * Move key fields to @EAREZ8
     C                   MOVEL(P)  EAHHCD        WCHHCD                         FD Application
     C                   MOVEL(P)  EANYTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL(P)  EAFDFN        WCFDFN                         FD Fax Number
      *
     C     KLCHTL        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
     C     KLCHTL        CHAIN     @EAREZ8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKEAREL0'    MDACP
     C                   MOVEL     '@EAREZ8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL007.
     C                   MOVEL     'LBL007'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TLEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TLEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPKEA1        YFRDCS
      * Move non-key fields to @EAREZ8
     C                   MOVEL(P)  #DNVTX        WCNXTX                         FD Fax Attentio
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YFRDCS AND
     C                             YFRDC <> 'N'
     C                   MOVE      'Y'           YFRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         WCAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         WCAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         WCAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YFRDCS AND
     C                             YFRDC <> 'N'
     C                   MOVE      'Y'           YFRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YFRDC = 'Y'
     C                   UPDATE    @EAREZ8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PKEAREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TLEXIT        ENDSR
      /EJECT
     CSR   TMRVGN        BEGSR
      *================================================================
      * Upd Fax Detail        RT - Fax Detail  * Fax Attn 2
      *================================================================
      *
     C                   EVAL      WN0116 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0117                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0118                         RS Time Changed
     C                   EVAL      WN0119 = ' '                                 RS Record Statu
     C                   EVAL      WN0120 = ' '                                 RS Job
     C                   EVAL      WN0121 = ' '                                 RS Program
     C                   EVAL      WN0122 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0123                         RS Date Added
     C                   Z-ADD     *ZERO         WN0124                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSTM         KLIST
     C                   KFLD                    EAHHCD                         FD Application
     C                   KFLD                    EANYTX                         FD Fax Area Cod
     C                   KFLD                    EAFDFN                         FD Fax Number
      * Setup key
     C                   EVALR     EAHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         EAHHCD                         FD Application
     C                   MOVEL     #DLSTX        EANYTX                         FD Fax Area Cod
     C                   MOVEL     #DLRTX        EAFDFN                         FD Fax Number
      * Establish starting position
     C     KRSTM         CHAIN     @EAREZ9                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0808'     W0RTN
      * USER: Processing if Data record not found
      * Create Fax Detail - Fax Detail  * 
     C                   EXSR      TNCRRC
     C                   GOTO      TMEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Change Fax Detail - Fax Detail  * 
     C                   IF        NOT *IN90
     C                   EXSR      TOCHRC
     C                   ENDIF
      *================================================================
     CSR   TMEXIT        ENDSR
      /EJECT
     CSR   TNCRRC        BEGSR
      *================================================================
      * Create Fax Detail - Fax Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @EAREZ8
     C                   EVALR     WCHHCD = ' '                                 FD Application
     C                   MOVEL     'HPE'         WCHHCD                         FD Application
     C                   MOVEL     #DLSTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL     #DLRTX        WCFDFN                         FD Fax Number
     C                   MOVEL     #DNWTX        WCNXTX                         FD Fax Attentio
     C                   MOVEL     WN0116        WCAAVN                         RS User Changed
     C                   Z-ADD     WN0117        WCAADT                         RS Date Changed
     C                   Z-ADD     WN0118        WCAMTM                         RS Time Changed
     C                   MOVEL     WN0119        WCAJST                         RS Record Statu
     C                   MOVEL     WN0120        WCAHVN                         RS Job
     C                   MOVEL     WN0121        WCAGVN                         RS Program
     C                   MOVEL     WN0122        WCABVN                         RS User Added
     C                   Z-ADD     WN0123        WCABDT                         RS Date Added
     C                   Z-ADD     WN0124        WCABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WCAJST                         RS Record Statu
     C                   MOVEL     ##USR         WCABVN                         RS User Added
     C                   Z-ADD     ##JDT         WCABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WCABTM                         RS Time Added
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C     KLCRTN        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
      * Check for duplicate primary key
     C     KLCRTN        SETLL     @EAREZ8                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0809'     W0RTN
      * Send message 'Fax Detail             EX'
     C                   MOVEL     'PRK0809'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TNEXIT
     C                   ENDIF
      *
     C                   WRITE     @EAREZ8                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TNEXIT        ENDSR
      /EJECT
     CSR   TOCHRC        BEGSR
      *================================================================
      * Change Fax Detail - Fax Detail  * 
      *================================================================
      *
     C                   EVAL      WN0125 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0126                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0127                         RS Time Changed
     C                   EVAL      WN0128 = ' '                                 RS Record Statu
     C                   EVAL      WN0129 = ' '                                 RS Job
     C                   EVAL      WN0130 = ' '                                 RS Program
     C                   EVAL      WN0131 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0132                         RS Date Added
     C                   Z-ADD     *ZERO         WN0133                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YGRDC = ' '
      *
      * Move key fields to @EAREZ8
     C                   MOVEL(P)  EAHHCD        WCHHCD                         FD Application
     C                   MOVEL(P)  EANYTX        WCNYTX                         FD Fax Area Cod
     C                   MOVEL(P)  EAFDFN        WCFDFN                         FD Fax Number
      *
     C     KLCHTO        KLIST
     C                   KFLD                    WCHHCD                         FD Application
     C                   KFLD                    WCNYTX                         FD Fax Area Cod
     C                   KFLD                    WCFDFN                         FD Fax Number
     C     KLCHTO        CHAIN     @EAREZ8                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKEAREL0'    MDACP
     C                   MOVEL     '@EAREZ8'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL008.
     C                   MOVEL     'LBL008'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TOEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TOEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPKEA1        YGRDCS
      * Move non-key fields to @EAREZ8
     C                   MOVEL(P)  #DNWTX        WCNXTX                         FD Fax Attentio
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YGRDCS AND
     C                             YGRDC <> 'N'
     C                   MOVE      'Y'           YGRDC
     C                   ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                   MOVEL     ##USR         WCAAVN                         RS User Changed
     C                   Z-ADD     ##JDT         WCAADT                         RS Date Changed
     C                   Z-ADD     ##JTM         WCAMTM                         RS Time Changed
     C                   MOVEL     ##JOB         WCAHVN                         RS Job
     C                   MOVEL     ##PGM         WCAGVN                         RS Program
      * Set PGM.*Record Data Changed flag
     C                   IF        QPKEA1 <> YGRDCS AND
     C                             YGRDC <> 'N'
     C                   MOVE      'Y'           YGRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YGRDC = 'Y'
     C                   UPDATE    @EAREZ8                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PKEAREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   TOEXIT        ENDSR
      /EJECT
     CSR   TPRVGN        BEGSR
      *================================================================
      * Rtv/Crt/Chg MPR PrPur RT - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSTP         KLIST
     C                   KFLD                    WQTP01                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ABCD        WQTP01                         PD Producer Cod
      * Establish starting position
     C     KRSTP         SETLL     @E3CPF4                                      *
     C     KRSTP         READE     @E3CPF4                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK0967'     W0RTN
      * USER: Processing if Data record not found
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
     C                   EXSR      TQCRRC
     C                   GOTO      TPEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * CASE: PAR.MPR Purchase Type Code NE DB1.MPR Purchase Type Code
     C                   DOW       NOT *IN90
      * Del MPR Prdcr Purch   DL - MPR Producer Purch Type  * 
     C                   IF        #DC0A1 <> E3C0A1
     C                   EXSR      TRDLRC
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
     C                   EXSR      TSCRRC
     C                   END                                                    *FI
     C     KRSTP         READE     @E3CPF4                                90    *
     C                   ENDDO
      *================================================================
     CSR   TPEXIT        ENDSR
      /EJECT
     CSR   TQCRRC        BEGSR
      *================================================================
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @E3CPF3
     C                   MOVEL     #1ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     #DC0A1        WDC0A1                         MPR Purchase Ty
     C                   EVAL      WDAAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WDAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WDAMTM                         RS Time Changed
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     WN0067        WDAHVN                         RS Job
     C                   MOVEL     WN0068        WDAGVN                         RS Program
     C                   MOVEL     WN0069        WDABVN                         RS User Added
     C                   Z-ADD     WN0070        WDABDT                         RS Date Added
     C                   Z-ADD     WN0071        WDABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     ##USR         WDABVN                         RS User Added
     C                   Z-ADD     ##JDT         WDABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WDABTM                         RS Time Added
     C                   MOVEL     ##PGM         WDAGVN                         RS Program
     C                   MOVEL     ##JOB         WDAHVN                         RS Job
     C     KLCRTQ        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
      * Check for duplicate primary key
     C     KLCRTQ        SETLL     @E3CPF3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0968'     W0RTN
      * Send message 'MPR Producer Purch Typ EX'
     C                   MOVEL     'PRK0968'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TQEXIT
     C                   ENDIF
      *
     C                   WRITE     @E3CPF3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TQEXIT        ENDSR
      /EJECT
     CSR   TRDLRC        BEGSR
      *================================================================
      * Del MPR Prdcr Purch   DL - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @E3CPF3
     C                   MOVEL     E3ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     E3C0A1        WDC0A1                         MPR Purchase Ty
      *
     C     KLDLTR        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
     C     KLDLTR        CHAIN     @E3CPF3                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PKE3CPL0'    MDACP
     C                   MOVEL     '@E3CPF3'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL009.
     C                   MOVEL     'LBL009'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      TREXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      TREXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @E3CPF3                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   TREXIT        ENDSR
      /EJECT
     CSR   TSCRRC        BEGSR
      *================================================================
      * Crt MPR Prdcr Purch   CR - MPR Producer Purch Type  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @E3CPF3
     C                   MOVEL     #1ABCD        WDABCD                         PD Producer Cod
     C                   Z-ADD     #DC0A1        WDC0A1                         MPR Purchase Ty
     C                   MOVEL     WN0064        WDAAVN                         RS User Changed
     C                   Z-ADD     WN0065        WDAADT                         RS Date Changed
     C                   Z-ADD     WN0066        WDAMTM                         RS Time Changed
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     WN0067        WDAHVN                         RS Job
     C                   MOVEL     E3AGVN        WDAGVN                         RS Program
     C                   MOVEL     E3ABVN        WDABVN                         RS User Added
     C                   Z-ADD     E3ABDT        WDABDT                         RS Date Added
     C                   Z-ADD     E3ABTM        WDABTM                         RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WDAJST                         RS Record Statu
     C                   MOVEL     ##USR         WDABVN                         RS User Added
     C                   Z-ADD     ##JDT         WDABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WDABTM                         RS Time Added
     C                   MOVEL     ##PGM         WDAGVN                         RS Program
     C                   MOVEL     ##JOB         WDAHVN                         RS Job
     C     KLCRTS        KLIST
     C                   KFLD                    WDABCD                         PD Producer Cod
     C                   KFLD                    WDC0A1                         MPR Purchase Ty
      * Check for duplicate primary key
     C     KLCRTS        SETLL     @E3CPF3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK0968'     W0RTN
      * Send message 'MPR Producer Purch Typ EX'
     C                   MOVEL     'PRK0968'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      TSEXIT
     C                   ENDIF
      *
     C                   WRITE     @E3CPF3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   TSEXIT        ENDSR
      /EJECT
     CSR   VACKRL        BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                   MOVEL     #1ABCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1ABCD' defaulted for 'PD Producer Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1ABCD'
     C                   CALL      'PKA1SRR'                            90      Sel Producer
     C                   PARM      *BLANK        W0RTN
     C     #1ABCD        PARM      #1ABCD        WQ0044                         PD Producer Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKA1SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        9931      *
     C                   END
      *
     C                   IF        #1ABCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   END
      *================================================================
     CSR   VAEXIT        ENDSR
      /EJECT
     CSR   VBCKRL        BEGSR
      *================================================================
      * Check reference to Source
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1AACD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AACD' defaulted for 'SR Source Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AACD'
     C                   CALL      'PKDRSRR'                            90      Sel Source
     C                   PARM      *BLANK        W0RTN
     C     #1AACD        PARM      #1AACD        WQ0101                         SR Source Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKDRSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AACD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VBEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AACD = ' '
     C                   GOTO      VBEXIT
     C                   END
      *
     C     KLVBAA        KLIST
     C                   KFLD                    AAAACD                         SR Source Code
      * Setup key
     C                   MOVEL     #1AACD        AAAACD
     C     KLVBAA        CHAIN     @AAREAC                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VBEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VBEXIT
     C                   END
      * Send message 'Source                 NF'
     C                   MOVEL     'PRK0005'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0005'     W0RTN
      *================================================================
     CSR   VBEXIT        ENDSR
      /EJECT
     CSR   VCCKRL        BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1ACCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1ACCD'
     C                   CALL      'PKD3SRR'                            90      Sel Hog Buyer
     C                   PARM      *BLANK        W0RTN
     C     #1ACCD        PARM      #1ACCD        WQ0102                         HB Buyer Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKD3SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1ACCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VCEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1ACCD = ' '
     C                   GOTO      VCEXIT
     C                   END
      *
     C     KLVCAD        KLIST
     C                   KFLD                    ADACCD                         HB Buyer Code
      * Setup key
     C                   MOVEL     #1ACCD        ADACCD
     C     KLVCAD        CHAIN     @ADREAF                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VCEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VCEXIT
     C                   END
      * Send message 'Hog Buyer              NF'
     C                   MOVEL     'PRK0011'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0011'     W0RTN
      *================================================================
     CSR   VCEXIT        ENDSR
      /EJECT
     CSR   VDCKRL        BEGSR
      *================================================================
      * Check reference to Producer
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1ADCD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ADCD' defaulted for 'Commission Producer Payee'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1ADCD'
     C                   CALL      'PKA1SRR'                            90      Sel Producer
     C                   PARM      *BLANK        W0RTN
     C     #1ADCD        PARM      #1ADCD        WQ0103                         PD Producer Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKA1SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1ADCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VDEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1ADCD = ' '
     C                   GOTO      VDEXIT
     C                   END
      *
     C     KLVDAC        KLIST
     C                   KFLD                    ACABCD                         PD Producer Cod
      * Setup key
     C                   MOVEL     #1ADCD        ACABCD
     C     KLVDAC        CHAIN     @ACREAI                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VDEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VDEXIT
     C                   END
      * Send message 'Producer               NF'
     C                   MOVEL     'PRK0009'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0009'     W0RTN
      *================================================================
     CSR   VDEXIT        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y1SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y1EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
      * KEY Screen
     C                   IF        @#DFMT = '#RCDKEY'
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
     C                   EVALR     W0CFL = ' '
     C                   Z-ADD     1             F
     C     ZINPOS        LOOKUP    W0END(F)                           96  96    LE
     C                   IF        *IN96 AND
     C                             ZINPOS >= W0BEG(F)
     C                   MOVEL     W0NAM(F)      W0CFL
     C                   ENDIF
     C                   ENDIF
      * DETAIL Screen
     C                   IF        @#DFMT = '#RCDDTL1'
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
     C                   EVALR     W0CFL = ' '
     C                   Z-ADD     1             F
     C     ZINPOS        LOOKUP    W1END(F)                           96  96    LE
     C                   IF        *IN96 AND
     C                             ZINPOS >= W1BEG(F)
     C                   MOVEL     W1NAM(F)      W0CFL
     C                   ENDIF
     C                   ENDIF
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
     C                   IF        ZHCSRW = 004 AND
     C                             ZHCSCL >= 020 AND
     C                             ZHCSCL <= 025 AND
     C                             @#DFMT = '#RCDKEY'
     C                   MOVEL     '#1ABCD'      YPMTFD                         PD Producer Cod
     C                   END
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*CSRLOC'     YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      1             YYLGCT                         # of grps
     C                   PARM      W0GRP         YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                   CALL      'Y2CPMSC'
     C                   PARM                    ##PGM
     C                   PARM      'Y'           YILE
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Clear all neither parameters
     C                   Z-ADD     *ZERO         P1GCNB                         PD VND Address
     C                   Z-ADD     *ZERO         P1GJNB                         PD EDI Trading
     C                   EVAL      P3G4SS = ' '                                 Live with M3
     C                   EVAL      P4R8CD = ' '                                 M3 Supplier Div
     C                   EVAL      P5SACD = ' '                                 M3 Supplier Gro
     C                   EVAL      P6DVTX = ' '                                 Pass Name
     C                   EVAL      P6DNTX = ' '                                 Address 1
     C                   EVAL      P6DOTX = ' '                                 Address 2
     C                   EVAL      P6DPTX = ' '                                 Address 3
     C                   EVAL      P6DQTX = ' '                                 City
     C                   EVAL      P6DRTX = ' '                                 State
     C                   EVAL      P6DSTX = ' '                                 Zip
     C                   EVAL      P6DTTX = ' '                                 Area Code
     C                   EVAL      P6DUTX = ' '                                 Telephone
     C                   EVAL      P6LSTX = ' '                                 Fax Area Code #
     C                   EVAL      P6LRTX = ' '                                 Fax Telephone
     C                   EVAL      P6NGTX = ' '                                 Fax Area Code #
     C                   EVAL      P6NHTX = ' '                                 Fax Telephone 2
     C                   EVAL      P6GNST = ' '                                 Vendor 1099
     C                   EVAL      P6DXTX = ' '                                 Vendor Tax Id.
     C                   EVAL      P6E0CD = ' '                                 Country Code
      *
      * Initialise indicators for re-entry
     C                   MOVE      '0'           *IN
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Define work field Vendor Return Code Usr
     C                   EVAL      WUGUST = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAALNB                         PD Production C
     C                   Z-ADD     *ZERO         WAAATH                         PD Std Delv Tim
     C                   Z-ADD     *ZERO         WAAMNB                         PD Std Truck Si
     C                   Z-ADD     *ZERO         WAGCNB                         PD VND Address
     C                   Z-ADD     *ZERO         WAGJNB                         PD EDI Trading
     C                   Z-ADD     *ZERO         WAAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WAAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WAABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WAABTM                         RS Time Added
      * Define work field Zero USR
     C                   Z-ADD     *ZERO         WUE9NB
      * Obtain default message file
     C     *DTAARA       DEFINE    PKMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WBAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WBABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WBABTM                         RS Time Added
      * Clear all neither parameters
      * Crt Producer Address  CR - Producer Address  * 
     C                   Z-ADD     *ZERO         AGAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         AGAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         AGABDT                         RS Date Added
     C                   Z-ADD     *ZERO         AGABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WCAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WCABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WCABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDC0A1                         MPR Purchase Ty
     C                   Z-ADD     *ZERO         WDAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WDAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WDABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WDABTM                         RS Time Added
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'Y'           W0PMT
      * Define null work field Address Number
     C                   Z-ADD     *ZERO         YN0001
      * Define null work field Pass Name
     C                   EVAL      YN0002 = ' '
      * Define null work field Fax Attn 1
     C                   EVAL      YN0003 = ' '
      * Define null work field Fax Attn 2
     C                   EVAL      YN0004 = ' '
      * Define null work field Vendor 1099
     C                   EVAL      YN0005 = ' '
      * Define null work field Vendor Tax Id.
     C                   EVAL      YN0006 = ' '
      * Define null work field M3 Supplier Tax ID
     C                   EVAL      YN0007 = ' '
      * Define null work field M3 Supplier Name
     C                   EVAL      YN0008 = ' '
      * Define null work field M3 Address Line 1
     C                   EVAL      YN0009 = ' '
      * Define null work field M3 Address Line 2
     C                   EVAL      YN0010 = ' '
      * Define null work field M3 Address Line 3
     C                   EVAL      YN0011 = ' '
      * Define null work field M3 City
     C                   EVAL      YN0012 = ' '
      * Define null work field M3 State
     C                   EVAL      YN0013 = ' '
      * Define null work field M3 Postal Code
     C                   EVAL      YN0014 = ' '
      * Define null work field M3 Telephone No 1
     C                   EVAL      YN0015 = ' '
      * Define null work field M3 Telephone No 2
     C                   EVAL      YN0016 = ' '
      * Define null work field M3 Fax Telephone
     C                   EVAL      YN0017 = ' '
      * Define null work field M3 Country Code
     C                   EVAL      YN0018 = ' '
      * Define null work field Producer/Trucker Sts Usr
     C                   EVAL      YN0019 = ' '
      * Define local work field M3 Supplier Group
     C                   EVAL      YL0001 = ' '
      * Define local work field M3 Address Line 4
     C                   EVAL      YL0002 = ' '
      * Define local work field M3 Telephone No 1
     C                   EVAL      YL0003 = ' '
      * Define local work field M3 Telephone No 2
     C                   EVAL      YL0004 = ' '
      * Define local work field M3 Fax Telephone
     C                   EVAL      YL0005 = ' '
      * Define local work field PD Name
     C                   EVAL      YL0006 = ' '
      * Define local work field Producer Address 1    USR
     C                   EVAL      YL0007 = ' '
      * Define local work field Producer Address 2    USR
     C                   EVAL      YL0008 = ' '
      * Define local work field Producer Address 3    USR
     C                   EVAL      YL0009 = ' '
      * Define local work field Producer City         USR
     C                   EVAL      YL0010 = ' '
      * Define local work field Producer State        USR
     C                   EVAL      YL0011 = ' '
      * Define local work field Producer Zip 10       USR
     C                   EVAL      YL0012 = ' '
      * Define local work field Vendor Tax Id.
     C                   EVAL      YL0013 = ' '
      * Define local work field Country Code Usr
     C                   EVAL      YL0014 = ' '
      * Define local work field MPR Purchase Type Code
     C                   Z-ADD     *ZERO         YL0015
      * Define local work field Search Type 3A
     C                   EVAL      YL0016 = ' '
      * Define local work field Business Unit/Cost Center
     C                   EVAL      YL0017 = ' '
      * Define local work field EDI Allow Changes
     C                   EVAL      YL0018 = ' '
      * Define local work field Oms Warehouse Code
     C                   EVAL      YL0019 = ' '
      * Define local work field BOH Company Number
     C                   Z-ADD     *ZERO         YL0020
      * Define local work field Oms SalesPerson Code
     C                   EVAL      YL0021 = ' '
      * Define local work field Oms Allow Multi-Company
     C                   EVAL      YL0022 = ' '
      * Define local work field Oms Default Printer
     C                   EVAL      YL0023 = ' '
      * Define local work field Oms Name
     C                   EVAL      YL0024 = ' '
      * Define local work field Oms System Value Alpha
     C                   EVAL      YL0025 = ' '
      * Define local work field Oms Access Denied (Y/N)
     C                   EVAL      YL0026 = ' '
      * Define local work field User Class f/usrprf   USR
     C                   EVAL      YL0027 = ' '
      * Define local work field System Value Numeric  USR
     C                   Z-ADD     *ZERO         YL0028
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   EVALR     W0BYP = ' '
      * Select initial mode
      * Add mode
     C                   IF        @1NROP = *ZERO
     C                   MOVEL     'ADD'         W0PMD
     C                   ELSE
      * Change mode
     C                   MOVEL     'CHG'         W0PMD
     C                   END
     C                   EVAL      W0GRP = ' '
      * USER: Initialize program
      * **NOTE: This program was cloned from PWC4E1R. Primary purpose is
      *         to show the JDE E1 info. Any changes to this function
      *         should consider changing PWC4E1R as well.
      * R17061 DN 04/27/21-Commented Out. Use RP4 Source.
      * Mov ApplN to CompanyRP4US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                   movel     P2EVTX        ##CMP
      * R17061 DN 04/27/21-Commented Out. Use RP4 Source.
      * Val Application/UserRP4IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                   CALL      'PDGXXFR'                            90      Val Application
     C                   PARM      *BLANK        W0RTN
     C     YL0019        PARM      *BLANK        WQ0106                         Oms Warehouse C
     C     YL0020        PARM      *ZERO         WQ0107                         CC Company Numb
     C                   PARM      'HPE'         WQ0108                         Oms Application
     C     YL0021        PARM      *BLANK        WQ0109                         Oms SalesPerson
     C     YL0022        PARM      *BLANK        WQ0110                         Oms Allow Multi
     C     YL0023        PARM      *BLANK        WQ0111                         Oms Default Pri
     C     YL0024        PARM      *BLANK        WQ0112                         Oms Name
     C     YL0025        PARM      *BLANK        WQ0113                         Oms System Valu
     C     YL0026        PARM      *BLANK        WQ0114                         Oms Access Deni
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
      * Send message 'Access Denied for User'
     C                   IF        YL0026 = 'Y'
     C                   MOVEL     'PRK0298'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to CompanyRP4US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                   movel     YL0025        ##CMP
     C                   END                                                    *FI
      * Rtv Company Values    XF - STR Order Management Sys  * EDIUSER
     C                   CALL      'PDGKXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0115                         BOH Company Num
     C                   PARM      'EDIUSER'     WQ0116                         Company Value C
     C     YL0027        PARM      *BLANK        WQ0117                         System Value Al
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.User Class f/usrprf   USR is *USER
     C                   IF        YL0027 = '*USER'
     C                   MOVEL     'Y'           YL0018                         EDI Allow Chang
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0018                         EDI Allow Chang
     C                   END                                                    *FI
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                   CALL      'PDHGXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0118                         BOH Company Num
     C                   PARM      @CN(002)      WQ0119                         Company Value C
     C     YL0028        PARM      *ZERO         WQ0120                         System Value Nu
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDHGXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: LCL.System Value Numeric  USR is EDI Default number
     C                   IF        YL0028 > 1
     C                   Z-ADD     YL0028        P1GJNB                         PD EDI Trading
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVE      *ZEROS        P1GJNB                         PD EDI Trading
     C                   END                                                    *FI
      * E3580 CGL 11/11/14 - M3 Vendor interfaces changes
      * Rtv Company Values    XF - STR Order Management Sys  * M3VEND
     C                   CALL      'PDGKXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0121                         BOH Company Num
     C                   PARM      @CN(003)      WQ0122                         Company Value C
     C     P3G4SS        PARM      *BLANK        WQ0123                         System Value Al
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * T8163 DN  01/16/17 - Get M3 Division #.
      * Rtv Company Values    XF - STR Order Management Sys  * M3HPEDIV
     C                   CALL      'PDGKXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0124                         BOH Company Num
     C                   PARM      @CN(004)      WQ0125                         Company Value C
     C     P4R8CD        PARM      *BLANK        WQ0126                         System Value Al
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * SDN440 RMC 5/7/2021 GET E1 HPE SEARCH TYPE F/VENDOR
      * Rtv Company Values    XF - STR Order Management Sys  * E1SRCHTYP
     C                   CALL      'PDGKXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0127                         BOH Company Num
     C                   PARM      @CN(005)      WQ0128                         Company Value C
     C     YL0016        PARM      *BLANK        WQ0129                         System Value Al
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * R17061 DN 07/23/21-Get Security Cost Center.
      * Rtv Company Values    XF - STR Order Management Sys  * E1MCU
     C                   CALL      'PDGKXFR'                            90      Rtv Company Val
     C                   PARM      *BLANK        W0RTN
     C                   PARM      YL0020        WQ0130                         BOH Company Num
     C                   PARM      'E1MCU'       WQ0131                         Company Value C
     C     YL0017        PARM      *BLANK        WQ0132                         System Value Al
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGKXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      *================================================================
     CSR   ZZEXIT        ENDSR
** KEY Screen: Field position and name array
01044
** W0END
01049
** W0NAM
#1ABCD
** W1BEG
01045011100114101557016220181301878
02069021340232502390025810264602837
02841028670290202906029280309303100
03349033560341403421036050367003677
03861038680392603933041170443604439
04634046440469204890049000494805146
05156054020541205460056580568605716
05914059240597205980
** W1END
01050011170115001596016610185201917
02108021730236402429026200268502839
02852028690290402917029300309803119
03354033750341903440036440367503696
03866038870393103952041560443604441
04634046680469704892049240495505148
05195054070543605467056640569005720
05914059380597306009
** W1NAM
#1ABCD    #1GCNB    #DQHCD    #1AGTX    #DDVTX    #DAITX    #DDNTX
#DAJTX    #DDOTX    #DDCTX    #DDPTX    #DAKTX    #DDQTX    #DANST
#DCJTX    #DEZCD    #DDRTX    #DDSTX    #DE0CD    #DC9TX    #DDATX
#DPFAC    #DLQTX    #DDTTX    #DDUTX    #DNVTX    #DHGT1    #DHIT1
#DLSTX    #DLRTX    #DNGTX    #DNHTX    #DNWTX    #DJTSS    #DGBT1
#1AJST    #DD6TX    #DPBCD    #1AACD    #DAFTX    #DSVA1    #1ACCD
#DBSTX    #1ADCD    #DCNTX    #1GJNB    #1ALNB    #1AATH    #1AMNB
#1IWST    #DLVTX    #DC0A1    #DP5TX
** @CN
00001 Not Found
00002 HPEEDIDEFU
00003 M3VEND
00004 M3HPEDIV
00005 E1SRCHTYP
