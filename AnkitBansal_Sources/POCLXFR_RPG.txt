     H/TITLE PPS Files Purges       XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 08/14/07  Time  : 18:24:53
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJWCPL3IF  E           K        DISK
      * RSQ : PS Availability Audit     Aud Date/Type/Seq
      *
     FPDK2CPL1IF  E           K        DISK
      * RTV : PS Kill Plan              Retrieval index
      *
     FPDI9CPLAIF  E           K        DISK
      * RSQ : PS Production Adjustment  Production date
      *
     FPDJCCPL3IF  E           K        DISK
      * RSQ : PS Prod Schedule          Production Date
      *
     FPDI8CPLPIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Production date
      *
     FPDLMCPL2IF  E           K        DISK
      * RSQ : PS Prod Dept Schedule     Production Date
      *
     FPDJDCPL4IF  E           K        DISK
      * RSQ : PS Production Detail Com  Production Date
      *
     FPDJWCPL0UF  E           K        DISK
      * UPD : PS Availability Audit     Update index
      *
     FPDK2CPL0UF  E           K        DISK
      * UPD : PS Kill Plan              Update index
      *
     FPDI9CPL0UF  E           K        DISK
      * UPD : PS Production Adjustment  Update index
      *
     FPDJCCPL0UF  E           K        DISK
      * UPD : PS Prod Schedule          Update index
      *
     FPDI8CPL0UF  E           K        DISK
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDLMCPL0UF  E           K        DISK
      * UPD : PS Prod Dept Schedule     Update index
      *
     FPDJDCPL0UF  E           K        DISK
      * UPD : PS Production Detail Com  Update index
      *
     I@JWCPML
      * PS Availability Audit     Aud Date/Type/Seq
      * Renamed input format fields
     I              JWAIC3                          WAAIC3
     I              JWHMDT                          WAHMDT
     I              JWZPST                          WAZPST
     I              JWASQN                          WAASQN
     I              JWHYQT                          WAHYQT
     I              JWE8ST                          WAE8ST
     I              JWESWG                          WAESWG
     I              JWHZQT                          WAHZQT
     I              JWEQWG                          WAEQWG
     I              JWH0QT                          WAH0QT
     I              JWERWG                          WAERWG
     I              JWH4QT                          WAH4QT
     I              JWEWWG                          WAEWWG
     I              JWICDT                          WAICDT
     I              JWIDDT                          WAIDDT
     I              JWB7C7                          WAB7C7
     I              JWT0CD                          WAT0CD
     I              JWBXVN                          WABXVN
     I              JWAORN                          WAAORN
     I              JWAOSN                          WAAOSN
     I              JWAOSL                          WAAOSL
     I              JWPSAT                          WAPSAT
     I              JWPSIS                          WAPSIS
     I              JWUVST                          WAUVST
     I              JWUWST                          WAUWST
     I              JWUXST                          WAUXST
     I              JWAATM                          WAAATM
     I              JWAYNA                          WAAYNA
     I              JWA0NA                          WAA0NA
     I              JWAXDT                          WAAXDT
      *
     I@JWCPBA
      * PS Availability Audit     Update index
      * Renamed input format fields
     I              JWAIC3                          WBAIC3
     I              JWHMDT                          WBHMDT
     I              JWZPST                          WBZPST
     I              JWASQN                          WBASQN
     I              JWHYQT                          WBHYQT
     I              JWE8ST                          WBE8ST
     I              JWESWG                          WBESWG
     I              JWHZQT                          WBHZQT
     I              JWEQWG                          WBEQWG
     I              JWH0QT                          WBH0QT
     I              JWERWG                          WBERWG
     I              JWH4QT                          WBH4QT
     I              JWEWWG                          WBEWWG
     I              JWICDT                          WBICDT
     I              JWIDDT                          WBIDDT
     I              JWB7C7                          WBB7C7
     I              JWT0CD                          WBT0CD
     I              JWBXVN                          WBBXVN
     I              JWAORN                          WBAORN
     I              JWAOSN                          WBAOSN
     I              JWAOSL                          WBAOSL
     I              JWPSAT                          WBPSAT
     I              JWPSIS                          WBPSIS
     I              JWUVST                          WBUVST
     I              JWUWST                          WBUWST
     I              JWUXST                          WBUXST
     I              JWAATM                          WBAATM
     I              JWAYNA                          WBAYNA
     I              JWA0NA                          WBA0NA
     I              JWAXDT                          WBAXDT
      *
     I@K2CPKE
      * PS Kill Plan              Retrieval index
      * Renamed input format fields
     I              K2AIC3                          WCAIC3
     I              K2UPNB                          WCUPNB
     I              K2UQNB                          WCUQNB
     I              K2GGDT                          WCGGDT
     I              K2HVHD                          WCHVHD
     I              K2AVWE                          WCAVWE
     I              K2ESPC                          WCESPC
     I              K2ETPC                          WCETPC
     I              K2EUPC                          WCEUPC
     I              K2EVPC                          WCEVPC
     I              K2EWPC                          WCEWPC
     I              K2A0SX                          WCA0SX
     I              K2A1SX                          WCA1SX
     I              K2A2SX                          WCA2SX
     I              K2A3SX                          WCA3SX
     I              K2A4SX                          WCA4SX
     I              K2UVST                          WCUVST
     I              K2UWST                          WCUWST
     I              K2UXST                          WCUXST
     I              K2VSST                          WCVSST
     I              K2AATM                          WCAATM
     I              K2AYNA                          WCAYNA
     I              K2A0NA                          WCA0NA
     I              K2AXDT                          WCAXDT
      *
     I@K2CPKD
      * PS Kill Plan              Update index
      * Renamed input format fields
     I              K2AIC3                          WDAIC3
     I              K2UPNB                          WDUPNB
     I              K2UQNB                          WDUQNB
     I              K2GGDT                          WDGGDT
     I              K2HVHD                          WDHVHD
     I              K2AVWE                          WDAVWE
     I              K2ESPC                          WDESPC
     I              K2ETPC                          WDETPC
     I              K2EUPC                          WDEUPC
     I              K2EVPC                          WDEVPC
     I              K2EWPC                          WDEWPC
     I              K2A0SX                          WDA0SX
     I              K2A1SX                          WDA1SX
     I              K2A2SX                          WDA2SX
     I              K2A3SX                          WDA3SX
     I              K2A4SX                          WDA4SX
     I              K2UVST                          WDUVST
     I              K2UWST                          WDUWST
     I              K2UXST                          WDUXST
     I              K2VSST                          WDVSST
     I              K2AATM                          WDAATM
     I              K2AYNA                          WDAYNA
     I              K2A0NA                          WDA0NA
     I              K2AXDT                          WDAXDT
      *
     I@I9CPMN
      * PS Production Adjustment  Production date
      * Renamed input format fields
     I              I9AIC3                          WEAIC3
     I              I9ELDT                          WEELDT
     I              I9HGCD                          WEHGCD
     I              I9AJCD                          WEAJCD
     I              I9PSAD                          WEPSAD
     I              I9PSAN                          WEPSAN
     I              I9PIAD                          WEPIAD
     I              I9V6ST                          WEV6ST
     I              I9D8C7                          WED8C7
     I              I9UVST                          WEUVST
     I              I9UWST                          WEUWST
     I              I9UXST                          WEUXST
     I              I9VSST                          WEVSST
     I              I9AATM                          WEAATM
     I              I9AYNA                          WEAYNA
     I              I9A0NA                          WEA0NA
     I              I9AXDT                          WEAXDT
      *
     I@I9CPUU
      * PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WFAIC3
     I              I9ELDT                          WFELDT
     I              I9HGCD                          WFHGCD
     I              I9AJCD                          WFAJCD
     I              I9PSAD                          WFPSAD
     I              I9PSAN                          WFPSAN
     I              I9PIAD                          WFPIAD
     I              I9V6ST                          WFV6ST
     I              I9D8C7                          WFD8C7
     I              I9UVST                          WFUVST
     I              I9UWST                          WFUWST
     I              I9UXST                          WFUXST
     I              I9VSST                          WFVSST
     I              I9AATM                          WFAATM
     I              I9AYNA                          WFAYNA
     I              I9A0NA                          WFA0NA
     I              I9AXDT                          WFAXDT
      *
     I@JCCPMO
      * PS Prod Schedule          Production Date
      * Renamed input format fields
     I              JCAIC3                          WGAIC3
     I              JCV5ST                          WGV5ST
     I              JCELDT                          WGELDT
     I              JCHVHD                          WGHVHD
     I              JCZ6NB                          WGZ6NB
     I              JCZ7NB                          WGZ7NB
     I              JCDGPC                          WGDGPC
     I              JCAVCW                          WGAVCW
     I              JCDIPC                          WGDIPC
     I              JCZ0NB                          WGZ0NB
     I              JCAVLE                          WGAVLE
     I              JCECWG                          WGECWG
     I              JCUVST                          WGUVST
     I              JCUWST                          WGUWST
     I              JCUXST                          WGUXST
     I              JCVSST                          WGVSST
     I              JCAATM                          WGAATM
     I              JCAYNA                          WGAYNA
     I              JCA0NA                          WGA0NA
     I              JCAXDT                          WGAXDT
      *
     I@JCCPVB
      * PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WHAIC3
     I              JCV5ST                          WHV5ST
     I              JCELDT                          WHELDT
     I              JCHVHD                          WHHVHD
     I              JCZ6NB                          WHZ6NB
     I              JCZ7NB                          WHZ7NB
     I              JCDGPC                          WHDGPC
     I              JCAVCW                          WHAVCW
     I              JCDIPC                          WHDIPC
     I              JCZ0NB                          WHZ0NB
     I              JCAVLE                          WHAVLE
     I              JCECWG                          WHECWG
     I              JCUVST                          WHUVST
     I              JCUWST                          WHUWST
     I              JCUXST                          WHUXST
     I              JCVSST                          WHVSST
     I              JCAATM                          WHAATM
     I              JCAYNA                          WHAYNA
     I              JCA0NA                          WHA0NA
     I              JCAXDT                          WHAXDT
      *
     I@I8CPMP
      * PS Prod Item Schedule     Production date
      * Renamed input format fields
     I              I8AIC3                          WIAIC3
     I              I8V5ST                          WIV5ST
     I              I8ELDT                          WIELDT
     I              I8HGCD                          WIHGCD
     I              I8AJCD                          WIAJCD
     I              I8GPDT                          WIGPDT
     I              I8WTSP                          WIWTSP
     I              I8QTSP                          WIQTSP
     I              I8DJPC                          WIDJPC
     I              I8F8WG                          WIF8WG
     I              I8WTIN                          WIWTIN
     I              I8D5NB                          WID5NB
     I              I8DXWG                          WIDXWG
     I              I8B2NB                          WIB2NB
     I              I8WTCN                          WIWTCN
     I              I8PSCV                          WIPSCV
     I              I8SAWT                          WISAWT
     I              I8B9NB                          WIB9NB
     I              I8D1WG                          WID1WG
     I              I8CBNB                          WICBNB
     I              I8EZWG                          WIEZWG
     I              I8CCNB                          WICCNB
     I              I8E0WG                          WIE0WG
     I              I8D6NB                          WID6NB
     I              I8OAWT                          WIOAWT
     I              I8CDNB                          WICDNB
     I              I8UNW2                          WIUNW2
     I              I8CENB                          WICENB
     I              I8F9WG                          WIF9WG
     I              I8BPNB                          WIBPNB
     I              I8GAWG                          WIGAWG
     I              I8BQNB                          WIBQNB
     I              I8GBWG                          WIGBWG
     I              I8BRNB                          WIBRNB
     I              I8GCWG                          WIGCWG
     I              I8BSNB                          WIBSNB
     I              I8GDWG                          WIGDWG
     I              I8BWNB                          WIBWNB
     I              I8GEWG                          WIGEWG
     I              I8PS6U                          WIPS6U
     I              I8WCST                          WIWCST
     I              I8WPST                          WIWPST
     I              I8B5ST                          WIB5ST
     I              I8TFST                          WITFST
     I              I8TEST                          WITEST
     I              I8THST                          WITHST
     I              I8UDST                          WIUDST
     I              I8UFST                          WIUFST
     I              I8UGST                          WIUGST
     I              I8UHST                          WIUHST
     I              I8B6ST                          WIB6ST
     I              I8B7ST                          WIB7ST
     I              I8DVWG                          WIDVWG
     I              I8D7NB                          WID7NB
     I              I8FCAD                          WIFCAD
     I              I8D9NB                          WID9NB
     I              I8DWWG                          WIDWWG
     I              I8EANB                          WIEANB
     I              I8SHWT                          WISHWT
     I              I8EBNB                          WIEBNB
     I              I8AVWT                          WIAVWT
     I              I8ECNB                          WIECNB
     I              I8WTON                          WIWTON
     I              I8EDNB                          WIEDNB
     I              I8FNWT                          WIFNWT
     I              I8EENB                          WIEENB
     I              I8QTAS                          WIQTAS
     I              I8EFNB                          WIEFNB
     I              I8WAIO                          WIWAIO
     I              I8EGNB                          WIEGNB
     I              I8R3CD                          WIR3CD
     I              I8RGNB                          WIRGNB
     I              I8RHNB                          WIRHNB
     I              I8RINB                          WIRINB
     I              I8XRCD                          WIXRCD
     I              I8UVST                          WIUVST
     I              I8UWST                          WIUWST
     I              I8UXST                          WIUXST
     I              I8VSST                          WIVSST
     I              I8AATM                          WIAATM
     I              I8AYNA                          WIAYNA
     I              I8A0NA                          WIA0NA
     I              I8AXDT                          WIAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WJAIC3
     I              I8V5ST                          WJV5ST
     I              I8ELDT                          WJELDT
     I              I8HGCD                          WJHGCD
     I              I8AJCD                          WJAJCD
     I              I8GPDT                          WJGPDT
     I              I8WTSP                          WJWTSP
     I              I8QTSP                          WJQTSP
     I              I8DJPC                          WJDJPC
     I              I8F8WG                          WJF8WG
     I              I8WTIN                          WJWTIN
     I              I8D5NB                          WJD5NB
     I              I8DXWG                          WJDXWG
     I              I8B2NB                          WJB2NB
     I              I8WTCN                          WJWTCN
     I              I8PSCV                          WJPSCV
     I              I8SAWT                          WJSAWT
     I              I8B9NB                          WJB9NB
     I              I8D1WG                          WJD1WG
     I              I8CBNB                          WJCBNB
     I              I8EZWG                          WJEZWG
     I              I8CCNB                          WJCCNB
     I              I8E0WG                          WJE0WG
     I              I8D6NB                          WJD6NB
     I              I8OAWT                          WJOAWT
     I              I8CDNB                          WJCDNB
     I              I8UNW2                          WJUNW2
     I              I8CENB                          WJCENB
     I              I8F9WG                          WJF9WG
     I              I8BPNB                          WJBPNB
     I              I8GAWG                          WJGAWG
     I              I8BQNB                          WJBQNB
     I              I8GBWG                          WJGBWG
     I              I8BRNB                          WJBRNB
     I              I8GCWG                          WJGCWG
     I              I8BSNB                          WJBSNB
     I              I8GDWG                          WJGDWG
     I              I8BWNB                          WJBWNB
     I              I8GEWG                          WJGEWG
     I              I8PS6U                          WJPS6U
     I              I8WCST                          WJWCST
     I              I8WPST                          WJWPST
     I              I8B5ST                          WJB5ST
     I              I8TFST                          WJTFST
     I              I8TEST                          WJTEST
     I              I8THST                          WJTHST
     I              I8UDST                          WJUDST
     I              I8UFST                          WJUFST
     I              I8UGST                          WJUGST
     I              I8UHST                          WJUHST
     I              I8B6ST                          WJB6ST
     I              I8B7ST                          WJB7ST
     I              I8DVWG                          WJDVWG
     I              I8D7NB                          WJD7NB
     I              I8FCAD                          WJFCAD
     I              I8D9NB                          WJD9NB
     I              I8DWWG                          WJDWWG
     I              I8EANB                          WJEANB
     I              I8SHWT                          WJSHWT
     I              I8EBNB                          WJEBNB
     I              I8AVWT                          WJAVWT
     I              I8ECNB                          WJECNB
     I              I8WTON                          WJWTON
     I              I8EDNB                          WJEDNB
     I              I8FNWT                          WJFNWT
     I              I8EENB                          WJEENB
     I              I8QTAS                          WJQTAS
     I              I8EFNB                          WJEFNB
     I              I8WAIO                          WJWAIO
     I              I8EGNB                          WJEGNB
     I              I8R3CD                          WJR3CD
     I              I8RGNB                          WJRGNB
     I              I8RHNB                          WJRHNB
     I              I8RINB                          WJRINB
     I              I8XRCD                          WJXRCD
     I              I8UVST                          WJUVST
     I              I8UWST                          WJUWST
     I              I8UXST                          WJUXST
     I              I8VSST                          WJVSST
     I              I8AATM                          WJAATM
     I              I8AYNA                          WJAYNA
     I              I8A0NA                          WJA0NA
     I              I8AXDT                          WJAXDT
      *
     I@LMCPMQ
      * PS Prod Dept Schedule     Production Date
      * Renamed input format fields
     I              LMAIC3                          WKAIC3
     I              LMV5ST                          WKV5ST
     I              LMELDT                          WKELDT
     I              LMR3CD                          WKR3CD
     I              LMRMPA                          WKRMPA
     I              LMGFWG                          WKGFWG
     I              LMGGWG                          WKGGWG
     I              LMCLNB                          WKCLNB
     I              LMGHWG                          WKGHWG
     I              LMDVNB                          WKDVNB
     I              LMGNWG                          WKGNWG
     I              LMDZNB                          WKDZNB
     I              LMGOWG                          WKGOWG
     I              LMD0NB                          WKD0NB
     I              LMGPWG                          WKGPWG
     I              LMD1NB                          WKD1NB
     I              LMGQWG                          WKGQWG
     I              LMD4NB                          WKD4NB
     I              LMGRWG                          WKGRWG
     I              LMTKST                          WKTKST
     I              LMTLST                          WKTLST
     I              LMTNST                          WKTNST
     I              LMCD3S                          WKCD3S
     I              LMTVST                          WKTVST
     I              LMTWST                          WKTWST
     I              LMUVST                          WKUVST
     I              LMUWST                          WKUWST
     I              LMUXST                          WKUXST
     I              LMVSST                          WKVSST
     I              LMAATM                          WKAATM
     I              LMAYNA                          WKAYNA
     I              LMA0NA                          WKA0NA
     I              LMAXDT                          WKAXDT
      *
     I@LMCPO0
      * PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WLAIC3
     I              LMV5ST                          WLV5ST
     I              LMELDT                          WLELDT
     I              LMR3CD                          WLR3CD
     I              LMRMPA                          WLRMPA
     I              LMGFWG                          WLGFWG
     I              LMGGWG                          WLGGWG
     I              LMCLNB                          WLCLNB
     I              LMGHWG                          WLGHWG
     I              LMDVNB                          WLDVNB
     I              LMGNWG                          WLGNWG
     I              LMDZNB                          WLDZNB
     I              LMGOWG                          WLGOWG
     I              LMD0NB                          WLD0NB
     I              LMGPWG                          WLGPWG
     I              LMD1NB                          WLD1NB
     I              LMGQWG                          WLGQWG
     I              LMD4NB                          WLD4NB
     I              LMGRWG                          WLGRWG
     I              LMTKST                          WLTKST
     I              LMTLST                          WLTLST
     I              LMTNST                          WLTNST
     I              LMCD3S                          WLCD3S
     I              LMTVST                          WLTVST
     I              LMTWST                          WLTWST
     I              LMUVST                          WLUVST
     I              LMUWST                          WLUWST
     I              LMUXST                          WLUXST
     I              LMVSST                          WLVSST
     I              LMAATM                          WLAATM
     I              LMAYNA                          WLAYNA
     I              LMA0NA                          WLA0NA
     I              LMAXDT                          WLAXDT
      *
     I@JDCPMR
      * PS Production Detail Com  Production Date
      * Renamed input format fields
     I              JDAIC3                          WMAIC3
     I              JDV5ST                          WMV5ST
     I              JDELDT                          WMELDT
     I              JDHGCD                          WMHGCD
     I              JDAJCD                          WMAJCD
     I              JDDXNB                          WMDXNB
     I              JDGXTX                          WMGXTX
     I              JDUVST                          WMUVST
     I              JDUWST                          WMUWST
     I              JDUXST                          WMUXST
     I              JDVSST                          WMVSST
     I              JDAATM                          WMAATM
     I              JDAYNA                          WMAYNA
     I              JDA0NA                          WMA0NA
     I              JDAXDT                          WMAXDT
      *
     I@JDCPU6
      * PS Production Detail Com  Update index
      * Renamed input format fields
     I              JDAIC3                          WOAIC3
     I              JDV5ST                          WOV5ST
     I              JDELDT                          WOELDT
     I              JDHGCD                          WOHGCD
     I              JDAJCD                          WOAJCD
     I              JDDXNB                          WODXNB
     I              JDGXTX                          WOGXTX
     I              JDUVST                          WOUVST
     I              JDUWST                          WOUWST
     I              JDUXST                          WOUXST
     I              JDVSST                          WOVSST
     I              JDAATM                          WOAATM
     I              JDAYNA                          WOAYNA
     I              JDA0NA                          WOA0NA
     I              JDAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJW1    E DSPDJWCPL0
      * UPD : PS Availability Audit     Update index
      * Renamed input format fields
     I              JWAIC3                          WBAIC3
     I              JWHMDT                          WBHMDT
     I              JWZPST                          WBZPST
     I              JWASQN                          WBASQN
     I              JWHYQT                          WBHYQT
     I              JWE8ST                          WBE8ST
     I              JWESWG                          WBESWG
     I              JWHZQT                          WBHZQT
     I              JWEQWG                          WBEQWG
     I              JWH0QT                          WBH0QT
     I              JWERWG                          WBERWG
     I              JWH4QT                          WBH4QT
     I              JWEWWG                          WBEWWG
     I              JWICDT                          WBICDT
     I              JWIDDT                          WBIDDT
     I              JWB7C7                          WBB7C7
     I              JWT0CD                          WBT0CD
     I              JWBXVN                          WBBXVN
     I              JWAORN                          WBAORN
     I              JWAOSN                          WBAOSN
     I              JWAOSL                          WBAOSL
     I              JWPSAT                          WBPSAT
     I              JWPSIS                          WBPSIS
     I              JWUVST                          WBUVST
     I              JWUWST                          WBUWST
     I              JWUXST                          WBUXST
     I              JWAATM                          WBAATM
     I              JWAYNA                          WBAYNA
     I              JWA0NA                          WBA0NA
     I              JWAXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDK21    E DSPDK2CPL0
      * UPD : PS Kill Plan              Update index
      * Renamed input format fields
     I              K2AIC3                          WDAIC3
     I              K2UPNB                          WDUPNB
     I              K2UQNB                          WDUQNB
     I              K2GGDT                          WDGGDT
     I              K2HVHD                          WDHVHD
     I              K2AVWE                          WDAVWE
     I              K2ESPC                          WDESPC
     I              K2ETPC                          WDETPC
     I              K2EUPC                          WDEUPC
     I              K2EVPC                          WDEVPC
     I              K2EWPC                          WDEWPC
     I              K2A0SX                          WDA0SX
     I              K2A1SX                          WDA1SX
     I              K2A2SX                          WDA2SX
     I              K2A3SX                          WDA3SX
     I              K2A4SX                          WDA4SX
     I              K2UVST                          WDUVST
     I              K2UWST                          WDUWST
     I              K2UXST                          WDUXST
     I              K2VSST                          WDVSST
     I              K2AATM                          WDAATM
     I              K2AYNA                          WDAYNA
     I              K2A0NA                          WDA0NA
     I              K2AXDT                          WDAXDT
      *
     IQPDI91    E DSPDI9CPL0
      * UPD : PS Production Adjustment  Update index
      * Renamed input format fields
     I              I9AIC3                          WFAIC3
     I              I9ELDT                          WFELDT
     I              I9HGCD                          WFHGCD
     I              I9AJCD                          WFAJCD
     I              I9PSAD                          WFPSAD
     I              I9PSAN                          WFPSAN
     I              I9PIAD                          WFPIAD
     I              I9V6ST                          WFV6ST
     I              I9D8C7                          WFD8C7
     I              I9UVST                          WFUVST
     I              I9UWST                          WFUWST
     I              I9UXST                          WFUXST
     I              I9VSST                          WFVSST
     I              I9AATM                          WFAATM
     I              I9AYNA                          WFAYNA
     I              I9A0NA                          WFA0NA
     I              I9AXDT                          WFAXDT
      *
     IQPDJC1    E DSPDJCCPL0
      * UPD : PS Prod Schedule          Update index
      * Renamed input format fields
     I              JCAIC3                          WHAIC3
     I              JCV5ST                          WHV5ST
     I              JCELDT                          WHELDT
     I              JCHVHD                          WHHVHD
     I              JCZ6NB                          WHZ6NB
     I              JCZ7NB                          WHZ7NB
     I              JCDGPC                          WHDGPC
     I              JCAVCW                          WHAVCW
     I              JCDIPC                          WHDIPC
     I              JCZ0NB                          WHZ0NB
     I              JCAVLE                          WHAVLE
     I              JCECWG                          WHECWG
     I              JCUVST                          WHUVST
     I              JCUWST                          WHUWST
     I              JCUXST                          WHUXST
     I              JCVSST                          WHVSST
     I              JCAATM                          WHAATM
     I              JCAYNA                          WHAYNA
     I              JCA0NA                          WHA0NA
     I              JCAXDT                          WHAXDT
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WJAIC3
     I              I8V5ST                          WJV5ST
     I              I8ELDT                          WJELDT
     I              I8HGCD                          WJHGCD
     I              I8AJCD                          WJAJCD
     I              I8GPDT                          WJGPDT
     I              I8WTSP                          WJWTSP
     I              I8QTSP                          WJQTSP
     I              I8DJPC                          WJDJPC
     I              I8F8WG                          WJF8WG
     I              I8WTIN                          WJWTIN
     I              I8D5NB                          WJD5NB
     I              I8DXWG                          WJDXWG
     I              I8B2NB                          WJB2NB
     I              I8WTCN                          WJWTCN
     I              I8PSCV                          WJPSCV
     I              I8SAWT                          WJSAWT
     I              I8B9NB                          WJB9NB
     I              I8D1WG                          WJD1WG
     I              I8CBNB                          WJCBNB
     I              I8EZWG                          WJEZWG
     I              I8CCNB                          WJCCNB
     I              I8E0WG                          WJE0WG
     I              I8D6NB                          WJD6NB
     I              I8OAWT                          WJOAWT
     I              I8CDNB                          WJCDNB
     I              I8UNW2                          WJUNW2
     I              I8CENB                          WJCENB
     I              I8F9WG                          WJF9WG
     I              I8BPNB                          WJBPNB
     I              I8GAWG                          WJGAWG
     I              I8BQNB                          WJBQNB
     I              I8GBWG                          WJGBWG
     I              I8BRNB                          WJBRNB
     I              I8GCWG                          WJGCWG
     I              I8BSNB                          WJBSNB
     I              I8GDWG                          WJGDWG
     I              I8BWNB                          WJBWNB
     I              I8GEWG                          WJGEWG
     I              I8PS6U                          WJPS6U
     I              I8WCST                          WJWCST
     I              I8WPST                          WJWPST
     I              I8B5ST                          WJB5ST
     I              I8TFST                          WJTFST
     I              I8TEST                          WJTEST
     I              I8THST                          WJTHST
     I              I8UDST                          WJUDST
     I              I8UFST                          WJUFST
     I              I8UGST                          WJUGST
     I              I8UHST                          WJUHST
     I              I8B6ST                          WJB6ST
     I              I8B7ST                          WJB7ST
     I              I8DVWG                          WJDVWG
     I              I8D7NB                          WJD7NB
     I              I8FCAD                          WJFCAD
     I              I8D9NB                          WJD9NB
     I              I8DWWG                          WJDWWG
     I              I8EANB                          WJEANB
     I              I8SHWT                          WJSHWT
     I              I8EBNB                          WJEBNB
     I              I8AVWT                          WJAVWT
     I              I8ECNB                          WJECNB
     I              I8WTON                          WJWTON
     I              I8EDNB                          WJEDNB
     I              I8FNWT                          WJFNWT
     I              I8EENB                          WJEENB
     I              I8QTAS                          WJQTAS
     I              I8EFNB                          WJEFNB
     I              I8WAIO                          WJWAIO
     I              I8EGNB                          WJEGNB
     I              I8R3CD                          WJR3CD
     I              I8RGNB                          WJRGNB
     I              I8RHNB                          WJRHNB
     I              I8RINB                          WJRINB
     I              I8XRCD                          WJXRCD
     I              I8UVST                          WJUVST
     I              I8UWST                          WJUWST
     I              I8UXST                          WJUXST
     I              I8VSST                          WJVSST
     I              I8AATM                          WJAATM
     I              I8AYNA                          WJAYNA
     I              I8A0NA                          WJA0NA
     I              I8AXDT                          WJAXDT
      *
     IQPDLM1    E DSPDLMCPL0
      * UPD : PS Prod Dept Schedule     Update index
      * Renamed input format fields
     I              LMAIC3                          WLAIC3
     I              LMV5ST                          WLV5ST
     I              LMELDT                          WLELDT
     I              LMR3CD                          WLR3CD
     I              LMRMPA                          WLRMPA
     I              LMGFWG                          WLGFWG
     I              LMGGWG                          WLGGWG
     I              LMCLNB                          WLCLNB
     I              LMGHWG                          WLGHWG
     I              LMDVNB                          WLDVNB
     I              LMGNWG                          WLGNWG
     I              LMDZNB                          WLDZNB
     I              LMGOWG                          WLGOWG
     I              LMD0NB                          WLD0NB
     I              LMGPWG                          WLGPWG
     I              LMD1NB                          WLD1NB
     I              LMGQWG                          WLGQWG
     I              LMD4NB                          WLD4NB
     I              LMGRWG                          WLGRWG
     I              LMTKST                          WLTKST
     I              LMTLST                          WLTLST
     I              LMTNST                          WLTNST
     I              LMCD3S                          WLCD3S
     I              LMTVST                          WLTVST
     I              LMTWST                          WLTWST
     I              LMUVST                          WLUVST
     I              LMUWST                          WLUWST
     I              LMUXST                          WLUXST
     I              LMVSST                          WLVSST
     I              LMAATM                          WLAATM
     I              LMAYNA                          WLAYNA
     I              LMA0NA                          WLA0NA
     I              LMAXDT                          WLAXDT
      *
     IQPDJD1    E DSPDJDCPL0
      * UPD : PS Production Detail Com  Update index
      * Renamed input format fields
     I              JDAIC3                          WOAIC3
     I              JDV5ST                          WOV5ST
     I              JDELDT                          WOELDT
     I              JDHGCD                          WOHGCD
     I              JDAJCD                          WOAJCD
     I              JDDXNB                          WODXNB
     I              JDGXTX                          WOGXTX
     I              JDUVST                          WOUVST
     I              JDUWST                          WOUWST
     I              JDUXST                          WOUXST
     I              JDVSST                          WOVSST
     I              JDAATM                          WOAATM
     I              JDAYNA                          WOAYNA
     I              JDA0NA                          WOA0NA
     I              JDAXDT                          WOAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1NGDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1NGDT    PARM           WP0001  70       Purge Date USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PPS Files Purges       XF
      * ***** Change Date and Comments
     C                     EXSR UASUBR                     ***** Change Da
      * *-------------------------------------------------------------*
      * Read all rcds for Purge - PS Availability Audit  * 
     C                     EXSR SARVGN
      * Read all rcds for Purge - PS Kill Plan  * 
     C                     EXSR SCRVGN
      * Read all rcds for Purge - PS Production Adjustment  * 
     C                     EXSR SERVGN
      * Read all rcds for Purge - PS Prod Schedule  * 
     C                     EXSR SGRVGN
      * Read all rcds for Purge - PS Prod Item Schedule  * 
     C                     EXSR SIRVGN
      * Read all rcds for Purge - PS Prod Dept Schedule  * 
     C                     EXSR SKRVGN
      * Read all rcds for Purge - PS Production Detail Com  * 
     C                     EXSR SMRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Availability Audit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@JWCPML                    *
     C                     READ @JWCPML                  90*
      * Data record not found
     C   90                MOVEL'USR2001' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.PSAA Audit Date LT PAR.Purge Date USR
     C           WAHMDT    IFLT P1NGDT                     *IF
      * DLT Avail Audit        DL - PS Availability Audit  * 
     C                     EXSR SBDLRC
     C                     END                             *FI
     C                     READ @JWCPML                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * DLT Avail Audit        DL - PS Availability Audit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JWCPBA
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAHMDT    WBHMDT           PSAA Audit Date
     C                     MOVELWAZPST    WBZPST           PSAA Audit Type
     C                     Z-ADDWAASQN    WBASQN           PSAA Audit Sequ
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHMDT           PSAA Audit Date
     C                     KFLD           WBZPST           PSAA Audit Type
     C                     KFLD           WBASQN           PSAA Audit Sequ
     C           KLDLSB    CHAIN@JWCPBA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJWCPL0'MDACP
     C                     MOVEL'@JWCPBA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JWCPBA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Kill Plan  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@K2CPKE                    *
     C                     READ @K2CPKE                  90*
      * Data record not found
     C   90                MOVEL'USR2368' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Kill Date LT PAR.Purge Date USR
     C           WCGGDT    IFLT P1NGDT                     *IF
      * DLT Kill Plan          DL - PS Kill Plan  * 
     C                     EXSR SDDLRC
     C                     END                             *FI
     C                     READ @K2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * DLT Kill Plan          DL - PS Kill Plan  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @K2CPKD
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCUPNB    WDUPNB           Min Carcass Wei
     C                     Z-ADDWCUQNB    WDUQNB           Max Carcass Wei
     C                     Z-ADDWCGGDT    WDGGDT           Kill Date
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDUPNB           Min Carcass Wei
     C                     KFLD           WDUQNB           Max Carcass Wei
     C                     KFLD           WDGGDT           Kill Date
     C           KLDLSD    CHAIN@K2CPKD              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDK2CPL0'MDACP
     C                     MOVEL'@K2CPKD' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@K2CPKD                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@I9CPMN                    *
     C                     READ @I9CPMN                  90*
      * Data record not found
     C   90                MOVEL'USR1765' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Date LT PAR.Purge Date USR
     C           WEELDT    IFLT P1NGDT                     *IF
      * DLT Prod. Adjustment   DL - PS Production Adjustment  * 
     C                     EXSR SFDLRC
     C                     END                             *FI
     C                     READ @I9CPMN                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Prod. Adjustment   DL - PS Production Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I9CPUU
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEELDT    WFELDT           Production Date
     C                     Z-ADDWEHGCD    WFHGCD           Item Code
     C                     MOVELWEAJCD    WFAJCD           Warehouse Code
     C                     MOVELWEPSAD    WFPSAD           PS Adjustment T
     C                     Z-ADDWEPSAN    WFPSAN           PS Adjustment N
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFPSAD           PS Adjustment T
     C                     KFLD           WFPSAN           PS Adjustment N
     C           KLDLSF    CHAIN@I9CPUU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI9CPL0'MDACP
     C                     MOVEL'@I9CPUU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I9CPUU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@JCCPMO                    *
     C                     READ @JCCPMO                  90*
      * Data record not found
     C   90                MOVEL'USR1795' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Date LT PAR.Purge Date USR
     C           WGELDT    IFLT P1NGDT                     *IF
      * DLT Production Hdr     DL - PS Prod Schedule  * 
     C                     EXSR SHDLRC
     C                     END                             *FI
     C                     READ @JCCPMO                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * DLT Production Hdr     DL - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JCCPVB
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     MOVELWGV5ST    WHV5ST           Production Type
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLDLSH    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHV5ST           Production Type
     C                     KFLD           WHELDT           Production Date
     C           KLDLSH    CHAIN@JCCPVB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJCCPL0'MDACP
     C                     MOVEL'@JCCPVB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JCCPVB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@I8CPMP                    *
     C                     READ @I8CPMP                  90*
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Date LT PAR.Purge Date USR
     C           WIELDT    IFLT P1NGDT                     *IF
      * DLT Production Dtl     DL - PS Prod Item Schedule  * 
     C                     EXSR SJDLRC
     C                     END                             *FI
     C                     READ @I8CPMP                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * DLT Production Dtl     DL - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @I8CPUR
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     MOVELWIV5ST    WJV5ST           Production Type
     C                     Z-ADDWIELDT    WJELDT           Production Date
     C                     Z-ADDWIHGCD    WJHGCD           Item Code
     C                     MOVELWIAJCD    WJAJCD           Warehouse Code
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJV5ST           Production Type
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLDLSJ    CHAIN@I8CPUR              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@I8CPUR                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@LMCPMQ                    *
     C                     READ @LMCPMQ                  90*
      * Data record not found
     C   90                MOVEL'USR2507' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Date LT PAR.Purge Date USR
     C           WKELDT    IFLT P1NGDT                     *IF
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
     C                     EXSR SLDLRC
     C                     END                             *FI
     C                     READ @LMCPMQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Delete PS Prod Dept Sched - PS Prod Dept Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LMCPO0
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     MOVELWKV5ST    WLV5ST           Production Type
     C                     Z-ADDWKELDT    WLELDT           Production Date
     C                     MOVELWKR3CD    WLR3CD           Department Code
      *
     C           KLDLSL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLR3CD           Department Code
     C           KLDLSL    CHAIN@LMCPO0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLMCPL0'MDACP
     C                     MOVEL'@LMCPO0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LMCPO0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Read all rcds for Purge - PS Production Detail Com  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@JDCPMR                    *
     C                     READ @JDCPMR                  90*
      * Data record not found
     C   90                MOVEL'USR1797' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Production Date LT PAR.Purge Date USR
     C           WMELDT    IFLT P1NGDT                     *IF
      * DLT Production Sched   DL - PS Production Detail Com  * 
     C                     EXSR SNDLRC
     C                     END                             *FI
     C                     READ @JDCPMR                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNDLRC    BEGSR
      *================================================================
      * DLT Production Sched   DL - PS Production Detail Com  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JDCPU6
     C                     Z-ADDWMAIC3    WOAIC3           Company Number
     C                     MOVELWMV5ST    WOV5ST           Production Type
     C                     Z-ADDWMELDT    WOELDT           Production Date
     C                     Z-ADDWMHGCD    WOHGCD           Item Code
     C                     MOVELWMAJCD    WOAJCD           Warehouse Code
     C                     Z-ADDWMDXNB    WODXNB           Sequence Number
      *
     C           KLDLSN    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOV5ST           Production Type
     C                     KFLD           WOELDT           Production Date
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOAJCD           Warehouse Code
     C                     KFLD           WODXNB           Sequence Number
     C           KLDLSN    CHAIN@JDCPU6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJDCPL0'MDACP
     C                     MOVEL'@JDCPU6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JDCPU6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Date and Comments
      *================================================================
      * *****
      * ** 08/14/2007 LJB FP1009
      * ** Removed company number. All files are purged by date.
      * ** Removed date calcs. This will be done in the calling program
      * ** and the purge date will be passed in.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHMDT           PSAA Audit Date
     C                     Z-ADD*ZERO     WAASQN           PSAA Audit Sequ
     C                     Z-ADD*ZERO     WAHYQT           PSAA Quantity O
     C                     Z-ADD*ZERO     WAESWG           PSAA Weight Ord
     C                     Z-ADD*ZERO     WAHZQT           PSAA Quantity A
     C                     Z-ADD*ZERO     WAEQWG           PSAA Weight All
     C                     Z-ADD*ZERO     WAH0QT           PSAA Quantity S
     C                     Z-ADD*ZERO     WAERWG           PSAA Weight Shi
     C                     Z-ADD*ZERO     WAH4QT           PSAA Quantity A
     C                     Z-ADD*ZERO     WAEWWG           PSAA Weight Adj
     C                     Z-ADD*ZERO     WAICDT           PSAA Ship Date
     C                     Z-ADD*ZERO     WAIDDT           PSAA Production
     C                     Z-ADD*ZERO     WAB7C7           PSAA Item Code
     C                     Z-ADD*ZERO     WAAORN           PSAA Order Numb
     C                     Z-ADD*ZERO     WAAOSN           PSAA Order Seq
     C                     Z-ADD*ZERO     WAAOSL           PSAA Order Seco
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCUPNB           Min Carcass Wei
     C                     Z-ADD*ZERO     WCUQNB           Max Carcass Wei
     C                     Z-ADD*ZERO     WCGGDT           Kill Date
     C                     Z-ADD*ZERO     WCHVHD           Hog Volume
     C                     Z-ADD*ZERO     WCAVWE           Average Weight
     C                     Z-ADD*ZERO     WCESPC           PSK Distributio
     C                     Z-ADD*ZERO     WCETPC           PSK Percent Unu
     C                     Z-ADD*ZERO     WCEUPC           PSK Percent Unu
     C                     Z-ADD*ZERO     WCEVPC           PSK Percent Unu
     C                     Z-ADD*ZERO     WCEWPC           PSK Percent Unu
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEPSAN           PS Adjustment N
     C                     Z-ADD*ZERO     WEPIAD           PS Adjustment Q
     C                     Z-ADD*ZERO     WED8C7           PS Consumed Ite
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHVHD           Hog Volume
     C                     Z-ADD*ZERO     WGZ6NB           Average Live We
     C                     Z-ADD*ZERO     WGZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WGDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WGAVCW           Average Cold We
     C                     Z-ADD*ZERO     WGDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WGZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WGAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WGECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIELDT           Production Date
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WIWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WIQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WIDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WIF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WIWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WID5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WIDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WIB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WIWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WIPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WISAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WIB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WID1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WICBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WIEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WICCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WIE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WID6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WIOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WICDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WIUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WICENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WIF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WIBPNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGAWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WID7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WIFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WID9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WIDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WIEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WISHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WIEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WIECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WIWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WIEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WIFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WIEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WIQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WIEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WIEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKELDT           Production Date
     C                     Z-ADD*ZERO     WKRMPA           CDS RM Pieces A
     C                     Z-ADD*ZERO     WKGFWG           CDS RM Weight A
     C                     Z-ADD*ZERO     WKGGWG           CDS Avg Piece W
     C                     Z-ADD*ZERO     WKCLNB           CDS CV Pieces A
     C                     Z-ADD*ZERO     WKGHWG           CDS CV Weight A
     C                     Z-ADD*ZERO     WKDVNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WKGNWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WKDZNB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WKGOWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WKD0NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WKGPWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WKD1NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WKGQWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WKD4NB           CDS Pieces Unus
     C                     Z-ADD*ZERO     WKGRWG           CDS Weight Unus
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMDXNB           Sequence Number
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
