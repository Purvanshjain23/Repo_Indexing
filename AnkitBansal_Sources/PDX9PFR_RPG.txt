     H/TITLE PRT Daily Holdovers    PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/08/21  Time  : 11:42:12
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FPPB5REL1IF  E           K        DISK
      * RTV : On Time Reason Codes      Retrieval index
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPDX9PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Daily Holdovers    PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WABZNA
     I              FFADTX                          WAADTX
     I              FFACNA                          WAACNA
     I              FFADNA                          WAADNA
     I              FFAENA                          WAAENA
     I              FFAJNA                          WAAJNA
     I              FFBTTX                          WABTTX
     I              FFEZNB                          WAEZNB
     I              FFBGCD                          WABGCD
     I              FFEEDT                          WAEEDT
     I              FFDUTX                          WADUTX
     I              FFNRVA                          WANRVA
     I              FFNSVA                          WANSVA
     I              FFNTVA                          WANTVA
     I              FFNUVA                          WANUVA
     I              FFP1ST                          WAP1ST
     I              FFDVTX                          WADVTX
     I              FFDWTX                          WADWTX
     I              FFLVCD                          WALVCD
     I              FFS8NB                          WAS8NB
     I              FFS9NB                          WAS9NB
     I              FFNMVA                          WANMVA
     I              FFNOVA                          WANOVA
     I              FFNPVA                          WANPVA
     I              FFNQVA                          WANQVA
     I              FFMFCD                          WAMFCD
     I              FFQXNB                          WAQXNB
     I              FFQ1NB                          WAQ1NB
     I              FFMRNG                          WAMRNG
     I              FFMRNE                          WAMRNE
     I              FFRFNB                          WARFNB
     I              FFMREG                          WAMREG
     I              FFBQPR                          WABQPR
     I              FFBRPR                          WABRPR
     I              FFBSPR                          WABSPR
     I              FFBTPR                          WABTPR
     I              FFBUPR                          WABUPR
     I              FFBVPR                          WABVPR
     I              FFDJWG                          WADJWG
     I              FFDKWG                          WADKWG
     I              FFDLWG                          WADLWG
     I              FFDMWG                          WADMWG
     I              FFDNWG                          WADNWG
     I              FFDOWG                          WADOWG
     I              FFB2PR                          WAB2PR
     I              FFB3PR                          WAB3PR
     I              FFB4PR                          WAB4PR
     I              FFB5PR                          WAB5PR
     I              FFB6PR                          WAB6PR
     I              FFB7PR                          WAB7PR
     I              FFAAC7                          WAAAC7
     I              FFCOFI                          WACOFI
     I              FFK6TX                          WAK6TX
     I              FFOCNA                          WAOCNA
     I              FFODNA                          WAODNA
     I              FFW7CD                          WAW7CD
     I              FFK7TX                          WAK7TX
     I              FFTENO                          WATENO
     I              FFK8TX                          WAK8TX
     I              FFAOFC                          WAAOFC
     I              FFAOLI                          WAAOLI
     I              FFKHDT                          WAKHDT
     I              FFUNUS                          WAUNUS
     I              FFUNU2                          WAUNU2
     I              FFUNU3                          WAUNU3
     I              FFUVST                          WAUVST
     I              FFUWST                          WAUWST
     I              FFUXST                          WAUXST
     I              FFVSST                          WAVSST
     I              FFAATM                          WAAATM
     I              FFAYNA                          WAAYNA
     I              FFA0NA                          WAA0NA
     I              FFAXDT                          WAAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLAIC3                          WBAIC3
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLKEDT                          WBKEDT
     I              FLSXNB                          WBSXNB
     I              FLKFDT                          WBKFDT
     I              FLACTM                          WBACTM
     I              FLK5TX                          WBK5TX
     I              FLW5CD                          WBW5CD
     I              FLEJDT                          WBEJDT
     I              FLAGTM                          WBAGTM
     I              FLKJDT                          WBKJDT
     I              FLATTM                          WBATTM
     I              FLHDDT                          WBHDDT
     I              FLAUTM                          WBAUTM
     I              FLKKDT                          WBKKDT
     I              FLAVTM                          WBAVTM
     I              FLZ4NB                          WBZ4NB
     I              FLY7ST                          WBY7ST
     I              FLY2ST                          WBY2ST
     I              FLWHTX                          WBWHTX
     I              FLWITX                          WBWITX
     I              FLWJTX                          WBWJTX
     I              FLWKTX                          WBWKTX
     I              FLWLTX                          WBWLTX
     I              FLN7DT                          WBN7DT
     I              FLN8DT                          WBN8DT
     I              FLN9DT                          WBN9DT
     I              FLB3TM                          WBB3TM
     I              FLB4TM                          WBB4TM
     I              FLB5TM                          WBB5TM
     I              FLIASX                          WBIASX
     I              FLIBSX                          WBIBSX
     I              FLICSX                          WBICSX
     I              FLWVTX                          WBWVTX
     I              FLWWTX                          WBWWTX
     I              FLWXTX                          WBWXTX
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   3   60P1AODT
     IP2PARM      DS
      * I :  Daily HoldOver Rpt Type
     I                                        1   1 P2XEST
     IP3PARM      DS
      * FLD: *Arrays
      * I :  Thru Date             USR
     I                                    P   1   40P3OADT
      * I :  Date In
     I                                    P   5   80P3KCDT
      * I :  Time In
     I                                    P   9  120P3TMIN
      * I :  USR Time
     I                                    P  13  160P3WENB
     IP4PARM      DS
      * FLD: *Arrays
      * I :  USR Warehouse Code
     I                                        1   3 P4CPCD
      * I :  USR CDE Parm 1
     I                                        4   6 P4VSCD
      * I :  USR CDE Parm 2
     I                                        7   9 P4VTCD
      * I :  USR CDE Parm 3
     I                                       10  12 P4VUCD
      * I :  USR CDE Parm 4
     I                                       13  15 P4VVCD
      * I :  USR CDE Parm 5
     I                                       16  18 P4VWCD
      * I :  USR CDE Parm 6
     I                                       19  21 P4VXCD
      * I :  USR CDE Parm 7
     I                                       22  24 P4VYCD
      * I :  USR CDE Parm 8
     I                                       25  27 P4VZCD
      * I :  USR CDE Parm 9
     I                                       28  30 P4V0CD
      * I :  USR Select/Omit Flag
     I                                       31  31 P4CYST
     IP5PARM      DS
      * I :  Carrier Code Usr
     I                                        1   3 P5H8AA
     IP6PARM      DS
      * B :  USR Display 1
     I                                        1   1 P6TIST
     IP7PARM      DS
      * N :  Record Found USR
     I                                        1   1 P7WXST
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AODT    PARM           WP0002  70       Scheduled Ship
     C           P2XEST    PARM           WP0003  1        Daily HoldOver
     C           P3OADT    PARM           WP0004  70       Thru Date
     C           P3KCDT    PARM           WP0005  70       Date In
     C           P3TMIN    PARM           WP0006  60       Time In
     C           P3WENB    PARM           WP0007  60       USR Time
     C           P4CPCD    PARM           WP0008  3        USR Warehouse C
     C           P4VSCD    PARM           WP0009  3        USR CDE Parm 1
     C           P4VTCD    PARM           WP0010  3        USR CDE Parm 2
     C           P4VUCD    PARM           WP0011  3        USR CDE Parm 3
     C           P4VVCD    PARM           WP0012  3        USR CDE Parm 4
     C           P4VWCD    PARM           WP0013  3        USR CDE Parm 5
     C           P4VXCD    PARM           WP0014  3        USR CDE Parm 6
     C           P4VYCD    PARM           WP0015  3        USR CDE Parm 7
     C           P4VZCD    PARM           WP0016  3        USR CDE Parm 8
     C           P4V0CD    PARM           WP0017  3        USR CDE Parm 9
     C           P4CYST    PARM           WP0018  1        USR Select/Omit
     C           P5H8AA    PARM           WP0019  3        Carrier Code Us
     C           P6TIST    PARM P6TIST    WP0020  1        USR Display 1
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Daily Holdovers    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * USER: On print of end of report format
      * * Set parm to email if at least one record printed    E004076
      * CASE: LCL.USR Display 5 is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       P6TIST           USR Display 1
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Daily Holdovers    PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@FJCPN3                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Ship From Wareh
     C                     MOVEL'Y'       W0AL01  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL02  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDFJAIC3    $CAIC3           Company Number
     C                     MOVELFJVPCD    $CVPCD           Ship From Wareh
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFJAIC3    $DAIC3           Company Number
     C                     MOVELFJVPCD    $DVPCD           Ship From Wareh
     C                     Z-ADDFJRMNB    $DRMNB           Load ID
     C                     Z-ADDFJAODT    $DAODT           Scheduled Ship
     C                     MOVELFJPJST    $DPJST           LTL Flag
     C                     MOVELFJPKST    $DPKST           Load Status
     C                     Z-ADDFJRNNB    $DRNNB           Reefer Temperat
     C                     MOVELFJDMTX    $DDMTX           Seal 1
     C                     MOVELFJDNTX    $DDNTX           Seal 2
     C                     MOVELFJDOTX    $DDOTX           Seal 3
     C                     MOVELFJWTTX    $DWTTX           Seal 4
     C                     MOVELFJWUTX    $DWUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    $DRPNB           Total Load Orde
     C                     Z-ADDFJFLAM    $DFLAM           Flat Amount
     C                     MOVELFJXQST    $DXQST           Allocate Pounds
     C                     Z-ADDFJRRNB    $DRRNB           Total Stops
     C                     MOVELFJDYTX    $DDYTX           Transloader Car
     C                     Z-ADDFJSBNB    $DSBNB           BOL Time
     C                     MOVELFJBZNA    $DBZNA           Carrier Code
     C                     MOVELFJDXTX    $DDXTX           Trailer Id
     C                     MOVEL*BLANK    $DADTX           Name
     C                     MOVEL*BLANK    $DAJNA           City
     C                     MOVEL*BLANK    $DEINA           State
     C                     MOVEL*BLANK    $DBCCD           Salesperson Cod
     C                     Z-ADDFJJ4DT    $DJ4DT           Truck Ready Dat
     C                     MOVELFJRONB    $DRONB           Truck Size
     C                     Z-ADDFJSQNB    $DSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    $DR1NB           Rated Freight
     C                     MOVELFJVCST    $DVCST           Ship Status
     C                     MOVELFJVDST    $DVDST           Load Type
     C                     Z-ADDFJSDNB    $DSDNB           Number Pallets
     C                     Z-ADDFJPAOU    $DPAOU           Number Pallets
     C                     Z-ADDFJDGWG    $DDGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    $DSXNB           Estimated Arriv
     C                     Z-ADDFJHADT    $DHADT           Actual Arrival
     C                     Z-ADDFJAART    $DAART           Actual Arrival
     C                     Z-ADDFJDHWG    $DDHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    $DDIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    $DAQDT           Actual Departur
     C                     Z-ADDFJS6NB    $DS6NB           Departure Time
     C                     Z-ADDFJPRTM    $DPRTM           Product Tempera
     C                     Z-ADDFJNPSV    $DNPSV           Number Spacers
     C                     MOVELFJJ8TX    $DJ8TX           Car/Veh. Initia
     C                     MOVELFJJ9TX    $DJ9TX           Recorder ID
     C                     MOVELFJQ2CD    $DQ2CD           Shipping Method
     C                     MOVELFJDBCD    $DDBCD           Ship To State C
     C                     Z-ADDFJGRWE    $DGRWE           Gross Weight
     C                     MOVELFJXCCD    $DXCCD           Carrier Broker
     C                     MOVELFJU2ST    $DU2ST           Export Status
     C                     Z-ADDFJF9DT    $DF9DT           Actual Ship Dat
     C                     MOVELFJONTM    $DONTM           On Time - (Y/N)
     C                     Z-ADDFJTRTM    $DTRTM           Truck Ready Tim
     C                     Z-ADDFJT4NB    $DT4NB           Schedule Sequen
     C                     Z-ADDFJJ5DT    $DJ5DT           Spotted Date
     C                     Z-ADDFJSPTM    $DSPTM           Spotted Time
     C                     Z-ADDFJJ6DT    $DJ6DT           Load Finished D
     C                     Z-ADDFJLFTM    $DLFTM           Load Finished T
     C                     Z-ADDFJJ7DT    $DJ7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    $DBOTM           BOL Complete Ti
     C                     Z-ADDFJTLMI    $DTLMI           Total Load Mile
     C                     Z-ADD*ZERO     $DEJDT           Actual Delivery
     C                     Z-ADDFJJ8DT    $DJ8DT           BOL Received Da
     C                     Z-ADDFJBLTM    $DBLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    $DKIDT           Truck Departure
     C                     Z-ADDFJASTM    $DASTM           Truck Departure
     C                     Z-ADDFJKADT    $DKADT           Adjusted Depart
     C                     Z-ADDFJAJCM    $DAJCM           Adjusted Depart
     C                     MOVELFJXACD    $DXACD           Shipping Line
     C                     MOVELFJOANA    $DOANA           Port Delv Termi
     C                     MOVELFJK4TX    $DK4TX           Vessel Name
     C                     Z-ADDFJVOAG    $DVOAG           Voyage
     C                     Z-ADDFJKBDT    $DKBDT           Sail Date
     C                     MOVELFJNBBO    $DNBBO           Booking Number
     C                     MOVELFJW4CD    $DW4CD           Discharge Port
     C                     Z-ADDFJEFDT    $DEFDT           Arrival Date
     C                     MOVELFJCNTN    $DCNTN           Container Numbe
     C                     Z-ADDFJKCDT    $DKCDT           Date In
     C                     Z-ADDFJTMIN    $DTMIN           Time In
     C                     Z-ADDFJKDDT    $DKDDT           Date Out
     C                     Z-ADDFJVMNB    $DVMNB           Time Out
     C                     Z-ADDFJOCFR    $DOCFR           Load Total Frei
     C                     Z-ADDFJKJDT    $DKJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    $DATTM           Scheduled Deliv
     C                     MOVELFJOTRS    $DOTRS           LH Unused Sts
     C                     MOVELFJRNST    $DRNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    $DBRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    $DEIDT           Requested Deliv
     C                     MOVELFJRMST    $DRMST           Load Acceptance
     C                     MOVELFJAJCD    $DAJCD           Warehouse Code
     C                     Z-ADDFJKKDT    $DKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $DAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $DKZDT           Deadline Depart
     C                     Z-ADDFJAXTM    $DAXTM           Deadline Depart
     C                     MOVELFJLHOS    $DLHOS           Load Held Over
     C                     MOVELFJLHOR    $DLHOR           Load Held Over
     C                     MOVELFJWNTX    $DWNTX           Load Held Over
     C                     MOVELFJOITX    $DOITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    $DOJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    $DLLDT           Express Mail Da
     C                     MOVELFJLSHG    $DLSHG           Load Shag Flag
     C                     MOVELFJYPST    $DYPST           Load Wash Flag
     C                     Z-ADDFJK0DT    $DK0DT           Product Complet
     C                     Z-ADDFJAYTM    $DAYTM           Product Complet
     C                     Z-ADDFJKNNX    $DKNNX           Pallets Loaded
     C                     Z-ADDFJICWG    $DICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    $DIDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    $DH9SX           Load Confirmed
     C                     MOVELFJWOTX    $DWOTX           Load Confirmed
     C                     Z-ADDFJK1DT    $DK1DT           Load Confirmati
     C                     Z-ADDFJAZTM    $DAZTM           Load Door 1
     C                     Z-ADDFJK2DT    $DK2DT           Override Total
     C                     Z-ADDFJA0TM    $DA0TM           Load Door 2
     C                     MOVELFJROST    $DROST           Partial Load
     C                     MOVELFJRPST    $DRPST           Load Confirmati
     C                     MOVELFJRQST    $DRQST           Export Load USD
     C                     MOVELFJRRST    $DRRST           Late Delivery E
     C                     Z-ADDFJZBVA    $DZBVA           Load Actual Fre
     C                     MOVELFJWPTX    $DWPTX           Hide on WW Load
     C                     MOVELFJWQTX    $DWQTX           Late Billing Em
     C                     MOVELFJWRTX    $DWRTX           Shipping Temp C
     C                     MOVELFJWSTX    $DWSTX           LH Held Over Rs
     C                     MOVELFJRVSX    $DRVSX           Multi Company L
     C                     MOVELFJRUSX    $DRUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    $DRWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    $DRXSX           LH Power Only L
     C                     MOVELFJRYSX    $DRYSX           MG Created Load
     C                     MOVELFJRZSX    $DRZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    $DR0SX           Load U/M
     C                     MOVELFJR1SX    $DR1SX           TPM Shipment St
     C                     MOVELFJR2SX    $DR2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    $DR3SX           LH On-Time Reas
     C                     MOVELFJR4SX    $DR4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    $DPYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    $DCKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    $DPZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    $DCLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    $DP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $DCMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    $DP1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    $DCNTM           LH Unused Time
     C                     Z-ADDFJP2DT    $DP2DT           LH Unused Date
     C                     Z-ADDFJCOTM    $DCOTM           LH Unused Time
     C                     Z-ADDFJP3DT    $DP3DT           LH Unused Date
     C                     Z-ADDFJCQTM    $DCQTM           LH Unused Time
     C                     MOVELFJUVST    $DUVST           EDI Status 1
     C                     MOVELFJUWST    $DUWST           EDI Status 2
     C                     MOVELFJUXST    $DUXST           EDI Status 3
     C                     Z-ADDFJAATM    $DAATM           Job Time
     C                     MOVELFJAYNA    $DAYNA           User Id
     C                     MOVELFJA0NA    $DA0NA           Job Name
     C                     Z-ADDFJAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Daily Holdover Dtl PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FJVPCD    WZA001           Ship From Wareh
     C                     MOVELFJVPCD    WZA001
     C           *LIKE     DEFN FJAODT    WZA002           Scheduled Ship
     C                     Z-ADDFJAODT    WZA002
     C           *LIKE     DEFN FJRMNB    WZA003           Load ID
     C                     Z-ADDFJRMNB    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @FJCPN3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Missed Deadline - report type 2
      * CASE: PAR.Daily HoldOver Rpt Type is Missed Deadline +12 Hours
     C           P2XEST    IFEQ '2'                        *IF
      * VAL Any Inv Ord on Ld  RT - Order Header TRG  * 
     C                     EXSR SSRVGN
      * If all orders on load are transfers, exclude load
      * CASE: PAR.Record Found USR is Record Not Found
     C           P7WXST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Company select
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c2ANDc1
      *   |- c2    : PAR.Company Number is greater than zero
      *   |- c1    : DB1.Company Number NE PAR.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFGT *ZERO                      *IF
     C           FJAIC3    IFNE P1AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR STRVGN
      * S00623 RMC allow til next day after 1am before considering a load
      * * If Report Type is All Holdovers
      * CASE: PAR.Daily HoldOver Rpt Type is All Holdovers
     C           P2XEST    IFEQ '1'                        *IF
      * LCL.Date                  USR = DB1.Scheduled Ship Date + CON.1 *
     C           FJAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0012
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0012
     C                     END
      * E00526 11/05/09 compare to company value time instead of hardcode
      * BOL Complete Date/Time
      * CASE: DB1.BOL Complete Date EQ LCL.Date                  USR
     C           FJJ7DT    IFEQ YL0012                     *IF
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0009    IFEQ 'BX'                       *IF
      * CASE: DB1.BOL Complete Time LT LCL.USR From Time 6.0
     C           FJBOTM    IFLT YL0002                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.BOL Complete Time LT LCL.USR To Time 6.0
     C           FJBOTM    IFLT YL0003                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 04/01/09 PKD E00380 If the Load departed before 1:00am the next
      *    day, then it's not a holdover. ** Compare to Comp value 11/05/
      * Truck Departure Date = Scheduled Ship Date
      * CASE: DB1.Truck Departure Date EQ DB1.Scheduled Ship Date
     C           FJKIDT    IFEQ FJAODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Truck Departure Date = Scheduled Ship Date + 1 & Time < 01:00:00
      * CASE: DB1.Truck Departure Date EQ LCL.Date                  USR
     C           FJKIDT    IFEQ YL0012                     *IF
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0009    IFEQ 'BX'                       *IF
      * CASE: DB1.Truck Departure Time LT LCL.USR From Time 6.0
     C           FJASTM    IFLT YL0002                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Truck Departure Time LT LCL.USR To Time 6.0
     C           FJASTM    IFLT YL0003                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * If Req Deliv Date Target Date passed, only select if matching E
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date In is Entered
     C           P3KCDT    IFNE *ZERO                      *IF
      * CASE: PAR.Date In NE DB1.Requested Delivery Date
     C           P3KCDT    IFNE FJEIDT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * If Carrier Code is passed in, only select if matching   E003914
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Carrier Code Usr is entered
     C           P5H8AA    IFNE *BLANK                     *IF
      * CASE: PAR.Carrier Code Usr NE DB1.Carrier Code
     C           P5H8AA    IFNE FJBZNA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Ship From Wareh
     C                     MOVEL*BLANK    W0AL01  1        Scheduled Ship
     C                     MOVEL*BLANK    W0AL02  1        Load ID
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Ship From Wareh
     C                     MOVEL'Y'       W0AL01  1        Scheduled Ship
     C                     MOVEL'Y'       W0AL02  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           FJVPCD    IFNE WZA001                     Ship From Wareh
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           FJAODT    IFNE WZA002                     Scheduled Ship
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           FJRMNB    IFNE WZA003                     Load ID
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Daily Holdover Dtl PO: Mainline
      *================================================================
      * PRT Daily Holdover Dtl PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQKB02           Load ID
      * Define keylist
     C           KPSB      KLIST
     C                     KFLD           WQKB02           Load ID
     C                     KFLD           FLRVNB           Stop/Drop
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB02           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    WQKB02           Load ID
     C                     Z-ADDWURVNB    FLRVNB           Stop/Drop
      * Establish starting position
     C           KPSB      SETLL@FLCPE8                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop/Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $EVPCD           Ship From Wareh
     C                     Z-ADDFLRMNB    $ERMNB           Load ID
     C                     MOVEL*BLANK    $EBZNA           Carrier Code
     C                     MOVEL*BLANK    $EOGNA           USR Carrier Nam
     C                     MOVEL*BLANK    $ES2TX           Trailer ID USR
     C                     MOVEL*BLANK    $EDXTX           Trailer Id
     C                     Z-ADDFLRVNB    $ERVNB           Stop/Drop
     C                     MOVEL*BLANK    $EN6TX           Text-19
     C                     MOVEL*BLANK    $EADTX           Name
     C                     MOVEL*BLANK    $EAJNA           City
     C                     MOVEL*BLANK    $EF2TX           USR City Short
     C                     MOVEL*BLANK    $EEINA           State
     C                     Z-ADD*ZERO     $EAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $EYANB           Deadline Depart
     C                     Z-ADD*ZERO     $EYBNB           Deadline Depart
     C                     MOVEL*BLANK    $EODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     $EJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     $ETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     $ERDTM           USR Ready Time
     C                     Z-ADD*ZERO     $ET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     $EJ6DT           Load Finished D
     C                     Z-ADD*ZERO     $EX7NB           Load Finished M
     C                     Z-ADD*ZERO     $ELFTM           Load Finished T
     C                     Z-ADD*ZERO     $EFDTM           USR Finished Ti
     C                     Z-ADD*ZERO     $EBFNX           USR Complete Da
     C                     Z-ADD*ZERO     $ECPTM           USR Complete Ti
     C                     Z-ADD*ZERO     $EBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     $EKIDT           Truck Departure
     C                     Z-ADD*ZERO     $EX8NB           Truck Departure
     C                     Z-ADD*ZERO     $E               USR Picked Up T
     C                     Z-ADD*ZERO     $EASTM           Truck Departure
     C                     Z-ADD*ZERO     $EBLTM           BOL Received Ti
     C                     Z-ADDFLZ4NB    $EZ4NB           MPC Number
     C                     MOVELFLY7ST    $EY7ST           Load Dtl On Tim
     C                     MOVELFLY2ST    $EY2ST           On Time Add'l R
     C                     MOVELFLWHTX    $EWHTX           Seal Nbr 1
     C                     MOVELFLWITX    $EWITX           Seal Nbr 2
     C                     MOVELFLWJTX    $EWJTX           Seal Nbr 3
     C                     MOVELFLWKTX    $EWKTX           Seal Nbr 4
     C                     MOVELFLWLTX    $EWLTX           Seal Nbr 5
     C                     Z-ADDFLN7DT    $EN7DT           LD Carrier Appt
     C                     Z-ADDFLN8DT    $EN8DT           LD Unused Date
     C                     Z-ADDFLN9DT    $EN9DT           LD Unused Date
     C                     Z-ADDFLB3TM    $EB3TM           LD Carrier Appt
     C                     Z-ADDFLB4TM    $EB4TM           LD Unused Time
     C                     Z-ADDFLB5TM    $EB5TM           LD Unused Time
     C                     MOVELFLIASX    $EIASX           Miles Error Sts
     C                     MOVELFLIBSX    $EIBSX           LD Unused Sts 2
     C                     MOVELFLICSX    $EICSX           HPB Transload S
     C                     MOVELFLWVTX    $EWVTX           LD Cst Svc Trac
     C                     MOVELFLWWTX    $EWWTX           Carrier Ref PRO
     C                     MOVELFLWXTX    $EWXTX           Cust Assigned A
     C                     Z-ADD*ZERO     $ETLMI           Total Load Mile
     C                     Z-ADDFLKJDT    $EKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     $EX9NB           Scheduled Deliv
     C                     MOVEL*BLANK    $EFNSX           Transfer in Sto
     C                     MOVEL*BLANK    $EJPNA           @Narrative 15
     C                     MOVEL*BLANK    $ESTTX           USR Text 7
     C                     Z-ADDFLRUNB    $ERUNB           Stop/Drop Seque
     C                     Z-ADDFLRWNB    $ERWNB           Miles to next s
     C                     Z-ADDFLRXNB    $ERXNB           Freight Charge
     C                     Z-ADDFLSQNB    $ESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFLT0NB    $ET0NB           Freight Misc. C
     C                     Z-ADDFLT1NB    $ET1NB           Freight Stop Ch
     C                     Z-ADDFLR1NB    $ER1NB           Rated Freight
     C                     Z-ADDFLAIC3    $EAIC3           Company Number
     C                     MOVEL*BLANK    $ECBAA           Warehouse Code
     C                     Z-ADDFLC4NB    $EC4NB           Order Number
     C                     Z-ADD*ZERO     $EOIDT           USR MMDD 1
     C                     Z-ADD*ZERO     $ESBNB           BOL Time
     C                     MOVEL*BLANK    $EWSTX           LH Held Over Rs
     C                     MOVELFLVCST    $EVCST           Ship Status
     C                     Z-ADDFLKEDT    $EKEDT           Estimated Arriv
     C                     Z-ADDFLSXNB    $ESXNB           Estimated Arriv
     C                     Z-ADDFLKFDT    $EKFDT           Appointment Con
     C                     Z-ADDFLACTM    $EACTM           Appointment Con
     C                     MOVELFLK5TX    $EK5TX           Confirmation Ma
     C                     MOVELFLW5CD    $EW5CD           Confirmation Nu
     C                     Z-ADDFLAGTM    $EAGTM           Actual Delivery
     C                     Z-ADDFLATTM    $EATTM           Scheduled Deliv
     C                     Z-ADDFLHDDT    $EHDDT           Deadline Depart
     C                     Z-ADDFLAUTM    $EAUTM           Deadline Depart
     C                     Z-ADDFLKKDT    $EKKDT           On Yard Date
     C                     MOVELFLUVST    $EUVST           EDI Status 1
     C                     MOVELFLUWST    $EUWST           EDI Status 2
     C                     MOVELFLUXST    $EUXST           EDI Status 3
     C                     Z-ADDFLAATM    $EAATM           Job Time
     C                     MOVELFLAYNA    $EAYNA           User Id
     C                     MOVELFLA0NA    $EA0NA           Job Name
     C                     Z-ADDFLAXDT    $EAXDT           Job Date
      * USER: Process before print of detail format
      * C2821:  want 0:01 to print, but don't want 0:00 to print.
     C                     MOVELWN0002    WN0003           USR Display 1
     C                     MOVELWN0002    WN0004           USR Display 2
     C                     MOVELWN0002    WN0005           USR Display 3
      * If Load Finished Time = 0, don't display Load Finished Time
      * CASE: PAR.Load Finished Time EQ WRK.ZERO
     C           $DLFTM    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       WN0003           USR Display 1
     C                     END                             *FI
      * If BOL Complete Time = 0, don't display BOL Complete Time
      * CASE: PAR.BOL Complete Time EQ WRK.ZERO
     C           $DBOTM    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       WN0004           USR Display 2
     C                     END                             *FI
      * If Truck Departure Time = 0, don't display Truck Departure Time
      * CASE: PAR.Truck Departure Time EQ WRK.ZERO
     C           $DASTM    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       WN0005           USR Display 3
     C                     END                             *FI
      * Print Stop information only once
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Load ID EQ PAR.USR Load ID
      *   |- c2    : DB1.Stop/Drop EQ PAR.USR Stop/Drop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           FLRMNB    IFEQ WN0001                     *IF
     C           FLRVNB    IFEQ WN0007                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     GOTO B2EXIT                     *QUIT
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * ** Only set off the display flag if the customer is not Promo
      * ** or samples. This will prevent invalid blank load id's. E00196
      * ** Setof display flag if customer is not Promotional/Samples  E00
      * CASE: LCL.Type Code is Not Promotional/Samples
     C           YL0005    IFNE 'PS'                       *IF
     C                     MOVEL'N'       WN0002           USR Display fie
     C                     END                             *FI
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FLRMNB    WZB001           Load ID
     C                     Z-ADDFLRMNB    WZB001
     C           *LIKE     DEFN FLRVNB    WZB002           Stop/Drop
     C                     Z-ADDFLRVNB    WZB002
     C           *LIKE     DEFN FLC4NB    WZB003           Order Number
     C                     Z-ADDFLC4NB    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FLCPE8                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Select passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Select
     C           P4CYST    IFEQ 'S'                        *IF
      * Select only Order Detail records matching warehouse codes passed
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P4CPCD    IFNE *BLANK                     *IF
     C           P4VSCD    ORNE *BLANK                     *OR
     C           P4VTCD    ORNE *BLANK                     *OR
     C           P4VUCD    ORNE *BLANK                     *OR
     C           P4VVCD    ORNE *BLANK                     *OR
     C           P4VWCD    ORNE *BLANK                     *OR
     C           P4VXCD    ORNE *BLANK                     *OR
     C           P4VYCD    ORNE *BLANK                     *OR
     C           P4VZCD    ORNE *BLANK                     *OR
     C           P4V0CD    ORNE *BLANK                     *OR
     C                     MOVEL'N'       WUDJST           Select Status
      * Check warehouse 1
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           P4CPCD    IFNE *BLANK                     *IF
      * RTV Check Warehouse    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4CPCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 2
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VSCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VSCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VTCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VTCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VUCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VUCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VVCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VVCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 6
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VWCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VWCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 7
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VXCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VXCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VYCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VYCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 9
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4VZCD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4VZCD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * Check warehouse 10
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   |- c2    : WRK.Select Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4V0CD    IFNE *BLANK                     *IF
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Check Warehouse    RT - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLAIC3    WL0011           Company Number
     C                     Z-ADDFLC4NB    WL0012           Order Number
     C                     MOVELP4V0CD    WL0013    P      Warehouse Code
     C                     MOVELWUDJST    WL0014    P      Select Status
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUDJST    P      Select Status
     C                     END                             *FI
      * If select status is no then do not select record
      * CASE: WRK.Select Status is no
     C           WUDJST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Omit passed warehouses
      * CASE: PAR.USR Select/Omit Flag is Omit
     C           P4CYST    IFEQ 'O'                        *IF
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR SRRVGN
      * Omit any Order Detail records matching warehouse codes passed in
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code not Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code not Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code not Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code not Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code not Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code not Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code not Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code not Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code not Blank
      *   '-
     C           P4CPCD    IFNE *BLANK                     *IF
     C           P4VSCD    ORNE *BLANK                     *OR
     C           P4VTCD    ORNE *BLANK                     *OR
     C           P4VUCD    ORNE *BLANK                     *OR
     C           P4VVCD    ORNE *BLANK                     *OR
     C           P4VWCD    ORNE *BLANK                     *OR
     C           P4VXCD    ORNE *BLANK                     *OR
     C           P4VYCD    ORNE *BLANK                     *OR
     C           P4VZCD    ORNE *BLANK                     *OR
     C           P4V0CD    ORNE *BLANK                     *OR
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10
      *   |- c1    : PAR.USR Warehouse Code EQ WRK.Warehouse Code
      *   |- c2    : PAR.USR CDE Parm 1 EQ WRK.Warehouse Code
      *   |- c3    : PAR.USR CDE Parm 2 EQ WRK.Warehouse Code
      *   |- c4    : PAR.USR CDE Parm 3 EQ WRK.Warehouse Code
      *   |- c5    : PAR.USR CDE Parm 4 EQ WRK.Warehouse Code
      *   |- c6    : PAR.USR CDE Parm 5 EQ WRK.Warehouse Code
      *   |- c7    : PAR.USR CDE Parm 6 EQ WRK.Warehouse Code
      *   |- c8    : PAR.USR CDE Parm 7 EQ WRK.Warehouse Code
      *   |- c9    : PAR.USR CDE Parm 8 EQ WRK.Warehouse Code
      *   |- c10   : PAR.USR CDE Parm 9 EQ WRK.Warehouse Code
      *   '-
     C           P4CPCD    IFEQ WUAJCD                     *IF
     C           P4VSCD    OREQ WUAJCD                     *OR
     C           P4VTCD    OREQ WUAJCD                     *OR
     C           P4VUCD    OREQ WUAJCD                     *OR
     C           P4VVCD    OREQ WUAJCD                     *OR
     C           P4VWCD    OREQ WUAJCD                     *OR
     C           P4VXCD    OREQ WUAJCD                     *OR
     C           P4VYCD    OREQ WUAJCD                     *OR
     C           P4VZCD    OREQ WUAJCD                     *OR
     C           P4V0CD    OREQ WUAJCD                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Load ID
     C                     MOVEL*BLANK    W0BL01  1        Stop/Drop
     C                     MOVEL*BLANK    W0BL02  1        Order Number
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Load ID
     C                     MOVEL'Y'       W0BL01  1        Stop/Drop
     C                     MOVEL'Y'       W0BL02  1        Order Number
     C                     ELSE
      * Next record - Detect level breaks
     C           FLRMNB    IFNE WZB001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FLRVNB    IFNE WZB002                     Stop/Drop
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FLC4NB    IFNE WZB003                     Order Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
      * PRTOBJ calls after print of Load ID format
      * Embedded PRTOBJ : PRT Holdover Trff Cmts PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * PRT Holdover Trff Cmts PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQKC01           Load ID
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    WQKC01           Load ID
      * Establish starting position
     C           KRSC      SETLL@KECPGI                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDKERMNB    $FRMNB           Load ID
     C                     Z-ADDKEDXNB    $FDXNB           Sequence Number
     C                     MOVELKEGXTX    $FGXTX           Comment Line
     C                     MOVELKEUVST    $FUVST           EDI Status 1
     C                     MOVELKEUWST    $FUWST           EDI Status 2
     C                     MOVELKEUXST    $FUXST           EDI Status 3
     C                     MOVELKEVSST    $FVSST           Record Status
     C                     Z-ADDKEAATM    $FAATM           Job Time
     C                     MOVELKEAYNA    $FAYNA           User Id
     C                     MOVELKEA0NA    $FA0NA           Job Name
     C                     Z-ADDKEAXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KERMNB    WZC001           Load ID
     C                     Z-ADDKERMNB    WZC001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@KECPGI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Load ID
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           KERMNB    IFNE WZC001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Daily Holdovers    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Daily Holdovers    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Ship From Warehouse of PRT Daily Holdovers    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$CKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Scheduled Ship Date of PRT Daily Holdovers    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Load ID of PRT Daily Holdovers    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of PRT Daily Holdovers    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
     C                     MOVEL'N'       WUDTSX           Print (Yes/No)
      * Mention hidden format
     C   99N99             WRITE$DDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Daily Holdover Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Load ID of PRT Daily Holdover Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Stop/Drop of PRT Daily Holdover Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Number of PRT Daily Holdover Dtl PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of PRT Daily Holdover Dtl PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * * Set flag for at least one load record is printed    E004076
     C                     MOVEL'Y'       YL0001           USR Display 5
      * CUR = PAR By name
     C                     MOVEL$DVPCD    $EVPCD           Ship From Wareh
     C                     Z-ADD$DRMNB    $ERMNB           Load ID
     C                     MOVEL$DBZNA    $EBZNA           Carrier Code
     C                     MOVEL$DDXTX    $EDXTX           Trailer Id
     C                     Z-ADDWURVNB    $ERVNB           Stop/Drop
     C                     Z-ADD$DAODT    $EAODT           Scheduled Ship
     C                     Z-ADD$DT4NB    $ET4NB           Schedule Sequen
     C                     Z-ADD$DJ6DT    $EJ6DT           Load Finished D
     C                     Z-ADD$DLFTM    $ELFTM           Load Finished T
     C                     Z-ADD$DBOTM    $EBOTM           BOL Complete Ti
     C                     Z-ADD$DKIDT    $EKIDT           Truck Departure
     C                     Z-ADD$DASTM    $EASTM           Truck Departure
     C                     Z-ADD$DBLTM    $EBLTM           BOL Received Ti
     C                     Z-ADD$DTLMI    $ETLMI           Total Load Mile
     C                     MOVEL$DWSTX    $EWSTX           LH Held Over Rs
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR SGRVGN
     C                     MOVEL$DDXTX    $ES2TX           Trailer ID USR
      * Rtv Cust# & TIS Ind    RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * CASE: CUR.Transfer in Storage Ind is No
     C           $EFNSX    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    WUPFTX           Text 1 Length U
     C                     MOVELWUPFTX    $EFNSX           Transfer in Sto
     C                     END                             *FI
      * Rtv Co/Customer Type - Company Customer  * 
     C                     EXSR SIRVGN
      * ** 09/26/2007 FT558 LJB
      * ** Skip printing if customer is Promotional/Samples
      * CASE: LCL.Type Code is Is Promotional/Samples
     C           YL0005    IFEQ 'PS'                       *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * RTV Cust Name/Addr     RT - Customer  * 
     C                     EXSR SJRVGN
      * CUR.Deadline Departure MM/DD = PAR.Deadline Departure Date
     C                     Z-ADD$DKZDT    $EYANB           Deadline Depart
     C           $DAXTM    DIV  100       $EYBNB           Deadline Depart
      * Rtv 1st Ord Delv Date RT - OM Load Detail  * 
     C                     EXSR SKRVGN
      * CUR.Scheduled Delivery MM/DD = CUR.Scheduled Delivery Date
     C                     Z-ADD$EKJDT    $EX9NB           Scheduled Deliv
      * CUR.Load Finished MM/DD   USR = PAR.Load Finished Date
     C                     Z-ADD$DJ6DT    $EX7NB           Load Finished M
     C           $DLFTM    DIV  100       $EFDTM           USR Finished Ti
      * CUR.USR Complete Date = PAR.BOL Complete Date
     C                     Z-ADD$DJ7DT    $EBFNX           USR Complete Da
     C           $DBOTM    DIV  100       $ECPTM           USR Complete Ti
      * CUR.Truck Departure MM/DD = PAR.Truck Departure Date
     C                     Z-ADD$DKIDT    $EX8NB           Truck Departure
     C           $DASTM    DIV  100       $E               USR Picked Up T
      * ** Get On Time Reason description from the new On Time Reason fil
     C           $DBLTM    DIV  100       $ESBNB           BOL Time
      * CUR.USR MMDD 1 = PAR.BOL Received Date
     C                     Z-ADD$DJ8DT    $EOIDT           USR MMDD 1
      * ** Include BOL Received Date/Time                     E002962
      * ** On Time Reason Code Description
      * CASE: PAR.LH On-Time Reason Code is Blank
     C           $DR3SX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $EJPNA           @Narrative 15
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV OT Resaon Descript RT - On Time Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$DR3SX    WL0004    P      On Time Reason
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $EJPNA    P      OTR Description
     C                     END                             *FI
      * ** Holdover Reason and Holdover reason description
      * CASE: PAR.LH Held Over Reason is *Blanks
     C           $DR4SX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $EWSTX           LH Held Over Rs
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV OT Resaon Descript RT - On Time Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$DR4SX    WL0004    P      On Time Reason
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUHTT1    P      OTR Description
     C                     MOVELWUHTT1    $ESTTX           USR Text 7
     C                     END                             *FI
      * ** Held over reason comment
      * CASE: CUR.Load ID EQ PAR.USR Load ID
     C           $ERMNB    IFEQ WN0001                     *IF
     C                     MOVEL'N'       YL0004           Print (Yes/No)
     C                     MOVEL*BLANK    $EWSTX           LH Held Over Rs
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0004           Print (Yes/No)
     C                     END                             *FI
      * PAR.USR Load ID = DB1.Load ID
     C                     Z-ADDFLRMNB    WN0001           USR Load ID
     C                     Z-ADDFLRVNB    WN0007           USR Stop/Drop
     C                     Z-ADDFLRVNB    $ERVNB           Stop/Drop
      * 05/11/04 SLM PKTR01 Multi-Company - Function was changed
      * RTV UM/Whs Code        RT - Order Header TRG  * 
     C                     EXSR SNRVGN
      * RTV From/To WHS   PFS RT - Order Detail  * 
     C                     EXSR SPRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $EAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEAODT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $EAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$EAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VEAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEC4NB           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WN0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WN0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WN0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WN0005    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of PRT Holdover Trff Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Load ID of PRT Holdover Trff Cmts PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Detail line. of PRT Holdover Trff Cmts PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Daily Holdovers    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship From Warehouse of PRT Daily Holdovers    PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Scheduled Ship Date of PRT Daily Holdovers    PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Daily Holdovers    PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Daily Holdovers    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Daily Holdover Dtl PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Daily Holdover Dtl PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Stop/Drop of PRT Daily Holdover Dtl PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT Daily Holdover Dtl PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Daily Holdover Dtl PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Holdover Trff Cmts PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Holdover Trff Cmts PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Holdover Trff Cmts PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
      * Company selected
      * CASE: TOP.Company Number is greater than zero
     C           $BAIC3    IFGT *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BADTX           Name
     C                     MOVEL'*ALL'    $BADTX           Name
     C                     END                             *FI
     C                     Z-ADDP1AODT    $BAODT           Scheduled Ship
     C                     MOVELP2XEST    $BXEST           Daily HoldOver
      * TOP.Condition Desc. 1  USR = Condition name of TOP.Daily HoldOver
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1493224   Y2LSNO  70       List number
     C                     PARM $BXEST    W0INVL 25        Daily HoldOver
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     Z-ADDP3TMIN    $BTMIN           Time In
     C                     Z-ADDP3OADT    $BOADT           Thru Date
     C                     Z-ADDP3WENB    $BVMNB           Time Out
      * * Put passed in delivery date in the heading          E003072
      * * This date will affect records selected from the load header
     C                     Z-ADDP3KCDT    $BKCDT           Date In
     C                     MOVELP5H8AA    $BH8AA           Carrier Code Us
     C                     MOVEL'N'       WUDWSX           Print Selection
     C                     MOVEL'N'       WUQKST           Display Flag
      * Business day process
      * CASE: TOP.Daily HoldOver Rpt Type is Business Day 0600-0559 am
     C           $BXEST    IFEQ '3'                        *IF
     C                     MOVEL@CN,003   $BSLTX           Text USR 20
      * CASE: WRK.Print (Yes/No) USR is Yes
     C           WUDTSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUDWSX           Print Selection
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,004   $BSLTX           Text USR 20
     C                     END                             *FI
      * Set up warehouses
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10
      *   |- c1    : PAR.USR Warehouse Code is Warehouse Code Blank
      *   |- c2    : PAR.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : PAR.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : PAR.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : PAR.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : PAR.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : PAR.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : PAR.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : PAR.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : PAR.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4CPCD    IFEQ *BLANK                     *IF
     C           P4VSCD    IFEQ *BLANK                     *IF
     C           P4VTCD    IFEQ *BLANK                     *IF
     C           P4VUCD    IFEQ *BLANK                     *IF
     C           P4VVCD    IFEQ *BLANK                     *IF
     C           P4VWCD    IFEQ *BLANK                     *IF
     C           P4VXCD    IFEQ *BLANK                     *IF
     C           P4VYCD    IFEQ *BLANK                     *IF
     C           P4VZCD    IFEQ *BLANK                     *IF
     C           P4V0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ALL'     $BZUCD           Warehouse 1 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP4CPCD    $BZUCD           Warehouse 1 USR
     C                     MOVELP4VSCD    $BZVCD           Warehouse 2 USR
     C                     MOVELP4VTCD    $BZWCD           Warehouse 3 USR
     C                     MOVELP4VUCD    $BZXCD           Warehouse 4 USR
     C                     MOVELP4VVCD    $BZYCD           Warehouse 5 USR
     C                     MOVELP4VWCD    $BZZCD           Warehouse 6 USR
     C                     MOVELP4VXCD    $BZ0CD           Warehouse 7 USR
     C                     MOVELP4VYCD    $BZ1CD           Warehouse 8 USR
     C                     MOVELP4VZCD    $BZ2CD           Warehouse 9 USR
     C                     MOVELP4V0CD    $BZ3CD           Warehouse 10 US
     C                     END                             *FI
      * TOP.USR Desc. 10 = Condition name of PAR.USR Select/Omit Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1377659   Y2LSNO  70       List number
     C                     PARM P4CYST    W0INVL 25        USR Select/Omit
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
      * * Put *ALL in Carrier Code name if carrier code is blank   3914
      * CASE: TOP.Carrier Code Usr is entered
     C           $BH8AA    IFNE *BLANK                     *IF
      * RTV Active Carr Name   RT - Carrier  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BW1TX           Carrier Name DR
     C                     MOVEL'*ALL'    $BW1TX           Carrier Name DR
     C                     END                             *FI
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $BAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBAODT
      * Convert Date In to display format
      * Convert date
     C           1000000   ADD  $BKCDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBKCDT
      * Convert Thru Date             USR to display format
      * Convert date
     C           1000000   ADD  $BOADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBOADT
     C                     MOVEL'0'       *IN79
     C           WUDTSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUDWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0001    KMAIC3           Company Number
     C                     MOVELWL0002    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0003           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Active Carr Name   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$BH8AA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSE     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $BADTX           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Last Stop on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSF02           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    WQSF02           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FLCPE8                    *
     C           KRSSF     READE@FLCPE8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURVNB           Stop/Drop
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WURVNB           Stop/Drop
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WABZNA           Carrier Code
      * Setup key
     C                     MOVEL$EBZNA    WABZNA           Carrier Code
      * Establish starting position
     C           KRSSG     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EOGNA           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAADTX    $EOGNA           Name
     C                     MOVELWAVSST    WUVSST           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Cust# & TIS Ind    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD$EAIC3    BEAIC3           Company Number
     C                     Z-ADD$EC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     MOVEL*BLANK    $EFNSX           Transfer in Sto
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    WUBKC7           Ship To Custome
     C                     MOVELBEFNSX    $EFNSX           Transfer in Sto
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Co/Customer Type - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$EAIC3    EOAIC3           Company Number
     C                     Z-ADDWUBKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     MOVEL*BLANK    YL0005           Type Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    YL0005           Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWUBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    $EN6TX           Customer Name
     C                     MOVELBBACNA    WUACNA           Address Line 1
     C                     MOVELBBADNA    WUADNA           Address Line 2
     C                     MOVELBBAENA    WUAENA           Address Line 3
     C                     MOVELBBAJNA    $EF2TX           City
     C                     MOVELBBBGCD    $EEINA           State Code
     C                     MOVELBBBTTX    WUBTTX           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Date RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSK02           Load ID
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK02           Load ID
     C                     KFLD           WBRVNB           Stop/Drop
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADD$ERMNB    WQSK02           Load ID
     C                     Z-ADDFLRVNB    WBRVNB           Stop/Drop
      * Establish starting position
     C           KPSSK     SETLL@FLCPEB                    *
     C           KRSSK     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date     RT - Order Header TRG  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    BEAIC3           Company Number
     C                     Z-ADDWBC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $EKJDT           Requested Deliv
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEEIDT    $EKJDT           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV OT Resaon Descript RT - On Time Reason Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           B5G3AA           On Time Reason
      * Setup key
     C                     MOVELWL0004    B5G3AA           On Time Reason
      * Establish starting position
     C           KRSSM     CHAIN@B5REF6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3631' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           OTR Description
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB5HTT1    WL0005           OTR Description
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    $EODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0006           Boxes Total Qua
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSN01           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADD$ERMNB    WQSN01           Load ID
     C                     Z-ADD*ZERO     WCC4NB           Order Number
      * Establish starting position
     C           KPSSN     SETLL@BFCPR0                    *
     C           KRSSN     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADD1         WL0008           Order Sequence
     C                     MOVEL$EODCD    WL0009    P      USR Unit of Mea
     C                     Z-ADDYL0006    WL0010           Boxes Total Qua
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    $EODCD    P      USR Unit of Mea
     C                     Z-ADDWL0010    YL0006           Boxes Total Qua
      * If doing for one Order, because it isnt tied to a load yet
      * CASE: DB1.Load ID is Blank
     C           WCRMNB    IFEQ 0                          *IF
      * CASE: PAR.USR Unit of Measure is Mixed
     C           $EODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVEL'BOXLOAD' WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0008           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0006    IFLT YL0008                     *IF
     C                     MOVEL'CB'      $EODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      $EODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * orig code
     C           KRSSN     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           $EODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVEL'BOXLOAD' WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0008           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0006    IFLT YL0008                     *IF
     C                     MOVEL'CB'      $EODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      $EODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSO02           Order Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSO01           Company Number
     C                     Z-ADDWL0007    WQSO02           Order Number
     C                     Z-ADDWL0008    OMDPNB           Order Sequence
      * Establish starting position
     C           KPSSO     SETLL@BGWKL1                    *
     C           KRSSO     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           USR Unit of Mea
     C                     Z-ADD*ZERO     WL0010           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT                     *QUIT
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0007           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0007    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0007           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0007    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    WL0010           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           WL0009    IFEQ *BLANK                     *IF
     C                     MOVELYL0007    WL0009           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0007    IFEQ WL0009                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WL0009           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV From/To WHS   PFS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSP02           Order Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADD$EAIC3    WQSP01           Company Number
     C                     Z-ADD$EC4NB    WQSP02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSP     SETLL@BGWKL1                    *
     C           KRSSP     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $ECBAA           Warehouse Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    $ECBAA           Warehouse Code
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Check Warehouse    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADDWL0011    WQSQ01           Company Number
     C                     Z-ADDWL0012    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BGWKL1                    *
     C           KRSSQ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.Warehouse Code
     C           OMAJCD    IFEQ WL0013                     *IF
     C                     MOVEL'Y'       WL0014           Select Status
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSR02           Order Number
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WQSR01           Company Number
     C                     Z-ADDFLC4NB    WQSR02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAJCD           Warehouse Code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WUAJCD           Warehouse Code
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * VAL Any Inv Ord on Ld  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * record not found means all orders on load are transfers
      * record found means there's 1+ orders on load which are not transf
     C                     MOVEL'N'       P7WXST           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSS02           Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQSS02           Load ID
      * Establish starting position
     C           KRSSS     SETLL@BFCPD9                    *
     C           KRSSS     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Billing Activity Type is Invoice
     C           WDOBST    IFEQ '1'                        *IF
     C                     MOVEL'Y'       P7WXST           Record Found US
     C                     GOTO SSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSS     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0009           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQST01           Load ID
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Load ID
     C                     KFLD           WCC4NB           Order Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQST01           Load ID
     C                     Z-ADD*ZERO     WCC4NB           Order Number
      * Establish starting position
     C           KPSST     SETLL@BFCPR0                    *
     C           KRSST     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0006           Company Number
     C                     Z-ADDWCC4NB    WL0007           Order Number
     C                     Z-ADD1         WL0008           Order Sequence
     C                     MOVELYL0009    WL0009    P      USR Unit of Mea
     C                     Z-ADDYL0010    WL0010           Boxes Total Qua
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0009    P      USR Unit of Mea
     C                     Z-ADDWL0010    YL0010           Boxes Total Qua
     C           KRSST     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0009    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVEL'BOXLOAD' WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0011           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0010    IFLT YL0011                     *IF
     C                     MOVEL'CB'      YL0009           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0009           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Daily Holdover Dtl PO
      *================================================================
      * RTV Last Stop on Load  RT - Load Detail  * 
     C                     EXSR SFRVGN
      * ** Pass Override miles, if entered                 E00207
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    $DTLMI           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    $DTLMI           Total Load Mile
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0001  70       USR Load ID
     C                     MOVEL*BLANK    WN0002  1        USR Display fie
     C                     MOVEL*BLANK    WN0003  1        USR Display 1
     C                     MOVEL*BLANK    WN0004  1        USR Display 2
     C                     MOVEL*BLANK    WN0005  1        USR Display 3
     C                     MOVEL*BLANK    WN0006  1        USR Display 4
     C                     Z-ADD*ZERO     WN0007  50       USR Stop/Drop
      *
      * PRT Daily Holdover Dtl PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 05/02/2014 LJB E002962
      * ** Include BOL Received Date/Time after Deadline Date/Time
      * *****
      * ** 10/21/2008 LJB E00240
      * ** Select/Omit by warehouse, if any are entered.
      * *****
      * ** 08/14/2008 LJB E00207
      * ** Override miles are passed in if they were entered.
      * *****
      * ** 07/22/2008 LJB E00196
      * ** Only set off the display flag if the customer is not Promo
      * ** or samples. This will prevent invalid blank load id's.
      * *****
      * ** 04/17/2008 LJB E00024
      * ** Add the Order Number and the order's Company Number
      * ** Also, add the warehouse number from order detail
      * *****
      * ** 09/26/2007 FT558 LJB
      * ** Don't print if the Customer is Promotional/Samples
      * *****
      * ** 06/28/2006 LJB TRF011
      * ** On Time Reasons are now stored in a file. Also, the OTR Code
      * ** is now 3 char instead 1. Retrieve the OTR description from
      * ** the new On Time Reason file.
      * *****
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Holdover Trff Cmts PO
      *================================================================
      * PRT Holdover Trff Cmts PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT Daily Holdover Dtl PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WN0002           USR Display fie
     C                     MOVEL'Y'       YL0004           Print (Yes/No)
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7WXST           Record Found US
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Print (Yes/No) USR
     C                     MOVEL*BLANK    WUDTSX  1
      * Define work field Display Flag
     C                     MOVEL*BLANK    WUQKST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FJVPCD           Ship From Wareh
     C                     MOVEL*LOVAL    FJAODT           Scheduled Ship
     C                     MOVEL*LOVAL    FJRMNB           Load ID
      * Define work field Print Selections
     C                     MOVEL*BLANK    WUDWSX  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FLRMNB           Load ID
     C                     MOVEL*HIVAL    FLRVNB           Stop/Drop
     C                     MOVEL*LOVAL    FLC4NB           Order Number
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WAEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WANRVA           Pallet Balance
     C                     Z-ADD*ZERO     WANSVA           Long hook balan
     C                     Z-ADD*ZERO     WANTVA           Short hook bala
     C                     Z-ADD*ZERO     WANUVA           Tub Balance
     C                     Z-ADD*ZERO     WAS8NB           Home Phone
     C                     Z-ADD*ZERO     WAS9NB           Other Phone
     C                     Z-ADD*ZERO     WANMVA           Flat Rate
     C                     Z-ADD*ZERO     WANOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WANPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WANQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WAQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WAQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WAMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WAMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WARFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WAMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WABQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WABRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WABSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WABTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WABUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WABVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WADJWG           Unused Weight R
     C                     Z-ADD*ZERO     WADKWG           Unused Weight R
     C                     Z-ADD*ZERO     WADLWG           Unused Weight R
     C                     Z-ADD*ZERO     WADMWG           Unused Weight R
     C                     Z-ADD*ZERO     WADNWG           Unused Weight R
     C                     Z-ADD*ZERO     WADOWG           Unused Weight R
     C                     Z-ADD*ZERO     WAB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WAB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WAB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WAB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WAB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WAB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WAAAC7           Contact Number
     C                     Z-ADD*ZERO     WATENO           Carrier Unused
     C                     Z-ADD*ZERO     WAAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WAAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WAKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Text 1 Length USR
     C                     MOVEL*BLANK    WUPFTX  1
      * Define work field Address Line 1
     C                     MOVEL*BLANK    WUACNA 30
      * Define work field Address Line 2
     C                     MOVEL*BLANK    WUADNA 30
      * Define work field Address Line 3
     C                     MOVEL*BLANK    WUAENA 30
      * Define work field Zip/Postal Code
     C                     MOVEL*BLANK    WUBTTX 11
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBRWNB           Miles to next s
     C                     Z-ADD*ZERO     WBRXNB           Freight Charge
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBKFDT           Appointment Con
     C                     Z-ADD*ZERO     WBACTM           Appointment Con
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WBB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field OTR Description
     C                     MOVEL*BLANK    WUHTT1 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Select Status
     C                     MOVEL*BLANK    WUDJST  1
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KERMNB           Load ID
     C                     MOVEL*LOVAL    KEDXNB           Sequence Number
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 10
     C                     Z-ADD*ZERO     WL0003 155
      * Define local variables for subroutine SMRVGN.
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005 20
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010 112
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014  1
      * Define local work field USR Display 5
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field USR From Time 6.0
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field USR To Time 6.0
     C                     Z-ADD*ZERO     YL0003  60
      * Define local work field Print (Yes/No) USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0011  50
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0012  70
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUDTSX           Print (Yes/No)
     C                     MOVEL'Y'       WUQKST           Display Flag
     C                     MOVEL'N'       YL0001           USR Display 5
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0002           System Value Nu
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     MOVEL@CN,002   WL0002    P      Company Value C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0003           System Value Nu
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 HOLDOVERBX
00002 HOLDOVERCB
00003 Deadline Depart Date
00004 Scheduled Ship Date
