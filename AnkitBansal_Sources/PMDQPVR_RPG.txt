     H/TITLE PMT WF Excess Frt Chgs PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 04/17/09  Time  : 13:14:55
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPMDQPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PMT WF Excess Frt Chgs PV Prompt & validate record
      *
     FCAAPREL1IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPOA9REL1IF  E           K        DISK
      * RTV : Freight Charge            Retrieval index
      *
     FPMD9REL1IF  E           K        DISK
      * RTV : Freight Group             Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 028  5 0A
     E                    W0END   7 028  5 0A
     E                    W0NAM   7 028 10
      * Long constants
     E                    @CN#    1   4  6   @CN    25
     IEAPREGF
      * Salesperson               Retrieval index       NV
      * Renamed input format fields
     I              APBCCD                          WABCCD
     I              APALTX                          WAALTX
     I              APACNA                          WAACNA
     I              APADNA                          WAADNA
     I              APAENA                          WAAENA
     I              APAJNA                          WAAJNA
     I              APBGCD                          WABGCD
     I              APBTTX                          WABTTX
     I              APBVTX                          WABVTX
     I              APBWTX                          WABWTX
     I              APDZTX                          WADZTX
     I              APD0TX                          WAD0TX
     I              APD1TX                          WAD1TX
     I              APLVCD                          WALVCD
     I              APKZCD                          WAKZCD
     I              APAIC3                          WAAIC3
     I              APAVNB                          WAAVNB
     I              APDSCD                          WADSCD
     I              APUVST                          WAUVST
     I              APUWST                          WAUWST
     I              APUXST                          WAUXST
     I              APVSST                          WAVSST
     I              APAATM                          WAAATM
     I              APAYNA                          WAAYNA
     I              APA0NA                          WAA0NA
     I              APAXDT                          WAAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WBBZNA
     I              FFADTX                          WBADTX
     I              FFACNA                          WBACNA
     I              FFADNA                          WBADNA
     I              FFAENA                          WBAENA
     I              FFAJNA                          WBAJNA
     I              FFBTTX                          WBBTTX
     I              FFEZNB                          WBEZNB
     I              FFBGCD                          WBBGCD
     I              FFEEDT                          WBEEDT
     I              FFDUTX                          WBDUTX
     I              FFNRVA                          WBNRVA
     I              FFNSVA                          WBNSVA
     I              FFNTVA                          WBNTVA
     I              FFNUVA                          WBNUVA
     I              FFP1ST                          WBP1ST
     I              FFDVTX                          WBDVTX
     I              FFDWTX                          WBDWTX
     I              FFLVCD                          WBLVCD
     I              FFS8NB                          WBS8NB
     I              FFS9NB                          WBS9NB
     I              FFNMVA                          WBNMVA
     I              FFNOVA                          WBNOVA
     I              FFNPVA                          WBNPVA
     I              FFNQVA                          WBNQVA
     I              FFMFCD                          WBMFCD
     I              FFQXNB                          WBQXNB
     I              FFQ1NB                          WBQ1NB
     I              FFMRNG                          WBMRNG
     I              FFMRNE                          WBMRNE
     I              FFRFNB                          WBRFNB
     I              FFMREG                          WBMREG
     I              FFBQPR                          WBBQPR
     I              FFBRPR                          WBBRPR
     I              FFBSPR                          WBBSPR
     I              FFBTPR                          WBBTPR
     I              FFBUPR                          WBBUPR
     I              FFBVPR                          WBBVPR
     I              FFDJWG                          WBDJWG
     I              FFDKWG                          WBDKWG
     I              FFDLWG                          WBDLWG
     I              FFDMWG                          WBDMWG
     I              FFDNWG                          WBDNWG
     I              FFDOWG                          WBDOWG
     I              FFB2PR                          WBB2PR
     I              FFB3PR                          WBB3PR
     I              FFB4PR                          WBB4PR
     I              FFB5PR                          WBB5PR
     I              FFB6PR                          WBB6PR
     I              FFB7PR                          WBB7PR
     I              FFAAC7                          WBAAC7
     I              FFCOFI                          WBCOFI
     I              FFK6TX                          WBK6TX
     I              FFOCNA                          WBOCNA
     I              FFODNA                          WBODNA
     I              FFW7CD                          WBW7CD
     I              FFK7TX                          WBK7TX
     I              FFTENO                          WBTENO
     I              FFK8TX                          WBK8TX
     I              FFAOFC                          WBAOFC
     I              FFAOLI                          WBAOLI
     I              FFKHDT                          WBKHDT
     I              FFUNUS                          WBUNUS
     I              FFUNU2                          WBUNU2
     I              FFUNU3                          WBUNU3
     I              FFUVST                          WBUVST
     I              FFUWST                          WBUWST
     I              FFUXST                          WBUXST
     I              FFVSST                          WBVSST
     I              FFAATM                          WBAATM
     I              FFAYNA                          WBAYNA
     I              FFA0NA                          WBA0NA
     I              FFAXDT                          WBAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WDBKC7
     I              BBAYTX                          WDAYTX
     I              BBACNA                          WDACNA
     I              BBADNA                          WDADNA
     I              BBAENA                          WDAENA
     I              BBAJNA                          WDAJNA
     I              BBBGCD                          WDBGCD
     I              BBG5CD                          WDG5CD
     I              BBBTTX                          WDBTTX
     I              BBBVTX                          WDBVTX
     I              BBBWTX                          WDBWTX
     I              BBABTX                          WDABTX
     I              BBA2NA                          WDA2NA
     I              BBCBST                          WDCBST
     I              BBB0NA                          WDB0NA
     I              BBP3NB                          WDP3NB
     I              BBAXNA                          WDAXNA
     I              BBI6DT                          WDI6DT
     I              BBAYDT                          WDAYDT
     I              BBANC7                          WDANC7
     I              BBBTC7                          WDBTC7
     I              BBK6ST                          WDK6ST
     I              BBUZST                          WDUZST
     I              BBKXCD                          WDKXCD
     I              BBLTCD                          WDLTCD
     I              BBQNST                          WDQNST
     I              BBS2NB                          WDS2NB
     I              BBVHVA                          WDVHVA
     I              BBI7DT                          WDI7DT
     I              BBRJST                          WDRJST
     I              BBRKST                          WDRKST
     I              BBQWST                          WDQWST
     I              BBQXST                          WDQXST
     I              BBQYST                          WDQYST
     I              BBUNCS                          WDUNCS
     I              BBUVST                          WDUVST
     I              BBUWST                          WDUWST
     I              BBUXST                          WDUXST
     I              BBVSST                          WDVSST
     I              BBAATM                          WDAATM
     I              BBAYNA                          WDAYNA
     I              BBA0NA                          WDA0NA
     I              BBAXDT                          WDAXDT
      *
     I@A9REJZ
      * Freight Charge            Retrieval index
      * Renamed input format fields
     I              A9CDAA                          WECDAA
     I              A9PNNA                          WEPNNA
     I              A9C3VL                          WEC3VL
     I              A9JUSX                          WEJUSX
     I              A9JZSX                          WEJZSX
     I              A9J5SX                          WEJ5SX
     I              A9JVSX                          WEJVSX
     I              A9JWSX                          WEJWSX
     I              A9JXSX                          WEJXSX
     I              A9JYSX                          WEJYSX
     I              A9KKSX                          WEKKSX
     I              A9J0SX                          WEJ0SX
     I              A9J1SX                          WEJ1SX
     I              A9KRSX                          WEKRSX
     I              A9KPSX                          WEKPSX
     I              A9KQSX                          WEKQSX
     I              A9J2SX                          WEJ2SX
     I              A9J3SX                          WEJ3SX
     I              A9J4SX                          WEJ4SX
     I              A9J6SX                          WEJ6SX
     I              A9J7SX                          WEJ7SX
     I              A9J8SX                          WEJ8SX
     I              A9J9SX                          WEJ9SX
     I              A9KASX                          WEKASX
     I              A9OPDT                          WEOPDT
     I              A9VSST                          WEVSST
     I              A9MJDT                          WEMJDT
     I              A9BETM                          WEBETM
     I              A9CCVN                          WECCVN
     I              A9CDVN                          WECDVN
     I              A9MKDT                          WEMKDT
     I              A9BFTM                          WEBFTM
     I              A9CEVN                          WECEVN
     I              A9CFVN                          WECFVN
      *
     I@D9REU0
      * Freight Group             Retrieval index
      * Renamed input format fields
     I              D9J9AA                          WFJ9AA
     I              D9SUNA                          WFSUNA
     I              D9VSST                          WFVSST
     I              D9MJDT                          WFMJDT
     I              D9BETM                          WFBETM
     I              D9CCVN                          WFCCVN
     I              D9CDVN                          WFCDVN
     I              D9MKDT                          WFMKDT
     I              D9BFTM                          WFBFTM
     I              D9CEVN                          WFCEVN
     I              D9CFVN                          WFCFVN
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WGAIC3
     I              ABADTX                          WGADTX
     I              ABACNA                          WGACNA
     I              ABADNA                          WGADNA
     I              ABAENA                          WGAENA
     I              ABAJNA                          WGAJNA
     I              ABBTTX                          WGBTTX
     I              ABBVTX                          WGBVTX
     I              ABBWTX                          WGBWTX
     I              ABA2NA                          WGA2NA
     I              ABABTX                          WGABTX
     I              ABBGCD                          WGBGCD
     I              ABKXCD                          WGKXCD
     I              ABUVST                          WGUVST
     I              ABUWST                          WGUWST
     I              ABUXST                          WGUXST
     I              ABVSST                          WGVSST
     I              ABAATM                          WGAATM
     I              ABAYNA                          WGAYNA
     I              ABA0NA                          WGA0NA
     I              ABAXDT                          WGAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WHBCCD
     I              APALTX                          WHALTX
     I              APACNA                          WHACNA
     I              APADNA                          WHADNA
     I              APAENA                          WHAENA
     I              APAJNA                          WHAJNA
     I              APBGCD                          WHBGCD
     I              APBTTX                          WHBTTX
     I              APBVTX                          WHBVTX
     I              APBWTX                          WHBWTX
     I              APDZTX                          WHDZTX
     I              APD0TX                          WHD0TX
     I              APD1TX                          WHD1TX
     I              APLVCD                          WHLVCD
     I              APKZCD                          WHKZCD
     I              APAIC3                          WHAIC3
     I              APAVNB                          WHAVNB
     I              APDSCD                          WHDSCD
     I              APUVST                          WHUVST
     I              APUWST                          WHUWST
     I              APUXST                          WHUXST
     I              APVSST                          WHVSST
     I              APAATM                          WHAATM
     I              APAYNA                          WHAYNA
     I              APA0NA                          WHA0NA
     I              APAXDT                          WHAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WJAJVN
     I              DRAUNA                          WJAUNA
     I              DRB8NA                          WJB8NA
     I              DRAHVN                          WJAHVN
     I              DRI6ST                          WJI6ST
     I              DRI7ST                          WJI7ST
     I              DRXMST                          WJXMST
     I              DRXNST                          WJXNST
     I              DRI8ST                          WJI8ST
     I              DRNLNB                          WJNLNB
     I              DRMPNA                          WJMPNA
     I              DRBCCD                          WJBCCD
     I              DRAIC3                          WJAIC3
     I              DRDQCD                          WJDQCD
     I              DRDRCD                          WJDRCD
     I              DRAJCD                          WJAJCD
     I              DRBUVN                          WJBUVN
     I              DRUVST                          WJUVST
     I              DRUWST                          WJUWST
     I              DRUXST                          WJUXST
     I              DRAATM                          WJAATM
     I              DRAYNA                          WJAYNA
     I              DRA0NA                          WJA0NA
     I              DRAXDT                          WJAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WKAJVN
     I              DTDNCD                          WKDNCD
     I              DTAIC3                          WKAIC3
     I              DTDQCD                          WKDQCD
     I              DTDRCD                          WKDRCD
     I              DTAJCD                          WKAJCD
     I              DTJFST                          WKJFST
     I              DTUVST                          WKUVST
     I              DTUWST                          WKUWST
     I              DTUXST                          WKUXST
     I              DTAATM                          WKAATM
     I              DTAYNA                          WKAYNA
     I              DTA0NA                          WKA0NA
     I              DTAXDT                          WKAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WLDNCD
     I              DNAUNA                          WLAUNA
     I              DNVKST                          WLVKST
     I              DNRSCD                          WLRSCD
     I              DNUVST                          WLUVST
     I              DNUWST                          WLUWST
     I              DNUXST                          WLUXST
     I              DNAATM                          WLAATM
     I              DNAYNA                          WLAYNA
     I              DNA0NA                          WLA0NA
     I              DNAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  System Date Format
     I                                       15  17 P1B8NA
      * N :  User Profile Name
     I                                       18  27 P1AJVN
      * N :  Allow Multi-Company
     I                                       28  28 P1I6ST
      * N :  Default Printer
     I                                       29  38 P1MPNA
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Night Queue Run Sts
     I                                       44  44 P2WUST
      * N :  PRT Night Queue
     I                                       45  54 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  55  625P2AJAA
      * N :  Customer Number Pass  USR
     I                                    P  63  705P2AJNC
      * N :  From Date Pass        USR
     I                                    P  71  785P2AJAD
      * N :  Thru Date Pass        USR
     I                                    P  79  865P2AJAG
      * N :  System Value Numeric
     I                                    P  87  945P2M8NB
      * N :  Ship to Customer Pass USR
     I                                    P  95 1025P2SHTC
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'From date exceeds to date'
      * Message data for 'Email format required'
      * Email Format
     I                                        1   5 ZA0001
      * Message data for 'Salesperson            NF'
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0002
      * Message data for 'Customer not found'
      * Message data for 'Email format required'
      * Email Format
     I                                        1   5 ZA0003
      * Message data for 'One or more whse rq'd'
      * Warehouse Code
     I                                        1   3 ZA0004
      * Message data for 'Select/Omit req'd if whse'
      * USR Select/Omit Flag
     I                                        1   1 ZA0005
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse not found'
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0006
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0007
      * Application Code
     I                                       11  16 ZA0008
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0009
      * Application Code
     I                                       11  16 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * PAR = DTL By name
     C                     MOVEL#1AJCD    P1AJCD           Warehouse Code
     C                     Z-ADD#1AIC3    P1AIC3           Company Number
     C                     MOVEL#1BCCD    P1BCCD           Salesperson Cod
      * ** Add Ship To Customer to passed parms     11/12/2007 LJB FP1225
     C                     Z-ADD#1BKC7    P2SHTC           Ship to Custome
     C                     Z-ADD#1BTC7    P2AJNC           Customer Number
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
      * PAR.From Date Pass        USR = DTL.Invoice Date
     C                     Z-ADD#1AWDT    P2AJAD           From Date Pass
      * PAR.Thru Date Pass        USR = DTL.Thru Date             USR
     C                     Z-ADD#DOADT    P2AJAG           Thru Date Pass
     C                     Z-ADD1         P2M8NB           System Value Nu
      * ** Pass the Select/Omit flag and the Warehouse Codes if entered E
      * CASE: DTL.Select Option is Option 1
     C           #DOPTI    IFEQ '1'                        *IF
      * ** Report by Salesperson Code
     C                     MOVEL@CN,01    P2G3TX           PRT Description
     C                     MOVEL*BLANK    WUBMVN           Program name US
     C                     MOVEL'PMDVPFR' WUBMVN           Program name US
     C                     ELSE
      * CASE: DTL.Select Option is Option 2
     C           #DOPTI    IFEQ '2'                        *IF
      * ** Report by Carrier Code
     C                     MOVEL@CN,02    P2G3TX           PRT Description
     C                     MOVEL*BLANK    WUBMVN           Program name US
     C                     MOVEL'PMDZPFR' WUBMVN           Program name US
     C                     ELSE
      * CASE: DTL.Select Option is Option 3
     C           #DOPTI    IFEQ '3'                        *IF
      * ** Report by Customer
     C                     MOVEL@CN,03    P2G3TX           PRT Description
     C                     MOVEL*BLANK    WUBMVN           Program name US
     C                     MOVEL'PMPHPFR' WUBMVN           Program name US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PRT Excess Frt Chg Rpt CL - WF Excessive Freight Chgs  * 
     C                     CALL 'PMDSUPC'              90  PRT Excess Frt
     C           WUH3TX    PARM *BLANK    WQ0001  7        Return Code Usr
     C                     PARM P2G3TX    WQ0002 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0003 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0004  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0005  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0006  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0007 10        PRT Night Queue
     C                     PARM P2AJAA    WQ0008 155       Company Number
     C                     PARM P2AJNC    WQ0009 155       Customer Number
     C                     PARM P2AJAD    WQ0010 155       From Date Pass
     C                     PARM P2AJAG    WQ0011 155       Thru Date Pass
     C           P2M8NB    PARM P2M8NB    WQ0012 155       System Value Nu
     C                     PARM P2SHTC    WQ0013 155       Ship to Custome
     C                     PARM #1CDAA    WQ0014  6        FC Code
     C                     PARM #1BZNA    WQ0015  3        Carrier Code
     C                     PARM #1BCCD    WQ0016  3        Salesperson Cod
     C                     PARM #DJ9AA    WQ0017  6        FCG Group Code
     C                     PARM #1AJCD    WQ0018  3        USR Warehouse C
     C                     PARM #DVSCD    WQ0019  3        USR CDE Parm 1
     C                     PARM #DVTCD    WQ0020  3        USR CDE Parm 2
     C                     PARM #DVUCD    WQ0021  3        USR CDE Parm 3
     C                     PARM #DVVCD    WQ0022  3        USR CDE Parm 4
     C                     PARM #DVWCD    WQ0023  3        USR CDE Parm 5
     C                     PARM #DVXCD    WQ0024  3        USR CDE Parm 6
     C                     PARM #DVYCD    WQ0025  3        USR CDE Parm 7
     C                     PARM #DVZCD    WQ0026  3        USR CDE Parm 8
     C                     PARM #DV0CD    WQ0027  3        USR CDE Parm 9
     C                     PARM #DCYST    WQ0028  1        USR Select/Omit
     C                     PARM #DOPTI    WQ0029  1        Select Option
     C                     PARM #DA9TX    WQ0030  5        Email Format
     C                     PARM #DUGTX    WQ0031 50        Email Address
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993835*
     C                     SETON                     343743*
     C                     SETON                     454749*
     C                     SETON                     514446*
     C                     SETON                     485052*
     C                     END
      * ** Send "Report Submitted" message to the screen
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Report has been submitted'
     C                     MOVEL'USR2720' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Invoice Date
      * External date
     C                     Z-ADDV1AWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #1AWDT
      * Validate Thru Date             USR
      * External date
     C                     Z-ADDVDOADT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #DOADT
      * Validate Select Option
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DOPTI'  IFEQ YPMTFD
      * Select Option
     C                     MOVEL#DOPTI    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHOPTI
     C                     SELEC
     C           W0INVL    WHEQ '1'                        1
     C                     Z-ADD1         ZHOPTI
     C           W0INVL    WHEQ '2'                        2
     C                     Z-ADD2         ZHOPTI
     C           W0INVL    WHEQ '3'                        3
     C                     Z-ADD3         ZHOPTI
     C           W0INVL    WHEQ '4'                        4
     C                     Z-ADD4         ZHOPTI
     C                     ENDSL
     C                     EXFMTZGOPTI
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHOPTI    WHEQ 1
     C                     MOVEL'1'       W0INVL           1
     C           ZHOPTI    WHEQ 2
     C                     MOVEL'2'       W0INVL           2
     C           ZHOPTI    WHEQ 3
     C                     MOVEL'3'       W0INVL           3
     C           ZHOPTI    WHEQ 4
     C                     MOVEL'4'       W0INVL           4
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DOPTI
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Email Format
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DA9TX    W0NSRQ  1        Email Format
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DA9TX'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1803372   Y2LSNO  70
     C           #DA9TX    PARM #DA9TX    W0EXVL 25        Email Format
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate USR Select/Omit Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DCYST'  IFEQ YPMTFD
      * USR Select/Omit Flag
     C                     MOVEL#DCYST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHCYST
     C                     SELEC
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD1         ZHCYST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHCYST
     C                     ENDSL
     C                     EXFMTZGCYST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHCYST    WHEQ 1
     C                     MOVEL'O'       W0INVL           O
     C           ZHCYST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DCYST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * ** F4 to prompt
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * ** F4 on Company Number
      * CASE: PGM.*Cursor field <IS> DTL.Company Number
     C           W0CFL     IFEQ 'V1AIC3'                   *IF
      * CASE: PAR.Allow Multi-Company is yes
     C           P1I6ST    IFEQ 'Y'                        *IF
      * SEL Company by Number  SR - Company Name and Address  * 
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0032  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** F4 on Freight Group
      * CASE: PGM.*Cursor field <IS> DTL.FCG Group Code
     C           W0CFL     IFEQ '#DJ9AA'                   *IF
      * Sel Frt Group         SR - Freight Group  * 
     C                     CALL 'PMXKSRR'              90  Sel Frt Group
     C                     PARM *BLANK    W0RTN   7
     C           #DJ9AA    PARM #DJ9AA    WQ0033  6        FCG Group Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMXKSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
      * ** F4 on Salesperson
      * CASE: PGM.*Cursor field <IS> DTL.Salesperson Code
     C           W0CFL     IFEQ '#1BCCD'                   *IF
      * SEL Salesperson All    SR - Salesperson  * 
     C                     CALL 'PDFASRR'              90  SEL Salesperson
     C                     PARM *BLANK    W0RTN   7
     C           #1BCCD    PARM #1BCCD    WQ0034  3        Salesperson Cod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
      * RTV Name, status       RT - Salesperson  * 
     C                     EXSR SARVGN
      * CASE: LCL.Record Status is Inactive
     C           YL0001    IFEQ 'I'                        *IF
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL@CN,04    #DALTX           Salesperson Nam
     C                     END                             *FI
     C                     END                             *FI
      * ** F4 on Carrier Code
      * CASE: PGM.*Cursor field <IS> DTL.Carrier Code
     C           W0CFL     IFEQ '#1BZNA'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0035  3        Carrier Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DW1TX    P      Name
     C                     MOVELWL0003    YL0001    P      Record Status
     C                     END                             *FI
      * ** F4 on Freight Code
      * CASE: PGM.*Cursor field <IS> DTL.FC Code
     C           W0CFL     IFEQ '#1CDAA'                   *IF
      * ** Get miles from the load header             E00207 8/18/2008
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SCRVGN
      * ** Use Override miles if they exist           E00207 8/18/2008
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    YL0002           Total Load Mile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    YL0002           Total Load Mile
     C                     END                             *FI
      * Sel Manual Charge     SL - Freight Charge  * 
     C                     CALL 'POLNSRR'              90  Sel Manual Char
     C                     PARM *BLANK    W0RTN   7
     C           #1CDAA    PARM #1CDAA    WQ0036  6        FC Code
     C           YL0003    PARM *BLANK    WQ0037 30        FC Description
     C           YL0004    PARM *ZERO     WQ0038  72       FC Rate Amount
     C           YL0005    PARM *BLANK    WQ0039  2        FC Unit of Meas
     C           YL0006    PARM *BLANK    WQ0040  1        FC Act Frt Incl
     C           YL0007    PARM *BLANK    WQ0041  1        FC Frt Add/Dedu
     C           YL0008    PARM *BLANK    WQ0042  1        FC Load Type Se
     C           YL0009    PARM *BLANK    WQ0043  1        FC State Select
     C           YL0010    PARM *BLANK    WQ0044  1        FC Export Selec
     C           YL0011    PARM *BLANK    WQ0045  1        FC Shag/Wash Se
     C           YL0012    PARM *BLANK    WQ0046  1        FC Auto Calc St
     C           YL0013    PARM *BLANK    WQ0047  1        FC Charge Categ
     C           YL0014    PARM *BLANK    WQ0048  1        FC Shag/Wash Co
     C           YL0015    PARM *BLANK    WQ0049  1        FC Edit Sequenc
     C           YL0016    PARM *BLANK    WQ0050  1        FC Tot Freight
     C           YL0017    PARM *BLANK    WQ0051  1        FC Special Type
     C           YL0018    PARM *BLANK    WQ0052  1        FC ExpInt FR/FZ
     C           YL0019    PARM *BLANK    WQ0053  1        FC Reference Re
     C           YL0020    PARM *BLANK    WQ0054  1        FC Trans Mode S
     C           YL0021    PARM *BLANK    WQ0055  1        FC Freight Rate
     C           YL0022    PARM *BLANK    WQ0056  1        FC Company Sele
     C           YL0023    PARM *BLANK    WQ0057  1        FC Company/Carr
     C           YL0024    PARM *BLANK    WQ0058  1        FC Shared Respo
     C           YL0025    PARM *BLANK    WQ0059  1        FC Unused Sts 1
     C                     PARM YL0002    WQ0060  70       Total Load Mile
     C           YL0026    PARM YL0026    WQ0061  72       LFC Amount
     C                     PARM YL0027    WQ0062  50       Total Stops
     C                     PARM YL0028    WQ0063  3        Carrier Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POLNSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     END                             *FI
      * ** F4 on Customer Number                 FP1225 11/13/2007
      * CASE: PGM.*Cursor field <IS> DTL.Ship To Customer
     C           W0CFL     IFEQ 'V1BKC7'                   *IF
      * SEL Ship To Customer   SR - Customer  * 
     C                     CALL 'PDR5SRR'              90  SEL Ship To Cus
     C                     PARM *BLANK    W0RTN   7
     C           #1BKC7    PARM #1BKC7    WQ0064  70       Ship To Custome
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 1
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code
     C           W0CFL     IFEQ '#1AJCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0065  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 2
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 1
     C           W0CFL     IFEQ '#DVSCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVSCD    PARM #DVSCD    WQ0066  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 3
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 2
     C           W0CFL     IFEQ '#DVTCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVTCD    PARM #DVTCD    WQ0067  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9947  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 4
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 3
     C           W0CFL     IFEQ '#DVUCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVUCD    PARM #DVUCD    WQ0068  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9949  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 5
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 4
     C           W0CFL     IFEQ '#DVVCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVVCD    PARM #DVVCD    WQ0069  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 6
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 5
     C           W0CFL     IFEQ '#DVWCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVWCD    PARM #DVWCD    WQ0070  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 7
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 6
     C           W0CFL     IFEQ '#DVXCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVXCD    PARM #DVXCD    WQ0071  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 8
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 7
     C           W0CFL     IFEQ '#DVYCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVYCD    PARM #DVYCD    WQ0072  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 9
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 8
     C           W0CFL     IFEQ '#DVZCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DVZCD    PARM #DVZCD    WQ0073  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9950  *
     C                     END
     C                     END                             *FI
      * ** F4 on Warehouse 10
      * CASE: PGM.*Cursor field <IS> DTL.USR CDE Parm 9
     C           W0CFL     IFEQ '#DV0CD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #DV0CD    PARM #DV0CD    WQ0074  3        Warehouse Code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DW1TX    P      Name
     C                     MOVELWL0003    YN0002    P      Record Status
     C                     MOVEL*BLANK    #DUWTX           Ship To Name
      * Ship To Name          DRV
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    #DSANA           FC Description
      * FC Description DRV
      * Rtv Frt Charge Info   RT - Freight Charge  * 
     C                     EXSR SERVGN
     C                     MOVEL*BLANK    #DSVNA           FCG Group Desc
      * FCG Group Desc DRV
      * Rtv Frt Group Info    RT - Freight Group  * 
     C                     EXSR SFRVGN
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * ** Error if from date is after thru date
      * CASE: DTL.Invoice Date GT DTL.Thru Date             USR
     C           #1AWDT    IFGT #DOADT                     *IF
      * Setup message data for message
      * Send message 'From date exceeds to date'
     C                     MOVEL'USR0319' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * ** Error email Format is required if email is entered
      * CASE: DTL.Email Address is Entered
     C           #DUGTX    IFNE *BLANK                     *IF
      * CASE: DTL.Email Format is Not Entered
     C           #DA9TX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DA9TX    ZA0001           Email Format
      * Send message 'Email format required'
     C                     MOVEL'USR3676' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve company name
      * CASE: DTL.Company Number is not equal to zero
     C           #1AIC3    IFNE *ZERO                      *IF
      * RTV Company Name Only  RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0004           Company Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DAPTX    P      Name
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Allow Multi-Company is yes
     C           P1I6ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL'*ALL'    #DAPTX           Company Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * ** Salesperson code
      * CASE: DTL.Salesperson Code is entered
     C           #1BCCD    IFNE *BLANK                     *IF
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
      * Send message 'Salesperson            NF'
     C                     MOVEL'USR0039' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * ** Carrier code
      * CASE: DTL.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DW1TX    P      Name
     C                     MOVELWL0003    YL0001    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0002           Carrier Code
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * ** Customer Number               FP1225 11/13/2007
      * CASE: DTL.Ship To Customer is not equal to zero
     C           #1BKC7    IFNE *ZERO                      *IF
      * RTV Name RT - Customer  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
      * Send message 'Customer not found'
     C                     MOVEL'USR0525' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * ** Email format required if email address is entered
      * CASE: DTL.Email Address is Entered
     C           #DUGTX    IFNE *BLANK                     *IF
      * CASE: DTL.Email Format is Not Entered
     C           #DA9TX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DA9TX    ZA0003           Email Format
      * Send message 'Email format required'
     C                     MOVEL'USR3676' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * ** Additional changes for task # E00384:
      * ** At least one warehouse required if Select/Omit flag entered
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10ANDc11
      *   |- c1    : DTL.USR Select/Omit Flag is *Entered
      *   |- c2    : DTL.Warehouse Code is Blanks
      *   |- c3    : DTL.USR CDE Parm 1 is Blanks
      *   |- c4    : DTL.USR CDE Parm 2 is Blanks
      *   |- c5    : DTL.USR CDE Parm 3 is Blanks
      *   |- c6    : DTL.USR CDE Parm 4 is Blanks
      *   |- c7    : DTL.USR CDE Parm 5 is Blanks
      *   |- c8    : DTL.USR CDE Parm 6 is Blanks
      *   |- c9    : DTL.USR CDE Parm 7 is Blanks
      *   |- c10   : DTL.USR CDE Parm 8 is Blanks
      *   |- c11   : DTL.USR CDE Parm 9 is Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCYST    IFEQ 'O'                        *IF
     C           #DCYST    OREQ 'S'
     C           #1AJCD    IFEQ *BLANK                     *IF
     C           #DVSCD    IFEQ *BLANK                     *IF
     C           #DVTCD    IFEQ *BLANK                     *IF
     C           #DVUCD    IFEQ *BLANK                     *IF
     C           #DVVCD    IFEQ *BLANK                     *IF
     C           #DVWCD    IFEQ *BLANK                     *IF
     C           #DVXCD    IFEQ *BLANK                     *IF
     C           #DVYCD    IFEQ *BLANK                     *IF
     C           #DVZCD    IFEQ *BLANK                     *IF
     C           #DV0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0004           Warehouse Code
      * Send message 'One or more whse rq'd'
     C                     MOVEL'USR4144' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
      * ** Select/Omit flag required if one or more warehouses enterd
      * CASE:
      *  - c1AND(c2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11)
      *   |- c1    : DTL.USR Select/Omit Flag is Blanks
      *   |- c2    : DTL.Warehouse Code is Not Blanks
      *   |- c3    : DTL.USR CDE Parm 1 is Not Blanks
      *   |- c4    : DTL.USR CDE Parm 2 is Not Blanks
      *   |- c5    : DTL.USR CDE Parm 3 is Not Blanks
      *   |- c6    : DTL.USR CDE Parm 4 is Not Blanks
      *   |- c7    : DTL.USR CDE Parm 5 is Not Blanks
      *   |- c8    : DTL.USR CDE Parm 6 is Not Blanks
      *   |- c9    : DTL.USR CDE Parm 7 is Not Blanks
      *   |- c10   : DTL.USR CDE Parm 8 is Not Blanks
      *   |- c11   : DTL.USR CDE Parm 9 is Not Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCYST    IFEQ *BLANK                     *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1AJCD    IFNE *BLANK                     *IF
     C           #DVSCD    ORNE *BLANK                     *OR
     C           #DVTCD    ORNE *BLANK                     *OR
     C           #DVUCD    ORNE *BLANK                     *OR
     C           #DVVCD    ORNE *BLANK                     *OR
     C           #DVWCD    ORNE *BLANK                     *OR
     C           #DVXCD    ORNE *BLANK                     *OR
     C           #DVYCD    ORNE *BLANK                     *OR
     C           #DVZCD    ORNE *BLANK                     *OR
     C           #DV0CD    ORNE *BLANK                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#DCYST    ZA0005           USR Select/Omit
      * Send message 'Select/Omit req'd if whse'
     C                     MOVEL'USR4145' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
      * ** Validate warehouse 1 if entered
      * CASE: DTL.Warehouse Code is Warehouse Code not Blank
     C           #1AJCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 2 if entered
      * CASE: DTL.USR CDE Parm 1 is Warehouse Code not Blank
     C           #DVSCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVSCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9945  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 3 if entered
      * CASE: DTL.USR CDE Parm 2 is Warehouse Code not Blank
     C           #DVTCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVTCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9947  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 4 if entered
      * CASE: DTL.USR CDE Parm 3 is Warehouse Code not Blank
     C           #DVUCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVUCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9949  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 5 if entered
      * CASE: DTL.USR CDE Parm 4 is Warehouse Code not Blank
     C           #DVVCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVVCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 6 if entered
      * CASE: DTL.USR CDE Parm 5 is Warehouse Code not Blank
     C           #DVWCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVWCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 7 if entered
      * CASE: DTL.USR CDE Parm 6 is Warehouse Code not Blank
     C           #DVXCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVXCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9946  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 8 if entered
      * CASE: DTL.USR CDE Parm 7 is Warehouse Code not Blank
     C           #DVYCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVYCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 9 if entered
      * CASE: DTL.USR CDE Parm 8 is Warehouse Code not Blank
     C           #DVZCD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DVZCD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9950  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Validate warehouse 10 if entered
      * CASE: DTL.USR CDE Parm 9 is Warehouse Code not Blank
     C           #DV0CD    IFNE *BLANK                     *IF
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DV0CD    WL0006    P      Warehouse Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    YN0028    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Omit is selected there must be at least 1 warehouse entered
      * CASE: DTL.USR Select/Omit Flag is Omit
     C           #DCYST    IFEQ 'O'                        *IF
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10
      *   |- c1    : DTL.Warehouse Code is Warehouse Code Blank
      *   |- c2    : DTL.USR CDE Parm 1 is Warehouse Code Blank
      *   |- c3    : DTL.USR CDE Parm 2 is Warehouse Code Blank
      *   |- c4    : DTL.USR CDE Parm 3 is Warehouse Code Blank
      *   |- c5    : DTL.USR CDE Parm 4 is Warehouse Code Blank
      *   |- c6    : DTL.USR CDE Parm 5 is Warehouse Code Blank
      *   |- c7    : DTL.USR CDE Parm 6 is Warehouse Code Blank
      *   |- c8    : DTL.USR CDE Parm 7 is Warehouse Code Blank
      *   |- c9    : DTL.USR CDE Parm 8 is Warehouse Code Blank
      *   |- c10   : DTL.USR CDE Parm 9 is Warehouse Code Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AJCD    IFEQ *BLANK                     *IF
     C           #DVSCD    IFEQ *BLANK                     *IF
     C           #DVTCD    IFEQ *BLANK                     *IF
     C           #DVUCD    IFEQ *BLANK                     *IF
     C           #DVVCD    IFEQ *BLANK                     *IF
     C           #DVWCD    IFEQ *BLANK                     *IF
     C           #DVXCD    IFEQ *BLANK                     *IF
     C           #DVYCD    IFEQ *BLANK                     *IF
     C           #DVZCD    IFEQ *BLANK                     *IF
     C           #DV0CD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1AJCD    ZA0006           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9943  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Thru Date             USR required
     C           #DOADT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Select Option required
     C           #DOPTI    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1BTC7           Parent Customer
     C                     MOVEL*BLANK    #1R0SX           Load U/M
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1C5VL           LFC Amount
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #1CONB           Invoice Number
     C                     Z-ADD*ZERO     #1AWDT           Invoice Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     Z-ADD*ZERO     #DOADT           Thru Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDOADT
     C                     MOVEL*BLANK    #DOPTI           Select Option
     C                     MOVEL*BLANK    #1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
     C                     Z-ADD*ZERO     #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVEL*BLANK    #DUWTX           Ship To Name
     C                     MOVEL*BLANK    #DJ9AA           FCG Group Code
     C                     MOVEL*BLANK    #DSVNA           FCG Group Desc
     C                     MOVEL*BLANK    #1CDAA           FC Code
     C                     MOVEL*BLANK    #DSANA           FC Description
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #DUGTX           Email Address
     C                     MOVEL*BLANK    #DA9TX           Email Format
     C                     MOVEL*BLANK    #DCYST           USR Select/Omit
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     MOVEL*BLANK    #DVWCD           USR CDE Parm 5
     C                     MOVEL*BLANK    #DVSCD           USR CDE Parm 1
     C                     MOVEL*BLANK    #DVXCD           USR CDE Parm 6
     C                     MOVEL*BLANK    #DVTCD           USR CDE Parm 2
     C                     MOVEL*BLANK    #DVYCD           USR CDE Parm 7
     C                     MOVEL*BLANK    #DVUCD           USR CDE Parm 3
     C                     MOVEL*BLANK    #DVZCD           USR CDE Parm 8
     C                     MOVEL*BLANK    #DVVCD           USR CDE Parm 4
     C                     MOVEL*BLANK    #DV0CD           USR CDE Parm 9
      * CALC: Screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DW1TX    P      Name
     C                     MOVELWL0003    YN0002    P      Record Status
     C                     MOVEL*BLANK    #DUWTX           Ship To Name
      * Ship To Name          DRV
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SKRVGN
     C                     MOVEL*BLANK    #DSANA           FC Description
      * FC Description DRV
      * Rtv Frt Charge Info   RT - Freight Charge  * 
     C                     EXSR SLRVGN
     C                     MOVEL*BLANK    #DSVNA           FCG Group Desc
      * FCG Group Desc DRV
      * Rtv Frt Group Info    RT - Freight Group  * 
     C                     EXSR SMRVGN
      * USER: Load screen
      * ** Company Name
      * CASE: DTL.Company Number is Equal to zero
     C           #1AIC3    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL'*ALL'    #DAPTX           Company Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Company Name Only  RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0004           Company Number
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DAPTX    P      Name
     C                     END                             *FI
     C                     Z-ADD##JDT     #1AWDT           Invoice Date
     C                     Z-ADD##JDT     #DOADT           Thru Date
     C                     MOVEL'1'       #DOPTI           Select Option
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Invoice Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      * Convert Thru Date             USR to display format
      * Convert date
     C           1000000   ADD  #DOADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDOADT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Name, status       RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WABCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#1BCCD    WABCCD           Salesperson Cod
      * Establish starting position
     C           KRSSA     CHAINEAPREGF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL*BLANK    YL0001           Record Status
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAALTX    #DALTX           Salesperson Nam
     C                     MOVELWAVSST    YL0001           Record Status
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0001    WBBZNA           Carrier Code
      * Establish starting position
     C           KRSSB     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     MOVEL*BLANK    WL0003           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBADTX    WL0002           Name
     C                     MOVELWBVSST    WL0003           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDWCK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DUWTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAYTX    #DUWTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WECDAA           FC Code
      * Setup key
     C                     MOVEL#1CDAA    WECDAA           FC Code
      * Establish starting position
     C           KRSSE     CHAIN@A9REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3052' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSANA           FC Description
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEPNNA    #DSANA           FC Description
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Frt Group Info    RT - Freight Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFJ9AA           FCG Group Code
      * Setup key
     C                     MOVEL#DJ9AA    WFJ9AA           FCG Group Code
      * Establish starting position
     C           KRSSF     CHAIN@D9REU0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4002' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSVNA           FCG Group Descr
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFSUNA    #DSVNA           FCG Group Descr
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0004    WGAIC3           Company Number
      * Establish starting position
     C           KRSSG     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGADTX    WL0005           Name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBCCD           Salesperson Cod
      * Setup key
     C                     MOVEL#1BCCD    WHBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSH     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    #DALTX           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHBCCD    #1BCCD           Salesperson Cod
     C                     MOVELWHALTX    #DALTX           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Name RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DUWTX           Customer Name
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAYTX    #DUWTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0006    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Warehouse Descr
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWIF8NA    WL0007           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1BKC7    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DUWTX           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAYTX    #DUWTX           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WECDAA           FC Code
      * Setup key
     C                     MOVEL#1CDAA    WECDAA           FC Code
      * Establish starting position
     C           KRSSL     CHAIN@A9REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3052' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSANA           FC Description
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEPNNA    #DSANA           FC Description
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Frt Group Info    RT - Freight Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WFJ9AA           FCG Group Code
      * Setup key
     C                     MOVEL#DJ9AA    WFJ9AA           FCG Group Code
      * Establish starting position
     C           KRSSM     CHAIN@D9REU0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4002' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DSVNA           FCG Group Descr
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFSUNA    #DSVNA           FCG Group Descr
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WJAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELWJMPNA    P1MPNA           Default Printer
     C                     MOVELWJBCCD    YL0029           Salesperson Cod
     C                     MOVELWJBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAJVN           User Profile Na
     C                     KFLD           WKDNCD           Application Cod
      * Setup key
     C                     MOVELWL0008    WKAJVN           User Profile Na
     C                     MOVELWL0009    WKDNCD           Application Cod
      * Establish starting position
     C           KRSSO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIC3    WL0010           Company Number
     C                     MOVELWKAJCD    WL0011           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSP01           Application Cod
     C                     MOVEL'TRF'     WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WLRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWLAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVELWLRSCD    WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAUNA    WUAUNA           Description
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 04/15/2009 LJB E00384
      * ** Add processing for Multiple Warehouse Selection options
      * ** This will be for the screen and for the selected reports
      * **
      * ** 08/18/2008 LJB E00207
      * ** Use Override miles if they exist, else use total load miles
      * **
      * ** 11/12/2007 LJB FP1225
      * ** Add new program to print Excessive Freight by Customer. Add
      * ** Ship To Customer as a parameter to pass to called program
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DOPTI'  YPMTFD           Select Option
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DA9TX'  YPMTFD           Email Format
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DCYST'  YPMTFD           USR Select/Omit
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJNC           Customer Number
     C                     Z-ADD*ZERO     P2AJAD           From Date Pass
     C                     Z-ADD*ZERO     P2AJAG           Thru Date Pass
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     Z-ADD*ZERO     P2SHTC           Ship to Custome
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Program name USR
     C                     MOVEL*BLANK    WUBMVN 10
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WBEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WBNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WBNSVA           Long hook balan
     C                     Z-ADD*ZERO     WBNTVA           Short hook bala
     C                     Z-ADD*ZERO     WBNUVA           Tub Balance
     C                     Z-ADD*ZERO     WBS8NB           Home Phone
     C                     Z-ADD*ZERO     WBS9NB           Other Phone
     C                     Z-ADD*ZERO     WBNMVA           Flat Rate
     C                     Z-ADD*ZERO     WBNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WBNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WBNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WBQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WBRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WBMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WBBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WBDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WBDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WBB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WBB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WBAAC7           Contact Number
     C                     Z-ADD*ZERO     WBTENO           Carrier Unused
     C                     Z-ADD*ZERO     WBAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WBAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WBKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Pallets
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Unused Date
     C                     Z-ADD*ZERO     WCCLTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP0DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCMTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDP3NB           D & B Number
     C                     Z-ADD*ZERO     WDI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WDAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WDVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WDI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEC3VL           FC Rate Amount
     C                     Z-ADD*ZERO     WEOPDT           FC Auto Calc Ef
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WIBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJNLNB           Entity Number
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0006  3
     C                     MOVEL*BLANK    WL0007 30
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0008 10
     C                     MOVEL*BLANK    WL0009  6
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Total Load Miles
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field FC Description
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field FC Rate Amount
     C                     Z-ADD*ZERO     YL0004  72
      * Define local work field FC Unit of Measure
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field FC Act Frt Include Sts
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field FC Frt Add/Deduct
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field FC Load Type Select
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field FC State Select
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field FC Export Select
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field FC Shag/Wash Select
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field FC Auto Calc Sts
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field FC Charge Category
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field FC Shag/Wash Comp
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field FC Edit Sequence
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field FC Tot Freight Inc Sts
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field FC Special Type
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field FC ExpInt FR/FZ Select
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field FC Reference Required
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field FC Trans Mode Select
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field FC Freight Rate Type Sel
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field FC Company Select
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field FC Company/Carrier Select
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field FC Shared Responsibility
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field FC Unused Sts 10
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0026  72
      * Define local work field Total Stops
     C                     Z-ADD*ZERO     YL0027  50
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0028  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field FC Rate Amount
     C                     Z-ADD*ZERO     YN0003  72
      * Define null work field FC Unit of Measure
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field FC Act Frt Include Sts
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field FC Frt Add/Deduct
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field FC Load Type Select
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field FC State Select
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field FC Export Select
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field FC Shag/Wash Select
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field FC Auto Calc Sts
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field FC Charge Category
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field FC Shag/Wash Comp
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field FC Edit Sequence
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field FC Tot Freight Inc Sts
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field FC Special Type
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field FC ExpInt FR/FZ Select
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field FC Reference Required
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field FC Trans Mode Select
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field FC Freight Rate Type Sel
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field FC Company Select
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field FC Company/Carrier Select
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field FC Shared Responsibility
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field FC Unused Sts 10
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field FC Auto Calc Effective
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0028 30
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0029  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0007           User Profile Na
     C                     MOVEL'TRF'     ZA0008           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0008    P      User Profile Na
     C                     MOVEL'TRF'     WL0009    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1AIC3           Company Number
     C                     MOVELWL0011    P1AJCD    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0008    P      User Profile Na
     C                     MOVEL'TRF'     WL0009    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1AIC3           Company Number
     C                     MOVELWL0011    P1AJCD    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0009           User Profile Na
     C                     MOVEL'TRF'     ZA0010           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01051010620130702075020850233102341
02587025970284302853030990310903355
03365036110386704123043790439004635
04646048910490205147051580540305414
** W0END
01058010690130702077021140233302370
02593026260284802882031040313803357
03394036600387104123043810439204637
04648048930490405149051600540505416
** W0NAM
V1AWDT    VDOADT    #DOPTI    #1BCCD    #DALTX    #1BZNA    #DW1TX
V1BKC7    #DUWTX    #DJ9AA    #DSVNA    #1CDAA    #DSANA    V1AIC3
#DAPTX    #DUGTX    #DA9TX    #DCYST    #1AJCD    #DVWCD    #DVSCD
#DVXCD    #DVTCD    #DVYCD    #DVUCD    #DVZCD    #DVVCD    #DV0CD
** @CN
00001 Excessive Frt by Salesman
00002 Excessive Frt by Carrier
00003 Excessive Frt by Customer
00004 *Inactive Salesperson
