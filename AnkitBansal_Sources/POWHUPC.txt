/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR PRINTING WEEKLY PACKAGING USAGE      */
/*                                                                  */
/*  SYSTEM    - INVENTORY MANAGEMENT                                */
/*  DATE      - 06/18/03                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*         &COMPNYN       -  PASSED COMPANY NUMBER                  */
/*         &RCDSTS        -  PASSED RECORD STATUS                   */
/*         &APPLIC        -  APPLICATION CODE                       */
/*         &OUTQ          -  OUTPUT QUEUE                           */
/*         &HOLD          -  HOLD STATUS                            */
/*         &SAVE          -  SAVE STATUS                            */
/*         &COPYN         -  PASSED NUMBER OF COPIES                */
/*         &NIGHTQ        -  NIGHT JOB QUEUE                        */
/********************************************************************/
/* RMC   6/18/03  ADDED EMAIL ADDRESS PARM                         */
/********************************************************************/
 PDEAUPR:    PGM        PARM(&RETURN &COMPNYN &XFDATE &SHIFT +
                          &OUTQ &HOLD &SAVE &COPYN &EMAIL)
        DCL    &RETURN     *CHAR   (7)           /* Return Code               */
        DCL    &COMPNYN     *CHAR (15)
        DCL    &XFDATE       *CHAR  (07)
        DCL    &SHIFT       *CHAR  (1)
        DCL    &OUTQ        *CHAR  (10)
        DCL    &HOLD        *CHAR  (04)
        DCL    &SAVE        *CHAR  (04)
        DCL    &NIGHTQ      *CHAR  (10)
        DCL    &COMMAND     *CHAR  (512)
        DCL    &EMAIL       *CHAR  (50)

        DCL    &COMPANY     *DEC   (3 0)
        DCL    &COPY        *DEC   (2 0)
        DCL    &FDATE       *DEC   (7 0)
        DCL    &COPYN       *DEC

/* CONVERT PARAMETERS TO REQUIRED SIZE FOR PRINT FUNCTION                  */

             CHGVAR     VAR(&COMPANY)  VALUE(&COMPNYN)
             CHGVAR     VAR(&COPY)     VALUE(&COPYN)
             CHGVAR     VAR(&FDATE)    VALUE(&XFDATE)

             ADDLIBLE   LIB(ESEND)
             MONMSG CPF0000
/*************                            ********************/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(POR2PFR$) +
                          OUTQ(&OUTQ) COPIES(&COPY) HOLD(&HOLD) +
                          SAVE(&SAVE)
             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

             CALL       PGM(POR2PFR) PARM(' ' &COMPANY &FDATE &SHIFT)
             IF         COND(&EMAIL *NE ' ') THEN(DO)
             ESNDMAIL   RECIPIENT(&EMAIL) +
                          SUBJECT(PKG_USAGE) ATTLIST((* *PDF *N +
                          POR2PFR$))
             ENDDO
ENDPGM:     ENDPGM
