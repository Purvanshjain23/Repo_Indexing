// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POLOEFR
// ?Date: 14.08.2025 Time: 03:37:56
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

EXECUTE FUNCTION(VAL Set Inter. Access  IF) TYPE(EXCINTFUN)                     AC1144606;
PARAMETER('OMS');
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.Allow_Multi_Company);
PARAMETER(PAR.Default_Printer);
PARAMETER(PAR.Salesperson_Code);

//?USER: Initialize subfile record (new record)

// RCD.Record Status = CND.Active
RCD.Record_Status = 'A';

// RCD.FC Act Frt Include Sts = CND.No
RCD.FC_Act_Frt_Include_Sts = 'N';

// RCD.FC Load Type Select = CND.All
RCD.FC_Load_Type_Select = 'A';

// RCD.FC Export Select = CND.All
RCD.FC_Export_Select = 'A';

// RCD.FC State Select = CND.No
RCD.FC_State_Select = 'N';

// RCD.FC Shag/Wash Select = CND.No
RCD.FC_Shag_Wash_Select = 'N';

// RCD.FC Auto Calc Sts = CND.No
RCD.FC_Auto_Calc_Sts = 'N';

// RCD.FC Edit Sequence = CND.None
RCD.FC_Edit_Sequence = 'N';

// RCD.FC Tot Freight Inc Sts = CND.Yes
RCD.FC_Tot_Freight_Inc_Sts = 'Y';

// RCD.FC Special Type = CND.Not Special Type
RCD.FC_Special_Type = 'N';

//?USER: Validate subfile record fields

CASE;

// IF RCD.*SFLSEL is Option 8
IF RCD.*SFLSEL = '8'/'8';

CASE;

// IF RCD.FC State Select is Yes
IF RCD.FC_State_Select = 'Y';

// Call program Zzz Frt Charge State  EF.
CALL PROGRAM(Zzz Frt Charge State  EF) ('POLREFR');
PARAMETER(RCD.FC_Code);

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

// RCD.*SFLSEL = CND.*Reset to blank
RCD.*SFLSEL = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Option is not allowed.'
ERROR(USR2262);
MSGPARM(RCD.*SFLSEL);

ENDIF;

ENDIF;

//?USER: Create DBF record

EXECUTE FUNCTION(Crt Freight Charge    CR) TYPE(CRTOBJ) FILE(POA9REP)           AC1626731;
PARAMETER(RCD.FC_Code);
PARAMETER(RCD.FC_Description);
PARAMETER(RCD.FC_Rate_Amount);
PARAMETER(RCD.FC_Unit_of_Measure);
PARAMETER(RCD.FC_Act_Frt_Include_Sts);
PARAMETER(RCD.FC_Frt_Add_Deduct);
PARAMETER(RCD.FC_Load_Type_Select);
PARAMETER(RCD.FC_State_Select);
PARAMETER(RCD.FC_Export_Select);
PARAMETER(RCD.FC_Shag_Wash_Select);
PARAMETER(RCD.FC_Auto_Calc_Sts);
PARAMETER(RCD.FC_Charge_Category);
PARAMETER(RCD.FC_Shag_Wash_Comp);
PARAMETER(RCD.FC_Edit_Sequence);
PARAMETER(RCD.FC_Tot_Freight_Inc_Sts);
PARAMETER(RCD.FC_Special_Type);
PARAMETER(RCD.FC_ExpInt_FR_FZ_Select);
PARAMETER(RCD.FC_Reference_Required);
PARAMETER(RCD.FC_Trans_Mode_Select);
PARAMETER(RCD.FC_Freight_Rate_Type_Sel);
PARAMETER(RCD.FC_Company_Select);
PARAMETER(RCD.FC_Company_Carrier_Select);
PARAMETER(RCD.FC_Shared_Responsibility);
PARAMETER(RCD.FC_Unused_Sts_10);
PARAMETER(RCD.FC_Auto_Calc_Effective);
PARAMETER(RCD.Record_Status);
PARAMETER(RCD.Create_Date);
PARAMETER(RCD.Create_Time);
PARAMETER(RCD.Create_User);
PARAMETER(RCD.Create_Program);
PARAMETER(RCD.Change_Date);
PARAMETER(RCD.Change_Time);
PARAMETER(RCD.Change_User);
PARAMETER(RCD.Change_Program);

//?USER: Change DBF record

EXECUTE FUNCTION(Chg Freight Charge    CH) TYPE(CHGOBJ) FILE(POA9REP)           AC1626732;
PARAMETER(RCD.FC_Code);
PARAMETER(RCD.FC_Description);
PARAMETER(RCD.FC_Rate_Amount);
PARAMETER(RCD.FC_Unit_of_Measure);
PARAMETER(RCD.FC_Act_Frt_Include_Sts);
PARAMETER(RCD.FC_Frt_Add_Deduct);
PARAMETER(RCD.FC_Load_Type_Select);
PARAMETER(RCD.FC_State_Select);
PARAMETER(RCD.FC_Export_Select);
PARAMETER(RCD.FC_Shag_Wash_Select);
PARAMETER(RCD.FC_Auto_Calc_Sts);
PARAMETER(RCD.FC_Charge_Category);
PARAMETER(RCD.FC_Shag_Wash_Comp);
PARAMETER(RCD.FC_Edit_Sequence);
PARAMETER(RCD.FC_Tot_Freight_Inc_Sts);
PARAMETER(RCD.FC_Special_Type);
PARAMETER(RCD.FC_ExpInt_FR_FZ_Select);
PARAMETER(RCD.FC_Reference_Required);
PARAMETER(RCD.FC_Trans_Mode_Select);
PARAMETER(RCD.FC_Freight_Rate_Type_Sel);
PARAMETER(RCD.FC_Company_Select);
PARAMETER(RCD.FC_Company_Carrier_Select);
PARAMETER(RCD.FC_Shared_Responsibility);
PARAMETER(RCD.FC_Unused_Sts_10);
PARAMETER(RCD.FC_Auto_Calc_Effective);
PARAMETER(RCD.Record_Status);
PARAMETER(RCD.Create_Date);
PARAMETER(RCD.Create_Time);
PARAMETER(RCD.Create_User);
PARAMETER(RCD.Create_Program);
PARAMETER(RCD.Change_Date);
PARAMETER(RCD.Change_Time);
PARAMETER(RCD.Change_User);
PARAMETER(RCD.Change_Program);

