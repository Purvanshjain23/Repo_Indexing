     H/TITLE EDT TPM Ship Hdr Error EF Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Edit file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 10/21/13  Time  : 10:35:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPBIMEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT TPM Ship Hdr Error EF Edit file
      *
     FPBAZREL3IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : TPM Shipment Header       DtTmSq(d)/Acc/Ship#/Sts
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPBAZREL0UF  E           K        DISK
      * UPD : TPM Shipment Header       Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    ARR1       20  1               ARRAY 1
     E                    ARR2        7  1               ARRAY 2
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPBAZREL0
      * UPD : TPM Shipment Header       Update index
      * Current/previous master file format fields for change control
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDI8T       DS
      * Internal date
     I                                        1   80XDI8DT
     I                                        1   40XDI8CY
     I                                        1   10XDI8CC
     I                                        2   40XDI8YY
     I                                        5   60XDI8MM
     I                                        7   80XDI8DD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     IYBRDCS      DS                            367
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  TPM Freight Order Sts
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  OH Unused Date 3
     I                                    P 683 6860PANQDT
      * I :  OH Unused Date 4
     I                                    P 687 6900PANRDT
      * I :  OH Unused Date 5
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  OH Unused Time 4
     I                                    P 707 7100PABSTM
      * I :  OH Unused Time 5
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYDRDCS      DS                            525
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IYERDCS      DS                            234
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: TPM Shipment Header
      * I :  TPM Transaction Date
     I                                        1   80P1AOD8
      * I :  TPM Transaction Time
     I                                        9  140P1AMTS
      * I :  TPM Transaction Sequence
     I                                    P  15  170P1X0NY
      * I :  TPM Ship Access Code
     I                                       18  19 P1RAST
      * I :  TPM Shipment Number Code
     I                                       20  39 P1UJNA
      * I :  TPM Status Code
     I                                       40  41 P1RDST
      * I :  TPM Shipment Process Sts
     I                                    P  42  440P1X1NY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Err rsn req'd with sts=2'
      * TPM Shipment Error Reason
     I                                        1   6 ZA0001
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Load ID
     I                                    P   2   50ZA0003
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0004
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0005
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AOD8    PARM           WP0001  80       TPM Transaction
     C           P1AMTS    PARM           WP0002  60       TPM Transaction
     C           P1X0NY    PARM           WP0003  50       TPM Transaction
     C           P1RAST    PARM           WP0004  2        TPM Ship Access
     C           P1UJNA    PARM           WP0005 20        TPM Shipment Nu
     C           P1RDST    PARM           WP0006  2        TPM Status Code
     C           P1X1NY    PARM           WP0007  50       TPM Shipment Pr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
     C           YPMTFD    IFEQ *BLANKS
      * USER: Initialize subfile header
      * First time calcs
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
      * CTL = PAR By name
     C                     MOVELP1RAST    #2RAST           TPM Ship Access
     C                     Z-ADDP1X1NY    #CX1NY           TPM Shipment Pr
     C                     Z-ADDP1AOD8    #2AOD8           TPM Transaction
     C                     Z-ADDP1AMTS    #2AMTS           TPM Transaction
     C                     Z-ADDP1X0NY    #2X0NY           TPM Transaction
     C                     MOVELP1UJNA    #2UJNA           TPM Shipment Nu
     C                     MOVELP1RDST    #2RDST           TPM Status Code
      * CASE: CTL.TPM Shipment Process Sts is Error
     C           #CX1NY    IFEQ 2                          *IF
     C                     MOVEL@CN,001   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Not Processed
     C           #CX1NY    IFEQ 0                          *IF
     C                     MOVEL@CN,002   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Processed
     C           #CX1NY    IFEQ 1                          *IF
     C                     MOVEL@CN,003   #CEET1           Description 21A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
     C                     END
      *................................................................
      * Position file
     C           *LIKE     DEFN #2AOD8    WZAOD8
     C                     MOVEL#2AOD8    WZAOD8           TPM Transaction
     C           *LIKE     DEFN #2AMTS    WZAMTS
     C                     MOVEL#2AMTS    WZAMTS           TPM Transaction
     C           *LIKE     DEFN #2X0NY    WZX0NY
     C                     MOVEL#2X0NY    WZX0NY           TPM Transaction
     C           *LIKE     DEFN #2UJNA    WZUJNA
     C                     MOVEL#2UJNA    WZUJNA           TPM Shipment Nu
     C           *LIKE     DEFN #2RDST    WZRDST
     C                     MOVEL#2RDST    WZRDST           TPM Status Code
     C           KPOS      KLIST
     C                     KFLD           AZAOD8           TPM Transaction
     C                     KFLD           AZAMTS           TPM Transaction
     C                     KFLD           AZX0NY           TPM Transaction
     C                     KFLD           AZRAST           TPM Ship Access
     C                     KFLD           AZUJNA           TPM Shipment Nu
     C                     KFLD           AZRDST           TPM Status Code
      * Setup key
     C           #2AOD8    IFEQ *ZERO
     C                     MOVEL*HIVAL    AZAOD8           TPM Transaction
     C                     ELSE
     C                     Z-ADD#2AOD8    AZAOD8
     C                     ENDIF
     C           #2AMTS    IFEQ *ZERO
     C                     MOVEL*HIVAL    AZAMTS           TPM Transaction
     C                     ELSE
     C                     Z-ADD#2AMTS    AZAMTS
     C                     ENDIF
     C           #2X0NY    IFEQ *ZERO
     C                     MOVEL*HIVAL    AZX0NY           TPM Transaction
     C                     ELSE
     C                     Z-ADD#2X0NY    AZX0NY
     C                     ENDIF
     C                     MOVEL#2RAST    AZRAST
     C                     MOVEL#2UJNA    AZUJNA
     C                     MOVEL#2RDST    AZRDST
      * 82=EOF
     C           KPOS      SETLL@AZRERQ              82    *
      * 82=EOF
     C  N82                READ @AZRERQ                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@AZRERQ                  90*
     C  N82                READ @AZRERQ                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  3
     C                     MOVE *ALL'1'   WKIND1  3
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADDP1X1NY    WUOLNY           Number 1.0 USR
      * Restrict to passed in Access Code
      * CASE: DB1.TPM Ship Access Code NE CTL.TPM Ship Access Code
     C           AZRAST    IFNE #2RAST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Process Status, if entered
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.TPM Shipment Process Sts is Error
      *   |- c2    : DB1.TPM Shipment Process Sts NE CTL.TPM Shipment Pro
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CX1NY    IFEQ 2                          *IF
     C           AZX1NY    IFNE #CX1NY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.TPM Shipment Process Sts is Processed
      *   |- c2    : DB1.TPM Shipment Process Sts NE CTL.TPM Shipment Pro
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CX1NY    IFEQ 1                          *IF
     C           AZX1NY    IFNE #CX1NY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.TPM Shipment Process Sts is Not Processed
      *   |- c2    : DB1.TPM Shipment Process Sts NE CTL.TPM Shipment Pro
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CX1NY    IFEQ 0                          *IF
     C           AZX1NY    IFNE #CX1NY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test date if entered
      * CASE: CTL.TPM Transaction Date is Entered
     C           #2AOD8    IFNE *ZERO                      *IF
      * CASE: DB1.TPM Transaction Date NE CTL.TPM Transaction Date
     C           AZAOD8    IFNE #2AOD8                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Test time if entered
      * CASE: CTL.TPM Transaction Time is Entered
     C           #2AMTS    IFNE *ZERO                      *IF
      * CASE: DB1.TPM Transaction Time NE CTL.TPM Transaction Time
     C           AZAMTS    IFNE #2AMTS                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Test sequence if entered
      * CASE: CTL.TPM Transaction Sequence is Entered
     C           #2X0NY    IFNE *ZERO                      *IF
      * CASE: DB1.TPM Transaction Sequence NE CTL.TPM Transaction Sequenc
     C           AZX0NY    IFNE #2X0NY                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Test Shipment Number if entered
      * CASE: CTL.TPM Shipment Number Code is Entered
     C           #2UJNA    IFNE *BLANK                     *IF
      * CASE: DB1.TPM Shipment Number Code NE CTL.TPM Shipment Number Cod
     C           AZUJNA    IFNE #2UJNA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Test TPM Status if entered
      * CASE: CTL.TPM Status Code NE WRK.Blank 6 USR
     C           #2RDST    IFNE WUXKTX                     *IF
      * CASE: DB1.TPM Status Code NE CTL.TPM Status Code
     C           AZRDST    IFNE #2RDST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C                     READ @AZRERQ                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * CTL.Description 14A      USR = Condition name of CTL.TPM Ship Acc
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2077058   Y2LSNO  70       List number
     C                     PARM #2RAST    W0INVL 25        TPM Ship Access
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CI6TX    PARM           W0CNNM 25        Description 14A
      *
      * CASE: CTL.TPM Shipment Process Sts is Error
     C           #CX1NY    IFEQ 2                          *IF
     C                     MOVEL@CN,001   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Not Processed
     C           #CX1NY    IFEQ 0                          *IF
     C                     MOVEL@CN,002   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Processed
     C           #CX1NY    IFEQ 1                          *IF
     C                     MOVEL@CN,003   #CEET1           Description 21A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #CEET1           Description 21A
     C                     MOVEL'*All'    #CEET1           Description 21A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate TPM Transaction Date
      * External date
     C                     Z-ADDV2AOD8    XDEXDT
      * Check date
     C                     EXSR XDC84
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDI8DT    #2AOD8
      * Validate TPM Transaction Time
     C                     Z-ADD#2AMTS    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
      * Change of position specified
     C           YPMTFD    IFEQ *BLANKS
     C           WZAOD8    CASNE#2AOD8    FBRQRL           TPM Transaction
     C           WZAMTS    CASNE#2AMTS    FBRQRL           TPM Transaction
     C           WZX0NY    CASNE#2X0NY    FBRQRL           TPM Transaction
     C           WZUJNA    CASNE#2UJNA    FBRQRL           TPM Shipment Nu
     C           WZRDST    CASNE#2RDST    FBRQRL           TPM Status Code
     C                     END
     C                     END
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,36
      * No errors
     C                     SETOF                     98
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
      * Validate TPM Shipment Error Reason
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U1AG'  IFEQ YPMTFD
     C           ##RR      ANDEQYPMRRN
      * TPM Shipment Error Reason
     C                     MOVEL#1U1AG    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU1AG
     C                     SELEC
     C           W0INVL    WHEQ 'STOPS'                    STOPS
     C                     Z-ADD1         ZHU1AG
     C           W0INVL    WHEQ 'INVFAC'                   INVFAC
     C                     Z-ADD2         ZHU1AG
     C           W0INVL    WHEQ 'ORDSTS'                   ORDSTS
     C                     Z-ADD3         ZHU1AG
     C           W0INVL    WHEQ 'HDRSTS'                   HDRSTS
     C                     Z-ADD4         ZHU1AG
     C           W0INVL    WHEQ 'TPMFOS'                   TPMFOS
     C                     Z-ADD5         ZHU1AG
     C           W0INVL    WHEQ 'NOORDS'                   NOORDS
     C                     Z-ADD6         ZHU1AG
     C           W0INVL    WHEQ 'BLKORD'                   BLKORD
     C                     Z-ADD7         ZHU1AG
     C           W0INVL    WHEQ 'LCKINV'                   LCKINV
     C                     Z-ADD8         ZHU1AG
     C           W0INVL    WHEQ 'TRKSIZ'                   TRKSIZ
     C                     Z-ADD9         ZHU1AG
     C           W0INVL    WHEQ 'UNACPT'                   UNACPT
     C                     Z-ADD10        ZHU1AG
     C           W0INVL    WHEQ 'ONHOLD'                   ONHOLD
     C                     Z-ADD11        ZHU1AG
     C           W0INVL    WHEQ 'INUSE'                    INUSE
     C                     Z-ADD12        ZHU1AG
     C           W0INVL    WHEQ 'REQREV'                   REQREV
     C                     Z-ADD13        ZHU1AG
     C           W0INVL    WHEQ 'LCKPND'                   LCKPND
     C                     Z-ADD14        ZHU1AG
     C           W0INVL    WHEQ 'LCKERR'                   LCKERR
     C                     Z-ADD15        ZHU1AG
     C           W0INVL    WHEQ 'ORDMSS'                   ORDMSS
     C                     Z-ADD16        ZHU1AG
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD17        ZHU1AG
     C           W0INVL    WHEQ 'ORDCNL'                   ORDCNL
     C                     Z-ADD18        ZHU1AG
     C           W0INVL    WHEQ 'LODCNL'                   LODCNL
     C                     Z-ADD19        ZHU1AG
     C           W0INVL    WHEQ 'CNLERR'                   CNLERR
     C                     Z-ADD20        ZHU1AG
     C           W0INVL    WHEQ 'ORDINV'                   ORDINV
     C                     Z-ADD21        ZHU1AG
     C                     ENDSL
      * Window width
     C                     Z-ADD30        YWWDWD
      * Window depth
     C                     Z-ADD21        YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD11        YWWDRW
     C                     ADD  YZSFDL    YWWDRW
      * Window start column
     C                     Z-ADD73        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
     C                     EXFMTZGU1AG
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU1AG    WHEQ 1
     C                     MOVEL'STOPS'   W0INVL           STOPS
     C           ZHU1AG    WHEQ 2
     C                     MOVEL'INVFAC'  W0INVL           INVFAC
     C           ZHU1AG    WHEQ 3
     C                     MOVEL'ORDSTS'  W0INVL           ORDSTS
     C           ZHU1AG    WHEQ 4
     C                     MOVEL'HDRSTS'  W0INVL           HDRSTS
     C           ZHU1AG    WHEQ 5
     C                     MOVEL'TPMFOS'  W0INVL           TPMFOS
     C           ZHU1AG    WHEQ 6
     C                     MOVEL'NOORDS'  W0INVL           NOORDS
     C           ZHU1AG    WHEQ 7
     C                     MOVEL'BLKORD'  W0INVL           BLKORD
     C           ZHU1AG    WHEQ 8
     C                     MOVEL'LCKINV'  W0INVL           LCKINV
     C           ZHU1AG    WHEQ 9
     C                     MOVEL'TRKSIZ'  W0INVL           TRKSIZ
     C           ZHU1AG    WHEQ 10
     C                     MOVEL'UNACPT'  W0INVL           UNACPT
     C           ZHU1AG    WHEQ 11
     C                     MOVEL'ONHOLD'  W0INVL           ONHOLD
     C           ZHU1AG    WHEQ 12
     C                     MOVEL'INUSE'   W0INVL           INUSE
     C           ZHU1AG    WHEQ 13
     C                     MOVEL'REQREV'  W0INVL           REQREV
     C           ZHU1AG    WHEQ 14
     C                     MOVEL'LCKPND'  W0INVL           LCKPND
     C           ZHU1AG    WHEQ 15
     C                     MOVEL'LCKERR'  W0INVL           LCKERR
     C           ZHU1AG    WHEQ 16
     C                     MOVEL'ORDMSS'  W0INVL           ORDMSS
     C           ZHU1AG    WHEQ 17
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHU1AG    WHEQ 18
     C                     MOVEL'ORDCNL'  W0INVL           ORDCNL
     C           ZHU1AG    WHEQ 19
     C                     MOVEL'LODCNL'  W0INVL           LODCNL
     C           ZHU1AG    WHEQ 20
     C                     MOVEL'CNLERR'  W0INVL           CNLERR
     C           ZHU1AG    WHEQ 21
     C                     MOVEL'ORDINV'  W0INVL           ORDINV
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U1AG
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * * Enter reason if 2=Error
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.TPM Shipment Error Reason is Not Entered
      *   |- c2    : RCD.TPM Shipment Process Sts is Error
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U1AG    IFEQ *BLANK                     *IF
     C           #1X1NY    IFEQ 2                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1U1AG    ZA0001           TPM Shipment Er
      * Send message 'Err rsn req'd with sts=2'
     C                     MOVEL'USR4662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
      *
     C                     END                             *FI
      * * Process Status description
      * CASE: CTL.TPM Shipment Process Sts is Error
     C           #CX1NY    IFEQ 2                          *IF
     C                     MOVEL@CN,001   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Not Processed
     C           #CX1NY    IFEQ 0                          *IF
     C                     MOVEL@CN,002   #CEET1           Description 21A
     C                     ELSE
      * CASE: CTL.TPM Shipment Process Sts is Processed
     C           #CX1NY    IFEQ 1                          *IF
     C                     MOVEL@CN,003   #CEET1           Description 21A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * * Reload if Date filter is changed
      * CASE: CTL.TPM Transaction Date is Entered
     C           #2AOD8    IFNE *ZERO                      *IF
      * CASE: RCD.TPM Transaction Date NE CTL.TPM Transaction Date
     C           #1AOD8    IFNE #2AOD8                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * * Reload if Time filter is changed
      * CASE: CTL.TPM Transaction Time is Entered
     C           #2AMTS    IFNE *ZERO                      *IF
      * CASE: RCD.TPM Transaction Time NE CTL.TPM Transaction Time
     C           #1AMTS    IFNE #2AMTS                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * * Reload if Sequence filter is changed
      * CASE: CTL.TPM Transaction Sequence is Entered
     C           #2X0NY    IFNE *ZERO                      *IF
      * CASE: RCD.TPM Transaction Sequence NE CTL.TPM Transaction Sequenc
     C           #1X0NY    IFNE #2X0NY                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * * Reload if Shipment Number filter is changed
      * CASE: CTL.TPM Shipment Number Code is Entered
     C           #2UJNA    IFNE *BLANK                     *IF
      * CASE: RCD.TPM Shipment Number Code NE CTL.TPM Shipment Number Cod
     C           #1UJNA    IFNE #2UJNA                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * * Reload if Status Code filter is changed
      * CASE: CTL.TPM Status Code NE WRK.Blank for 3          USR
     C           #2RDST    IFNE WUUAT1                     *IF
      * CASE: RCD.TPM Status Code NE CTL.TPM Status Code
     C           #1RDST    IFNE #2RDST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * 7=Unlock OMS Load
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * * Convert 20 char Shipment# to 7.0 Load ID
     C                     MOVEL#1UJNA    WUSLTX           Text USR 20
      * CLC Rmv Trail blnks-20 US - /UT User Source  * 
      ** INPUT FIELD MUST BE 20 CHAR TPM SHIPMENT NUMBER FIELD
      ** OUTPUT FIELD MUST BE 7.0 LOAD ID WORK FIELD
      ** BOTH FIELDS MUST BE RECEIVED IN WORK CONTEXT
      ** START AT THE END OF THE SHIPMENT NUMBER AND WORK FORWARD
      ** TO FIND THE FIRST NON-BLANK NUMBER AND MOVE THAT TO THE
      ** LOAD ID FIELD, ALSO STARTING AT THE END.
     C                     MOVEAWUSLTX    ARR1             LOAD SHIP# ARRY
     C                     Z-ADD20        X       20       SET ARR1 CNTR
     C                     Z-ADD7         Y       20       SET ARR2 CNTR
     C*
     C           X         DOWGT0
     C           ARR1,X    IFEQ ' '
     C                     SUB  1         X
     C                     ELSE
     C           Y         IFGT 0
     C                     MOVE ARR1,X    ARR2,Y
     C                     SUB  1         Y
     C                     SUB  1         X
     C                     ENDIF
     C                     ENDIF
     C*
     C                     ENDDO
     C*
     C                     MOVEAARR2      WUE2TX           LOAD OUTPUT
     C                     MOVE WUE2TX    WURMNB           Load ID
      * RTV Load Info for TPM  RT - Load Header  * 
     C                     EXSR SARVGN
      *
     C                     MOVEL*BLANK    WN0001  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0002 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0002           User Profile Na
      *
     C                     MOVEL*BLANK    WN0003 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SBRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0003    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0001    P      User Profile Na
     C                     MOVEL@CN,004   WL0002    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0003    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0003    WL0001    P      User Profile Na
     C                     MOVEL@CN,004   WL0002    P      Application Cod
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUAIC3           Company Number
     C                     MOVELWL0004    YL0003    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0003    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0002    IFGT *ZERO                      *IF
     C                     Z-ADDYL0002    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0003    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0001           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR SFRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           'F'       IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
     C                     Z-ADDWURMNB    ZA0003           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           WUPKST    IFEQ 'I'                        *IF
     C           WUPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUPKST    ZA0004           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0001  70       Load ID
     C                     PARM WUAIC3    WQ0002  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0003  1        Pick Status USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVELWUPKST    ZA0005           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0004  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0005  1        Status - Y or N
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
      * Send message 'Load cannot be unlocked'
     C                     MOVEL'USR4664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
      *
     C                     MOVEL*BLANK    WN0004  3        Shipping Line
     C                     MOVEL*BLANK    WN0005 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0006  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0007  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
     C                     EXSR SHCHRC
      *
     C                     MOVEL*BLANK    WN0151  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0152  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN0153  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN0154  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
     C                     EXSR SIRVGN
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR SMRVGN
      * Rtv Active Status     RT - PFS Interface  * 
     C                     EXSR SNRVGN
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0151    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0006  1        Lock/Unlock
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0007  70       Load ID
     C                     PARM WUAIC3    WQ0008  30       Company Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0009  1        Lock/Unlock
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0007    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0010  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0011  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WURMNB    WQ0012  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
     C                     EXSR SORVGN
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWURMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVEL@CN,008   PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVEL'L'       PBMNTX    P      Change Log Prio
     C                     MOVEL'U'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL*BLANK    PBBZNA    P      Carrier Code
     C                     Z-ADDWUAIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C                     ADD  011       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,36
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
      * CASE: WRK.USR Update Flag is Yes
     C           WUR4ST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    WUR4ST           USR Update Flag
      * Send message 'Load has been unlocked'
     C                     MOVEL'USR4663' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * CHG TPM Ship Header    CO - TPM Shipment Header  * 
     C                     EXSR SUCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,36
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     MOVEL*BLANK    #1RAST           TPM Ship Access
     C                     Z-ADD*ZERO     #1Q2QT           TPM Quantity
     C                     Z-ADD*ZERO     #1POWG           TPM Weight
     C                     Z-ADD*ZERO     #1VGDT           TPM Actual Ship
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #1YWNY           TPM Total Load
     C                     Z-ADD*ZERO     #1XJNY           TPM Cube
     C                     MOVEL*BLANK    #1RIST           TPM Cube UOM
     C                     MOVEL*BLANK    #1U1AF           TPM Weight UOM
     C                     MOVEL*BLANK    #1U1AD           TPM Quantity UO
     C                     MOVEL*BLANK    #1R2ST           TPM Length UOM
     C                     MOVEL*BLANK    #1U1AE           TPM Distance UO
     C                     MOVEL*BLANK    #1RMAA           TPM Condition C
     C                     Z-ADD*ZERO     #1XKNY           TPM Condition Q
     C                     MOVEL*BLANK    #1RNAA           TPM Condition C
     C                     Z-ADD*ZERO     #1XLNY           TPM Condition Q
     C                     MOVEL*BLANK    #1ROAA           TPM Condition C
     C                     Z-ADD*ZERO     #1XMNY           TPM Condition Q
     C                     MOVEL*BLANK    #1RPAA           TPM Condition C
     C                     Z-ADD*ZERO     #1XNNY           TPM Condition Q
     C                     MOVEL*BLANK    #1RTAA           TPM Condition C
     C                     Z-ADD*ZERO     #1XUNY           TPM Condition Q
     C                     MOVEL*BLANK    #1RQAA           TPM Route Code
     C                     MOVEL*BLANK    #1AAU1           TPM Service
     C                     MOVEL*BLANK    #1RRAA           TPM Equipment C
     C                     Z-ADD*ZERO     #1XONY           TPM Number of C
     C                     Z-ADD*ZERO     #1XPNY           TPM Equipment M
     C                     Z-ADD*ZERO     #1XQNY           TPM Equipment M
     C                     Z-ADD*ZERO     #1XRNY           TPM Equipment M
     C                     MOVEL*BLANK    #1SCST           TPM Equipment M
     C                     MOVEL*BLANK    #1SDST           TPM Equipment M
     C                     MOVEL*BLANK    #1U1AC           TPM Equipment M
     C                     MOVEL*BLANK    #1UKNA           TPM BOL Number
     C                     Z-ADD*ZERO     #1XSNY           TPM Carrier Fre
     C                     Z-ADD*ZERO     #1XTNY           TPM Length
     C                     Z-ADD*ZERO     #1XVNY           TPM Number of P
     C                     Z-ADD*ZERO     #RN4NY           Processing Sequ
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1AOD8           TPM Transaction
      * Clear external version also
     C                     Z-ADD*ZERO     V1AOD8
     C                     Z-ADD*ZERO     #1AMTS           TPM Transaction
     C                     Z-ADD*ZERO     #1X0NY           TPM Transaction
     C                     MOVEL*BLANK    #1UJNA           TPM Shipment Nu
     C                     MOVEL*BLANK    #1RDST           TPM Status Code
     C                     MOVEL*BLANK    #1RSAA           TPM Carrier SCA
     C                     Z-ADD*ZERO     #1X1NY           TPM Shipment Pr
     C                     MOVEL*BLANK    #1U1AG           TPM Shipment Er
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AZRERQ fields to subfile
      *================================================================
     C                     MOVELAZRAST    #1RAST           TPM Ship Access
     C                     Z-ADDAZQ2QT    #1Q2QT           TPM Quantity
     C                     Z-ADDAZPOWG    #1POWG           TPM Weight
     C                     Z-ADDAZVGDT    #1VGDT           TPM Actual Ship
     C                     Z-ADDAZP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDAZYWNY    #1YWNY           TPM Total Load
     C                     Z-ADDAZXJNY    #1XJNY           TPM Cube
     C                     MOVELAZRIST    #1RIST           TPM Cube UOM
     C                     MOVELAZU1AF    #1U1AF           TPM Weight UOM
     C                     MOVELAZU1AD    #1U1AD           TPM Quantity UO
     C                     MOVELAZR2ST    #1R2ST           TPM Length UOM
     C                     MOVELAZU1AE    #1U1AE           TPM Distance UO
     C                     MOVELAZRMAA    #1RMAA           TPM Condition C
     C                     Z-ADDAZXKNY    #1XKNY           TPM Condition Q
     C                     MOVELAZRNAA    #1RNAA           TPM Condition C
     C                     Z-ADDAZXLNY    #1XLNY           TPM Condition Q
     C                     MOVELAZROAA    #1ROAA           TPM Condition C
     C                     Z-ADDAZXMNY    #1XMNY           TPM Condition Q
     C                     MOVELAZRPAA    #1RPAA           TPM Condition C
     C                     Z-ADDAZXNNY    #1XNNY           TPM Condition Q
     C                     MOVELAZRTAA    #1RTAA           TPM Condition C
     C                     Z-ADDAZXUNY    #1XUNY           TPM Condition Q
     C                     MOVELAZRQAA    #1RQAA           TPM Route Code
     C                     MOVELAZAAU1    #1AAU1           TPM Service
     C                     MOVELAZRRAA    #1RRAA           TPM Equipment C
     C                     Z-ADDAZXONY    #1XONY           TPM Number of C
     C                     Z-ADDAZXPNY    #1XPNY           TPM Equipment M
     C                     Z-ADDAZXQNY    #1XQNY           TPM Equipment M
     C                     Z-ADDAZXRNY    #1XRNY           TPM Equipment M
     C                     MOVELAZSCST    #1SCST           TPM Equipment M
     C                     MOVELAZSDST    #1SDST           TPM Equipment M
     C                     MOVELAZU1AC    #1U1AC           TPM Equipment M
     C                     MOVELAZUKNA    #1UKNA           TPM BOL Number
     C                     Z-ADDAZXSNY    #1XSNY           TPM Carrier Fre
     C                     Z-ADDAZXTNY    #1XTNY           TPM Length
     C                     Z-ADDAZXVNY    #1XVNY           TPM Number of P
     C                     Z-ADDAZAOD8    #1AOD8           TPM Transaction
     C                     Z-ADDAZAMTS    #1AMTS           TPM Transaction
     C                     Z-ADDAZX0NY    #1X0NY           TPM Transaction
     C                     MOVELAZUJNA    #1UJNA           TPM Shipment Nu
     C                     MOVELAZRDST    #1RDST           TPM Status Code
     C                     MOVELAZRSAA    #1RSAA           TPM Carrier SCA
     C                     Z-ADDAZX1NY    #1X1NY           TPM Shipment Pr
     C                     MOVELAZU1AG    #1U1AG           TPM Shipment Er
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CWRSX           All Orders Sts
     C                     MOVEL*BLANK    #2RAST           TPM Ship Access
     C                     MOVEL*BLANK    #CI6TX           Description 14A
     C                     Z-ADD*ZERO     #CX1NY           TPM Shipment Pr
     C                     MOVEL*BLANK    #CEET1           Description 21A
     C                     Z-ADD*ZERO     #2AOD8           TPM Transaction
      * Clear external version also
     C                     Z-ADD*ZERO     V2AOD8
     C                     Z-ADD*ZERO     #2AMTS           TPM Transaction
     C                     Z-ADD*ZERO     #2X0NY           TPM Transaction
     C                     MOVEL*BLANK    #2UJNA           TPM Shipment Nu
     C                     MOVEL*BLANK    #2RDST           TPM Status Code
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TPM Transaction Date to display format
      * Convert date
     C                     Z-ADD#1AOD8    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    V1AOD8
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert TPM Transaction Date to display format
      * Convert date
     C                     Z-ADD#2AOD8    XDI8DT
     C                     EXSR XDV84T
     C                     Z-ADDXDEXDT    V2AOD8
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load Info for TPM  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWURMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0001           Status - Y or N
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0001           Status - Y or N
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    WUAIC3           Company Number
     C                     MOVELFJPKST    WUPKST           Load Status
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0002    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSB     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,005   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WUG0TX           Allow Multi-Com
     C                     MOVELDRMPNA    WUG0TX           Default Printer
     C                     MOVELDRBCCD    WUG0TX           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0002           Company Number
     C                     MOVELDRBUVN    WN0003           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0001    DTAJVN           User Profile Na
     C                     MOVELWL0002    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSC     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0003           Company Number
     C                     MOVELDTAJCD    WL0004           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN ADBWC3    WQSD01           Shipping Compan
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0004    WQSD01           Shipping Compan
      * Establish starting position
     C           KRSSD     SETLL@ADREWA                    *
     C           KRSSD     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Warehouse Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           ADVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           ADAOCD    IFNE *BLANK                     *IF
     C                     MOVELADAOCD    WUG0TX           Warehouse Code
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Name
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WUG0TX           Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADDWUAIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQSG01           PFS Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           PFS Load ID
      * Setup key
     C                     Z-ADDWURMNB    WQSG01           PFS Load ID
      * Establish starting position
     C           KRSSG     SETLL@BKCPEK                    *
     C           KRSSG     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  30       Company Number
     C                     Z-ADD*ZERO     WN0009  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0010  1        LTL Flag
     C                     Z-ADD*ZERO     WN0011  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0012 15        Seal 1
     C                     MOVEL*BLANK    WN0013 15        Seal 2
     C                     MOVEL*BLANK    WN0014 15        Seal 3
     C                     MOVEL*BLANK    WN0015 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0016 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0017  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0018 112       Flat Amount
     C                     MOVEL*BLANK    WN0019  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0020  50       Total Stops
     C                     MOVEL*BLANK    WN0021 20        Trailer Id
     C                     MOVEL*BLANK    WN0022  3        Transloader Car
     C                     Z-ADD*ZERO     WN0023  40       BOL Time
     C                     MOVEL*BLANK    WN0024  3        Carrier Code
     C                     MOVEL*BLANK    WN0025  7        Truck Size
     C                     Z-ADD*ZERO     WN0026  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0027  1        Ship Status
     C                     MOVEL*BLANK    WN0028  1        Load Type
     C                     Z-ADD*ZERO     WN0029  50       Number Pallets
     C                     Z-ADD*ZERO     WN0030  50       Number Pallets
     C                     Z-ADD*ZERO     WN0031 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0032  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0033  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0034  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0035 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0036 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0037  70       Actual Departur
     C                     Z-ADD*ZERO     WN0038  40       Departure Time
     C                     Z-ADD*ZERO     WN0039  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0040  52       Product Tempera
     C                     Z-ADD*ZERO     WN0041  50       Number Pallets
     C                     MOVEL*BLANK    WN0042 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0043  70       Total Load Mile
     C                     MOVEL*BLANK    WN0044 12        Recorder ID
     C                     MOVEL*BLANK    WN0045  2        Shipping Method
     C                     MOVEL*BLANK    WN0046  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0047  2        Ship To State C
     C                     Z-ADD*ZERO     WN0048  70       Gross Weight
     C                     MOVEL*BLANK    WN0049  3        Carrier Broker
     C                     MOVEL*BLANK    WN0050  1        Export Status
     C                     Z-ADD*ZERO     WN0051  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0052  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0053  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0054  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0055  70       Spotted Date
     C                     Z-ADD*ZERO     WN0056  60       Spotted Time
     C                     Z-ADD*ZERO     WN0057  70       Load Finished D
     C                     Z-ADD*ZERO     WN0058  60       Load Finished T
     C                     Z-ADD*ZERO     WN0059  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0060  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0061  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0062  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0063  70       Truck Departure
     C                     Z-ADD*ZERO     WN0064  60       Truck Departure
     C                     Z-ADD*ZERO     WN0065  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0066  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0067  3        Shipping Line
     C                     MOVEL*BLANK    WN0068 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0069 30        Vessel Name
     C                     Z-ADD*ZERO     WN0070  50       Voyage
     C                     Z-ADD*ZERO     WN0071  70       Sail Date
     C                     MOVEL*BLANK    WN0072 12        Booking Number
     C                     MOVEL*BLANK    WN0073 20        Discharge Port
     C                     Z-ADD*ZERO     WN0074  70       Arrival Date
     C                     MOVEL*BLANK    WN0075 12        Container Numbe
     C                     Z-ADD*ZERO     WN0076  70       Date In
     C                     Z-ADD*ZERO     WN0077  60       Time In
     C                     Z-ADD*ZERO     WN0078  70       Date Out
     C                     Z-ADD*ZERO     WN0079  60       Time Out
     C                     Z-ADD*ZERO     WN0080 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0081  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0082  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0083  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0084  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0085  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0086  70       Requested Deliv
     C                     MOVEL*BLANK    WN0087  1        Load Acceptance
     C                     MOVEL*BLANK    WN0088  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0089  70       On Yard Date
     C                     Z-ADD*ZERO     WN0090  60       On Yard Time
     C                     Z-ADD*ZERO     WN0091  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0092  60       Deadline Depart
     C                     MOVEL*BLANK    WN0093  1        Load Held Over
     C                     MOVEL*BLANK    WN0094  1        Load Held Over
     C                     MOVEL*BLANK    WN0095 15        Load Held Over
     C                     MOVEL*BLANK    WN0096 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0097 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0098  70       Express Mail Da
     C                     MOVEL*BLANK    WN0099  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0100  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0101  70       Product Complet
     C                     Z-ADD*ZERO     WN0102  60       Product Complet
     C                     Z-ADD*ZERO     WN0103  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0104  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0105  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0106  1        Load Confirmed
     C                     MOVEL*BLANK    WN0107 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0108  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0109  60       Load Door 1
     C                     Z-ADD*ZERO     WN0110  70       Override Total
     C                     Z-ADD*ZERO     WN0111  60       Load Door 2
     C                     MOVEL*BLANK    WN0112  1        Partial Load
     C                     MOVEL*BLANK    WN0113  1        Load Confirmati
     C                     MOVEL*BLANK    WN0114  1        Export Load USD
     C                     MOVEL*BLANK    WN0115  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0116 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0117 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0118 15        Late Billing Em
     C                     MOVEL*BLANK    WN0119 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0120 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0121  1        Multi Company L
     C                     MOVEL*BLANK    WN0122  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0123  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0124  1        LH Power Only L
     C                     MOVEL*BLANK    WN0125  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0126  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0127  2        Load U/M
     C                     MOVEL*BLANK    WN0128  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0129  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0130  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0131  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0132  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0133  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0134  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0135  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0136  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0137  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0138  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0139  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0140  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0141  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0142  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0143  60       LH Unused Time
     C                     MOVEL*BLANK    WN0144  1        EDI Status 1
     C                     MOVEL*BLANK    WN0145  1        EDI Status 2
     C                     MOVEL*BLANK    WN0146  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0147  60       Job Time
     C                     MOVEL*BLANK    WN0148 10        User Id
     C                     MOVEL*BLANK    WN0149 10        Job Name
     C                     Z-ADD*ZERO     WN0150  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWURMNB    WARMNB           Load ID
      *
     C           KLCHSH    KLIST
     C                     KFLD           WARMNB           Load ID
     C           KLCHSH    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WAPKST    P      Load Status
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSI01           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
      * Setup key
     C                     Z-ADDWURMNB    WQSI01           Load ID
      * Establish starting position
     C           KRSSI     SETLL@FLCPBW                    *
     C           KRSSI     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR SJRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WN0151           Trans Contol AS
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSI     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR SKRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSK01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSK02           Order Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSK01           Company Number
     C                     Z-ADDBEC4NB    WQSK02           Order Number
      * Establish starting position
     C           KRSSK     SETLL@BGWKL1                    *
     C           KRSSK     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWBXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,006   DPDOCD           System Value Co
      * Establish starting position
     C           KRSSM     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           System Value Al
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0005           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWUAIC3    BUY1NX           PFS Company Num
     C                     MOVEL@CN,007   BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSSN     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           PFS AccuSort Ac
     C                     MOVEL*BLANK    YL0007           PFS Carlisle Ac
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    YL0006           PFS AccuSort Ac
     C                     MOVELBUWUSX    YL0007           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADDWURMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FLCPEB                    *
     C           KRSSO     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR SPCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR SQRVGN
     C           KRSSO     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0155  50       Stop/Drop
     C                     MOVEL*BLANK    WN0156 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0157  72       Freight Charge
     C                     Z-ADD*ZERO     WN0158  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0159  30       Company Number
     C                     Z-ADD*ZERO     WN0160  70       Order Number
     C                     MOVEL*BLANK    WN0161  1        Ship Status
     C                     Z-ADD*ZERO     WN0162  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0163  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0164  70       Appointment Con
     C                     Z-ADD*ZERO     WN0165  60       Appointment Con
     C                     MOVEL*BLANK    WN0166 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0167 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0168  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0169  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0170  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0171  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0172  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0173  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0174  70       On Yard Date
     C                     Z-ADD*ZERO     WN0175  60       On Yard Time
     C                     Z-ADD*ZERO     WN0176  70       MPC Number
     C                     MOVEL*BLANK    WN0177  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0178  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0179 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0180 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0181 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0182 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0183 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0184  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0185  70       LD Sls Appt Con
     C                     Z-ADD*ZERO     WN0186  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0187  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0188  60       LD Sls Appt Con
     C                     Z-ADD*ZERO     WN0189  60       LD Unused Time
     C                     MOVEL*BLANK    WN0190  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0191  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0192  2        HPB Transload S
     C                     MOVEL*BLANK    WN0193 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0194 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0195 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0196  1        EDI Status 1
     C                     MOVEL*BLANK    WN0197  1        EDI Status 2
     C                     MOVEL*BLANK    WN0198  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0199  60       Job Time
     C                     MOVEL*BLANK    WN0200 10        User Id
     C                     MOVEL*BLANK    WN0201 10        Job Name
     C                     Z-ADD*ZERO     WN0202  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWCRMNB    WDRMNB           Load ID
     C                     Z-ADDWCRUNB    WDRUNB           Stop/Drop Seque
      *
     C           KLCHSP    KLIST
     C                     KFLD           WDRMNB           Load ID
     C                     KFLD           WDRUNB           Stop/Drop Seque
     C           KLCHSP    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YBRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWCRWNB    WDRWNB           Miles to next s
     C                     Z-ADD*ZERO     WDT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WDT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSQ02           Load ID
     C           *LIKE     DEFN WEC4NB    WQSQ03           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
     C                     KFLD           WQSQ03           Order Number
      * Setup key
     C                     Z-ADDWCRMNB    WQSQ02           Load ID
     C                     Z-ADDWCC4NB    WQSQ03           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BFCPNQ                    *
     C           KRSSQ     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR SRCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR SSRVGN
     C           KRSSQ     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0203  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0204  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0205  70       Ship To Custome
     C                     MOVEL*BLANK    WN0206 30        Ship To Name
     C                     MOVEL*BLANK    WN0207 30        Ship To Address
     C                     MOVEL*BLANK    WN0208 30        Ship To Address
     C                     MOVEL*BLANK    WN0209 30        Ship To Address
     C                     MOVEL*BLANK    WN0210 20        Ship To City
     C                     MOVEL*BLANK    WN0211  2        Ship To State C
     C                     MOVEL*BLANK    WN0212 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0213  70       Bill to Custome
     C                     MOVEL*BLANK    WN0214 30        Bill to Name
     C                     MOVEL*BLANK    WN0215 30        Bill to Address
     C                     MOVEL*BLANK    WN0216 30        Bill to Address
     C                     MOVEL*BLANK    WN0217 30        Bill to Address
     C                     MOVEL*BLANK    WN0218 20        Bill to City
     C                     MOVEL*BLANK    WN0219  2        Bill to State C
     C                     MOVEL*BLANK    WN0220 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0221 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0222  70       Order Date
     C                     Z-ADD*ZERO     WN0223  70       Requested Ship
     C                     Z-ADD*ZERO     WN0224  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0225  70       Cancel Date
     C                     MOVEL*BLANK    WN0226  2        Terms Code
     C                     MOVEL*BLANK    WN0227 40        Special Instruc
     C                     MOVEL*BLANK    WN0228 40        Special Instruc
     C                     MOVEL*BLANK    WN0229  3        Carrier Code
     C                     MOVEL*BLANK    WN0230  1        Comment Print A
     C                     MOVEL*BLANK    WN0231  1        Comment Print I
     C                     MOVEL*BLANK    WN0232  1        Comment Print P
     C                     MOVEL*BLANK    WN0233  1        Comment Print S
     C                     MOVEL*BLANK    WN0234  3        Reason Code
     C                     MOVEL*BLANK    WN0235  1        Order in Use
     C                     MOVEL*BLANK    WN0236  1        Header Status
     C                     MOVEL*BLANK    WN0237  1        Header Status L
     C                     MOVEL*BLANK    WN0238  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0239  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0240 10        User Original E
     C                     Z-ADD*ZERO     WN0241  70       Date of Origina
     C                     Z-ADD*ZERO     WN0242 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0243 112       Order Weight To
     C                     MOVEL*BLANK    WN0244  1        Credit Hold
     C                     MOVEL*BLANK    WN0245  1        Production Hold
     C                     MOVEL*BLANK    WN0246  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0247  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0248  40       Requested Deliv
     C                     MOVEL*BLANK    WN0249  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0250 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0251  70       Load ID
     C                     Z-ADD*ZERO     WN0252  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0253  1        LTL Flag
     C                     MOVEL*BLANK    WN0254  1        Price Audit
     C                     MOVEL*BLANK    WN0255  1        Price Status
     C                     MOVEL*BLANK    WN0256  2        Shipping Method
     C                     MOVEL*BLANK    WN0257  1        Export Status
     C                     MOVEL*BLANK    WN0258  1        Palletize
     C                     MOVEL*BLANK    WN0259  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0260  1        Slip Sheet
     C                     MOVEL*BLANK    WN0261  1        Age Code
     C                     Z-ADD*ZERO     WN0262  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0263  1        Load Type
     C                     Z-ADD*ZERO     WN0264  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0265  1        Load Plan Order
     C                     MOVEL*BLANK    WN0266  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0267  70       Resell Referenc
     C                     MOVEL*BLANK    WN0268 30        Special Comment
     C                     MOVEL*BLANK    WN0269 30        Special Comment
     C                     MOVEL*BLANK    WN0270  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0271  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0272  2        Manager Level C
     C                     MOVEL*BLANK    WN0273  3        VP Level Code
     C                     Z-ADD*ZERO     WN0274  70       Attach to Order
     C                     MOVEL*BLANK    WN0275  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0276  70       Invoice Number
     C                     MOVEL*BLANK    WN0277  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0278  70       Invoice Date
     C                     MOVEL*BLANK    WN0279  2        Event Code
     C                     MOVEL*BLANK    WN0280  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0281  1        Modified Flag
     C                     Z-ADD*ZERO     WN0282 112       A/R order Value
     C                     MOVEL*BLANK    WN0283  1        Billing Activit
     C                     MOVEL*BLANK    WN0284  1        Block Order Fla
     C                     MOVEL*BLANK    WN0285  1        Order Certifica
     C                     Z-ADD*ZERO     WN0286 112       Invoice Order V
     C                     MOVEL*BLANK    WN0287  1        Process Sts for
     C                     MOVEL*BLANK    WN0288  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0289  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0290  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0291  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0292  1        Email Cust On O
     C                     MOVEL*BLANK    WN0293  1        Order Emailed
     C                     MOVEL*BLANK    WN0294  1        Export Docs Go
     C                     MOVEL*BLANK    WN0295  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0296  1        Broker Order St
     C                     MOVEL*BLANK    WN0297  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0298  2        Order Requires
     C                     MOVEL*BLANK    WN0299  2        TPM Freight Ord
     C                     MOVEL*BLANK    WN0300  2        Export USDA App
     C                     MOVEL*BLANK    WN0301  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0302  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0303  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0304  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0305  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0306  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0307  70       OH Unused Date
     C                     Z-ADD*ZERO     WN0308  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0309  60       Time of Origina
     C                     Z-ADD*ZERO     WN0310  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0311  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0312  60       OH Unused Time
     C                     Z-ADD*ZERO     WN0313 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0314 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0315 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0316 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0317 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0318  70       Claim Number
     C                     MOVEL*BLANK    WN0319  1        EDI Status 1
     C                     MOVEL*BLANK    WN0320  1        EDI Status 2
     C                     MOVEL*BLANK    WN0321  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0322  60       Job Time
     C                     MOVEL*BLANK    WN0323 10        User Id
     C                     MOVEL*BLANK    WN0324 10        Job Name
     C                     Z-ADD*ZERO     WN0325  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C           KLCHSR    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWFAIC3    PAAIC3           Company Number
     C                     Z-ADDWFC4NB    PAC4NB           Order Number
     C                     MOVELWFJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWFANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWFBKC7    PABKC7           Ship To Custome
     C                     MOVELWFBRTX    PABRTX    P      Ship To Name
     C                     MOVELWFHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWFHONA    PAHONA    P      Ship To Address
     C                     MOVELWFHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWFHNNA    PAHNNA    P      Ship To City
     C                     MOVELWFDBCD    PADBCD    P      Ship To State C
     C                     MOVELWFCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWFB0C7    PAB0C7           Bill to Custome
     C                     MOVELWFAETX    PAAETX    P      Bill to Name
     C                     MOVELWFB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWFB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWFB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWFB2NA    PAB2NA    P      Bill to City
     C                     MOVELWFBHCD    PABHCD    P      Bill to State C
     C                     MOVELWFC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWFBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWFA0DT    PAA0DT           Order Date
     C                     Z-ADDWFA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWFGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWFACDT    PAACDT           Cancel Date
     C                     MOVELWFAQCD    PAAQCD    P      Terms Code
     C                     MOVELWFB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWFBYNA    PABYNA    P      Special Instruc
     C                     MOVELWFBZNA    PABZNA    P      Carrier Code
     C                     MOVELWFGTST    PAGTST    P      Comment Print A
     C                     MOVELWFGVST    PAGVST    P      Comment Print I
     C                     MOVELWFGUST    PAGUST    P      Comment Print P
     C                     MOVELWFQFST    PAQFST    P      Comment Print S
     C                     MOVELWFCQCD    PACQCD    P      Reason Code
     C                     MOVELWFGJST    PAGJST    P      Order in Use
     C                     MOVELWFGWST    PAGWST    P      Header Status
     C                     MOVELWFGXST    PAGXST    P      Header Status L
     C                     MOVELWFGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWFAODT    PAAODT           Scheduled Ship
     C                     MOVELWFAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWFCXDT    PACXDT           Date of Origina
     C                     Z-ADDWFJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWFA1WG    PAA1WG           Order Weight To
     C                     MOVELWFXIST    PAXIST    P      Credit Hold
     C                     MOVELWFXJST    PAXJST    P      Production Hold
     C                     MOVELWFXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWFEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWFAFTM    PAAFTM           Requested Deliv
     C                     MOVELWFE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWFE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWFRMNB    PARMNB           Load ID
     C                     Z-ADDWFTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWFR1NB    PAR1NB           Rated Freight
     C                     MOVELWFPJST    PAPJST    P      LTL Flag
     C                     MOVELWFU0ST    PAU0ST    P      Price Audit
     C                     MOVELWFU1ST    PAU1ST    P      Price Status
     C                     MOVELWFQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWFU2ST    PAU2ST    P      Export Status
     C                     MOVELWFVEST    PAVEST    P      Palletize
     C                     MOVELWFVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWFVGST    PAVGST    P      Slip Sheet
     C                     MOVELWFRPCD    PARPCD    P      Age Code
     C                     Z-ADDWFRNNB    PARNNB           Reefer Temperat
     C                     MOVELWFVDST    PAVDST    P      Load Type
     C                     Z-ADDWFATIN    PAATIN           Attach to Invoi
     C                     MOVELWFU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWFU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWFRSRN    PARSRN           Resell Referenc
     C                     MOVELWFMHNA    PAMHNA    P      Special Comment
     C                     MOVELWFMINA    PAMINA    P      Special Comment
     C                     MOVELWFWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWFR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWFBFCD    PABFCD    P      Manager Level C
     C                     MOVELWFQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWFT3NB    PAT3NB           Attach to Order
     C                     MOVELWFSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWFCONB    PACONB           Invoice Number
     C                     MOVELWFCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWFAWDT    PAAWDT           Invoice Date
     C                     MOVELWFJPCD    PAJPCD    P      Event Code
     C                     MOVELWFXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWFZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWFVRVA    PAVRVA           A/R order Value
     C                     MOVELWFOBST    PAOBST    P      Billing Activit
     C                     MOVELWFBCST    PABCST    P      Block Order Fla
     C                     MOVELWFBDST    PABDST    P      Order Certifica
     C                     Z-ADDWFB7VL    PAB7VL           Invoice Order V
     C                     MOVELWFGASX    PAGASX    P      Process Sts for
     C                     MOVELWFGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWFGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWFGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWFFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWFFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWFFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWFFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWFFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWFFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWFFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWFFUSX    PAFUSX    P      Order Requires
     C                     MOVELWFFVSX    PAFVSX    P      TPM Freight Ord
     C                     MOVELWFFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWFFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWFFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWFNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWFNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWFNQDT    PANQDT           OH Unused Date
     C                     Z-ADDWFNRDT    PANRDT           OH Unused Date
     C                     Z-ADDWFNSDT    PANSDT           OH Unused Date
     C                     Z-ADDWFBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWFBQTM    PABQTM           Time of Origina
     C                     Z-ADDWFBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWFBSTM    PABSTM           OH Unused Time
     C                     Z-ADDWFBTTM    PABTTM           OH Unused Time
     C                     Z-ADDWFH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWFH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWFH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWFH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWFH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWFC0C7    PAC0C7           Claim Number
     C                     MOVELWFUVST    PAUVST    P      EDI Status 1
     C                     MOVELWFUWST    PAUWST    P      EDI Status 2
     C                     MOVELWFUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWFAATM    PAAATM           Job Time
     C                     MOVELWFAYNA    PAAYNA    P      User Id
     C                     MOVELWFA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWFAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0326  30       Order Sequence
     C                     Z-ADD*ZERO     WN0327  30       Order Secondary
     C                     Z-ADD*ZERO     WN0328 112       Rated Freight
     C                     Z-ADD*ZERO     WN0329 112       @Rated Freight
     C                     MOVEL*BLANK    WN0330  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN0329           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0330           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSS01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSS01           Company Number
     C                     Z-ADDWEC4NB    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@BGWKL1                    *
     C           KRSSS     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0005           Company Number
     C                     Z-ADDOMC4NB    WL0006           Order Number
     C                     Z-ADDOMDPNB    WL0007           Order Sequence
     C                     Z-ADDOMUENB    WL0008           Order Secondary
     C                     Z-ADD*ZERO     WL0009           Rated Freight
     C                     EXSR STCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0330           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WEA1WG    IFEQ *ZERO                      *IF
     C           *ZERO     OREQ *ZERO                      *OR
     C                     Z-ADD*ZERO     WN0328           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMATWG    DIV  WEA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMAVQT    MULT OMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WEA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0328    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0005           Company Number
     C                     Z-ADDOMC4NB    WL0006           Order Number
     C                     Z-ADDOMDPNB    WL0007           Order Sequence
     C                     Z-ADDOMUENB    WL0008           Order Secondary
     C                     Z-ADDWN0328    WL0009           Rated Freight
     C                     EXSR STCHRC
     C                     ADD  WN0328    WN0329           @Rated Freight
     C                     Z-ADDOMDPNB    WN0326           Order Sequence
     C                     Z-ADDOMUENB    WN0327           Order Secondary
     C                     END                             *FI
     C           KRSSS     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0329    IFNE *ZERO                      *IF
     C           WN0330    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN0329    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0328           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0005           Company Number
     C                     Z-ADDWEC4NB    WL0006           Order Number
     C                     Z-ADDWN0326    WL0007           Order Sequence
     C                     Z-ADDWN0327    WL0008           Order Secondary
     C                     Z-ADDWN0328    WL0009           Rated Freight
     C                     EXSR STCHRC
     C                     END                             *FI
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0331  70       Item Code
     C                     MOVEL*BLANK    WN0332  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0333  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0334  70       Order Group Cod
     C                     MOVEL*BLANK    WN0335  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0336  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0337 112       Billing Detail
     C                     Z-ADD*ZERO     WN0338 112       Billing Detail
     C                     Z-ADD*ZERO     WN0339 112       Billing Detail
     C                     Z-ADD*ZERO     WN0340 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0341  1        Comment Print A
     C                     MOVEL*BLANK    WN0342  1        Comment Print I
     C                     MOVEL*BLANK    WN0343  1        Comment Print P
     C                     MOVEL*BLANK    WN0344  1        Comment Print S
     C                     Z-ADD*ZERO     WN0345 112       Extended Amount
     C                     Z-ADD*ZERO     WN0346  70       Market Pricing
     C                     MOVEL*BLANK    WN0347  3        Commodity Marke
     C                     MOVEL*BLANK    WN0348  3        Date Method Cod
     C                     MOVEL*BLANK    WN0349  3        Price Method Co
     C                     Z-ADD*ZERO     WN0350 114       Price Overage O
     C                     Z-ADD*ZERO     WN0351  70       Contract Number
     C                     MOVEL*BLANK    WN0352  1        Price Status
     C                     Z-ADD*ZERO     WN0353  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0354  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0355  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0356  1        Work Confirm St
     C                     MOVEL*BLANK    WN0357  1        Work Over/Short
     C                     MOVEL*BLANK    WN0358  1        OD Production P
     C                     MOVEL*BLANK    WN0359 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0360 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0361  1        Age Code
     C                     MOVEL*BLANK    WN0362  1        Palletize
     C                     MOVEL*BLANK    WN0363  1        Slip Sheet
     C                     MOVEL*BLANK    WN0364  1        Catch Weight St
     C                     MOVEL*BLANK    WN0365  1        Price Audit
     C                     MOVEL*BLANK    WN0366  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0367  1        Production Date
     C                     Z-ADD*ZERO     WN0368 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0369 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0370 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0371 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0372 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0373 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0374 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0375 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0376 114       Unit Price
     C                     Z-ADD*ZERO     WN0377 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0378 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0379 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0380 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0381  70       Requested Ship
     C                     Z-ADD*ZERO     WN0382  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0383  70       Actual Shipped
     C                     MOVEL*BLANK    WN0384  1        Affect Inventor
     C                     MOVEL*BLANK    WN0385  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0386  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0387  30       Item Structure
     C                     Z-ADD*ZERO     WN0388  30       Item Structure
     C                     Z-ADD*ZERO     WN0389  30       Item Structure
     C                     MOVEL*BLANK    WN0390  2        Item Level
     C                     MOVEL*BLANK    WN0391  2        Quality Level
     C                     MOVEL*BLANK    WN0392  2        Pricing Product
     C                     MOVEL*BLANK    WN0393  2        Season Product
     C                     Z-ADD*ZERO     WN0394  70       Date of Origina
     C                     MOVEL*BLANK    WN0395 10        User Profile Na
     C                     MOVEL*BLANK    WN0396  6        Country Code
     C                     MOVEL*BLANK    WN0397  2        Event Code
     C                     MOVEL*BLANK    WN0398  3        Reason Code
     C                     MOVEL*BLANK    WN0399  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0400  1        Modified Flag
     C                     MOVEL*BLANK    WN0401  1        Substituted Fla
     C                     MOVEL*BLANK    WN0402  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0403 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0404 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0405  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0406  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0407  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0408  1        Affect Commissi
     C                     MOVEL*BLANK    WN0409  1        Affect Pricing
     C                     MOVEL*BLANK    WN0410  1        Released by Use
     C                     MOVEL*BLANK    WN0411  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0412  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0413  3        Production Ware
     C                     MOVEL*BLANK    WN0414  3        OD Price Type
     C                     Z-ADD*ZERO     WN0415  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0416  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0417  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0418  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0419  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0420  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0421  60       Price Code
     C                     Z-ADD*ZERO     WN0422  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0423  60       Substitution Li
     C                     Z-ADD*ZERO     WN0424  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0425 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0426 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0427 112       OD Item Target
     C                     Z-ADD*ZERO     WN0428 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0429 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0430 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0431 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0432 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0433 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0434 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0435 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0436 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0437 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0438  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0439  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0440  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0441 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0442  40       Item Age Days
     C                     Z-ADD*ZERO     WN0443  70       Production Ovr
     C                     Z-ADD*ZERO     WN0444  70       Production Ovr
     C                     MOVEL*BLANK    WN0445  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0446  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0447  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0448  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0449  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0450  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0451  1        EDI Status 1
     C                     MOVEL*BLANK    WN0452  1        EDI Status 2
     C                     MOVEL*BLANK    WN0453  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0454  60       Job Time
     C                     MOVEL*BLANK    WN0455 10        User Id
     C                     MOVEL*BLANK    WN0456 10        Job Name
     C                     Z-ADD*ZERO     WN0457  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0005    WGAIC3           Company Number
     C                     Z-ADDWL0006    WGC4NB           Order Number
     C                     Z-ADDWL0007    WGDPNB           Order Sequence
     C                     Z-ADDWL0008    WGUENB           Order Secondary
      *
     C           KLCHST    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHST    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0009    WGR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG TPM Ship Header    CO - TPM Shipment Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @AZREPT
     C                     Z-ADD#1AOD8    AZAOD8           TPM Transaction
     C                     Z-ADD#1AMTS    AZAMTS           TPM Transaction
     C                     Z-ADD#1X0NY    AZX0NY           TPM Transaction
     C                     MOVEL#1RAST    AZRAST    P      TPM Ship Access
     C                     MOVEL#1UJNA    AZUJNA    P      TPM Shipment Nu
     C                     MOVEL#1RDST    AZRDST    P      TPM Status Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           AZAOD8           TPM Transaction
     C                     KFLD           AZAMTS           TPM Transaction
     C                     KFLD           AZX0NY           TPM Transaction
     C                     KFLD           AZRAST           TPM Ship Access
     C                     KFLD           AZUJNA           TPM Shipment Nu
     C                     KFLD           AZRDST           TPM Status Code
     C           KLCHSU    CHAIN@AZREPT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBAZREL0'MDACP
     C                     MOVEL'@AZREPT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPBAZREL0               91  *
     C                     GOTO SUEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YERDCS
      * Move non-key fields to @AZREPT
     C                     Z-ADD#1Q2QT    AZQ2QT           TPM Quantity
     C                     Z-ADD#1POWG    AZPOWG           TPM Weight
     C                     Z-ADD#1VGDT    AZVGDT           TPM Actual Ship
     C                     Z-ADD#1P1DT    AZP1DT           TPM Planned Shi
     C                     Z-ADD#1YWNY    AZYWNY           TPM Total Load
     C                     Z-ADD#1XJNY    AZXJNY           TPM Cube
     C                     MOVEL#1RIST    AZRIST    P      TPM Cube UOM
     C                     MOVEL#1U1AF    AZU1AF    P      TPM Weight UOM
     C                     MOVEL#1U1AD    AZU1AD    P      TPM Quantity UO
     C                     MOVEL#1R2ST    AZR2ST    P      TPM Length UOM
     C                     MOVEL#1U1AE    AZU1AE    P      TPM Distance UO
     C                     MOVEL#1RMAA    AZRMAA    P      TPM Condition C
     C                     Z-ADD#1XKNY    AZXKNY           TPM Condition Q
     C                     MOVEL#1RNAA    AZRNAA    P      TPM Condition C
     C                     Z-ADD#1XLNY    AZXLNY           TPM Condition Q
     C                     MOVEL#1ROAA    AZROAA    P      TPM Condition C
     C                     Z-ADD#1XMNY    AZXMNY           TPM Condition Q
     C                     MOVEL#1RPAA    AZRPAA    P      TPM Condition C
     C                     Z-ADD#1XNNY    AZXNNY           TPM Condition Q
     C                     MOVEL#1RTAA    AZRTAA    P      TPM Condition C
     C                     Z-ADD#1XUNY    AZXUNY           TPM Condition Q
     C                     MOVEL#1RQAA    AZRQAA    P      TPM Route Code
     C                     MOVEL#1AAU1    AZAAU1    P      TPM Service
     C                     MOVEL#1RRAA    AZRRAA    P      TPM Equipment C
     C                     MOVEL#1RSAA    AZRSAA    P      TPM Carrier SCA
     C                     Z-ADD#1XONY    AZXONY           TPM Number of C
     C                     Z-ADD#1XPNY    AZXPNY           TPM Equipment M
     C                     Z-ADD#1XQNY    AZXQNY           TPM Equipment M
     C                     Z-ADD#1XRNY    AZXRNY           TPM Equipment M
     C                     MOVEL#1SCST    AZSCST    P      TPM Equipment M
     C                     MOVEL#1SDST    AZSDST    P      TPM Equipment M
     C                     MOVEL#1U1AC    AZU1AC    P      TPM Equipment M
     C                     MOVEL#1UKNA    AZUKNA    P      TPM BOL Number
     C                     Z-ADD#1XSNY    AZXSNY           TPM Carrier Fre
     C                     Z-ADD#1XTNY    AZXTNY           TPM Length
     C                     Z-ADD#1XVNY    AZXVNY           TPM Number of P
     C                     Z-ADD#1X1NY    AZX1NY           TPM Shipment Pr
     C                     MOVEL#1U1AG    AZU1AG    P      TPM Shipment Er
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@AZREPT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBAZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSV01           Application Cod
     C                     MOVEL'OMS'     WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL@CN,005   W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         XDC84     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDI8DT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDC84E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX01    XDI8DD           DD
     C                     Z-ADDXDEX02    XDI8MM           MM
     C           XDEY02    DIV  1000      XDI8CC           Y
     C                     Z-ADDXDEY02    XDI8YY            YYY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX01    XDI8MM           MM
     C                     Z-ADDXDEX02    XDI8DD           DD
     C           XDEY02    DIV  1000      XDI8CC           Y
     C                     Z-ADDXDEY02    XDI8YY            YYY
     C                     ELSE
     C           XDEY01    DIV  1000      XDI8CC           Y
     C                     Z-ADDXDEY01    XDI8YY            YYY
     C                     Z-ADDXDEX03    XDI8MM           MM
     C                     Z-ADDXDEX04    XDI8DD           DD
     C                     END
     C                     END
     C           YPMTFD    CABNE*BLANK    XDC84E
     C           XDDTFM    IFEQ 'YMD'
      *................................................................
     C           XDEY01    IFGE 2200
     C           XDI8DT    ORNE *ZERO
     C           XDEY01    ANDLT1801
     C                     GOTO XDC84M
     C                     END
     C                     ELSE
      *................................................................
     C           XDEY02    IFGE 2200
     C           XDI8DT    ORNE *ZERO
     C           XDEY02    ANDLT1801
     C                     GOTO XDC84M
     C                     END
     C                     END
      *................................................................
      * Check months in range 1 to 12
     C           XDI8MM    CABLT1         XDC84M
     C           XDI8MM    CABGT12        XDC84M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDI8DD    CABLT1         XDC84M
     C           XDI8DD    CABGT@XD,XDI8MMXDC84M
      *................................................................
      * Special case: leap year
     C           XDI8MM    IFEQ 2
     C           XDI8YY    IFNE 900
     C           XDI8YY    ANDNE100
     C           XDI8YY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDI8DD    CABGT28        XDC84M
     C                     END
     C                     END
     C                     GOTO XDC84E
      *................................................................
      * Send error message
     C           XDC84M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDC84E    ENDSR
      /EJECT
     CSR         XDV84T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDI8DD    XDEX01           DD
     C                     Z-ADDXDI8MM    XDEX02           MM
     C           1000      MULT XDI8CC    XDEY02           Y
     C                     ADD  XDI8YY    XDEY02            YYY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDI8MM    XDEX01           MM
     C                     Z-ADDXDI8DD    XDEX02           DD
     C           1000      MULT XDI8CC    XDEY02           Y
     C                     ADD  XDI8YY    XDEY02            YYY
     C                     ELSE
      * YMD format
     C           1000      MULT XDI8CC    XDEY01           Y
     C                     ADD  XDI8YY    XDEY01            YYY
     C                     Z-ADDXDI8MM    XDEX03           MM
     C                     Z-ADDXDI8DD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDV84E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 011
     C           ZHCSCL    ANDGE073
     C           ZHCSCL    ANDLE078
     C                     MOVEL'#1U1AG'  YPMTFD           TPM Shipment Er
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              92    *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Number 1.0 USR
     C                     Z-ADD*ZERO     WUOLNY  10
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Define work field Text USR 20
     C                     MOVEL*BLANK    WUSLTX 20
      * Define work field USR Work Field 7A
     C                     MOVEL*BLANK    WUE2TX  7
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Pallets
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Sls Appt Con
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Sls Appt Con
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WGGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine STCHRC.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009 112
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0003  52
      * Define null work field Seal 1
     C                     MOVEL*BLANK    YN0004 15
      * Define null work field Seal 2
     C                     MOVEL*BLANK    YN0005 15
      * Define null work field Seal 3
     C                     MOVEL*BLANK    YN0006 15
      * Define null work field Seal 1 Unused
     C                     MOVEL*BLANK    YN0007 15
      * Define null work field Seal 2 Unused
     C                     MOVEL*BLANK    YN0008 15
      * Define null work field Total Load Order Weight
     C                     Z-ADD*ZERO     YN0009  70
      * Define null work field Flat Amount
     C                     Z-ADD*ZERO     YN0010 112
      * Define null work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Total Stops
     C                     Z-ADD*ZERO     YN0012  50
      * Define null work field Trailer Id
     C                     MOVEL*BLANK    YN0013 20
      * Define null work field Transloader Carrier Code
     C                     MOVEL*BLANK    YN0014  3
      * Define null work field BOL Time
     C                     Z-ADD*ZERO     YN0015  40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field Truck Size
     C                     MOVEL*BLANK    YN0017  7
      * Define null work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0019 112
      * Define null work field Ship Status
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field Number Pallets Received
     C                     Z-ADD*ZERO     YN0022  50
      * Define null work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YN0023  50
      * Define null work field Load Carrier Pay Amt
     C                     Z-ADD*ZERO     YN0024 112
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0025  60
      * Define null work field Actual Arrival Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Actual Arrival Time
     C                     Z-ADD*ZERO     YN0027  40
      * Define null work field Trailer IN Weight
     C                     Z-ADD*ZERO     YN0028 112
      * Define null work field Trailer OUT Weight
     C                     Z-ADD*ZERO     YN0029 112
      * Define null work field Actual Departure Date
     C                     Z-ADD*ZERO     YN0030  70
      * Define null work field Departure Time
     C                     Z-ADD*ZERO     YN0031  40
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0032  50
      * Define null work field Product Temperature
     C                     Z-ADD*ZERO     YN0033  52
      * Define null work field Number Pallets Unserviced
     C                     Z-ADD*ZERO     YN0034  50
      * Define null work field Car/Veh. Initials
     C                     MOVEL*BLANK    YN0035 12
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0036  70
      * Define null work field Recorder ID
     C                     MOVEL*BLANK    YN0037 12
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0038  2
      * Define null work field Ship From Warehouse
     C                     MOVEL*BLANK    YN0039  3
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0040  2
      * Define null work field Gross Weight
     C                     Z-ADD*ZERO     YN0041  70
      * Define null work field Carrier Broker
     C                     MOVEL*BLANK    YN0042  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Actual Ship Date
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field On Time - (Y/N)
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Truck Ready Date
     C                     Z-ADD*ZERO     YN0046  70
      * Define null work field Truck Ready Time
     C                     Z-ADD*ZERO     YN0047  60
      * Define null work field Spotted Date
     C                     Z-ADD*ZERO     YN0048  70
      * Define null work field Spotted Time
     C                     Z-ADD*ZERO     YN0049  60
      * Define null work field Load Finished Date
     C                     Z-ADD*ZERO     YN0050  70
      * Define null work field Load Finished Time
     C                     Z-ADD*ZERO     YN0051  60
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0052  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0053  60
      * Define null work field BOL Received Date
     C                     Z-ADD*ZERO     YN0054  70
      * Define null work field BOL Received Time
     C                     Z-ADD*ZERO     YN0055  60
      * Define null work field Truck Departure Date
     C                     Z-ADD*ZERO     YN0056  70
      * Define null work field Truck Departure Time
     C                     Z-ADD*ZERO     YN0057  60
      * Define null work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YN0059  60
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0060  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0061 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0062 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0063  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0064  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0065 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0066 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0067  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0068 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0069  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0070  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0071  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0072  60
      * Define null work field Load Total Freight
     C                     Z-ADD*ZERO     YN0073 112
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0074  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0075  60
      * Define null work field LH Unused Sts
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field Bring Back Miles
     C                     Z-ADD*ZERO     YN0078  70
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Load Acceptance Flag
     C                     MOVEL*BLANK    YN0080  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0081  3
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0082  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0083  60
      * Define null work field Deadline Departure Date
     C                     Z-ADD*ZERO     YN0084  70
      * Define null work field Deadline Departure Time
     C                     Z-ADD*ZERO     YN0085  60
      * Define null work field Load Held Over
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Load Held Over Reason
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Load Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0088 15
      * Define null work field Ocean BOL Number
     C                     MOVEL*BLANK    YN0089 25
      * Define null work field Express Mail Number
     C                     MOVEL*BLANK    YN0090 20
      * Define null work field Express Mail Date
     C                     Z-ADD*ZERO     YN0091  70
      * Define null work field Load Shag Flag
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Load Wash Flag
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field Product Complete Date
     C                     Z-ADD*ZERO     YN0094  70
      * Define null work field Product Complete Time
     C                     Z-ADD*ZERO     YN0095  60
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0096  50
      * Define null work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0097  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0098  92
      * Define null work field Load Confirmed Sts
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field Load Confirmed Contact
     C                     MOVEL*BLANK    YN0100 25
      * Define null work field Load Confirmation Time
     C                     Z-ADD*ZERO     YN0101  70
      * Define null work field Load Door 1
     C                     Z-ADD*ZERO     YN0102  60
      * Define null work field Override Total Load Miles
     C                     Z-ADD*ZERO     YN0103  70
      * Define null work field Load Door 2
     C                     Z-ADD*ZERO     YN0104  60
      * Define null work field Partial Load
     C                     MOVEL*BLANK    YN0105  1
      * Define null work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YN0106  1
      * Define null work field Export Load USDA-OK
     C                     MOVEL*BLANK    YN0107  1
      * Define null work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YN0108  1
      * Define null work field Load Actual Freight
     C                     Z-ADD*ZERO     YN0109 112
      * Define null work field Hide on WW Load Sts
     C                     MOVEL*BLANK    YN0110 15
      * Define null work field Late Billing Email Flag
     C                     MOVEL*BLANK    YN0111 15
      * Define null work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    YN0112 25
      * Define null work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0113 25
      * Define null work field Multi Company Load
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    YN0115  1
      * Define null work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field LH Power Only Load
     C                     MOVEL*BLANK    YN0117  1
      * Define null work field LH Unused Sts 4
     C                     MOVEL*BLANK    YN0118  1
      * Define null work field LH Unused Sts 5
     C                     MOVEL*BLANK    YN0119  1
      * Define null work field Load U/M
     C                     MOVEL*BLANK    YN0120  2
      * Define null work field TPM Shipment Status
     C                     MOVEL*BLANK    YN0121  2
      * Define null work field LH Unused Sts 8
     C                     MOVEL*BLANK    YN0122  2
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0123  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0124  3
      * Define null work field LH Carrier Paid Dte
     C                     Z-ADD*ZERO     YN0125  70
      * Define null work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YN0126  60
      * Define null work field LH Last Combo Prod Date
     C                     Z-ADD*ZERO     YN0127  70
      * Define null work field LH Last Combo Prod Time
     C                     Z-ADD*ZERO     YN0128  60
      * Define null work field LPT Load Plan Start Dt
     C                     Z-ADD*ZERO     YN0129  70
      * Define null work field LPT Load Plan Start Tm
     C                     Z-ADD*ZERO     YN0130  60
      * Define null work field LH Unused Time 4
     C                     Z-ADD*ZERO     YN0131  60
      * Define null work field LH Unused Date 5
     C                     Z-ADD*ZERO     YN0132  70
      * Define null work field LH Unused Time 5
     C                     Z-ADD*ZERO     YN0133  60
      * Define null work field LH Unused Date 6
     C                     Z-ADD*ZERO     YN0134  70
      * Define null work field LH Unused Time 6
     C                     Z-ADD*ZERO     YN0135  60
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0136  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0137  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0138  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0007  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD11        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SVRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL*BLANK    WUR4ST           USR Update Flag
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 Errors Only
00002 Not Processed
00003 Processed
00004 LOCKLD
00005 Y2U0005
00006 PLTFLRSYS
00007 LDORDD
00008 UNLOCK
