     h option(*SRCSTMT:*NODEBUGIO)
      ************************************************************************
      * ENVIRONMENT: Pork Division
      * SYSTEM:      OMS---DEMAND PLANNING
      * PROGRAM:     PBOZUPR  GET PERIOD DATES PER 4-4-5 CALENDAR
      * PROGRAMMER:  R CENTONZE
      * CREATED:     08/21/14
      *
      * FUNCTION: This program will return either the current period
      *           begin/end dates or the previous period begin/end dates
      *           depending on the parm passed in
      ************************************************************************
     FCALCALE   IF   e           k disk
     FCALCALF   IF   e           k disk    rename(carec:calf)
     D wkcymdiso       s               D   datfmt(*iso)
     D xxsynondt       s              7  0
     C     *ENTRY        PLIST
     C                   PARM                    RTNCDE            7
     C                   PARM                    PERIOD            1
     C                   PARM                    curdat            7 0
     C                   PARM                    begin             7 0
     C                   PARM                    enddt             7 0
     C                   PARM                    hpsweek           2 0
     C*
     C     CALKEY        klist
     C                   KFLD                    PERDYR
     C                   KFLD                    PERDMO
     C*
      *
      * Put system date into Synon format of CYYMMDD.
      *
     C*    *mdy          movel     udate         wkcymdiso
     C*    *cymd         movel     wkcymdiso     xxsynondt
     c*                  z-add     xxsynondt     catdtsy
     c                   z-add     curdat        catdtsy
     C
     C     catdtsy       CHAIN     CAREC                              90
     C                   if        *in90 = *off                                 If cal hit
      *
      * Output HPS Week for the date sent in
     C                   Z-ADD     CAHPSWK       hpsweek
      *
      * GET PREVIOUS PERIOD
      *
     C     PERIOD        IFEQ      'P'
     C     CAAPER        SUB       1             PERDMO
     C                   Z-ADD     CAACYR        PERDYR
     C     perdmo        IFEQ      0
     C                   Z-ADD     12            PERDMO
     C     PERDYR        SUB       1             PERDYR
     C                   end
     C*
     C                   else
     C* DEFAULT GET CURRENT  WHEN PARM = 'C'  AND NOT 'P'
     C                   z-add     caaper        PERDMO            2 0
     C                   z-add     CAACYR        PERDYR            4 0
      *
     C                   end
     C                   end
     C*
     C* GET START AND END DATES
     C*
      *
     C     PERDMO        IFNE      0
     C     PERDYR        ANDNE     0
     C     CALKEY        SETLL     CALF
     C     *IN91         DOWEQ     '0'
     C     CALKEY        READE     CALF                                   91
     C     *IN91         IFEQ      '0'
     C     begin         IFEQ      0
     C                   Z-ADD     catdtsy       begin
     C                   END
     C* Last date read will be last date of the period
     C                   Z-ADD     catdtsy       enddt
     C                   END
     C                   ENDDO
     C                   ENDIF
     C*
     C                   SETON                                        LR
