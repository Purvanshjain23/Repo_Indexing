/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  PRINT BRANDED ITEMS                                 */
/*                                                                  */
/*  SYSTEM    - CROSS APPLICATION SYSTEM                            */
/*  DATE      - 07/12/01                                            */
/*                                                                  */
/*      PARAMETERS:                                                 */
/*                                                                  */
/*     O    &RETURN     - RETURN CODE                               */
/*     I    &APPLIC     - APPLICATION CODE                          */
/*     B    &COMPN      - COMPANY NUMBER (PASSED)                   */
/*     B    &COPYN      -  NO. OF COPIES (PASSED)                   */
/*     B    &HOLD       -  HOLD STATUS                              */
/*     B    &SAVE       -  SAVE STATUS                              */
/*     B    &NQSTAT     -  INDICATOR WHETHER MUST RUN IN NIGHT Q    */
/*     B    &NIGHTQ     -  NIGHT JOB QUEUE                          */
/*                                                                  */
/********************************************************************/

 POL3UPC:    PGM     PARM(&RETURN &OUTQ  &HOLD  &SAVE &COMPL &COPIESL +
                          &CATNML &MTO &MTOTYP &RCDSTS)
/* PARMS                                                                      */
        DCL    &RETURN     *CHAR   (7)           /* Return Code               */
        DCL    &COMPN      *DEC   (3 0)          /* Company Number (PASSED)   */
        DCL    &COMPL      *DEC                  /* Company Number (PASSED)   */
        DCL    &COPIES    *DEC    (2 0)           /*  # OF COPIES   */
        DCL    &COPIESL   *DEC                    /*  FOR PASSING   */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */

             DCL        VAR(&CATNML) TYPE(*CHAR) LEN(2) /* CATEGORY +
                          NMB   (PASSED)   */
             DCL        VAR(&MTO) TYPE(*CHAR) LEN(3) /* CATEGORY +
                          CODE  (PASSED)   */
             DCL        VAR(&MTOTYP) TYPE(*CHAR) LEN(3) /* CATEGORY +
                          TYPE  (PASSED)   */
             DCL        VAR(&RCDSTS) TYPE(*CHAR) LEN(1) /* RECORD +
                          STATUS  (PASSED)   */
             DCL        VAR(&CATNUM) TYPE(*DEC) LEN(2 0) /* CATEGORY +
                          NBR   (PASSED)   */
        DCL    &COMMAND    *CHAR   (512)

/* ERROR MESSAGE FIELDS                                                       */
        DCL    &MSG        *CHAR   (512)         /* message                   */
        DCL    &MSGID      *CHAR   (7)           /* message id                */
        DCL    &MSGL       *DEC    (5 0)

/********************************************************************/
/*   INITIALIZE VARIABLES                                           */
/********************************************************************/

             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR    VAR(&COPIES) VALUE(&COPIESL) /* change to +
                          length for print program */
             CHGVAR    VAR(&COMPN) VALUE(&COMPL) /* Change to length +
                          for print program */
             CHGVAR     VAR(&CATNUM) VALUE(&CATNML) /* Change to +
                          length for print program */
/********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/********************************************************************/

             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/*   CALL PRINT CL PROGRAM                                        */
/********************************************************************/

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(POL1PFR$) OUTQ(&OUTQ) +
                          COPIES(&COPIES) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

             CALL       PGM(POL1PFR) PARM(&RETURN &COMPN &CATNUM +
                          &MTO &RCDSTS &MTOTYP)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM

