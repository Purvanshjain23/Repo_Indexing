     H/TITLE Exc Crt Load Frt Chg  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/25/18  Time  : 09:46:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBCVCPL1IF  E           K        DISK
      * RTV : TMS Load Invoice Charge   Retrieval index
      *
     FPBCYCPL1IF  E           K        DISK
      * RTV : TMS Load Freight Charge   Retrieval index
      *
     FPBCYCPL0UF  E           K        DISK                      A
      * UPD : TMS Load Freight Charge   Update index
      *
     FPBCVCPL0UF  E           K        DISK
      * UPD : TMS Load Invoice Charge   Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@CVCPX3
      * TMS Load Invoice Charge   Retrieval index
      * Renamed input format fields
     I              CVTMLD                          WATMLD
     I              CVAYD8                          WAAYD8
     I              CVAFTH                          WAAFTH
     I              CVFSU1                          WAFSU1
     I              CVTMSQ                          WATMSQ
     I              CVA5D8                          WAA5D8
     I              CVALTH                          WAALTH
     I              CVU5AA                          WAU5AA
     I              CVU6AA                          WAU6AA
     I              CVU7AA                          WAU7AA
     I              CVM0VL                          WAM0VL
     I              CVM1VL                          WAM1VL
     I              CVDRSC                          WADRSC
     I              CVHENB                          WAHENB
     I              CVDLSC                          WADLSC
     I              CVTPRC                          WATPRC
     I              CVUYAA                          WAUYAA
     I              CVA0D8                          WAA0D8
     I              CVD9TM                          WAD9TM
      *
     I@CYCPYC
      * TMS Load Freight Charge   Retrieval index
      * Renamed input format fields
     I              CYTMLD                          WBTMLD
     I              CYHHNB                          WBHHNB
     I              CYA5D8                          WBA5D8
     I              CYALTH                          WBALTH
     I              CYU5AA                          WBU5AA
     I              CYU6AA                          WBU6AA
     I              CYU7AA                          WBU7AA
     I              CYM0VL                          WBM0VL
     I              CYM1VL                          WBM1VL
     I              CYDRSC                          WBDRSC
     I              CYHENB                          WBHENB
     I              CYU8AA                          WBU8AA
     I              CYURAA                          WBURAA
     I              CYCFAA                          WBCFAA
     I              CYDLSC                          WBDLSC
     I              CYTPRC                          WBTPRC
     I              CYUYAA                          WBUYAA
     I              CYA0D8                          WBA0D8
     I              CYD9TM                          WBD9TM
      *
     I@CYCPYB
      * TMS Load Freight Charge   Update index
      * Renamed input format fields
     I              CYTMLD                          WCTMLD
     I              CYHHNB                          WCHHNB
     I              CYA5D8                          WCA5D8
     I              CYALTH                          WCALTH
     I              CYU5AA                          WCU5AA
     I              CYU6AA                          WCU6AA
     I              CYU7AA                          WCU7AA
     I              CYM0VL                          WCM0VL
     I              CYM1VL                          WCM1VL
     I              CYDRSC                          WCDRSC
     I              CYHENB                          WCHENB
     I              CYU8AA                          WCU8AA
     I              CYURAA                          WCURAA
     I              CYCFAA                          WCCFAA
     I              CYDLSC                          WCDLSC
     I              CYTPRC                          WCTPRC
     I              CYUYAA                          WCUYAA
     I              CYA0D8                          WCA0D8
     I              CYD9TM                          WCD9TM
      *
     I@CVCPX2
      * TMS Load Invoice Charge   Update index
      * Renamed input format fields
     I              CVTMLD                          WDTMLD
     I              CVAYD8                          WDAYD8
     I              CVAFTH                          WDAFTH
     I              CVFSU1                          WDFSU1
     I              CVTMSQ                          WDTMSQ
     I              CVA5D8                          WDA5D8
     I              CVALTH                          WDALTH
     I              CVU5AA                          WDU5AA
     I              CVU6AA                          WDU6AA
     I              CVU7AA                          WDU7AA
     I              CVM0VL                          WDM0VL
     I              CVM1VL                          WDM1VL
     I              CVDRSC                          WDDRSC
     I              CVHENB                          WDHENB
     I              CVDLSC                          WDDLSC
     I              CVTPRC                          WDTPRC
     I              CVUYAA                          WDUYAA
     I              CVA0D8                          WDA0D8
     I              CVD9TM                          WDD9TM
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBCY1    E DSPBCYCPL0
      * UPD : TMS Load Freight Charge   Update index
      * Renamed input format fields
     I              CYTMLD                          WCTMLD
     I              CYHHNB                          WCHHNB
     I              CYA5D8                          WCA5D8
     I              CYALTH                          WCALTH
     I              CYU5AA                          WCU5AA
     I              CYU6AA                          WCU6AA
     I              CYU7AA                          WCU7AA
     I              CYM0VL                          WCM0VL
     I              CYM1VL                          WCM1VL
     I              CYDRSC                          WCDRSC
     I              CYHENB                          WCHENB
     I              CYU8AA                          WCU8AA
     I              CYURAA                          WCURAA
     I              CYCFAA                          WCCFAA
     I              CYDLSC                          WCDLSC
     I              CYTPRC                          WCTPRC
     I              CYUYAA                          WCUYAA
     I              CYA0D8                          WCA0D8
     I              CYD9TM                          WCD9TM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPBCV1    E DSPBCVCPL0
      * UPD : TMS Load Invoice Charge   Update index
      * Renamed input format fields
     I              CVTMLD                          WDTMLD
     I              CVAYD8                          WDAYD8
     I              CVAFTH                          WDAFTH
     I              CVFSU1                          WDFSU1
     I              CVTMSQ                          WDTMSQ
     I              CVA5D8                          WDA5D8
     I              CVALTH                          WDALTH
     I              CVU5AA                          WDU5AA
     I              CVU6AA                          WDU6AA
     I              CVU7AA                          WDU7AA
     I              CVM0VL                          WDM0VL
     I              CVM1VL                          WDM1VL
     I              CVDRSC                          WDDRSC
     I              CVHENB                          WDHENB
     I              CVDLSC                          WDDLSC
     I              CVTPRC                          WDTPRC
     I              CVUYAA                          WDUYAA
     I              CVA0D8                          WDA0D8
     I              CVD9TM                          WDD9TM
      *
     IYARDCS      DS                            179
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: TMS Load Invoice Charge
      * I :  TMS Load ID
     I                                    P   1   40P1TMLD
      * I :  TMS Extract Date
     I                                        5  120P1AYD8
      * I :  TMS Extract Time
     I                                    P  13  150P1AFTH
      * I :  TMS Extract File Name
     I                                       16  40 P1FSU1
     IP2PARM      DS
      * I :  Load ID
     I                                    P   1   40P2RMNB
     IP3PARM      DS
      * I :  Carrier Code
     I                                        1   3 P3BZNA
     IP4PARM      DS
      * I :  Rated Freight
     I                                    P   1   62P4R1NB
     IP5PARM      DS
      * I :  Add/Change/Delete USR
     I                                        1   1 P5DQSC
     IP6PARM      DS
      * I :  TMS Carrier SCAC
     I                                        1  10 P6URAA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1TMLD    PARM           WP0001  70       TMS Load ID
     C           P1AYD8    PARM           WP0002  80       TMS Extract Dat
     C           P1AFTH    PARM           WP0003  40       TMS Extract Tim
     C           P1FSU1    PARM           WP0004 25        TMS Extract Fil
     C           P2RMNB    PARM           WP0005  70       Load ID
     C           P3BZNA    PARM           WP0006  3        Carrier Code
     C           P4R1NB    PARM           WP0007 112       Rated Freight
     C           P5DQSC    PARM           WP0008  1        Add/Change/Dele
     C           P6URAA    PARM           WP0009 10        TMS Carrier SCA
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt Load Frt Chg  XF
      * S13418 DN 07/23/18-Will no longer process 'TONU'.
      * CASE: *OTHERWISE
      * If records came up in this extract, del the charges there,then re
      * Rtv Val Load Inv Chg  RT - TMS Load Invoice Charge  * 
     C                     EXSR SARVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Rtv Del Load Frt Chrg  RT - TMS Load Freight Charge  * 
     C                     EXSR SBRVGN
      * Rtv Crt Load Frt Chrg RT - TMS Load Invoice Charge  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * **** CREATE LOAD FREIGHT CHARGES FOR CURRENT LOAD BEING PROCESSED
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0006    PARM *ZERO     WQ0003  70       Date
     C                     PARM P1AYD8    WQ0004  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Exc Crt Load FC       XF - TMS Load Freight Charge  * 
     C                     CALL 'PBY2XFR'              90  Exc Crt Load FC
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1TMLD    WQ0005  70       TMS Load ID
     C                     PARM YL0006    WQ0006  70       Date
     C                     PARM P1AFTH    WQ0007  40       TMS Extract Tim
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBY2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Val Load Inv Chg  RT - TMS Load Invoice Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WATMLD    WQSA01           TMS Load ID
     C           *LIKE     DEFN WAAYD8    WQSA02           TMS Extract Dat
     C           *LIKE     DEFN WAAFTH    WQSA03           TMS Extract Tim
     C           *LIKE     DEFN WAFSU1    WQSA04           TMS Extract Fil
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           TMS Load ID
     C                     KFLD           WQSA02           TMS Extract Dat
     C                     KFLD           WQSA03           TMS Extract Tim
     C                     KFLD           WQSA04           TMS Extract Fil
      * Setup key
     C                     Z-ADDP1TMLD    WQSA01           TMS Load ID
     C                     Z-ADDP1AYD8    WQSA02           TMS Extract Dat
     C                     Z-ADDP1AFTH    WQSA03           TMS Extract Tim
     C                     MOVELP1FSU1    WQSA04           TMS Extract Fil
      * Establish starting position
     C           KRSSA     SETLL@CVCPX3                    *
     C           KRSSA     READE@CVCPX3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4939' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@CVCPX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Del Load Frt Chrg  RT - TMS Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSB01           TMS Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           TMS Load ID
      * Setup key
     C                     Z-ADDP1TMLD    WQSB01           TMS Load ID
      * Establish starting position
     C           KRSSB     SETLL@CYCPYC                    *
     C           KRSSB     READE@CYCPYC                  90*
      * Data record not found
     C   90                MOVEL'USR4945' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S13418 DN 07/23/18-Removed 'TMS EDI Code is Truck Order Not Used'
      * Del TMS Load Frt Chrg  DL - TMS Load Freight Charge  * 
     C                     EXSR SCDLRC
     C           KRSSB     READE@CYCPYC                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Del TMS Load Frt Chrg  DL - TMS Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CYCPYB
     C                     Z-ADDWBTMLD    WCTMLD           TMS Load ID
     C                     Z-ADDWBHHNB    WCHHNB           TMS Freight Cha
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCTMLD           TMS Load ID
     C                     KFLD           WCHHNB           TMS Freight Cha
     C           KLDLSC    CHAIN@CYCPYB              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCYCPL0'MDACP
     C                     MOVEL'@CYCPYB' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CYCPYB                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Crt Load Frt Chrg RT - TMS Load Invoice Charge  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        Text 3 Length U
     C                     MOVEL*BLANK    WN0002  3        USR Uom
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CVT *YYMD to *CYMD    XF - Calendar  * 
     C                     CALL 'PDGYXFR'              90  CVT *YYMD to *C
     C                     PARM *BLANK    W0RTN   7
     C           YL0001    PARM *ZERO     WQ0001  70       Date
     C                     PARM P1AYD8    WQ0002  80       DATE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0001    YL0002           LFC TFP Carrier
     C                     Z-ADD0         YL0003           Rated Freight
      * Declare restrictor key work fields
     C           *LIKE     DEFN WATMLD    WQSD01           TMS Load ID
     C           *LIKE     DEFN WAAYD8    WQSD02           TMS Extract Dat
     C           *LIKE     DEFN WAAFTH    WQSD03           TMS Extract Tim
     C           *LIKE     DEFN WAFSU1    WQSD04           TMS Extract Fil
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           TMS Load ID
     C                     KFLD           WQSD02           TMS Extract Dat
     C                     KFLD           WQSD03           TMS Extract Tim
     C                     KFLD           WQSD04           TMS Extract Fil
     C                     KFLD           WATMSQ           TMS Invoice Seq
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           TMS Load ID
     C                     KFLD           WQSD02           TMS Extract Dat
     C                     KFLD           WQSD03           TMS Extract Tim
     C                     KFLD           WQSD04           TMS Extract Fil
      * Setup key
     C                     Z-ADDP1TMLD    WQSD01           TMS Load ID
     C                     Z-ADDP1AYD8    WQSD02           TMS Extract Dat
     C                     Z-ADDP1AFTH    WQSD03           TMS Extract Tim
     C                     MOVELP1FSU1    WQSD04           TMS Extract Fil
     C                     Z-ADD1         WATMSQ           TMS Invoice Seq
      * Establish starting position
     C           KPSSD     SETLL@CVCPX3                    *
     C           KRSSD     READE@CVCPX3                  90*
      * Data record not found
     C   90                MOVEL'USR4939' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * EDI Code= ' '=Line haul=Rated Freight in OMS: update LH, dont crt
      * R12849 DN 03/27/18-Rated Freight Calcs after R12849 Change.
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : DB1.TMS Charge Type is ITEM
      *   |- c2    : DB1.TMS Charge Type is Contract Minimum Reached
      *   |- c3    : DB1.TMS Charge Type is DEFICIT
      *   |- c4    : DB1.TMS Charge Type is DISCOUNT
      *   '-
     C           WAU5AA    IFEQ 'ITEM'                     *IF
     C           WAU5AA    OREQ @CN,001                    *OR
     C           WAU5AA    OREQ @CN,002                    *OR
     C           WAU5AA    OREQ @CN,003                    *OR
     C                     ADD  WAM0VL    YL0003           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Last Seq for LFC   RT - TMS Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0001           TMS Load ID
     C                     Z-ADDYL0004    WL0002           TMS Freight Cha
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0004           TMS Freight Cha
     C                     ADD  1         YL0004           TMS Freight Cha
      * Crt TMS Load Frt Chrg  CR - TMS Load Freight Charge  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWATMLD    WL0003           TMS Load ID
     C                     Z-ADDYL0004    WL0004           TMS Freight Cha
     C                     Z-ADDWAA5D8    WL0005           TMS Invoice Dat
     C                     Z-ADDWAALTH    WL0006           TMS Invoice Tim
     C                     MOVELWAU5AA    WL0007    P      TMS Charge Type
     C                     MOVELWAU6AA    WL0008    P      TMS Charge Desc
     C                     MOVELWAU7AA    WL0009    P      TMS EDI Code
     C                     Z-ADDWAM0VL    WL0010           TMS Charge Amou
     C                     Z-ADDWAM1VL    WL0011           TMS Charge Rate
     C                     MOVELWADRSC    WL0012    P      TMS Rate Qualif
     C                     Z-ADDWAHENB    WL0013           TMS Charge Quan
     C                     MOVELYL0005    WL0014    P      TMS OMS Frt Cha
     C                     MOVELP6URAA    WL0015    P      TMS Carrier SCA
     C                     MOVELP3BZNA    WL0016    P      LFC Carrier Cod
     C                     MOVELWADLSC    WL0017    P      TMS Record Stat
     C                     Z-ADDWATPRC    WL0018           TMS Process Sta
     C                     MOVELWAUYAA    WL0019    P      TMS Error Reaso
     C                     Z-ADDWAA0D8    WL0020           TMS Change Date
     C                     Z-ADDWAD9TM    WL0021           TMS Change time
     C                     EXSR SFCRRC
     C                     END                             *FI
      * *
      * Chg TMS Load Inv Chg  CH - TMS Load Invoice Charge  * 
     C                     EXSR SGCHRC
     C           KRSSD     READE@CVCPX3                  90*
     C                     ENDDO
      * USER: Exit processing
      * Record found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Update LH with carrier paid info
      * CASE: LCL.Rated Freight is EQ Zero
     C           YL0003    IFEQ 0                          *IF
      * leave whats on the load if a new one didnt come up
     C                     Z-ADDP4R1NB    YL0003           Rated Freight
     C                     END                             *FI
      * Chg Carr Paysts,dt,tm CH - Load Header  * 
     C                     EXSR SHCHRC
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Last Seq for LFC   RT - TMS Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBTMLD    WQSE01           TMS Load ID
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           TMS Load ID
     C                     KFLD           WBHHNB           TMS Freight Cha
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           TMS Load ID
      * Setup key
     C                     Z-ADDWL0001    WQSE01           TMS Load ID
     C                     Z-ADDWL0002    WBHHNB           TMS Freight Cha
      * Establish starting position
     C           KPSSE     SETLL@CYCPYC                    *
     C           KRSSE     READE@CYCPYC                  90*
      * Data record not found
     C   90                MOVEL'USR4945' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBHHNB    WL0002           TMS Freight Cha
     C           KRSSE     READE@CYCPYC                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt TMS Load Frt Chrg  CR - TMS Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CYCPYB
     C                     Z-ADDWL0003    WCTMLD           TMS Load ID
     C                     Z-ADDWL0004    WCHHNB           TMS Freight Cha
     C                     Z-ADDWL0005    WCA5D8           TMS Invoice Dat
     C                     Z-ADDWL0006    WCALTH           TMS Invoice Tim
     C                     MOVELWL0007    WCU5AA           TMS Charge Type
     C                     MOVELWL0008    WCU6AA           TMS Charge Desc
     C                     MOVELWL0009    WCU7AA           TMS EDI Code
     C                     Z-ADDWL0010    WCM0VL           TMS Charge Amou
     C                     Z-ADDWL0011    WCM1VL           TMS Charge Rate
     C                     MOVELWL0012    WCDRSC           TMS Rate Qualif
     C                     Z-ADDWL0013    WCHENB           TMS Charge Quan
     C                     MOVELWL0014    WCU8AA           TMS OMS Frt Cha
     C                     MOVELWL0015    WCURAA           TMS Carrier SCA
     C                     MOVELWL0016    WCCFAA           LFC Carrier Cod
     C                     MOVELWL0017    WCDLSC           TMS Record Stat
     C                     Z-ADDWL0018    WCTPRC           TMS Process Sta
     C                     MOVELWL0019    WCUYAA           TMS Error Reaso
     C                     Z-ADDWL0020    WCA0D8           TMS Change Date
     C                     Z-ADDWL0021    WCD9TM           TMS Change time
      *
     C           KLCRSF    KLIST
     C                     KFLD           WCTMLD           TMS Load ID
     C                     KFLD           WCHHNB           TMS Freight Cha
      * Check for duplicate primary key
     C           KLCRSF    SETLL@CYCPYB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4946' W0RTN   7
      * Send message 'TMS Load Freight Charg EX'
     C                     MOVEL'USR4946' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@CYCPYB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg TMS Load Inv Chg  CH - TMS Load Invoice Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CVCPX2
     C                     Z-ADDWATMLD    WDTMLD           TMS Load ID
     C                     Z-ADDWAAYD8    WDAYD8           TMS Extract Dat
     C                     Z-ADDWAAFTH    WDAFTH           TMS Extract Tim
     C                     MOVELWAFSU1    WDFSU1    P      TMS Extract Fil
     C                     Z-ADDWATMSQ    WDTMSQ           TMS Invoice Seq
      *
     C           KLCHSG    KLIST
     C                     KFLD           WDTMLD           TMS Load ID
     C                     KFLD           WDAYD8           TMS Extract Dat
     C                     KFLD           WDAFTH           TMS Extract Tim
     C                     KFLD           WDFSU1           TMS Extract Fil
     C                     KFLD           WDTMSQ           TMS Invoice Seq
     C           KLCHSG    CHAIN@CVCPX2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCVCPL0'MDACP
     C                     MOVEL'@CVCPX2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPBCV1    YARDCS
      * Move non-key fields to @CVCPX2
     C                     Z-ADDWAA5D8    WDA5D8           TMS Invoice Dat
     C                     Z-ADDWAALTH    WDALTH           TMS Invoice Tim
     C                     MOVELWAU5AA    WDU5AA    P      TMS Charge Type
     C                     MOVELWAU6AA    WDU6AA    P      TMS Charge Desc
     C                     MOVELWAU7AA    WDU7AA    P      TMS EDI Code
     C                     Z-ADDWAM0VL    WDM0VL           TMS Charge Amou
     C                     Z-ADDWAM1VL    WDM1VL           TMS Charge Rate
     C                     MOVELWADRSC    WDDRSC    P      TMS Rate Qualif
     C                     Z-ADDWAHENB    WDHENB           TMS Charge Quan
     C                     MOVELWADLSC    WDDLSC    P      TMS Record Stat
     C                     Z-ADD1         WDTPRC           TMS Process Sta
     C                     MOVELWAUYAA    WDUYAA    P      TMS Error Reaso
     C                     Z-ADDWAA0D8    WDA0D8           TMS Change Date
     C                     Z-ADDWAD9TM    WDD9TM           TMS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPBCV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set TMS Record Stampp IF
     C                     Z-ADD##JTM     WDD9TM           TMS Change time
     C                     Z-ADD##JDT     WDA0D8           TMS Change Date
      * Set PGM.*Record Data Changed flag
     C           QPBCV1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CVCPX2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPBCVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Carr Paysts,dt,tm CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  30       Company Number
     C                     Z-ADD*ZERO     WN0004  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0005  1        LTL Flag
     C                     MOVEL*BLANK    WN0006  1        Load Status
     C                     Z-ADD*ZERO     WN0007  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0008 15        Seal 1
     C                     MOVEL*BLANK    WN0009 15        Seal 2
     C                     MOVEL*BLANK    WN0010 15        Seal 3
     C                     MOVEL*BLANK    WN0011 15        Seal 4
     C                     MOVEL*BLANK    WN0012 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0013  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0014 112       Flat Amount
     C                     MOVEL*BLANK    WN0015  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0016  50       Total Stops
     C                     MOVEL*BLANK    WN0017 20        Trailer Id
     C                     MOVEL*BLANK    WN0018  3        Transloader Car
     C                     Z-ADD*ZERO     WN0019  40       BOL Time
     C                     MOVEL*BLANK    WN0020  3        Carrier Code
     C                     MOVEL*BLANK    WN0021  7        Truck Size
     C                     Z-ADD*ZERO     WN0022  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0023  1        Ship Status
     C                     MOVEL*BLANK    WN0024  1        Load Type
     C                     Z-ADD*ZERO     WN0025  50       Number Pallets
     C                     Z-ADD*ZERO     WN0026  50       Number Pallets
     C                     Z-ADD*ZERO     WN0027 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0028  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0029  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0030  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0031 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0032 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0033  70       Actual Departur
     C                     Z-ADD*ZERO     WN0034  40       Departure Time
     C                     Z-ADD*ZERO     WN0035  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0036  52       Product Tempera
     C                     Z-ADD*ZERO     WN0037  50       Number Spacers
     C                     MOVEL*BLANK    WN0038 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0039  70       Total Load Mile
     C                     MOVEL*BLANK    WN0040 12        Recorder ID
     C                     MOVEL*BLANK    WN0041  2        Shipping Method
     C                     MOVEL*BLANK    WN0042  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0043  2        Ship To State C
     C                     Z-ADD*ZERO     WN0044  70       Gross Weight
     C                     MOVEL*BLANK    WN0045  3        Carrier Broker
     C                     MOVEL*BLANK    WN0046  1        Export Status
     C                     Z-ADD*ZERO     WN0047  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0048  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0049  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0050  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0051  70       Spotted Date
     C                     Z-ADD*ZERO     WN0052  60       Spotted Time
     C                     Z-ADD*ZERO     WN0053  70       Load Finished D
     C                     Z-ADD*ZERO     WN0054  60       Load Finished T
     C                     Z-ADD*ZERO     WN0055  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0056  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0057  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0058  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0059  70       Truck Departure
     C                     Z-ADD*ZERO     WN0060  60       Truck Departure
     C                     Z-ADD*ZERO     WN0061  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0062  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0063  3        Shipping Line
     C                     MOVEL*BLANK    WN0064 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0065 30        Vessel Name
     C                     Z-ADD*ZERO     WN0066  50       Voyage
     C                     Z-ADD*ZERO     WN0067  70       Sail Date
     C                     MOVEL*BLANK    WN0068 12        Booking Number
     C                     MOVEL*BLANK    WN0069 20        Discharge Port
     C                     Z-ADD*ZERO     WN0070  70       Arrival Date
     C                     MOVEL*BLANK    WN0071 12        Container Numbe
     C                     Z-ADD*ZERO     WN0072  70       Date In
     C                     Z-ADD*ZERO     WN0073  60       Time In
     C                     Z-ADD*ZERO     WN0074  70       Date Out
     C                     Z-ADD*ZERO     WN0075  60       Time Out
     C                     Z-ADD*ZERO     WN0076 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0077  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0078  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0079  1        LH Unused Sts
     C                     Z-ADD*ZERO     WN0080  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0081  70       Requested Deliv
     C                     MOVEL*BLANK    WN0082  1        Load Acceptance
     C                     MOVEL*BLANK    WN0083  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0084  70       On Yard Date
     C                     Z-ADD*ZERO     WN0085  60       On Yard Time
     C                     Z-ADD*ZERO     WN0086  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0087  60       Deadline Depart
     C                     MOVEL*BLANK    WN0088  1        Load Held Over
     C                     MOVEL*BLANK    WN0089  1        Load Held Over
     C                     MOVEL*BLANK    WN0090 15        Load Held Over
     C                     MOVEL*BLANK    WN0091 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0092 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0093  70       Express Mail Da
     C                     MOVEL*BLANK    WN0094  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0095  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0096  70       Product Complet
     C                     Z-ADD*ZERO     WN0097  60       Product Complet
     C                     Z-ADD*ZERO     WN0098  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0099  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0100  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0101  1        Load Confirmed
     C                     MOVEL*BLANK    WN0102 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0103  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0104  60       Load Door 1
     C                     Z-ADD*ZERO     WN0105  70       Override Total
     C                     Z-ADD*ZERO     WN0106  60       Load Door 2
     C                     MOVEL*BLANK    WN0107  1        Partial Load
     C                     MOVEL*BLANK    WN0108  1        Load Confirmati
     C                     MOVEL*BLANK    WN0109  1        Export Load USD
     C                     MOVEL*BLANK    WN0110  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0111 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0112 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0113 15        Late Billing Em
     C                     MOVEL*BLANK    WN0114 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0115 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0116  1        Multi Company L
     C                     MOVEL*BLANK    WN0117  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0118  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0119  1        LH Power Only L
     C                     MOVEL*BLANK    WN0120  1        MG Created Load
     C                     MOVEL*BLANK    WN0121  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0122  2        Load U/M
     C                     MOVEL*BLANK    WN0123  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0124  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0125  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0126  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0127  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0128  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0129  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0130  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0131  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0132  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0133  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0134  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0135  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0136  60       LH Unused Time
     C                     MOVEL*BLANK    WN0137  1        EDI Status 1
     C                     MOVEL*BLANK    WN0138  1        EDI Status 2
     C                     MOVEL*BLANK    WN0139  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0140  60       Job Time
     C                     MOVEL*BLANK    WN0141 10        User Id
     C                     MOVEL*BLANK    WN0142 10        Job Name
     C                     Z-ADD*ZERO     WN0143  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP2RMNB    WERMNB           Load ID
      *
     C           KLCHSH    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSH    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0003    WER1NB           Rated Freight
     C                     MOVEL'P'       WERNST    P      LH Carrier Paym
     C                     Z-ADDYL0002    WEPYDT           LH Carrier Paid
     C                     Z-ADDP1AFTH    WECKTM           LH Carrier Paid
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * CASE: Only zero if carrier plaid dte <>0 on a not paid
      *  - c1 AND c2
      *   |- c1    : PAR.LH Carrier Payment Sts is Not Paid
      *   |- c2    : DB1.LH Carrier Paid Dte NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'P'       IFEQ *BLANK                     *IF
     C           WEPYDT    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         WEPYDT           LH Carrier Paid
     C                     Z-ADD0         WECKTM           LH Carrier Paid
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WATMLD           TMS Load ID
     C                     Z-ADD*ZERO     WAAYD8           TMS Extract Dat
     C                     Z-ADD*ZERO     WAAFTH           TMS Extract Tim
     C                     Z-ADD*ZERO     WATMSQ           TMS Invoice Seq
     C                     Z-ADD*ZERO     WAA5D8           TMS Invoice Dat
     C                     Z-ADD*ZERO     WAALTH           TMS Invoice Tim
     C                     Z-ADD*ZERO     WAM0VL           TMS Charge Amou
     C                     Z-ADD*ZERO     WAM1VL           TMS Charge Rate
     C                     Z-ADD*ZERO     WAHENB           TMS Charge Quan
     C                     Z-ADD*ZERO     WATPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WAA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WAD9TM           TMS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTMLD           TMS Load ID
     C                     Z-ADD*ZERO     WBHHNB           TMS Freight Cha
     C                     Z-ADD*ZERO     WBA5D8           TMS Invoice Dat
     C                     Z-ADD*ZERO     WBALTH           TMS Invoice Tim
     C                     Z-ADD*ZERO     WBM0VL           TMS Charge Amou
     C                     Z-ADD*ZERO     WBM1VL           TMS Charge Rate
     C                     Z-ADD*ZERO     WBHENB           TMS Charge Quan
     C                     Z-ADD*ZERO     WBTPRC           TMS Process Sta
     C                     Z-ADD*ZERO     WBA0D8           TMS Change Date
     C                     Z-ADD*ZERO     WBD9TM           TMS Change time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WERPNB           Total Load Orde
     C                     Z-ADD*ZERO     WEFLAM           Flat Amount
     C                     Z-ADD*ZERO     WERRNB           Total Stops
     C                     Z-ADD*ZERO     WESBNB           BOL Time
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WESDNB           Number Pallets
     C                     Z-ADD*ZERO     WEPAOU           Number Pallets
     C                     Z-ADD*ZERO     WEDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEHADT           Actual Arrival
     C                     Z-ADD*ZERO     WEAART           Actual Arrival
     C                     Z-ADD*ZERO     WEDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WEDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WEAQDT           Actual Departur
     C                     Z-ADD*ZERO     WES6NB           Departure Time
     C                     Z-ADD*ZERO     WET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WEPRTM           Product Tempera
     C                     Z-ADD*ZERO     WENPSV           Number Spacers
     C                     Z-ADD*ZERO     WETLMI           Total Load Mile
     C                     Z-ADD*ZERO     WEGRWE           Gross Weight
     C                     Z-ADD*ZERO     WEF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WEJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WEJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WESPTM           Spotted Time
     C                     Z-ADD*ZERO     WEJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WELFTM           Load Finished T
     C                     Z-ADD*ZERO     WEJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WEBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WEJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WEBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WEKIDT           Truck Departure
     C                     Z-ADD*ZERO     WEASTM           Truck Departure
     C                     Z-ADD*ZERO     WEKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WEAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WEVOAG           Voyage
     C                     Z-ADD*ZERO     WEKBDT           Sail Date
     C                     Z-ADD*ZERO     WEEFDT           Arrival Date
     C                     Z-ADD*ZERO     WEKCDT           Date In
     C                     Z-ADD*ZERO     WETMIN           Time In
     C                     Z-ADD*ZERO     WEKDDT           Date Out
     C                     Z-ADD*ZERO     WEVMNB           Time Out
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WELLDT           Express Mail Da
     C                     Z-ADD*ZERO     WEK0DT           Product Complet
     C                     Z-ADD*ZERO     WEAYTM           Product Complet
     C                     Z-ADD*ZERO     WEKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WEICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WEIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WEK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WEAZTM           Load Door 1
     C                     Z-ADD*ZERO     WEK2DT           Override Total
     C                     Z-ADD*ZERO     WEA0TM           Load Door 2
     C                     Z-ADD*ZERO     WEZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WEPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WECLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WEP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WECMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WEP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WECNTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WECOTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WECQTM           LH Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  80
     C                     Z-ADD*ZERO     WL0006  40
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008 50
     C                     MOVEL*BLANK    WL0009  3
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013 101
     C                     MOVEL*BLANK    WL0014  6
     C                     MOVEL*BLANK    WL0015 10
     C                     MOVEL*BLANK    WL0016  4
     C                     MOVEL*BLANK    WL0017  1
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  6
     C                     Z-ADD*ZERO     WL0020  80
     C                     Z-ADD*ZERO     WL0021  60
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field LFC TFP Carrier Paid Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field TMS Freight Charge Seq
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field FC Code
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0006  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MG_MINMAX_ADJ
00002 DEFICIT
00003 DISCOUNT
