     H/TITLE Chg MoveTime Slot     XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 11/05/09  Time  : 17:15:22
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLAECPLBIF  E           K        DISK
      * RSQ : Delivery Sched Detail     Co/KDt/DDt/DTm/Sq-d
      *
     FPLAECPL0IF  E           K        DISK
      * RTV : Delivery Sched Detail     Retrieval index
      *
     FPLAGCPL1IF  E           K        DISK
      * RTV : Delivery Sched Split      Retrieval index
      *
     FPLAKCPL1IF  E           K        DISK
      * RTV : Delivery Sched Comment    Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLAECPL1UF  E           K        DISK                      A
      * UPD : Delivery Sched Detail     Update index
      *
     FPLAGCPL0UF  E           K        DISK                      A
      * UPD : Delivery Sched Split      Update index
      *
     FPLAKCPL0UF  E           K        DISK                      A
      * UPD : Delivery Sched Comment    Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     I@AECPJT
      * Delivery Sched Detail     Co/KDt/DDt/DTm/Sq-d
      * Renamed input format fields
     I              AEHONB                          WAHONB
     I              AEE0DT                          WAE0DT
     I              AEE6DT                          WAE6DT
     I              AEAGTH                          WAAGTH
     I              AEHZA1                          WAHZA1
     I              AEH0A1                          WAH0A1
     I              AEH1A1                          WAH1A1
     I              AEJ4CD                          WAJ4CD
     I              AEJ5CD                          WAJ5CD
     I              AELBCD                          WALBCD
     I              AELCCD                          WALCCD
     I              AEIOA1                          WAIOA1
     I              AEH2A1                          WAH2A1
     I              AEIJA1                          WAIJA1
     I              AEK9CD                          WAK9CD
     I              AEK8CD                          WAK8CD
     I              AEJ6CD                          WAJ6CD
     I              AEJ7CD                          WAJ7CD
     I              AEMGCD                          WAMGCD
     I              AEW1ST                          WAW1ST
     I              AEW2ST                          WAW2ST
     I              AEH3A1                          WAH3A1
     I              AEMECD                          WAMECD
     I              AEMFCD                          WAMFCD
     I              AEW4ST                          WAW4ST
     I              AEXWST                          WAXWST
     I              AEFRDT                          WAFRDT
     I              AEBOTH                          WABOTH
     I              AEE7DT                          WAE7DT
     I              AEAHTH                          WAAHTH
     I              AEE8DT                          WAE8DT
     I              AEAITH                          WAAITH
     I              AEXBST                          WAXBST
     I              AEXGST                          WAXGST
     I              AEXPST                          WAXPST
     I              AEXNST                          WAXNST
     I              AEXTST                          WAXTST
     I              AEXLST                          WAXLST
     I              AEW0ST                          WAW0ST
     I              AEYEST                          WAYEST
     I              AEFZDT                          WAFZDT
     I              AEB1TH                          WAB1TH
     I              AEAACD                          WAAACD
     I              AEABCD                          WAABCD
     I              AEAECD                          WAAECD
     I              AEHMNB                          WAHMNB
     I              AEBNNB                          WABNNB
     I              AEBONB                          WABONB
     I              AEAAVN                          WAAAVN
     I              AEAADT                          WAAADT
     I              AEAMTM                          WAAMTM
     I              AEAJST                          WAAJST
     I              AEAHVN                          WAAHVN
     I              AEAGVN                          WAAGVN
     I              AEABVN                          WAABVN
     I              AEABDT                          WAABDT
     I              AEABTM                          WAABTM
      *
     I@AECPIG
      * Delivery Sched Detail     Retrieval index
      * Renamed input format fields
     I              AEHONB                          WBHONB
     I              AEE0DT                          WBE0DT
     I              AEE6DT                          WBE6DT
     I              AEAGTH                          WBAGTH
     I              AEHZA1                          WBHZA1
     I              AEH0A1                          WBH0A1
     I              AEH1A1                          WBH1A1
     I              AEJ4CD                          WBJ4CD
     I              AEJ5CD                          WBJ5CD
     I              AELBCD                          WBLBCD
     I              AELCCD                          WBLCCD
     I              AEIOA1                          WBIOA1
     I              AEH2A1                          WBH2A1
     I              AEIJA1                          WBIJA1
     I              AEK9CD                          WBK9CD
     I              AEK8CD                          WBK8CD
     I              AEJ6CD                          WBJ6CD
     I              AEJ7CD                          WBJ7CD
     I              AEMGCD                          WBMGCD
     I              AEW1ST                          WBW1ST
     I              AEW2ST                          WBW2ST
     I              AEH3A1                          WBH3A1
     I              AEMECD                          WBMECD
     I              AEMFCD                          WBMFCD
     I              AEW4ST                          WBW4ST
     I              AEXWST                          WBXWST
     I              AEFRDT                          WBFRDT
     I              AEBOTH                          WBBOTH
     I              AEE7DT                          WBE7DT
     I              AEAHTH                          WBAHTH
     I              AEE8DT                          WBE8DT
     I              AEAITH                          WBAITH
     I              AEXBST                          WBXBST
     I              AEXGST                          WBXGST
     I              AEXPST                          WBXPST
     I              AEXNST                          WBXNST
     I              AEXTST                          WBXTST
     I              AEXLST                          WBXLST
     I              AEW0ST                          WBW0ST
     I              AEYEST                          WBYEST
     I              AEFZDT                          WBFZDT
     I              AEB1TH                          WBB1TH
     I              AEAACD                          WBAACD
     I              AEABCD                          WBABCD
     I              AEAECD                          WBAECD
     I              AEHMNB                          WBHMNB
     I              AEBNNB                          WBBNNB
     I              AEBONB                          WBBONB
     I              AEAAVN                          WBAAVN
     I              AEAADT                          WBAADT
     I              AEAMTM                          WBAMTM
     I              AEAJST                          WBAJST
     I              AEAHVN                          WBAHVN
     I              AEAGVN                          WBAGVN
     I              AEABVN                          WBABVN
     I              AEABDT                          WBABDT
     I              AEABTM                          WBABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
     I@AGCPIM
      * Delivery Sched Split      Retrieval index
      * Renamed input format fields
     I              AGHONB                          WDHONB
     I              AGE0DT                          WDE0DT
     I              AGE6DT                          WDE6DT
     I              AGAGTH                          WDAGTH
     I              AGHZA1                          WDHZA1
     I              AGH5A1                          WDH5A1
     I              AGKNCD                          WDKNCD
     I              AGKOCD                          WDKOCD
     I              AGLDCD                          WDLDCD
     I              AGLECD                          WDLECD
     I              AGH6A1                          WDH6A1
     I              AGAAVN                          WDAAVN
     I              AGAADT                          WDAADT
     I              AGAMTM                          WDAMTM
     I              AGAJST                          WDAJST
     I              AGAHVN                          WDAHVN
     I              AGAGVN                          WDAGVN
     I              AGABVN                          WDABVN
     I              AGABDT                          WDABDT
     I              AGABTM                          WDABTM
      *
     I@AGCPIL
      * Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WEHONB
     I              AGE0DT                          WEE0DT
     I              AGE6DT                          WEE6DT
     I              AGAGTH                          WEAGTH
     I              AGHZA1                          WEHZA1
     I              AGH5A1                          WEH5A1
     I              AGKNCD                          WEKNCD
     I              AGKOCD                          WEKOCD
     I              AGLDCD                          WELDCD
     I              AGLECD                          WELECD
     I              AGH6A1                          WEH6A1
     I              AGAAVN                          WEAAVN
     I              AGAADT                          WEAADT
     I              AGAMTM                          WEAMTM
     I              AGAJST                          WEAJST
     I              AGAHVN                          WEAHVN
     I              AGAGVN                          WEAGVN
     I              AGABVN                          WEABVN
     I              AGABDT                          WEABDT
     I              AGABTM                          WEABTM
      *
     I@AKCPI1
      * Delivery Sched Comment    Retrieval index
      * Renamed input format fields
     I              AKHONB                          WFHONB
     I              AKE0DT                          WFE0DT
     I              AKE6DT                          WFE6DT
     I              AKAGTH                          WFAGTH
     I              AKHZA1                          WFHZA1
     I              AKIIA1                          WFIIA1
     I              AKSKTX                          WFSKTX
     I              AKAAVN                          WFAAVN
     I              AKAADT                          WFAADT
     I              AKAMTM                          WFAMTM
     I              AKAJST                          WFAJST
     I              AKAHVN                          WFAHVN
     I              AKAGVN                          WFAGVN
     I              AKABVN                          WFABVN
     I              AKABDT                          WFABDT
     I              AKABTM                          WFABTM
      *
     I@AKCPI0
      * Delivery Sched Comment    Update index
      * Renamed input format fields
     I              AKHONB                          WGHONB
     I              AKE0DT                          WGE0DT
     I              AKE6DT                          WGE6DT
     I              AKAGTH                          WGAGTH
     I              AKHZA1                          WGHZA1
     I              AKIIA1                          WGIIA1
     I              AKSKTX                          WGSKTX
     I              AKAAVN                          WGAAVN
     I              AKAADT                          WGAADT
     I              AKAMTM                          WGAMTM
     I              AKAJST                          WGAJST
     I              AKAHVN                          WGAHVN
     I              AKAGVN                          WGAGVN
     I              AKABVN                          WGABVN
     I              AKABDT                          WGABDT
     I              AKABTM                          WGABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WHHMNB
     I              AXBNNB                          WHBNNB
     I              AXBONB                          WHBONB
     I              AXCQDT                          WHCQDT
     I              AXABTH                          WHABTH
     I              AXACTH                          WHACTH
     I              AXBPNB                          WHBPNB
     I              AXCSNB                          WHCSNB
     I              AXAUDT                          WHAUDT
     I              AXCMST                          WHCMST
     I              AXAGPR                          WHAGPR
     I              AXATVA                          WHATVA
     I              AXI1ST                          WHI1ST
     I              AXDHNB                          WHDHNB
     I              AXDINB                          WHDINB
     I              AXCNST                          WHCNST
     I              AXGINB                          WHGINB
     I              AXBZDT                          WHBZDT
     I              AXLSNB                          WHLSNB
     I              AXF3TX                          WHF3TX
     I              AXO8ST                          WHO8ST
     I              AXO9ST                          WHO9ST
     I              AXPAST                          WHPAST
     I              AXLDSH                          WHLDSH
     I              AXPBST                          WHPBST
     I              AXPCST                          WHPCST
     I              AXPDST                          WHPDST
     I              AXUWST                          WHUWST
     I              AXUXST                          WHUXST
     I              AXUYST                          WHUYST
     I              AXJKRU                          WHJKRU
     I              AXKEOR                          WHKEOR
     I              AXIOEW                          WHIOEW
     I              AXKJIO                          WHKJIO
     I              AXIOJR                          WHIOJR
     I              AXEIRR                          WHEIRR
     I              AXITMF                          WHITMF
     I              AXODJE                          WHODJE
     I              AXRJIF                          WHRJIF
     I              AXOEJF                          WHOEJF
     I              AXD0DT                          WHD0DT
     I              AXD1DT                          WHD1DT
     I              AXD2DT                          WHD2DT
     I              AXD3DT                          WHD3DT
     I              AXD4DT                          WHD4DT
     I              AXBNCD                          WHBNCD
     I              AXABCD                          WHABCD
     I              AXAECD                          WHAECD
     I              AXAAVN                          WHAAVN
     I              AXAADT                          WHAADT
     I              AXAMTM                          WHAMTM
     I              AXAJST                          WHAJST
     I              AXAHVN                          WHAHVN
     I              AXAGVN                          WHAGVN
     I              AXABVN                          WHABVN
     I              AXABDT                          WHABDT
     I              AXABTM                          WHABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WIHMNB
     I              AXBNNB                          WIBNNB
     I              AXBONB                          WIBONB
     I              AXCQDT                          WICQDT
     I              AXABTH                          WIABTH
     I              AXACTH                          WIACTH
     I              AXBPNB                          WIBPNB
     I              AXCSNB                          WICSNB
     I              AXAUDT                          WIAUDT
     I              AXCMST                          WICMST
     I              AXAGPR                          WIAGPR
     I              AXATVA                          WIATVA
     I              AXI1ST                          WII1ST
     I              AXDHNB                          WIDHNB
     I              AXDINB                          WIDINB
     I              AXCNST                          WICNST
     I              AXGINB                          WIGINB
     I              AXBZDT                          WIBZDT
     I              AXLSNB                          WILSNB
     I              AXF3TX                          WIF3TX
     I              AXO8ST                          WIO8ST
     I              AXO9ST                          WIO9ST
     I              AXPAST                          WIPAST
     I              AXLDSH                          WILDSH
     I              AXPBST                          WIPBST
     I              AXPCST                          WIPCST
     I              AXPDST                          WIPDST
     I              AXUWST                          WIUWST
     I              AXUXST                          WIUXST
     I              AXUYST                          WIUYST
     I              AXJKRU                          WIJKRU
     I              AXKEOR                          WIKEOR
     I              AXIOEW                          WIIOEW
     I              AXKJIO                          WIKJIO
     I              AXIOJR                          WIIOJR
     I              AXEIRR                          WIEIRR
     I              AXITMF                          WIITMF
     I              AXODJE                          WIODJE
     I              AXRJIF                          WIRJIF
     I              AXOEJF                          WIOEJF
     I              AXD0DT                          WID0DT
     I              AXD1DT                          WID1DT
     I              AXD2DT                          WID2DT
     I              AXD3DT                          WID3DT
     I              AXD4DT                          WID4DT
     I              AXBNCD                          WIBNCD
     I              AXABCD                          WIABCD
     I              AXAECD                          WIAECD
     I              AXAAVN                          WIAAVN
     I              AXAADT                          WIAADT
     I              AXAMTM                          WIAMTM
     I              AXAJST                          WIAJST
     I              AXAHVN                          WIAHVN
     I              AXAGVN                          WIAGVN
     I              AXABVN                          WIABVN
     I              AXABDT                          WIABDT
     I              AXABTM                          WIABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WCHONB
     I              AEE0DT                          WCE0DT
     I              AEE6DT                          WCE6DT
     I              AEAGTH                          WCAGTH
     I              AEHZA1                          WCHZA1
     I              AEH0A1                          WCH0A1
     I              AEH1A1                          WCH1A1
     I              AEJ4CD                          WCJ4CD
     I              AEJ5CD                          WCJ5CD
     I              AELBCD                          WCLBCD
     I              AELCCD                          WCLCCD
     I              AEIOA1                          WCIOA1
     I              AEH2A1                          WCH2A1
     I              AEIJA1                          WCIJA1
     I              AEK9CD                          WCK9CD
     I              AEK8CD                          WCK8CD
     I              AEJ6CD                          WCJ6CD
     I              AEJ7CD                          WCJ7CD
     I              AEMGCD                          WCMGCD
     I              AEW1ST                          WCW1ST
     I              AEW2ST                          WCW2ST
     I              AEH3A1                          WCH3A1
     I              AEMECD                          WCMECD
     I              AEMFCD                          WCMFCD
     I              AEW4ST                          WCW4ST
     I              AEXWST                          WCXWST
     I              AEFRDT                          WCFRDT
     I              AEBOTH                          WCBOTH
     I              AEE7DT                          WCE7DT
     I              AEAHTH                          WCAHTH
     I              AEE8DT                          WCE8DT
     I              AEAITH                          WCAITH
     I              AEXBST                          WCXBST
     I              AEXGST                          WCXGST
     I              AEXPST                          WCXPST
     I              AEXNST                          WCXNST
     I              AEXTST                          WCXTST
     I              AEXLST                          WCXLST
     I              AEW0ST                          WCW0ST
     I              AEYEST                          WCYEST
     I              AEFZDT                          WCFZDT
     I              AEB1TH                          WCB1TH
     I              AEAACD                          WCAACD
     I              AEABCD                          WCABCD
     I              AEAECD                          WCAECD
     I              AEHMNB                          WCHMNB
     I              AEBNNB                          WCBNNB
     I              AEBONB                          WCBONB
     I              AEAAVN                          WCAAVN
     I              AEAADT                          WCAADT
     I              AEAMTM                          WCAMTM
     I              AEAJST                          WCAJST
     I              AEAHVN                          WCAHVN
     I              AEAGVN                          WCAGVN
     I              AEABVN                          WCABVN
     I              AEABDT                          WCABDT
     I              AEABTM                          WCABTM
      *
     IQPLAG1    E DSPLAGCPL0
      * UPD : Delivery Sched Split      Update index
      * Renamed input format fields
     I              AGHONB                          WEHONB
     I              AGE0DT                          WEE0DT
     I              AGE6DT                          WEE6DT
     I              AGAGTH                          WEAGTH
     I              AGHZA1                          WEHZA1
     I              AGH5A1                          WEH5A1
     I              AGKNCD                          WEKNCD
     I              AGKOCD                          WEKOCD
     I              AGLDCD                          WELDCD
     I              AGLECD                          WELECD
     I              AGH6A1                          WEH6A1
     I              AGAAVN                          WEAAVN
     I              AGAADT                          WEAADT
     I              AGAMTM                          WEAMTM
     I              AGAJST                          WEAJST
     I              AGAHVN                          WEAHVN
     I              AGAGVN                          WEAGVN
     I              AGABVN                          WEABVN
     I              AGABDT                          WEABDT
     I              AGABTM                          WEABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPLAK1    E DSPLAKCPL0
      * UPD : Delivery Sched Comment    Update index
      * Renamed input format fields
     I              AKHONB                          WGHONB
     I              AKE0DT                          WGE0DT
     I              AKE6DT                          WGE6DT
     I              AKAGTH                          WGAGTH
     I              AKHZA1                          WGHZA1
     I              AKIIA1                          WGIIA1
     I              AKSKTX                          WGSKTX
     I              AKAAVN                          WGAAVN
     I              AKAADT                          WGAADT
     I              AKAMTM                          WGAMTM
     I              AKAJST                          WGAJST
     I              AKAHVN                          WGAHVN
     I              AKAGVN                          WGAGVN
     I              AKABVN                          WGABVN
     I              AKABDT                          WGABDT
     I              AKABTM                          WGABTM
      *
     IYARDCS      DS                            232
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WIHMNB
     I              AXBNNB                          WIBNNB
     I              AXBONB                          WIBONB
     I              AXCQDT                          WICQDT
     I              AXABTH                          WIABTH
     I              AXACTH                          WIACTH
     I              AXBPNB                          WIBPNB
     I              AXCSNB                          WICSNB
     I              AXAUDT                          WIAUDT
     I              AXCMST                          WICMST
     I              AXAGPR                          WIAGPR
     I              AXATVA                          WIATVA
     I              AXI1ST                          WII1ST
     I              AXDHNB                          WIDHNB
     I              AXDINB                          WIDINB
     I              AXCNST                          WICNST
     I              AXGINB                          WIGINB
     I              AXBZDT                          WIBZDT
     I              AXLSNB                          WILSNB
     I              AXF3TX                          WIF3TX
     I              AXO8ST                          WIO8ST
     I              AXO9ST                          WIO9ST
     I              AXPAST                          WIPAST
     I              AXLDSH                          WILDSH
     I              AXPBST                          WIPBST
     I              AXPCST                          WIPCST
     I              AXPDST                          WIPDST
     I              AXUWST                          WIUWST
     I              AXUXST                          WIUXST
     I              AXUYST                          WIUYST
     I              AXJKRU                          WIJKRU
     I              AXKEOR                          WIKEOR
     I              AXIOEW                          WIIOEW
     I              AXKJIO                          WIKJIO
     I              AXIOJR                          WIIOJR
     I              AXEIRR                          WIEIRR
     I              AXITMF                          WIITMF
     I              AXODJE                          WIODJE
     I              AXRJIF                          WIRJIF
     I              AXOEJF                          WIOEJF
     I              AXD0DT                          WID0DT
     I              AXD1DT                          WID1DT
     I              AXD2DT                          WID2DT
     I              AXD3DT                          WID3DT
     I              AXD4DT                          WID4DT
     I              AXBNCD                          WIBNCD
     I              AXABCD                          WIABCD
     I              AXAECD                          WIAECD
     I              AXAAVN                          WIAAVN
     I              AXAADT                          WIAADT
     I              AXAMTM                          WIAMTM
     I              AXAJST                          WIAJST
     I              AXAHVN                          WIAHVN
     I              AXAGVN                          WIAGVN
     I              AXABVN                          WIABVN
     I              AXABDT                          WIABDT
     I              AXABTM                          WIABTM
      *
     IYBRDCS      DS                            236
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Delivery Sched Detail
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * I :  DSH Kill Date
     I                                    P   3   60P1E0DT
      * I :  DSD Delivery Date
     I                                    P   7  100P1E6DT
      * I :  DSD Delivery Time
     I                                    P  11  130P1AGTH
      * I :  DSD Delivery Time Seq
     I                                    P  14  150P1HZA1
      * I :  BOH Company Number
     I                                    P  16  170P1HMNB
      * I :  BOH Buy Order Number
     I                                    P  18  200P1BNNB
      * I :  BOL Load Number
     I                                    P  21  230P1BONB
     IP2PARM      DS
      * I :  Delivery Time New Usr
     I                                    P   1   30P2B4TH
     IP3PARM      DS
      * I : MAP Start With Usr
     I                                        1   1 P3D4SS
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1E0DT    PARM           WP0002  70       DSH Kill Date
     C           P1E6DT    PARM           WP0003  70       DSD Delivery Da
     C           P1AGTH    PARM           WP0004  40       DSD Delivery Ti
     C           P1HZA1    PARM           WP0005  30       DSD Delivery Ti
     C           P1HMNB    PARM           WP0006  30       BOH Company Num
     C           P1BNNB    PARM           WP0007  50       BOH Buy Order N
     C           P1BONB    PARM           WP0008  50       BOL Load Number
     C           P2B4TH    PARM           WP0009  40       Delivery Time N
     C           P3D4SS    PARM           WP0010  1        Start With Usr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Chg MoveTime Slot     XF
      * Scheduling - Get key if found then take care of schedule rec
      * CASE: PAR.Start With Usr is Scheduling
     C           P3D4SS    IFEQ 'S'                        *IF
      * susan review 1
      * 1 - Read the Delivery Sch Detail and get the new key
      * Rtv Next Seq Num      RT - Delivery Sched Detail  * 
     C                     EXSR SARVGN
      * susan review 2
      * 2.  DSD,spl,Commnt -Clr old rcd, create with bol,kill,delv date,t
      * Rtv Crt DSD f/DelvTimeRT - Delivery Sched Detail  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * 4.  Change the BOL with the new delivery time
      * If this is excuted from the receiving screen then the
      * buy order load has already been updated
      * and that is fine
      * this will only read and if the time is different then it
      * change the time
      * susan review 5
      * Rtv/Chg Bol F/DelvTimeRT - Buy Order Load  * 
     C                     EXSR SKRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Next Seq Num      RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHONB    WQSA01           CC Company Numb
     C           *LIKE     DEFN WAE0DT    WQSA02           DSH Kill Date
     C           *LIKE     DEFN WAE6DT    WQSA03           DSD Delivery Da
     C           *LIKE     DEFN WAAGTH    WQSA04           DSD Delivery Ti
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           CC Company Numb
     C                     KFLD           WQSA02           DSH Kill Date
     C                     KFLD           WQSA03           DSD Delivery Da
     C                     KFLD           WQSA04           DSD Delivery Ti
      * Setup key
     C                     Z-ADDP1HONB    WQSA01           CC Company Numb
     C                     Z-ADDP1E0DT    WQSA02           DSH Kill Date
     C                     Z-ADDP1E6DT    WQSA03           DSD Delivery Da
     C                     Z-ADDP2B4TH    WQSA04           DSD Delivery Ti
      * Establish starting position
     C           KRSSA     SETLL@AECPJT                    *
     C           KRSSA     READE@AECPJT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           DSD Delivery Ti
     C                     Z-ADD1         YL0001           DSD Delivery Ti
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAHZA1    YL0001           DSD Delivery Ti
     C           WAHZA1    ADD  1         YL0001           DSD Delivery Ti
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@AECPJT                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Crt DSD f/DelvTimeRT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBE0DT           DSH Kill Date
     C                     KFLD           WBE6DT           DSD Delivery Da
     C                     KFLD           WBAGTH           DSD Delivery Ti
     C                     KFLD           WBHZA1           DSD Delivery Ti
      * Setup key
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
     C                     Z-ADDP1E0DT    WBE0DT           DSH Kill Date
     C                     Z-ADDP1E6DT    WBE6DT           DSD Delivery Da
     C                     Z-ADDP1AGTH    WBAGTH           DSD Delivery Ti
     C                     Z-ADDP1HZA1    WBHZA1           DSD Delivery Ti
      * Establish starting position
     C           KRSSB     CHAIN@AECPIG              90    *
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           P2B4TH    DIV  100       YL0002           DSD Scheduled H
      * Create new record
      * Crt Delv Sched Dtl    CR - Delivery Sched Detail  * 
     C                     EXSR SCCRRC
      * CASE: DB1.DSD Full/Split Load is Split
     C           WBW2ST    IFEQ 'S'                        *IF
      * Rtv Crt f/Delv        RT - Delivery Sched Split  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Rtv Chg for f/DelvTimeRT - Delivery Sched Comment  * 
     C                     EXSR SGRVGN
      * clear out the old record
      * Chg Clear Slot EXT   CH - Delivery Sched Detail  * 
     C                     EXSR SJCHRC
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt Delv Sched Dtl    CR - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AECPIH
     C                     Z-ADDWBHMNB    WCHONB           CC Company Numb
     C                     Z-ADDWBE0DT    WCE0DT           DSH Kill Date
     C                     Z-ADDWBE6DT    WCE6DT           DSD Delivery Da
     C                     Z-ADDP2B4TH    WCAGTH           DSD Delivery Ti
     C                     Z-ADDYL0001    WCHZA1           DSD Delivery Ti
     C                     Z-ADDYL0002    WCH0A1           DSD Scheduled H
     C                     Z-ADDWBH1A1    WCH1A1           DSD Farm Site C
     C                     MOVELWBJ4CD    WCJ4CD           DSD Building
     C                     MOVELWBJ5CD    WCJ5CD           DSD Room
     C                     MOVELWBLBCD    WCLBCD           DSD Sire Line C
     C                     MOVELWBLCCD    WCLCCD           DSD Hog Group C
     C                     Z-ADDWBIOA1    WCIOA1           DSD Unused Head
     C                     Z-ADDWBH2A1    WCH2A1           DSD Scheduled D
     C                     Z-ADDWBIJA1    WCIJA1           DSD Scheduled K
     C                     MOVELWBK9CD    WCK9CD           DSD Transportat
     C                     MOVELWBK8CD    WCK8CD           DSD Trucker Cod
     C                     MOVELWBJ6CD    WCJ6CD           DSD Driver
     C                     MOVELWBJ7CD    WCJ7CD           DSD Loading Cre
     C                     MOVELWBMGCD    WCMGCD           CHR Code
     C                     MOVELWBW1ST    WCW1ST           DSD Load Type
     C                     MOVELWBW2ST    WCW2ST           DSD Full/Split
     C                     Z-ADDWBH3A1    WCH3A1           DSD Movement Nu
     C                     MOVELWBMECD    WCMECD           DSD Truck ID
     C                     MOVELWBMFCD    WCMFCD           DSD Trailer ID
     C                     MOVELWBW4ST    WCW4ST           DSD Movement Pr
     C                     MOVELWBXWST    WCXWST           DSD Sched Route
     C                     Z-ADDWBFRDT    WCFRDT           DSD Sched Route
     C                     Z-ADDWBBOTH    WCBOTH           DSD Sched Route
     C                     Z-ADDWBE7DT    WCE7DT           DSD Sch Farm Ar
     C                     Z-ADDWBAHTH    WCAHTH           DSD Sch Farm Ar
     C                     Z-ADDWBE8DT    WCE8DT           DSD Sch Start L
     C                     Z-ADDWBAITH    WCAITH           DSD Sch Start L
     C                     MOVELWBXBST    WCXBST           DSD Receiving S
     C                     MOVELWBXGST    WCXGST           DSD Kill Shift
     C                     MOVELWBXPST    WCXPST           DSD BOL Kill Sh
     C                     MOVELWBXNST    WCXNST           DSD HPS Post St
     C                     MOVELWBXTST    WCXTST           DSD HPE Post St
     C                     MOVELWBXLST    WCXLST           DSD Lock Status
     C                     MOVELWBW0ST    WCW0ST           DSD Source Type
     C                     MOVELWBYEST    WCYEST           DSD Transfer St
     C                     Z-ADDWBFZDT    WCFZDT           DSD Unused Date
     C                     Z-ADDWBB1TH    WCB1TH           DSD Unused Time
     C                     MOVELWBAACD    WCAACD           SR Source Code
     C                     MOVELWBABCD    WCABCD           PD Producer Cod
     C                     MOVELWBAECD    WCAECD           PL Location Cod
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WCBONB           BOL Load Number
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVELWBAHVN    WCAHVN           RS Job
     C                     MOVELWBAGVN    WCAGVN           RS Program
     C                     MOVELWBABVN    WCABVN           RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCE0DT           DSH Kill Date
     C                     KFLD           WCE6DT           DSD Delivery Da
     C                     KFLD           WCAGTH           DSD Delivery Ti
     C                     KFLD           WCHZA1           DSD Delivery Ti
      * Check for duplicate primary key
     C           KLCRSC    SETLL@AECPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1029' W0RTN   7
      * Send message 'Delivery Sched Detail  EX'
     C                     MOVEL'PRK1029' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@AECPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Crt f/Delv        RT - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN WDE0DT    WQSD02           DSH Kill Date
     C           *LIKE     DEFN WDE6DT    WQSD03           DSD Delivery Da
     C           *LIKE     DEFN WDAGTH    WQSD04           DSD Delivery Ti
     C           *LIKE     DEFN WDHZA1    WQSD05           DSD Delivery Ti
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           DSH Kill Date
     C                     KFLD           WQSD03           DSD Delivery Da
     C                     KFLD           WQSD04           DSD Delivery Ti
     C                     KFLD           WQSD05           DSD Delivery Ti
      * Setup key
     C                     Z-ADDWBHONB    WQSD01           CC Company Numb
     C                     Z-ADDWBE0DT    WQSD02           DSH Kill Date
     C                     Z-ADDWBE6DT    WQSD03           DSD Delivery Da
     C                     Z-ADDWBAGTH    WQSD04           DSD Delivery Ti
     C                     Z-ADDWBHZA1    WQSD05           DSD Delivery Ti
      * Establish starting position
     C           KRSSD     SETLL@AGCPIM                    *
     C           KRSSD     READE@AGCPIM                  90*
      * Data record not found
     C   90                MOVEL'PRK1032' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
     C                     EXSR SEDLRC
      * Crt Delv Sched Split  CR - Delivery Sched Split  * 
     C                     EXSR SFCRRC
     C           KRSSD     READE@AGCPIM                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * Del Delv Sched Split  DL - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AGCPIL
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDE0DT    WEE0DT           DSH Kill Date
     C                     Z-ADDWDE6DT    WEE6DT           DSD Delivery Da
     C                     Z-ADDWDAGTH    WEAGTH           DSD Delivery Ti
     C                     Z-ADDWDHZA1    WEHZA1           DSD Delivery Ti
     C                     Z-ADDWDH5A1    WEH5A1           DSS Split Seque
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEE0DT           DSH Kill Date
     C                     KFLD           WEE6DT           DSD Delivery Da
     C                     KFLD           WEAGTH           DSD Delivery Ti
     C                     KFLD           WEHZA1           DSD Delivery Ti
     C                     KFLD           WEH5A1           DSS Split Seque
     C           KLDLSE    CHAIN@AGCPIL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAGCPL0'MDACP
     C                     MOVEL'@AGCPIL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AGCPIL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Delv Sched Split  CR - Delivery Sched Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AGCPIL
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDE0DT    WEE0DT           DSH Kill Date
     C                     Z-ADDWDE6DT    WEE6DT           DSD Delivery Da
     C                     Z-ADDP2B4TH    WEAGTH           DSD Delivery Ti
     C                     Z-ADDYL0001    WEHZA1           DSD Delivery Ti
     C                     Z-ADDWDH5A1    WEH5A1           DSS Split Seque
     C                     MOVELWDKNCD    WEKNCD           DSS Building
     C                     MOVELWDKOCD    WEKOCD           DSS Room
     C                     MOVELWDLDCD    WELDCD           DSS Sire Line C
     C                     MOVELWDLECD    WELECD           DSS Hog Group C
     C                     Z-ADDWDH6A1    WEH6A1           DSS Scheduled H
     C                     MOVELWDAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST           RS Record Statu
     C                     MOVELWDAHVN    WEAHVN           RS Job
     C                     MOVELWDAGVN    WEAGVN           RS Program
     C                     MOVELWDABVN    WEABVN           RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEE0DT           DSH Kill Date
     C                     KFLD           WEE6DT           DSD Delivery Da
     C                     KFLD           WEAGTH           DSD Delivery Ti
     C                     KFLD           WEHZA1           DSD Delivery Ti
     C                     KFLD           WEH5A1           DSS Split Seque
      * Check for duplicate primary key
     C           KLCRSF    SETLL@AGCPIL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1033' W0RTN   7
      * Send message 'Delivery Sched Split   EX'
     C                     MOVEL'PRK1033' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@AGCPIL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Chg for f/DelvTimeRT - Delivery Sched Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHONB    WQSG01           CC Company Numb
     C           *LIKE     DEFN WFE0DT    WQSG02           DSH Kill Date
     C           *LIKE     DEFN WFE6DT    WQSG03           DSD Delivery Da
     C           *LIKE     DEFN WFAGTH    WQSG04           DSD Delivery Ti
     C           *LIKE     DEFN WFHZA1    WQSG05           DSD Delivery Ti
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CC Company Numb
     C                     KFLD           WQSG02           DSH Kill Date
     C                     KFLD           WQSG03           DSD Delivery Da
     C                     KFLD           WQSG04           DSD Delivery Ti
     C                     KFLD           WQSG05           DSD Delivery Ti
      * Setup key
     C                     Z-ADDWBHONB    WQSG01           CC Company Numb
     C                     Z-ADDWBE0DT    WQSG02           DSH Kill Date
     C                     Z-ADDWBE6DT    WQSG03           DSD Delivery Da
     C                     Z-ADDWBAGTH    WQSG04           DSD Delivery Ti
     C                     Z-ADDWBHZA1    WQSG05           DSD Delivery Ti
      * Establish starting position
     C           KRSSG     SETLL@AKCPI1                    *
     C           KRSSG     READE@AKCPI1                  90*
      * Data record not found
     C   90                MOVEL'PRK1040' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Delivery Sched Cm DL - Delivery Sched Comment  * 
     C                     EXSR SHDLRC
      * Crt Delivery Sched Cm CR - Delivery Sched Comment  * 
     C                     EXSR SICRRC
     C           KRSSG     READE@AKCPI1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del Delivery Sched Cm DL - Delivery Sched Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AKCPI0
     C                     Z-ADDWFHONB    WGHONB           CC Company Numb
     C                     Z-ADDWFE0DT    WGE0DT           DSH Kill Date
     C                     Z-ADDWFE6DT    WGE6DT           DSD Delivery Da
     C                     Z-ADDWFAGTH    WGAGTH           DSD Delivery Ti
     C                     Z-ADDWFHZA1    WGHZA1           DSD Delivery Ti
     C                     Z-ADDWFIIA1    WGIIA1           DSC Line Number
      *
     C           KLDLSH    KLIST
     C                     KFLD           WGHONB           CC Company Numb
     C                     KFLD           WGE0DT           DSH Kill Date
     C                     KFLD           WGE6DT           DSD Delivery Da
     C                     KFLD           WGAGTH           DSD Delivery Ti
     C                     KFLD           WGHZA1           DSD Delivery Ti
     C                     KFLD           WGIIA1           DSC Line Number
     C           KLDLSH    CHAIN@AKCPI0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAKCPL0'MDACP
     C                     MOVEL'@AKCPI0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@AKCPI0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Delivery Sched Cm CR - Delivery Sched Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AKCPI0
     C                     Z-ADDWFHONB    WGHONB           CC Company Numb
     C                     Z-ADDWFE0DT    WGE0DT           DSH Kill Date
     C                     Z-ADDWFE6DT    WGE6DT           DSD Delivery Da
     C                     Z-ADDP2B4TH    WGAGTH           DSD Delivery Ti
     C                     Z-ADDYL0001    WGHZA1           DSD Delivery Ti
     C                     Z-ADDWFIIA1    WGIIA1           DSC Line Number
     C                     MOVELWFSKTX    WGSKTX           DSC Comment
     C                     MOVELWFAAVN    WGAAVN           RS User Changed
     C                     Z-ADDWFAADT    WGAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WGAMTM           RS Time Changed
     C                     MOVELWFAJST    WGAJST           RS Record Statu
     C                     MOVELWFAHVN    WGAHVN           RS Job
     C                     MOVELWFAGVN    WGAGVN           RS Program
     C                     MOVELWFABVN    WGABVN           RS User Added
     C                     Z-ADDWFABDT    WGABDT           RS Date Added
     C                     Z-ADDWFABTM    WGABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL##USR     WGABVN           RS User Added
     C                     Z-ADD##JDT     WGABDT           RS Date Added
     C                     Z-ADD##JTM     WGABTM           RS Time Added
     C                     MOVEL##PGM     WGAGVN           RS Program
     C                     MOVEL##JOB     WGAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WGHONB           CC Company Numb
     C                     KFLD           WGE0DT           DSH Kill Date
     C                     KFLD           WGE6DT           DSD Delivery Da
     C                     KFLD           WGAGTH           DSD Delivery Ti
     C                     KFLD           WGHZA1           DSD Delivery Ti
     C                     KFLD           WGIIA1           DSC Line Number
      * Check for duplicate primary key
     C           KLCRSI    SETLL@AKCPI0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1041' W0RTN   7
      * Send message 'Delivery Sched Comment EX'
     C                     MOVEL'PRK1041' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@AKCPI0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Clear Slot EXT   CH - Delivery Sched Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  20       DSD Scheduled H
     C                     Z-ADD*ZERO     WN0002  30       DSD Scheduled K
     C                     MOVEL*BLANK    WN0003  1        DSD Receiving S
     C                     MOVEL*BLANK    WN0004  1        DSD Kill Shift
     C                     MOVEL*BLANK    WN0005  1        DSD BOL Kill Sh
     C                     MOVEL*BLANK    WN0006 10        RS User Changed
     C                     Z-ADD*ZERO     WN0007  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0008  60       RS Time Changed
     C                     MOVEL*BLANK    WN0009  1        RS Record Statu
     C                     MOVEL*BLANK    WN0010 10        RS Job
     C                     MOVEL*BLANK    WN0011 10        RS Program
     C                     MOVEL*BLANK    WN0012 10        RS User Added
     C                     Z-ADD*ZERO     WN0013  70       RS Date Added
     C                     Z-ADD*ZERO     WN0014  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     Z-ADDWBE0DT    WCE0DT           DSH Kill Date
     C                     Z-ADDWBE6DT    WCE6DT           DSD Delivery Da
     C                     Z-ADDWBAGTH    WCAGTH           DSD Delivery Ti
     C                     Z-ADDWBHZA1    WCHZA1           DSD Delivery Ti
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCE0DT           DSH Kill Date
     C                     KFLD           WCE6DT           DSD Delivery Da
     C                     KFLD           WCAGTH           DSD Delivery Ti
     C                     KFLD           WCHZA1           DSD Delivery Ti
     C           KLCHSJ    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    YARDCS
      * Move non-key fields to @AECPIH
     C                     Z-ADD*ZERO     WCH1A1           DSD Farm Site C
     C                     MOVEL*BLANK    WCJ4CD    P      DSD Building
     C                     MOVEL*BLANK    WCJ5CD    P      DSD Room
     C                     MOVEL*BLANK    WCLBCD    P      DSD Sire Line C
     C                     MOVEL*BLANK    WCLCCD    P      DSD Hog Group C
     C                     Z-ADD*ZERO     WCIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WCH2A1           DSD Scheduled D
     C                     MOVEL*BLANK    WCK9CD    P      DSD Transportat
     C                     MOVEL*BLANK    WCK8CD    P      DSD Trucker Cod
     C                     MOVEL*BLANK    WCJ6CD    P      DSD Driver
     C                     MOVEL*BLANK    WCJ7CD    P      DSD Loading Cre
     C                     MOVEL'*ZERO'   WCMGCD    P      CHR Code
     C                     MOVELWBW1ST    WCW1ST    P      DSD Load Type
     C                     MOVEL'F'       WCW2ST    P      DSD Full/Split
     C                     Z-ADD*ZERO     WCH3A1           DSD Movement Nu
     C                     MOVEL*BLANK    WCMECD    P      DSD Truck ID
     C                     MOVEL*BLANK    WCMFCD    P      DSD Trailer ID
     C                     MOVEL'N'       WCW4ST    P      DSD Movement Pr
     C                     MOVELWUIXTX    WCXWST    P      DSD Sched Route
     C                     Z-ADD*ZERO     WCFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WCBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WCE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WCE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WCAITH           DSD Sch Start L
     C                     MOVEL'N'       WCXNST    P      DSD HPS Post St
     C                     MOVEL'N'       WCXTST    P      DSD HPE Post St
     C                     MOVEL'O'       WCXLST    P      DSD Lock Status
     C                     MOVELWUJ6TX    WCW0ST    P      DSD Source Type
     C                     MOVELWUIXTX    WCYEST    P      DSD Transfer St
     C                     Z-ADDWBFZDT    WCFZDT           DSD Unused Date
     C                     Z-ADDWBB1TH    WCB1TH           DSD Unused Time
     C                     MOVEL*BLANK    WCAACD    P      SR Source Code
     C                     MOVEL*BLANK    WCABCD    P      PD Producer Cod
     C                     MOVEL*BLANK    WCAECD    P      PL Location Cod
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv/Chg Bol F/DelvTimeRT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHHMNB           BOH Company Num
     C                     KFLD           WHBNNB           BOH Buy Order N
     C                     KFLD           WHBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WHHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WHBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WHBONB           BOL Load Number
      * Establish starting position
     C           KRSSK     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Buy Order LdDtTimeCH - Buy Order Load  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Buy Order LdDtTimeCH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0015  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0016  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0017  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0018  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0019  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0020  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0021  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0022  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0023  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0024  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0025  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0026  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0027  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0028  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0029 11        BOL Trailer
     C                     MOVEL*BLANK    WN0030  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0031  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0032  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0033  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0034  1        Reported to USD
     C                     MOVEL*BLANK    WN0035  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0036  1        BOL Status 4
     C                     MOVEL*BLANK    WN0037  2        BOL Status 5
     C                     MOVEL*BLANK    WN0038  2        BOL Status 6
     C                     MOVEL*BLANK    WN0039  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0040  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0041  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0042  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0043  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0044  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0045 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0046 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0047 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0048 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0049 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0050  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0051  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0052  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0053  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0054  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0055  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0056  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0057  6        PL Location Cod
     C                     MOVEL*BLANK    WN0058 10        RS User Changed
     C                     Z-ADD*ZERO     WN0059  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0060  60       RS Time Changed
     C                     MOVEL*BLANK    WN0061  1        RS Record Statu
     C                     MOVEL*BLANK    WN0062 10        RS Job
     C                     MOVEL*BLANK    WN0063 10        RS Program
     C                     MOVEL*BLANK    WN0064 10        RS User Added
     C                     Z-ADD*ZERO     WN0065  70       RS Date Added
     C                     Z-ADD*ZERO     WN0066  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C           KLCHSL    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YBRDCS
      * Move non-key fields to @AXCPBY
     C                     Z-ADDP2B4TH    WIABTH           BOL Pln Delv St
     C                     Z-ADDP2B4TH    WIACTH           BOL Pln Delv En
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WIAAVN           RS User Changed
     C                     Z-ADD##JDT     WIAADT           RS Date Changed
     C                     Z-ADD##JTM     WIAMTM           RS Time Changed
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WAE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WAAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WAHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WAH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WAH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WAIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WAH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WAIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WAH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WAFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WABOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WAE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WAAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WAE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WAAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WAFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WAB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WDE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WDAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WDHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WDH5A1           DSS Split Seque
     C                     Z-ADD*ZERO     WDH6A1           DSS Scheduled H
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHONB           CC Company Numb
     C                     Z-ADD*ZERO     WFE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WFE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WFAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WFHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WFIIA1           DSC Line Number
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field Blank Usr 2
     C                     MOVEL*BLANK    WUJ6TX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WHABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WHACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WHBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WHCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WHAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WHAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WHATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WHDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WHDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WHGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WHBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WHLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WHLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WHJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WHKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WHIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WHKJIO           BOL Unused Nbr
     C                     Z-ADD*ZERO     WHIOJR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WHEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WHITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WHODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WHRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WHOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WHD0DT           BOL Unused Date
     C                     Z-ADD*ZERO     WHD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WHD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WHD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WHD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Delivery Time Seq New Usr
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field DSD Scheduled Hour
     C                     Z-ADD*ZERO     YL0002  20
      *================================================================
     CSR         ZZEXIT    ENDSR
