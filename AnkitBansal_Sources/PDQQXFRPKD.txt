     H/TITLE Prc Inv Adjustments    XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 11/12/99  Time  : 08:07:03
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJTCPL2IF  E           K        DISK
      * RSQ : AS Inventory Adjustment   Prd/Frwhs/Towhs/Prddte/S
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company/Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : IC Item Balance           Acitve records only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : Application Profile       Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAB0REL0IF  E           K        DISK                      A
      * UPD : IC Item Balance           Update index
      *
     FPDJTCPL1UF  E           K        DISK
      * UPD : AS Inventory Adjustment   Update index
      *
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1   4  6   @CN    25
     I@JTCPA4
      * AS Inventory Adjustment   Prd/Frwhs/Towhs/Prddte/S
      * Renamed input format fields
     I              JTASPD                          WAASPD
     I              JTU5CD                          WAU5CD
     I              JTU6CD                          WAU6CD
     I              JTHHDT                          WAHHDT
     I              JTZAST                          WAZAST
     I              JTASQY                          WAASQY
     I              JTEMWG                          WAEMWG
     I              JTTWCD                          WATWCD
     I              JTZBST                          WAZBST
     I              JTZCST                          WAZCST
     I              JTZDST                          WAZDST
     I              JTZEST                          WAZEST
     I              JTXOCD                          WAXOCD
     I              JTXXCD                          WAXXCD
     I              JTTVCD                          WATVCD
      *
     I@BZREJU
      * Company/Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@B0REYY
      * IC Item Balance           Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WDAIC3
     I              B0HGCD                          WDHGCD
     I              B0AJCD                          WDAJCD
     I              B0AGCS                          WDAGCS
     I              B0AECS                          WDAECS
     I              B0BACS                          WDBACS
     I              B0BBCS                          WDBBCS
     I              B0CBPR                          WDCBPR
     I              B0GUDT                          WDGUDT
     I              B0XYST                          WDXYST
     I              B0CTPR                          WDCTPR
     I              B0G4DT                          WDG4DT
     I              B0BOWG                          WDBOWG
     I              B0DDQT                          WDDDQT
     I              B0DEQT                          WDDEQT
     I              B0DFQT                          WDDFQT
     I              B0HDQT                          WDHDQT
     I              B0HEQT                          WDHEQT
     I              B0AJQT                          WDAJQT
     I              B0AQQT                          WDAQQT
     I              B0AUQT                          WDAUQT
     I              B0EMQT                          WDEMQT
     I              B0DOQT                          WDDOQT
     I              B0ATNA                          WDATNA
     I              B0AKDT                          WDAKDT
     I              B0ANDT                          WDANDT
     I              B0IDVA                          WDIDVA
     I              B0JVST                          WDJVST
     I              B0BZPC                          WDBZPC
     I              B0DGQT                          WDDGQT
     I              B0DIDT                          WDDIDT
     I              B0ALCD                          WDALCD
     I              B0BFDY                          WDBFDY
     I              B0DJDT                          WDDJDT
     I              B0BGDY                          WDBGDY
     I              B0DKDT                          WDDKDT
     I              B0J2ST                          WDJ2ST
     I              B0DJQT                          WDDJQT
     I              B0BNWG                          WDBNWG
     I              B0DLDT                          WDDLDT
     I              B0DPQT                          WDDPQT
     I              B0DQQT                          WDDQQT
     I              B0DMDT                          WDDMDT
     I              B0M0ST                          WDM0ST
     I              B0J9ST                          WDJ9ST
     I              B0KBST                          WDKBST
     I              B0AKC8                          WDAKC8
     I              B0RINB                          WDRINB
     I              B0RHNB                          WDRHNB
     I              B0RGNB                          WDRGNB
     I              B0UVST                          WDUVST
     I              B0UWST                          WDUWST
     I              B0UXST                          WDUXST
     I              B0VSST                          WDVSST
     I              B0AATM                          WDAATM
     I              B0AYNA                          WDAYNA
     I              B0A0NA                          WDA0NA
     I              B0AXDT                          WDAXDT
      *
     I@B0REJT
      * IC Item Balance           Update index
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WFAIC3
     I              AFBCDT                          WFBCDT
     I              AFCQNB                          WFCQNB
     I              AFESNB                          WFESNB
     I              AFETNB                          WFETNB
     I              AFBZNB                          WFBZNB
     I              AFA9ST                          WFA9ST
     I              AFEINB                          WFEINB
     I              AFC5ST                          WFC5ST
     I              AFAQNB                          WFAQNB
     I              AFCMST                          WFCMST
     I              AFV9ST                          WFV9ST
     I              AFWAST                          WFWAST
     I              AFX2ST                          WFX2ST
     I              AFUVST                          WFUVST
     I              AFUWST                          WFUWST
     I              AFUXST                          WFUXST
     I              AFAATM                          WFAATM
     I              AFAYNA                          WFAYNA
     I              AFA0NA                          WFA0NA
     I              AFAXDT                          WFAXDT
      *
     I@JTCPA0
      * AS Inventory Adjustment   Update index
      * Renamed input format fields
     I              JTASPD                          WGASPD
     I              JTU5CD                          WGU5CD
     I              JTU6CD                          WGU6CD
     I              JTHHDT                          WGHHDT
     I              JTZAST                          WGZAST
     I              JTASQY                          WGASQY
     I              JTEMWG                          WGEMWG
     I              JTTWCD                          WGTWCD
     I              JTZBST                          WGZBST
     I              JTZCST                          WGZCST
     I              JTZDST                          WGZDST
     I              JTZEST                          WGZEST
     I              JTXOCD                          WGXOCD
     I              JTXXCD                          WGXXCD
     I              JTTVCD                          WGTVCD
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WHAJVN
     I              DRAUNA                          WHAUNA
     I              DRB8NA                          WHB8NA
     I              DRAHVN                          WHAHVN
     I              DRI6ST                          WHI6ST
     I              DRI7ST                          WHI7ST
     I              DRXMST                          WHXMST
     I              DRXNST                          WHXNST
     I              DRI8ST                          WHI8ST
     I              DRNLNB                          WHNLNB
     I              DRMPNA                          WHMPNA
     I              DRBCCD                          WHBCCD
     I              DRAIC3                          WHAIC3
     I              DRDQCD                          WHDQCD
     I              DRDRCD                          WHDRCD
     I              DRAJCD                          WHAJCD
     I              DRBUVN                          WHBUVN
     I              DRUVST                          WHUVST
     I              DRUWST                          WHUWST
     I              DRUXST                          WHUXST
     I              DRAATM                          WHAATM
     I              DRAYNA                          WHAYNA
     I              DRA0NA                          WHA0NA
     I              DRAXDT                          WHAXDT
      *
     I@DTRETE
      * Application Profile       Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WIAJVN
     I              DTDNCD                          WIDNCD
     I              DTAIC3                          WIAIC3
     I              DTDQCD                          WIDQCD
     I              DTDRCD                          WIDRCD
     I              DTAJCD                          WIAJCD
     I              DTJFST                          WIJFST
     I              DTUVST                          WIUVST
     I              DTUWST                          WIUWST
     I              DTUXST                          WIUXST
     I              DTAATM                          WIAATM
     I              DTAYNA                          WIAYNA
     I              DTA0NA                          WIA0NA
     I              DTAXDT                          WIAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WJAIC3
     I              ABADTX                          WJADTX
     I              ABACNA                          WJACNA
     I              ABADNA                          WJADNA
     I              ABAENA                          WJAENA
     I              ABAJNA                          WJAJNA
     I              ABBTTX                          WJBTTX
     I              ABBVTX                          WJBVTX
     I              ABBWTX                          WJBWTX
     I              ABA2NA                          WJA2NA
     I              ABABTX                          WJABTX
     I              ABBGCD                          WJBGCD
     I              ABKXCD                          WJKXCD
     I              ABUVST                          WJUVST
     I              ABUWST                          WJUWST
     I              ABUXST                          WJUXST
     I              ABVSST                          WJVSST
     I              ABAATM                          WJAATM
     I              ABAYNA                          WJAYNA
     I              ABA0NA                          WJA0NA
     I              ABAXDT                          WJAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WKDNCD
     I              DNAUNA                          WKAUNA
     I              DNVKST                          WKVKST
     I              DNRSCD                          WKRSCD
     I              DNUVST                          WKUVST
     I              DNUWST                          WKUWST
     I              DNUXST                          WKUXST
     I              DNAATM                          WKAATM
     I              DNAYNA                          WKAYNA
     I              DNA0NA                          WKA0NA
     I              DNAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB01    E DSCAB0REL0
      * UPD : IC Item Balance           Update index
      * Renamed input format fields
     I              B0AIC3                          WEAIC3
     I              B0HGCD                          WEHGCD
     I              B0AJCD                          WEAJCD
     I              B0AGCS                          WEAGCS
     I              B0AECS                          WEAECS
     I              B0BACS                          WEBACS
     I              B0BBCS                          WEBBCS
     I              B0CBPR                          WECBPR
     I              B0GUDT                          WEGUDT
     I              B0XYST                          WEXYST
     I              B0CTPR                          WECTPR
     I              B0G4DT                          WEG4DT
     I              B0BOWG                          WEBOWG
     I              B0DDQT                          WEDDQT
     I              B0DEQT                          WEDEQT
     I              B0DFQT                          WEDFQT
     I              B0HDQT                          WEHDQT
     I              B0HEQT                          WEHEQT
     I              B0AJQT                          WEAJQT
     I              B0AQQT                          WEAQQT
     I              B0AUQT                          WEAUQT
     I              B0EMQT                          WEEMQT
     I              B0DOQT                          WEDOQT
     I              B0ATNA                          WEATNA
     I              B0AKDT                          WEAKDT
     I              B0ANDT                          WEANDT
     I              B0IDVA                          WEIDVA
     I              B0JVST                          WEJVST
     I              B0BZPC                          WEBZPC
     I              B0DGQT                          WEDGQT
     I              B0DIDT                          WEDIDT
     I              B0ALCD                          WEALCD
     I              B0BFDY                          WEBFDY
     I              B0DJDT                          WEDJDT
     I              B0BGDY                          WEBGDY
     I              B0DKDT                          WEDKDT
     I              B0J2ST                          WEJ2ST
     I              B0DJQT                          WEDJQT
     I              B0BNWG                          WEBNWG
     I              B0DLDT                          WEDLDT
     I              B0DPQT                          WEDPQT
     I              B0DQQT                          WEDQQT
     I              B0DMDT                          WEDMDT
     I              B0M0ST                          WEM0ST
     I              B0J9ST                          WEJ9ST
     I              B0KBST                          WEKBST
     I              B0AKC8                          WEAKC8
     I              B0RINB                          WERINB
     I              B0RHNB                          WERHNB
     I              B0RGNB                          WERGNB
     I              B0UVST                          WEUVST
     I              B0UWST                          WEUWST
     I              B0UXST                          WEUXST
     I              B0VSST                          WEVSST
     I              B0AATM                          WEAATM
     I              B0AYNA                          WEAYNA
     I              B0A0NA                          WEA0NA
     I              B0AXDT                          WEAXDT
      *
     IQPDJT1    E DSPDJTCPL1
      * UPD : AS Inventory Adjustment   Update index
      * Renamed input format fields
     I              JTASPD                          WGASPD
     I              JTU5CD                          WGU5CD
     I              JTU6CD                          WGU6CD
     I              JTHHDT                          WGHHDT
     I              JTZAST                          WGZAST
     I              JTASQY                          WGASQY
     I              JTEMWG                          WGEMWG
     I              JTTWCD                          WGTWCD
     I              JTZBST                          WGZBST
     I              JTZCST                          WGZCST
     I              JTZDST                          WGZDST
     I              JTZEST                          WGZEST
     I              JTXOCD                          WGXOCD
     I              JTXXCD                          WGXXCD
     I              JTTVCD                          WGTVCD
      *
     IYARDCS      DS                             45
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Inv Adjustments    XF
      * Prc Inv Adjustments    RT - AS Inventory Adjustment  * 
     C                     EXSR SARVGN
      *
     C                     MOVEL*BLANK    WN0027 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0027           User Profile Na
      *
     C                     MOVEL*BLANK    WN0028 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RTV Program Setup      RT - User Profile Control  * 
     C                     EXSR SJRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0028    IFEQ *BLANK                     *IF
      * Retrieve Appl. Profile - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0027    WL0008    P      User Profile Na
     C                     MOVEL'OMS'     WL0009    P      Application Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WUAIC3           Company Number
     C                     MOVELWL0011    WUAJCD    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Appl. Profile - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0028    WL0008    P      User Profile Na
     C                     MOVEL'OMS'     WL0009    P      Application Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WUAIC3           Company Number
     C                     MOVELWL0011    WUAJCD    P      Warehouse Code
     C                     END                             *FI
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUAIC3           Company Number
     C                     MOVELWUWVST    WUWVST           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Text String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    WUBXTX           System Value Al
      * Exc Upd Last Dt Cllctn XF - AS Last Data Collection  * 
     C                     CALL 'PDTCXFR'              90  Exc Upd Last Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0113  30       Company Number
     C                     PARM 'INVADJ'  WQ0114  6        AS Data Collect
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prc Inv Adjustments    RT - AS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        AS Error Code
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     MOVEL*BLANK    WN0003  1        First Time Flag
     C                     MOVEL*BLANK    WN0004  3        Warehouse Code
     C                     MOVEL*BLANK    WN0005  1        Inventory Trans
     C                     MOVEL*BLANK    WN0006  2        Inventory Trans
     C                     Z-ADD*ZERO     WN0007  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0008  70       Production Date
     C                     MOVEL*BLANK    WN0009 30        Description
     C                     Z-ADD*ZERO     WN0010 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0011 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0012  70       Label Date
     C                     MOVEL*BLANK    WN0013  1        Error Status
     C                     MOVEL*BLANK    WN0014  1        AS Inventory Pr
     C                     MOVEL*BLANK    WN0015  1        Production Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD360       WN0002           Company Number
      * Establish starting position
     C           *LOVAL    SETLL@JTCPA4                    *
     C                     READ @JTCPA4                  90*
      * Data record not found
     C   90                MOVEL'USR1991' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Trans type, item, whse and customer must exists to process record
     C                     MOVEL'N'       WN0013           Error Status
      * If trans type not found error EQ yes
      * CASE: DB1.AS Transaction Type is *ALL values
     C           WATWCD    IFEQ 'DEL'                      *IF
     C           WATWCD    OREQ 'DLR'
     C           WATWCD    OREQ 'TRF'
     C           WATWCD    OREQ 'RET'
     C           WATWCD    OREQ 'IDL'
     C           WATWCD    OREQ 'IAD'
     C           WATWCD    OREQ 'SAD'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     Z-ADD*ZERO     WUHGCD           Item Code
     C                     MOVE WAASPD    WUHGCD           Item Code
      * Val Item/Rtv Whse,PDC  RT - Company/Item  * 
     C                     EXSR SBRVGN
      * If item is not found error EQ yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Fill in warehouse
      * CASE: DB1.AS From Warehouse ID Code EQ WRK.BLANK
     C           WAU5CD    IFEQ WUGSTX                     *IF
      * default whse from company/item
     C                     MOVELWUAJCD    WN0004           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWAU5CD    WN0004           Warehouse Code
     C                     END                             *FI
      * Val Accu-Sort Whse     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * If warehouse is not found error EQ yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * Validate Unit Cost
      * CASE: PAR.Error Status is no
     C           WN0013    IFEQ 'N'                        *IF
      * CASE: DB1.AS Transaction Type is Transfer
     C           WATWCD    IFEQ 'TRF'                      *IF
      * From Whse
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0002           Company Number
     C                     Z-ADDWUHGCD    WL0003           Item Code
     C                     MOVELWAU5CD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUAGCS           Unit Cost Per P
      * If unit cost = 0, error
      * CASE: WRK.Unit Cost Per Pound EQ WRK.ZERO
     C           WUAGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
      * To Whse
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0002           Company Number
     C                     Z-ADDWUHGCD    WL0003           Item Code
     C                     MOVELWAU6CD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUAGCS           Unit Cost Per P
      * Create IC Item Balance if it does not exist.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
     C                     EXSR SERVGN
      * Crt Item Balance       CR - IC Item Balance  * 
     C                     EXSR SFCRRC
     C                     Z-ADD.01       WUAGCS           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * If unit cost = 0, error
      * CASE: WRK.Unit Cost Per Pound EQ WRK.ZERO
     C           WUAGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0002           Company Number
     C                     Z-ADDWUHGCD    WL0003           Item Code
     C                     MOVELWN0004    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUAGCS           Unit Cost Per P
      * If unit cost = 0, error
      * CASE: WRK.Unit Cost Per Pound EQ WRK.ZERO
     C           WUAGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Error if no shift entered
      * CASE: DB1.AS Shift Number is Not Entered
     C           WAXOCD    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
      * Validate production date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     MOVE WAXXCD    WUELDT           Production Date
     C           WUELDT    MULT 10000.01  WUTTNB           Calc 6
     C                     MOVE WUTTNB    WUELDT           Production Date
      * Set Century.
      * CASE: WRK.Production Date is < 410101
     C           WUELDT    IFLT 410101                     *IF
     C                     ADD  1000000   WUELDT           Production Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0006           Company Number
     C                     Z-ADDWUELDT    WL0007           Post to G/L Dat
     C                     EXSR SGRVGN
      * Invalid production date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * Validate label date if production date control is yes
      * CASE: PAR.Production Date Control is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     MOVE WAHHDT    WUK7DT           Label Date
     C           WUK7DT    MULT 10000.01  WUTTNB           Calc 6
     C                     MOVE WUTTNB    WUK7DT           Label Date
      * Set Century.
      * CASE: WRK.Label Date is < 410101
     C           WUK7DT    IFLT 410101                     *IF
     C                     ADD  1000000   WUK7DT           Label Date
     C                     END                             *FI
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0006           Company Number
     C                     Z-ADDWUK7DT    WL0007           Post to G/L Dat
     C                     EXSR SGRVGN
      * Invalid label date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * If transfer transaction type validate warehouses
      * CASE: DB1.AS Transaction Type is Transfer
     C           WATWCD    IFEQ 'TRF'                      *IF
      * Validate from warehouse
      * CASE: DB1.AS From Warehouse ID Code is Entered
     C           WAU5CD    IFNE *BLANK                     *IF
      * Val Accu-Sort Whse     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAU5CD    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * If warehouse is not found error EQ yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
      * Validate to warehouse
      * CASE: DB1.AS To Warehouse ID Code is Entered
     C           WAU6CD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
     C                     EXSR SHRVGN
      * If warehouse is not found error EQ yes
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WN0013           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If no errors, process record
      * CASE: PAR.Error Status is no
     C           WN0013    IFEQ 'N'                        *IF
      * Date Manipulation
      * CASE: PAR.Production Date Control is no
     C           WN0015    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WN0008           Production Date
     C                     Z-ADD*ZERO     WN0012           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WAHHDT    WN0012           Label Date
     C           WN0012    MULT 10000.01  WUTTNB           Calc 6
     C                     MOVE WUTTNB    WN0012           Label Date
      * Set Century.
      * CASE: PAR.Label Date is < 410101
     C           WN0012    IFLT 410101                     *IF
     C                     ADD  1000000   WN0012           Label Date
     C                     END                             *FI
     C                     MOVE WAXXCD    WN0008           Production Date
     C           WN0008    MULT 10000.01  WUTTNB           Calc 6
     C                     MOVE WUTTNB    WN0008           Production Date
      * Set Century.
      * CASE: PAR.Production Date is < 410101
     C           WN0008    IFLT 410101                     *IF
     C                     ADD  1000000   WN0008           Production Date
     C                     END                             *FI
     C                     END                             *FI
      * --- Commented out 11/12/99 -Purva C9123 ---
     C                     Z-ADD##JDT     WN0007           Transaction Dat
      * -------------------------------------------
      * Update inventory balance files according to transaction type
      * CASE: DB1.AS Transaction Type is Delete
     C           WATWCD    IFEQ 'DEL'                      *IF
     C                     MOVEL'I'       WN0005           Inventory Trans
     C                     MOVEL*BLANK    WN0006           Inventory Trans
     C                     MOVEL'I'       WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
      * PAR.Description = Condition name of PAR.Inventory Trans. Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1162839   Y2LSNO  70       List number
     C                     PARM WN0006    W0INVL 25        Inventory Trans
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0009    PARM           W0CNNM 25        Description
      *
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WN0010           Transaction Qua
      * Upd Balances Issue/Adj XF - IC Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0001  30       Company Number
     C                     PARM WUHGCD    WQ0002  70       Item Code
     C                     PARM WN0004    WQ0003  3        Warehouse Code
     C                     PARM WN0005    WQ0004  1        Inventory Trans
     C                     PARM WN0006    WQ0005  2        Inventory Trans
     C                     PARM WN0007    WQ0006  70       Transaction Dat
     C                     PARM WN0008    WQ0007  70       Production Date
     C                     PARM 'PL'      WQ0008  2        Item Transactio
     C                     PARM WN0009    WQ0009 30        Description
     C                     PARM WATWCD    WQ0010  3        Reason Code
     C                     PARM *ZERO     WQ0011  70       Order Number
     C                     PARM WAXOCD    WQ0012  1        Shift Number
     C                     PARM WN0012    WQ0013  70       Label Date
     C                     PARM WN0011    WQ0014 112       USR Weight Accu
     C                     PARM WN0010    WQ0015 112       Transaction Qty
     C                     PARM 'N'       WQ0016  1        USR Unship Flag
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Shipping Add
     C           WATWCD    IFEQ 'SAD'                      *IF
     C                     MOVEL'A'       WN0005           Inventory Trans
     C                     MOVEL*BLANK    WN0006           Inventory Trans
     C                     MOVEL'A'       WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
      * PAR.Description = Condition name of PAR.Inventory Trans. Type
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1162839   Y2LSNO  70       List number
     C                     PARM WN0006    W0INVL 25        Inventory Trans
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0009    PARM           W0CNNM 25        Description
      *
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WN0010           Transaction Qua
      * Upd Balances Issue/Adj XF - IC Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0017  30       Company Number
     C                     PARM WUHGCD    WQ0018  70       Item Code
     C                     PARM WN0004    WQ0019  3        Warehouse Code
     C                     PARM WN0005    WQ0020  1        Inventory Trans
     C                     PARM WN0006    WQ0021  2        Inventory Trans
     C                     PARM WN0007    WQ0022  70       Transaction Dat
     C                     PARM WN0008    WQ0023  70       Production Date
     C                     PARM 'PL'      WQ0024  2        Item Transactio
     C                     PARM WN0009    WQ0025 30        Description
     C                     PARM WATWCD    WQ0026  3        Reason Code
     C                     PARM *ZERO     WQ0027  70       Order Number
     C                     PARM WAXOCD    WQ0028  1        Shift Number
     C                     PARM WN0012    WQ0029  70       Label Date
     C                     PARM WN0011    WQ0030 112       USR Weight Accu
     C                     PARM WN0010    WQ0031 112       Transaction Qty
     C                     PARM 'N'       WQ0032  1        USR Unship Flag
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Delete for Rework
     C           WATWCD    IFEQ 'DLR'                      *IF
      * *** a rework should be a negative receipt ***
     C                     MOVEL'R'       WN0005           Inventory Trans
     C                     MOVEL'RR'      WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
      * make weight negative, since this is a negative receipt
     C           *ZERO     SUB  WN0011    WN0011           Transaction Wei
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,01    WN0009           Description
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WUA5QT           Transaction Qua
      * make quantity negative, since this is a negative receipt
     C           *ZERO     SUB  WUA5QT    WN0010           Transaction Qua
      * Prc Create Dtl Receipt XF - IC Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0033  30       Company Number
     C                     PARM WUHGCD    WQ0034  70       Item Code
     C                     PARM WN0004    WQ0035  3        Warehouse Code
     C                     PARM WN0005    WQ0036  1        Inventory Trans
     C                     PARM WN0006    WQ0037  2        Inventory Trans
     C                     PARM WN0007    WQ0038  70       Transaction Dat
     C                     PARM WN0008    WQ0039  70       Production Date
     C                     PARM WN0009    WQ0040 30        Description
     C                     PARM WN0010    WQ0041 112       Transaction Qua
     C                     PARM WN0011    WQ0042 112       Transaction Wei
     C                     PARM WATWCD    WQ0043  3        Reason Code
     C                     PARM WAXOCD    WQ0044  1        Shift Number
     C                     PARM WN0012    WQ0045  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Transfer
     C           WATWCD    IFEQ 'TRF'                      *IF
     C                     MOVEL'T'       WN0005           Inventory Trans
     C                     MOVEL'TW'      WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WN0010           Transaction Qua
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,02    WN0009           Description
      * Upd Balances Transfer  XF - IC Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0046  30       Company Number
     C                     PARM WUHGCD    WQ0047  70       Item Code
     C                     PARM WAU5CD    WQ0048  3        Warehouse Code
     C                     PARM WN0005    WQ0049  1        Inventory Trans
     C                     PARM WN0006    WQ0050  2        Inventory Trans
     C                     PARM WN0007    WQ0051  70       Transaction Dat
     C                     PARM WN0008    WQ0052  70       Production Date
     C                     PARM 'PL'      WQ0053  2        Item Transactio
     C                     PARM WN0009    WQ0054 30        Description
     C                     PARM WATWCD    WQ0055  3        Reason Code
     C                     PARM *ZERO     WQ0056  70       Order Number
     C                     PARM WAXOCD    WQ0057  1        Shift Number
     C                     PARM WN0012    WQ0058  70       Label Date
     C                     PARM WAU6CD    WQ0059  3        USR Warehouse C
     C                     PARM WN0011    WQ0060 112       USR Weight Accu
     C                     PARM WN0010    WQ0061 112       USR Quantity
     C                     PARM 'N'       WQ0062  1        USR Unship Flag
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Return
     C           WATWCD    IFEQ 'RET'                      *IF
     C                     MOVEL'R'       WN0005           Inventory Trans
     C                     MOVEL*BLANK    WN0006           Inventory Trans
     C                     MOVEL'R'       WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,03    WN0009           Description
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WUA5QT           Transaction Qua
      * Prc Create Dtl Receipt XF - IC Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0063  30       Company Number
     C                     PARM WUHGCD    WQ0064  70       Item Code
     C                     PARM WN0004    WQ0065  3        Warehouse Code
     C                     PARM WN0005    WQ0066  1        Inventory Trans
     C                     PARM WN0006    WQ0067  2        Inventory Trans
     C                     PARM WN0007    WQ0068  70       Transaction Dat
     C                     PARM WN0008    WQ0069  70       Production Date
     C                     PARM WN0009    WQ0070 30        Description
     C                     PARM WUA5QT    WQ0071 112       Transaction Qua
     C                     PARM WN0011    WQ0072 112       Transaction Wei
     C                     PARM WATWCD    WQ0073  3        Reason Code
     C                     PARM WAXOCD    WQ0074  1        Shift Number
     C                     PARM WN0012    WQ0075  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Physical Inventory Adjust
     C           WATWCD    IFEQ 'IAD'                      *IF
     C                     MOVEL'A'       WN0005           Inventory Trans
     C                     MOVEL'AP'      WN0006           Inventory Trans
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     Z-ADD*ZERO     WUTVNB           Calc 7
     C                     MOVEL*BLANK    WURZCD           @Code 3A
     C                     MOVEL'-'       WURZCD           @Code 3A
      * Check for negative quantity done is issue/adjust xf
      * Check for negative weight
     C                     Z-ADD1         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAEMWG:ZQ WUEZTX    P  90  USR Work Field
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Set Calc 7
      * CASE: WRK.USR Work Field 3A EQ WRK.@Code 3A
     C           WUEZTX    IFEQ WURZCD                     *IF
     C                     Z-ADD6         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWAEMWG:ZQ WUEIWG    P  90  @AS Weight  7.0
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WUEIWG:ZQ WUEMWG    P      AS Total Net We
     C                     MOVE WUEMWG    WUTVNB           Calc 7
     C           *ZERO     SUB  WUTVNB    WUTVNB           Calc 7
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C                     END                             *FI
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,04    WN0009           Description
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WN0010           Transaction Qua
      * UPD Backout Spec'l Adj XF - IC Transaction Detail  * 
     C                     CALL 'PDLHXFR'              90  UPD Backout Spe
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0076  30       Company Number
     C                     PARM WUHGCD    WQ0077  70       Item Code
     C                     PARM WN0004    WQ0078  3        Warehouse Code
     C                     PARM 'A'       WQ0079  1        Inventory Trans
     C                     PARM 'SA'      WQ0080  2        Inventory Trans
     C                     PARM WN0007    WQ0081  70       Transaction Dat
     C                     PARM WN0008    WQ0082  70       Production Date
     C                     PARM WN0012    WQ0083  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Upd Balances Issue/Adj XF - IC Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0084  30       Company Number
     C                     PARM WUHGCD    WQ0085  70       Item Code
     C                     PARM WN0004    WQ0086  3        Warehouse Code
     C                     PARM WN0005    WQ0087  1        Inventory Trans
     C                     PARM WN0006    WQ0088  2        Inventory Trans
     C                     PARM WN0007    WQ0089  70       Transaction Dat
     C                     PARM WN0008    WQ0090  70       Production Date
     C                     PARM 'PL'      WQ0091  2        Item Transactio
     C                     PARM WN0009    WQ0092 30        Description
     C                     PARM WATWCD    WQ0093  3        Reason Code
     C                     PARM *ZERO     WQ0094  70       Order Number
     C                     PARM WAXOCD    WQ0095  1        Shift Number
     C                     PARM WN0012    WQ0096  70       Label Date
     C                     PARM WN0011    WQ0097 112       USR Weight Accu
     C                     PARM WN0010    WQ0098 112       Transaction Qty
     C                     PARM 'N'       WQ0099  1        USR Unship Flag
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: DB1.AS Transaction Type is Inventory Item Delete
     C           WATWCD    IFEQ 'IDL'                      *IF
      * *** a inventory item delete should be a negative receipt ***
     C                     MOVEL'R'       WN0005           Inventory Trans
     C                     MOVEL'RR'      WN0006           Inventory Trans
     C                     MOVE WAEMWG    WUTVNB           Calc 7
     C           WUTVNB    DIV  10        WN0011    H      Transaction Wei
      * make weight negative, since this is a negative receipt
     C           *ZERO     SUB  WN0011    WN0011           Transaction Wei
     C                     MOVEL*BLANK    WN0009           Description
     C                     MOVEL@CN,01    WN0009           Description
     C                     Z-ADD*ZERO     WUTSNB           Calc 5
     C                     MOVE WAASQY    WUTSNB           Calc 5
     C                     Z-ADDWUTSNB    WUA5QT           Transaction Qua
      * make quantity negative, since this is a negative receipt
     C           *ZERO     SUB  WUA5QT    WN0010           Transaction Qua
      * Prc Create Dtl Receipt XF - IC Transaction Detail  * 
     C                     CALL 'CAALXFR'              90  Prc Create Dtl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0002    WQ0100  30       Company Number
     C                     PARM WUHGCD    WQ0101  70       Item Code
     C                     PARM WN0004    WQ0102  3        Warehouse Code
     C                     PARM WN0005    WQ0103  1        Inventory Trans
     C                     PARM WN0006    WQ0104  2        Inventory Trans
     C                     PARM WN0007    WQ0105  70       Transaction Dat
     C                     PARM WN0008    WQ0106  70       Production Date
     C                     PARM WN0009    WQ0107 30        Description
     C                     PARM WN0010    WQ0108 112       Transaction Qua
     C                     PARM WN0011    WQ0109 112       Transaction Wei
     C                     PARM WATWCD    WQ0110  3        Reason Code
     C                     PARM WAXOCD    WQ0111  1        Shift Number
     C                     PARM WN0012    WQ0112  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAALXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0001           AS Error Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0001           AS Error Code
     C                     END                             *FI
      * Change inventory process flag
     C                     MOVEL'Y'       WN0014           AS Inventory Pr
      * Chg Inv Process Code   CH - AS Inventory Adjustment  * 
     C                     EXSR SICHRC
     C                     READ @JTCPA4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Item/Rtv Whse,PDC  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0002    WBAIC3           Company Number
     C                     Z-ADDWUHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0015           Production Date
     C                     MOVEL*BLANK    WUAJCD           Default Warehou
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBFZST    WN0015           Production Date
     C                     MOVELWBQ1CD    WUAJCD           Default Warehou
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val Accu-Sort Whse     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Trans Contol AS400/Plant is Plant
     C           WCXUST    IFEQ 'P'                        *IF
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0002    WDAIC3           Company Number
     C                     Z-ADDWL0003    WDHGCD           Item Code
     C                     MOVELWL0004    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Unit Cost Per P
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAGCS    WL0005           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0002    WBAIC3           Company Number
     C                     Z-ADDWUHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBRINB    WURINB           Item Structure
     C                     Z-ADDWBRHNB    WURHNB           Item Structure
     C                     Z-ADDWBRGNB    WURGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0016  60       Job Time
     C                     MOVEL*BLANK    WN0017 10        User Id
     C                     MOVEL*BLANK    WN0018 10        Job Name
     C                     Z-ADD*ZERO     WN0019  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWN0002    WEAIC3           Company Number
     C                     Z-ADDWUHGCD    WEHGCD           Item Code
     C                     MOVELWAU6CD    WEAJCD           Warehouse Code
     C                     Z-ADD.01       WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEBACS           Cost per Primar
     C                     Z-ADD*ZERO     WEBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WECBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WEGUDT           Revaluation Eff
     C                     MOVEL*BLANK    WEXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WECTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WEG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WEBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WEDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WEDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WEDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WEAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WEEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WEDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WEATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WEAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     MOVEL'N'       WEJVST           Inventory Plann
     C                     Z-ADD*ZERO     WEBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WEDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WEDIDT           Stock Out Date
     C                     MOVEL*BLANK    WEALCD           Buyer Code
     C                     Z-ADD*ZERO     WEBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WEDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WEBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WEDKDT           Lead Time - Dat
     C                     MOVEL*BLANK    WEJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WEDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WEBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WEDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WEDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WEDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WEDMDT           Last Physical C
     C                     MOVEL'N'       WEM0ST           Requisition Mod
     C                     MOVEL*BLANK    WEJ9ST           Cost Update Pen
     C                     MOVEL*BLANK    WEKBST           Post G/L Status
     C                     Z-ADD*ZERO     WEAKC8           Vendor - Item/W
     C                     Z-ADDWURINB    WERINB           Item Structure
     C                     Z-ADDWURHNB    WERHNB           Item Structure
     C                     Z-ADDWURGNB    WERGNB           Item Structure
     C                     MOVEL*BLANK    WEUVST           EDI Status 1
     C                     MOVEL*BLANK    WEUWST           EDI Status 2
     C                     MOVEL*BLANK    WEUXST           EDI Status 3
     C                     MOVEL'A'       WEVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WEAATM' defaulted for 'Job Time'.
      * Field '(DB1) WEAYNA' defaulted for 'User Id'.
      * Field '(DB1) WEA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WEAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSF    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'IC Item Balance        EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0006    WFAIC3           Company Number
     C                     Z-ADDWL0007    WFBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSG     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAU5CD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Inv Process Code   CH - AS Inventory Adjustment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  5        AS Box Quantity
     C                     MOVEL*BLANK    WN0021  7        AS Total Net We
     C                     MOVEL*BLANK    WN0022  3        AS Transaction
     C                     MOVEL*BLANK    WN0023  1        AS OMS Process
     C                     MOVEL*BLANK    WN0024  1        AS Process Code
     C                     MOVEL*BLANK    WN0025  1        AS Process Code
     C                     MOVEL*BLANK    WN0026  1        AS Carriage Ret
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @JTCPA0
     C                     MOVELWAASPD    WGASPD           AS Product Code
     C                     MOVELWAU5CD    WGU5CD           AS From Warehou
     C                     MOVELWAU6CD    WGU6CD           AS To Warehouse
     C                     MOVELWAHHDT    WGHHDT           AS Label Date
     C                     MOVELWAZAST    WGZAST           AS Inventory Pr
      *
     C           KLCHSI    KLIST
     C                     KFLD           WGASPD           AS Product Code
     C                     KFLD           WGU5CD           AS From Warehou
     C                     KFLD           WGU6CD           AS To Warehouse
     C                     KFLD           WGHHDT           AS Label Date
     C                     KFLD           WGZAST           AS Inventory Pr
     C           KLCHSI    CHAIN@JTCPA0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJTCPL1'MDACP
     C                     MOVEL'@JTCPA0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDJT1    YARDCS
      * Move non-key fields to @JTCPA0
     C                     MOVELWN0001    WGZCST           AS Error Code
     C                     MOVELWAXOCD    WGXOCD           AS Shift Number
     C                     MOVELWAXXCD    WGXXCD           AS Production D
      *
      * Set PGM.*Record Data Changed flag
     C           QPDJT1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVELWN0014    WGZAST           AS Inventory Pr
      * Set PGM.*Record Data Changed flag
     C           QPDJT1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@JTCPA0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDJTCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Program Setup      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0027    WHAJVN           User Profile Na
      * Establish starting position
     C           KRSSJ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHI6ST    WUI6ST           Allow Multi-Com
     C                     MOVELWHMPNA    WUMPNA           Default Printer
     C                     MOVELWHBCCD    WUBCCD           Salesperson Cod
     C                     MOVELWHBUVN    WN0028           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Retrieve Appl. Profile - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIAJVN           User Profile Na
     C                     KFLD           WIDNCD           Application Cod
      * Setup key
     C                     MOVELWL0008    WIAJVN           User Profile Na
     C                     MOVELWL0009    WIDNCD           Application Cod
      * Establish starting position
     C           KRSSK     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIAIC3    WL0010           Company Number
     C                     MOVELWIAJCD    WL0011           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WJAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WJAIC3           Company Number
      * Establish starting position
     C           KRSSL     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUADTX           Name
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJADTX    WUADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKDNCD    WQSM01           Application Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSM01           Application Cod
     C                     MOVEL'OMS'     WQSM01           Application Cod
      * Establish starting position
     C           KRSSM     SETLL@DNRESF                    *
     C           KRSSM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WKRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWKAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     C           KRSSM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKDNCD    WQSN01           Application Cod
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Application Cod
      * Setup key
     C                     MOVELWKRSCD    WQSN01           Application Cod
      * Establish starting position
     C           KRSSN     SETLL@DNRESF                    *
     C           KRSSN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKAUNA    WUAUNA           Description
     C           KRSSN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
      * Define work field Item Code
     C                     Z-ADD*ZERO     WUHGCD  70
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Iten Category N
     C                     Z-ADD*ZERO     WBSFNB           UnUsed NBR 5.2
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Packages (Trays
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           PM Crew Size
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           PM BOM Spec Dat
     C                     Z-ADD*ZERO     WBCNNB           PM Seaboard Spe
     C                     Z-ADD*ZERO     WBCRNB           PM Seaboard Rep
     C                     Z-ADD*ZERO     WBCSNB           PM Raw Yield
     C                     Z-ADD*ZERO     WBCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           CI Unused Wgt 1
     C                     Z-ADD*ZERO     WBF6WG           CI Unused Wgt 2
     C                     Z-ADD*ZERO     WBF7WG           CI Unused Wgt 3
     C                     Z-ADD*ZERO     WBBLNB           CI Unused Nbr 1
     C                     Z-ADD*ZERO     WBBNNB           CI Unused Nbr 2
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Unit Cost Per Pound
     C                     Z-ADD*ZERO     WUAGCS 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAECS           Last Cost
     C                     Z-ADD*ZERO     WDBACS           Cost per Primar
     C                     Z-ADD*ZERO     WDBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WDCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WDGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WDCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WDG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WDBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WDDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WDDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WDDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WDHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WDHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WDAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WDAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WDEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WDDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WDAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WDANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WDIDVA           Value of On Han
     C                     Z-ADD*ZERO     WDBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WDDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WDDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WDBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WDDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WDBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WDDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WDDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WDBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WDDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WDDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WDDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WDDMDT           Last Physical C
     C                     Z-ADD*ZERO     WDAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Clear all neither parameters
      * Crt Item Balance       CR - IC Item Balance  * 
     C                     Z-ADD*ZERO     WEAATM  60       Job Time
     C                     Z-ADD*ZERO     WEAXDT  70       Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Production Date
     C                     Z-ADD*ZERO     WUELDT  70
      * Define work field Calc 6
     C                     Z-ADD*ZERO     WUTTNB  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WFCQNB           Julian Date
     C                     Z-ADD*ZERO     WFESNB           Accounting Year
     C                     Z-ADD*ZERO     WFETNB           Accounting Peri
     C                     Z-ADD*ZERO     WFBZNB           OM Week
     C                     Z-ADD*ZERO     WFEINB           Week Number
     C                     Z-ADD*ZERO     WFAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Label Date
     C                     Z-ADD*ZERO     WUK7DT  70
      * Define work field Calc 7
     C                     Z-ADD*ZERO     WUTVNB  70
      * Define work field Calc 5
     C                     Z-ADD*ZERO     WUTSNB  50
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Define work field @Code 3A
     C                     MOVEL*BLANK    WURZCD  3
      * Define work field USR Work Field 3A
     C                     MOVEL*BLANK    WUEZTX  3
      * Define work field @AS Weight  7.0
     C                     MOVEL*BLANK    WUEIWG  7
      * Define work field AS Total Net Weight
     C                     MOVEL*BLANK    WUEMWG  7
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Salesperson Code
     C                     MOVEL*BLANK    WUBCCD  3
      * Define work field Allow Multi-Company
     C                     MOVEL*BLANK    WUI6ST  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHNLNB           Entity Number
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0002  30
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  3
     C                     Z-ADD*ZERO     WL0005 114
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0008 10
     C                     MOVEL*BLANK    WL0009  6
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Delete for Rework-Plant
00002 Transfer Warehouse-Plant
00003 Return to Plant
00004 Adjust Physical
